






<!DOCTYPE html>
<html lang="en" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark" data-a11y-animated-images="system">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-0946cdc16f15.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-3946c959759a.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-9b9a8c91acc5.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-11302a585e33.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-1a4564ab0fbf.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-12a8b2aa9101.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-5924a648f3e7.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-05358496cb79.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-aad6b801a158.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/color-modes-contrast-55dbfcae56ba.css" />
  
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-f08069444ca3.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-4b09d265965c.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-5344c827a597.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-eb757dedf4a1.css" />

    <meta name="optimizely-datafile" content="{&quot;groups&quot;: [], &quot;environmentKey&quot;: &quot;production&quot;, &quot;rollouts&quot;: [], &quot;typedAudiences&quot;: [], &quot;projectId&quot;: &quot;16737760170&quot;, &quot;variables&quot;: [], &quot;featureFlags&quot;: [], &quot;experiments&quot;: [], &quot;version&quot;: &quot;4&quot;, &quot;audiences&quot;: [{&quot;conditions&quot;: &quot;[\&quot;or\&quot;, {\&quot;match\&quot;: \&quot;exact\&quot;, \&quot;name\&quot;: \&quot;$opt_dummy_attribute\&quot;, \&quot;type\&quot;: \&quot;custom_attribute\&quot;, \&quot;value\&quot;: \&quot;$opt_dummy_value\&quot;}]&quot;, &quot;id&quot;: &quot;$opt_dummy_audience&quot;, &quot;name&quot;: &quot;Optimizely-Generated Audience for Backwards Compatibility&quot;}], &quot;anonymizeIP&quot;: true, &quot;sdkKey&quot;: &quot;WTc6awnGuYDdG98CYRban&quot;, &quot;attributes&quot;: [{&quot;id&quot;: &quot;16822470375&quot;, &quot;key&quot;: &quot;user_id&quot;}, {&quot;id&quot;: &quot;17143601254&quot;, &quot;key&quot;: &quot;spammy&quot;}, {&quot;id&quot;: &quot;18175660309&quot;, &quot;key&quot;: &quot;organization_plan&quot;}, {&quot;id&quot;: &quot;18813001570&quot;, &quot;key&quot;: &quot;is_logged_in&quot;}, {&quot;id&quot;: &quot;19073851829&quot;, &quot;key&quot;: &quot;geo&quot;}, {&quot;id&quot;: &quot;20175462351&quot;, &quot;key&quot;: &quot;requestedCurrency&quot;}, {&quot;id&quot;: &quot;20785470195&quot;, &quot;key&quot;: &quot;country_code&quot;}, {&quot;id&quot;: &quot;21656311196&quot;, &quot;key&quot;: &quot;opened_downgrade_dialog&quot;}], &quot;botFiltering&quot;: false, &quot;accountId&quot;: &quot;16737760170&quot;, &quot;events&quot;: [{&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;17911811441&quot;, &quot;key&quot;: &quot;hydro_click.dashboard.teacher_toolbox_cta&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18124116703&quot;, &quot;key&quot;: &quot;submit.organizations.complete_sign_up&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18145892387&quot;, &quot;key&quot;: &quot;no_metric.tracked_outside_of_optimizely&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18178755568&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.add_repo&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18180553241&quot;, &quot;key&quot;: &quot;submit.repository_imports.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18186103728&quot;, &quot;key&quot;: &quot;click.help.learn_more_about_repository_creation&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18188530140&quot;, &quot;key&quot;: &quot;test_event&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18191963644&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.transfer_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18195612788&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.import_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18210945499&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.invite_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18211063248&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.create_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18215721889&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.update_profile&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18224360785&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.dismiss&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18234832286&quot;, &quot;key&quot;: &quot;submit.organization_activation.complete&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18252392383&quot;, &quot;key&quot;: &quot;submit.org_repository.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18257551537&quot;, &quot;key&quot;: &quot;submit.org_member_invitation.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18259522260&quot;, &quot;key&quot;: &quot;submit.organization_profile.update&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18564603625&quot;, &quot;key&quot;: &quot;view.classroom_select_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18568612016&quot;, &quot;key&quot;: &quot;click.classroom_sign_in_click&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18572592540&quot;, &quot;key&quot;: &quot;view.classroom_name&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18574203855&quot;, &quot;key&quot;: &quot;click.classroom_create_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18582053415&quot;, &quot;key&quot;: &quot;click.classroom_select_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18589463420&quot;, &quot;key&quot;: &quot;click.classroom_create_classroom&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18591323364&quot;, &quot;key&quot;: &quot;click.classroom_create_first_classroom&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18591652321&quot;, &quot;key&quot;: &quot;click.classroom_grant_access&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18607131425&quot;, &quot;key&quot;: &quot;view.classroom_creation&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18831680583&quot;, &quot;key&quot;: &quot;upgrade_account_plan&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19064064515&quot;, &quot;key&quot;: &quot;click.signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19075373687&quot;, &quot;key&quot;: &quot;click.view_account_billing_page&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19077355841&quot;, &quot;key&quot;: &quot;click.dismiss_signup_prompt&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19079713938&quot;, &quot;key&quot;: &quot;click.contact_sales&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19120963070&quot;, &quot;key&quot;: &quot;click.compare_account_plans&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19151690317&quot;, &quot;key&quot;: &quot;click.upgrade_account_cta&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19424193129&quot;, &quot;key&quot;: &quot;click.open_account_switcher&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19520330825&quot;, &quot;key&quot;: &quot;click.visit_account_profile&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19540970635&quot;, &quot;key&quot;: &quot;click.switch_account_context&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19730198868&quot;, &quot;key&quot;: &quot;submit.homepage_signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19820830627&quot;, &quot;key&quot;: &quot;click.homepage_signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19988571001&quot;, &quot;key&quot;: &quot;click.create_enterprise_trial&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20036538294&quot;, &quot;key&quot;: &quot;click.create_organization_team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20040653299&quot;, &quot;key&quot;: &quot;click.input_enterprise_trial_form&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20062030003&quot;, &quot;key&quot;: &quot;click.continue_with_team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20068947153&quot;, &quot;key&quot;: &quot;click.create_organization_free&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20086636658&quot;, &quot;key&quot;: &quot;click.signup_continue.username&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20091648988&quot;, &quot;key&quot;: &quot;click.signup_continue.create_account&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20103637615&quot;, &quot;key&quot;: &quot;click.signup_continue.email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20111574253&quot;, &quot;key&quot;: &quot;click.signup_continue.password&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20120044111&quot;, &quot;key&quot;: &quot;view.pricing_page&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20152062109&quot;, &quot;key&quot;: &quot;submit.create_account&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20165800992&quot;, &quot;key&quot;: &quot;submit.upgrade_payment_form&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20171520319&quot;, &quot;key&quot;: &quot;submit.create_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20222645674&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.discuss_your_needs&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20227443657&quot;, &quot;key&quot;: &quot;submit.verify_primary_user_email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20234607160&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.try_enterprise&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20238175784&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20239847212&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.continue_free&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20251097193&quot;, &quot;key&quot;: &quot;recommended_plan&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20438619534&quot;, &quot;key&quot;: &quot;click.pricing_calculator.1_member&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20456699683&quot;, &quot;key&quot;: &quot;click.pricing_calculator.15_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20467868331&quot;, &quot;key&quot;: &quot;click.pricing_calculator.10_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20476267432&quot;, &quot;key&quot;: &quot;click.trial_days_remaining&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20476357660&quot;, &quot;key&quot;: &quot;click.discover_feature&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20479287901&quot;, &quot;key&quot;: &quot;click.pricing_calculator.custom_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20481107083&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.apply_teacher_benefits&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20483089392&quot;, &quot;key&quot;: &quot;click.pricing_calculator.5_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20484283944&quot;, &quot;key&quot;: &quot;click.onboarding_task&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20484996281&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.apply_student_benefits&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20486713726&quot;, &quot;key&quot;: &quot;click.onboarding_task_breadcrumb&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20490791319&quot;, &quot;key&quot;: &quot;click.upgrade_to_enterprise&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20491786766&quot;, &quot;key&quot;: &quot;click.talk_to_us&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20494144087&quot;, &quot;key&quot;: &quot;click.dismiss_enterprise_trial&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20499722759&quot;, &quot;key&quot;: &quot;completed_all_tasks&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20500710104&quot;, &quot;key&quot;: &quot;completed_onboarding_tasks&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20513160672&quot;, &quot;key&quot;: &quot;click.read_doc&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20516196762&quot;, &quot;key&quot;: &quot;actions_enabled&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20518980986&quot;, &quot;key&quot;: &quot;click.dismiss_trial_banner&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20535446721&quot;, &quot;key&quot;: &quot;click.issue_actions_prompt.dismiss_prompt&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20557002247&quot;, &quot;key&quot;: &quot;click.issue_actions_prompt.setup_workflow&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20595070227&quot;, &quot;key&quot;: &quot;click.pull_request_setup_workflow&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20626600314&quot;, &quot;key&quot;: &quot;click.seats_input&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20642310305&quot;, &quot;key&quot;: &quot;click.decrease_seats_number&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20662990045&quot;, &quot;key&quot;: &quot;click.increase_seats_number&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20679620969&quot;, &quot;key&quot;: &quot;click.public_product_roadmap&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20761240940&quot;, &quot;key&quot;: &quot;click.dismiss_survey_banner&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20767210721&quot;, &quot;key&quot;: &quot;click.take_survey&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20795281201&quot;, &quot;key&quot;: &quot;click.archive_list&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20966790249&quot;, &quot;key&quot;: &quot;contact_sales.submit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20996500333&quot;, &quot;key&quot;: &quot;contact_sales.existing_customer&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20996890162&quot;, &quot;key&quot;: &quot;contact_sales.blank_message_field&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21000470317&quot;, &quot;key&quot;: &quot;contact_sales.personal_email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21002790172&quot;, &quot;key&quot;: &quot;contact_sales.blank_phone_field&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21354412592&quot;, &quot;key&quot;: &quot;click.dismiss_create_readme&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21366102546&quot;, &quot;key&quot;: &quot;click.dismiss_zero_user_content&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21370252505&quot;, &quot;key&quot;: &quot;account_did_downgrade&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21370840408&quot;, &quot;key&quot;: &quot;click.cta_create_readme&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21375451068&quot;, &quot;key&quot;: &quot;click.cta_create_new_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21385390948&quot;, &quot;key&quot;: &quot;click.zero_user_content&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21467712175&quot;, &quot;key&quot;: &quot;click.downgrade_keep&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21484112202&quot;, &quot;key&quot;: &quot;click.downgrade&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21495292213&quot;, &quot;key&quot;: &quot;click.downgrade_survey_exit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21508241468&quot;, &quot;key&quot;: &quot;click.downgrade_survey_submit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21512030356&quot;, &quot;key&quot;: &quot;click.downgrade_support&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21539090022&quot;, &quot;key&quot;: &quot;click.downgrade_exit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21543640644&quot;, &quot;key&quot;: &quot;click_fetch_upstream&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21646510300&quot;, &quot;key&quot;: &quot;click.move_your_work&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21656151116&quot;, &quot;key&quot;: &quot;click.add_branch_protection_rule&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21663860599&quot;, &quot;key&quot;: &quot;click.downgrade_dialog_open&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21687860483&quot;, &quot;key&quot;: &quot;click.learn_about_protected_branches&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21689050333&quot;, &quot;key&quot;: &quot;click.dismiss_protect_this_branch&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21864370109&quot;, &quot;key&quot;: &quot;click.sign_in&quot;}], &quot;revision&quot;: &quot;1372&quot;}" />


  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-451d2fee086f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-327bbf-0aaeb22dd2a5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_soft-nav_soft-nav_ts-de360abf3418.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/environment-9fa8265d4c66.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-2646a2c533e3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-99e288659d4f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_fzy_js_index_js-node_modules_github_markdown-toolbar-element_dist_index_js-e3de700a4c9d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-44ef1e-ff95e778f461.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_details-dialog-element_dist_index_js-node_modules_github_memoize_-8664b7-b1d9fac72bf3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_delegated-events_dist_in-d36001-e1c38c8467da.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_text-ex-3415a8-7ecc10fb88d0.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_tab-container-element_dist_index_js-node_modules_github_auto-comp-bf192d-81631767a9f8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_view-components_app_components_primer_primer_js-node_modules_gith-6a1af4-1744f0940b1b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-a576981e43d1.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-081092cbde8f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-9d9fe1859ce5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_alive-client_dist-bf5aa2-424aa982deef.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-ba0e4d5b3207.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_hotkey_dist_index_js-b47a28757074.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_dimensions_js-node_modules_github_hydro-analyt-f69502-d8672aa6f36b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_color-convert_index_js-35b3ae68c408.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_github_template-parts_lib_-273494-0fb4f42e57f4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_paste-markdown_dist_index_esm_js-node_modules_github_quote-select-1bdbba-dd6debfb8eb8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_updatable-content_ts-70e6c1269039.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_keyboard-shortcuts-helper_ts-app_assets_modules_github_bl-1f24ae-60413f6f3a61.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_onfocus_ts-app_ass-dbc08c-c80bb6d2e713.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_sticky-scroll-into-view_ts-1d145b63ed56.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-2e2258-dae7d38e0248.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-80a9915bf75c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-af0fd5d569dd.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-06ff531-fe0b8ccc90a5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-86e9ba7bffb7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_optimizely_optimizely-sdk_dist_optimizely_browser_es_min_js-node_modules-3f2a9e-fc88059edf41.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/optimizely-88264c7905d8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_morphdom_dist_morphdom-esm_js-node_modules_github_template-parts_lib_index_js-58417dae193c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_virtualized-list_es_index_js-node_modules_github_memoize_dist_esm_index_js-8496b7c4b809.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_mini-th-34a24a-01ff22798072.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_ref-selector_ts-7bdefeb88a1a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/repositories-1e8ac8fa769f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-414f05-4046b86b0100.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_clipboard-copy-element_dist_index_esm_js-node_modules_github_mini-17eb43-0e309b61f5f6.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-f96c66-3aec21e0f76c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/diffs-33e9e3a841ed.js"></script>
  

  <title>cgenie.muffin/sedgem_box_benthic.f90 at _DEV_FeNIP2N · derpycode/cgenie.muffin</title>



  <meta name="route-pattern" content="/:user_id/:repository/blob/*name(/*path)">

    
  <meta name="current-catalog-service-hash" content="581425c0eaaa5e5e53c5b736f58a14dbe5d38b0be425901738ad0670bd1d5a33">


  <meta name="request-id" content="EBEC:56CF:4A533A9:4ED1524:6435E8B6" data-turbo-transient="true" /><meta name="html-safe-nonce" content="ebeccf17a233dd4f9f4b697481d2ef936b16d30d73a5f02921a21d6034054162" data-turbo-transient="true" /><meta name="visitor-payload" content="eyJyZWZlcnJlciI6Imh0dHBzOi8vZ2l0aHViLmNvbS9kZXJweWNvZGUvY2dlbmllLm11ZmZpbi90cmVlL19ERVZfRmVOSVAyTi9nZW5pZS1zZWRnZW0vc3JjL2ZvcnRyYW4iLCJyZXF1ZXN0X2lkIjoiRUJFQzo1NkNGOjRBNTMzQTk6NEVEMTUyNDo2NDM1RThCNiIsInZpc2l0b3JfaWQiOiIxODk2NzY2MTU3ODQyOTA0NDI1IiwicmVnaW9uX2VkZ2UiOiJzZWEiLCJyZWdpb25fcmVuZGVyIjoiaWFkIn0=" data-turbo-transient="true" /><meta name="visitor-hmac" content="babf244edcecb3726fd20906b88d5799f9f40ffc3ae25a4d9b96569f82940f4d" data-turbo-transient="true" />


    <meta name="hovercard-subject-tag" content="repository:133421586" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,source-code,file-tree" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_source" data-turbo-transient>

    <meta name="google-site-verification" content="c1kuD-K2HIVF635lypcsWPoD4kilo5-jA_wBFyT4uMY">
  <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
  <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
  <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">
  <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" /><meta name="octolytics-actor-id" content="10086766" /><meta name="octolytics-actor-login" content="derpycode" /><meta name="octolytics-actor-hash" content="3eed2ff799b1a475f847af280ee21b7596d7dc7666a597290b057acc3c269f30" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-turbo-transient="true" />

  




  

    <meta name="user-login" content="derpycode">

  <link rel="sudo-modal" href="/sessions/sudo_modal">

    <meta name="viewport" content="width=device-width">
    
      <meta name="description" content="Contribute to derpycode/cgenie.muffin development by creating an account on GitHub.">
      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905" />
      <meta name="twitter:image:src" content="https://opengraph.githubassets.com/bfde43916bf4f0ec009893d82e5ef304fa2f3ba05a35baf71aeac467378c929a/derpycode/cgenie.muffin" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="cgenie.muffin/sedgem_box_benthic.f90 at _DEV_FeNIP2N · derpycode/cgenie.muffin" /><meta name="twitter:description" content="Contribute to derpycode/cgenie.muffin development by creating an account on GitHub." />
      <meta property="og:image" content="https://opengraph.githubassets.com/bfde43916bf4f0ec009893d82e5ef304fa2f3ba05a35baf71aeac467378c929a/derpycode/cgenie.muffin" /><meta property="og:image:alt" content="Contribute to derpycode/cgenie.muffin development by creating an account on GitHub." /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="cgenie.muffin/sedgem_box_benthic.f90 at _DEV_FeNIP2N · derpycode/cgenie.muffin" /><meta property="og:url" content="https://github.com/derpycode/cgenie.muffin" /><meta property="og:description" content="Contribute to derpycode/cgenie.muffin development by creating an account on GitHub." />
      
    <link rel="assets" href="https://github.githubassets.com/">
      <link rel="shared-web-socket" href="wss://alive.github.com/_sockets/u/10086766/ws?session=eyJ2IjoiVjMiLCJ1IjoxMDA4Njc2NiwicyI6MTA5NTEwNDQwNywiYyI6MjcwNDk0OTY2NSwidCI6MTY4MTI1NDU5MH0=--e4622e13146c0207eb0f5ab994969f71bc71e736ed5edf8281e64346b9fb2e40" data-refresh-url="/_alive" data-session-id="b2c4e7164822425a69eac3fd2992081d11285524e373e5b95cc5ea3db241a5a8">
      <link rel="shared-web-socket-src" href="/assets-cdn/worker/socket-worker-71e98f781d79.js">


        <meta name="hostname" content="github.com">


      <meta name="keyboard-shortcuts-preference" content="all">
      <script type="application/json" id="memex_keyboard_shortcuts_preference">"all"</script>

        <meta name="expected-hostname" content="github.com">

    <meta name="enabled-features" content="TURBO_EXPERIMENT_RISKY,IMAGE_METRIC_TRACKING,GEOJSON_AZURE_MAPS,SLASH_COMMANDS_NEW_LINE,SLASH_COMMANDS_DELAY">


  <meta http-equiv="x-pjax-version" content="adbefbb30cc9e6bf30f8a5d28c13ebd12b56500efb92694f4c914710861bb3e6" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="0db263f9a873141d8256f783c35f244c06d490aacc3b680f99794dd8fd59fb59" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="bb9fa2fabb43ec5c9e06212854a00dc829061571cbe6be16734f29eed6ebe83f" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="2b8684439a381242e10550291f727f332a0a40d74e9410923fc0a1517c5ce802" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

        <meta data-hydrostats="publish">

  <meta name="go-import" content="github.com/derpycode/cgenie.muffin git https://github.com/derpycode/cgenie.muffin.git">

  <meta name="octolytics-dimension-user_id" content="10086766" /><meta name="octolytics-dimension-user_login" content="derpycode" /><meta name="octolytics-dimension-repository_id" content="133421586" /><meta name="octolytics-dimension-repository_nwo" content="derpycode/cgenie.muffin" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="133421586" /><meta name="octolytics-dimension-repository_network_root_nwo" content="derpycode/cgenie.muffin" />



    <link rel="canonical" href="https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" data-turbo-transient>
  <meta name="turbo-body-classes" content="logged-in env-production page-responsive page-blob">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <meta name="browser-optimizely-client-errors-url" content="https://api.github.com/_private/browser/optimizely_client/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />


  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-in env-production page-responsive page-blob" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-in env-production page-responsive page-blob" style="word-wrap: break-word;">
      


    <div class="position-relative js-header-wrapper ">
      <a href="#start-of-content" class="p-3 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>
      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      


        <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_command-palette-api_dist_command-palette-api_js-node_modules_gith-2eba16-be919efb60d2.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_clipboard-copy-element_dist_index_esm_js-node_modules_github_mini-dd78dd-e63b84b25be7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_command-palette_items_help-item_ts-app_assets_modules_github_comman-48ad9d-caa3c9446740.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/command-palette-a2687563d1c6.js"></script>

            <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap" role="banner">

    <div class="Header-item mt-n1 mb-n1  d-none d-md-flex">
      <a
  class="Header-link"
  href="https://github.com/"
  data-hotkey="g d"
  aria-label="Homepage "
  data-turbo="false"
  data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;go to dashboard&quot;,&quot;label&quot;:&quot;icon:logo&quot;}"
>
  <svg height="32" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github v-align-middle">
    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
</svg>
</a>

    </div>

    <div class="Header-item d-md-none">
        <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="Header-link js-details-target btn-link">    <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="octicon octicon-three-bars">
    <path d="M1 2.75A.75.75 0 0 1 1.75 2h12.5a.75.75 0 0 1 0 1.5H1.75A.75.75 0 0 1 1 2.75Zm0 5A.75.75 0 0 1 1.75 7h12.5a.75.75 0 0 1 0 1.5H1.75A.75.75 0 0 1 1 7.75ZM1.75 12h12.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</button>    </div>

    <div class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
              



<div class="header-search flex-auto position-relative js-site-search flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"
>
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="133421586" data-scoped-search-url="/derpycode/cgenie.muffin/search" data-owner-scoped-search-url="/users/derpycode/search" data-unscoped-search-url="/search" data-turbo="false" action="/derpycode/cgenie.muffin/search" accept-charset="UTF-8" method="get">
      <label class="form-control header-search-wrapper input-sm p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
        <input type="text"
          class="form-control js-site-search-focus header-search-input jump-to-field js-jump-to-field js-site-search-field is-clearable"
          data-hotkey=s,/
          name="q"
          
          placeholder="Search or jump to…"
          data-unscoped-placeholder="Search or jump to…"
          data-scoped-placeholder="Search or jump to…"
          autocapitalize="off"
          role="combobox"
          aria-haspopup="listbox"
          aria-expanded="false"
          aria-autocomplete="list"
          aria-controls="jump-to-results"
          aria-label="Search or jump to…"
          data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations"
          spellcheck="false"
          autocomplete="off"
        >
        <input type="hidden" value="WRNU6HghIlMp4PX8Cnr3pVgFLkKYAuYXU-QfK7mwmoXC6XWfs-DTBhY1BBvQztFO-sik1H20u3RTwCSoPynTRg" data-csrf="true" class="js-data-jump-to-suggestions-path-csrf" />
        <input type="hidden" class="js-site-search-type-field" name="type" >
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="20" aria-hidden="true" class="mr-1 header-search-key-slash"><path fill="none" stroke="#979A9C" opacity=".4" d="M3.5.5h12c1.7 0 3 1.3 3 3v13c0 1.7-1.3 3-3 3h-12c-1.7 0-3-1.3-3-3v-13c0-1.7 1.3-3 3-3z"></path><path fill="#979A9C" d="M11.8 6L8 15.1h-.9L10.8 6h1z"></path></svg>


          <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
            
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="suggestion">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="color-fg-muted">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="scoped_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-owner-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="owner_scoped_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this user">
        In this user
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="global_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="m-3 anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
    </li>
</ul>

          </div>
      </label>
</form>  </div>
</div>

        <nav id="global-nav" class="d-flex flex-column flex-md-row flex-self-stretch flex-md-self-auto" aria-label="Global">
    <a class="Header-link py-md-3 d-block d-md-none py-2 border-top border-md-top-0 border-white-fade" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" data-turbo="false" href="/dashboard">Dashboard</a>

  <a class="js-selected-navigation-item Header-link mt-md-n3 mb-md-n3 py-2 py-md-3 mr-0 mr-md-3 border-top border-md-top-0 border-white-fade" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-turbo="false" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="/pulls">
      Pull<span class="d-inline d-md-none d-lg-inline"> request</span>s
</a>
  <a class="js-selected-navigation-item Header-link mt-md-n3 mb-md-n3 py-2 py-md-3 mr-0 mr-md-3 border-top border-md-top-0 border-white-fade" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-turbo="false" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="/issues">Issues</a>

      <a class="js-selected-navigation-item Header-link mt-md-n3 mb-md-n3 py-2 py-md-3 mr-0 mr-md-3 border-top border-md-top-0 border-white-fade" data-ga-click="Header, click, Nav menu - item:workspaces context:user" data-turbo="false" data-selected-links="/codespaces /codespaces" href="/codespaces">Codespaces</a>

    <div class="d-flex position-relative">
      <a class="js-selected-navigation-item Header-link flex-auto mt-md-n3 mb-md-n3 py-2 py-md-3 mr-0 mr-md-3 border-top border-md-top-0 border-white-fade" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-turbo="false" data-selected-links=" /marketplace" href="/marketplace">Marketplace</a>
    </div>

  <a class="js-selected-navigation-item Header-link mt-md-n3 mb-md-n3 py-2 py-md-3 mr-0 mr-md-3 border-top border-md-top-0 border-white-fade" data-ga-click="Header, click, Nav menu - item:explore" data-turbo="false" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">Explore</a>

      <a class="js-selected-navigation-item Header-link d-block d-md-none py-2 py-md-3 border-top border-md-top-0 border-white-fade" data-ga-click="Header, click, Nav menu - item:Sponsors" data-hydro-click="{&quot;event_type&quot;:&quot;sponsors.button_click&quot;,&quot;payload&quot;:{&quot;button&quot;:&quot;HEADER_SPONSORS_DASHBOARD&quot;,&quot;sponsorable_login&quot;:&quot;derpycode&quot;,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="fc4042c8e45afe3f63bcd11d4d659bbb7b9ebb2bff99f4c6cc435d3bbb1aa5e6" data-turbo="false" data-selected-links=" /sponsors/accounts" href="/sponsors/accounts">Sponsors</a>

    <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-3 border-top border-md-top-0 border-white-fade" data-turbo="false" href="/settings/profile">Settings</a>

    <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-3 border-top border-md-top-0 border-white-fade" data-turbo="false" href="/derpycode">
      <img class="avatar avatar-user" loading="lazy" decoding="async" src="https://avatars.githubusercontent.com/u/10086766?s=40&amp;v=4" width="20" height="20" alt="@derpycode" />
      derpycode
</a>
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form data-turbo="false" action="/logout" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="7t4qE1eT012QXZfG0FMzFxDjkmC_Q1oUBMNcnAY2sk7kWTrv57vSP-h6nCcZcC7dQjfnXGo7WM26i0p27MHi7A" />
      <button
        type="submit"
        class="Header-link mr-0 mr-md-3 py-2 py-md-3 border-top border-md-top-0 border-white-fade d-md-none btn-link d-block width-full text-left"
        style="padding-left: 2px;"
        data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;sign out&quot;,&quot;label&quot;:&quot;icon:logout&quot;}"
      >
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sign-out v-align-middle">
    <path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"></path>
</svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
        <a
  class="Header-link"
  href="https://github.com/"
  data-hotkey="g d"
  aria-label="Homepage "
  data-turbo="false"
  data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;go to dashboard&quot;,&quot;label&quot;:&quot;icon:logo&quot;}"
>
  <svg height="32" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github v-align-middle">
    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
</svg>
</a>

    </div>

    <div class="Header-item mr-0 mr-md-3 flex-order-1 flex-md-order-none">
        

<notification-indicator data-channel="eyJjIjoibm90aWZpY2F0aW9uLWNoYW5nZWQ6MTAwODY3NjYiLCJ0IjoxNjgxMjU0NTkwfQ==--2a585819789e0f2086a84da1bade52627e8321f682aaa37bbc5209b7cffadfb6" data-indicator-mode="none" data-tooltip-global="You have unread notifications" data-tooltip-unavailable="Notifications are unavailable at the moment." data-tooltip-none="You have no unread notifications" data-fetch-indicator-src="/notifications/indicator" data-fetch-indicator-enabled="true" data-view-component="true" class="js-socket-channel">
  <a id="AppHeader-notifications-button" href="/notifications"
    class="Header-link notification-indicator position-relative tooltipped tooltipped-sw"

    

    data-hotkey="g n"
    data-target="notification-indicator.link"
    aria-label="Notifications"

      data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;go to notifications&quot;,&quot;label&quot;:&quot;icon:read&quot;}"
  >

    <span
      data-target="notification-indicator.badge"
      class="mail-status unread" hidden>
    </span>

      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>
  </a>

</notification-indicator>
    </div>


    <div class="Header-item position-relative d-none d-md-flex">
        <details class="details-overlay details-reset">
  <summary
    class="Header-link"
    aria-label="Create new…"
    data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;create new&quot;,&quot;label&quot;:&quot;icon:add&quot;}"
  >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-plus">
    <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"></path>
</svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw">
    
<a role="menuitem" class="dropdown-item" href="/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

  <a role="menuitem" class="dropdown-item" href="/codespaces/new">
    New codespace
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>



  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-md-flex">
        
  <details class="details-overlay details-reset js-feature-preview-indicator-container" data-feature-preview-indicator-src="/users/derpycode/feature_preview/indicator_check">

  <summary
    class="Header-link"
    aria-label="View profile and more"
    data-analytics-event="{&quot;category&quot;:&quot;Header&quot;,&quot;action&quot;:&quot;show menu&quot;,&quot;label&quot;:&quot;icon:avatar&quot;}"
  >
    <img src="https://avatars.githubusercontent.com/u/10086766?s=40&amp;v=4" alt="@derpycode" size="20" height="20" width="20" data-view-component="true" class="avatar avatar-small circle" />
      <span class="unread-indicator js-feature-preview-indicator" style="top: 1px;" hidden></span>
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu
      class="dropdown-menu dropdown-menu-sw"
      style="width: 180px"
      
      preload>
      <include-fragment src="/users/10086766/menu" loading="lazy">
        <p class="text-center mt-3" data-hide-on-error>
          <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
        </p>
        <p class="ml-1 mb-2 mt-2 color-fg-default" data-show-on-error>
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
          Sorry, something went wrong.
        </p>
      </include-fragment>
  </details-menu>
</details>

    </div>
</header>

            
    </div>

  <div id="start-of-content" class="show-on-focus"></div>







    <div id="js-flash-container" data-turbo-replace>





  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div class="px-2" >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    
    <notification-shelf-watcher data-base-url="https://github.com/notifications/beta/shelf" data-channel="eyJjIjoibm90aWZpY2F0aW9uLWNoYW5nZWQ6MTAwODY3NjYiLCJ0IjoxNjgxMjU0NTkwfQ==--2a585819789e0f2086a84da1bade52627e8321f682aaa37bbc5209b7cffadfb6" data-view-component="true" class="js-socket-channel"></notification-shelf-watcher>
  <div hidden data-initial data-target="notification-shelf-watcher.placeholder"></div>






      <details
  class="details-reset details-overlay details-overlay-dark js-command-palette-dialog"
  id="command-palette-pjax-container"
  data-turbo-replace
>
  <summary aria-label="command palette trigger" tabindex="-1"></summary>
  <details-dialog class="command-palette-details-dialog d-flex flex-column flex-justify-center height-fit" aria-label="command palette">
    <command-palette
      class="command-palette color-bg-default rounded-3 border color-shadow-small"
      return-to=/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90
      user-id="10086766"
      activation-hotkey="Mod+k,Mod+Alt+k"
      command-mode-hotkey="Mod+Shift+k"
      data-action="
        command-palette-input-ready:command-palette#inputReady
        command-palette-page-stack-updated:command-palette#updateInputScope
        itemsUpdated:command-palette#itemsUpdated
        keydown:command-palette#onKeydown
        loadingStateChanged:command-palette#loadingStateChanged
        selectedItemChanged:command-palette#selectedItemChanged
        pageFetchError:command-palette#pageFetchError
      ">

        <command-palette-mode
          data-char="#"
            data-scope-types="[&quot;&quot;]"
            data-placeholder="Search issues and pull requests"
        ></command-palette-mode>
        <command-palette-mode
          data-char="#"
            data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
            data-placeholder="Search issues, pull requests, discussions, and projects"
        ></command-palette-mode>
        <command-palette-mode
          data-char="!"
            data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
            data-placeholder="Search projects"
        ></command-palette-mode>
        <command-palette-mode
          data-char="@"
            data-scope-types="[&quot;&quot;]"
            data-placeholder="Search or jump to a user, organization, or repository"
        ></command-palette-mode>
        <command-palette-mode
          data-char="@"
            data-scope-types="[&quot;owner&quot;]"
            data-placeholder="Search or jump to a repository"
        ></command-palette-mode>
        <command-palette-mode
          data-char="/"
            data-scope-types="[&quot;repository&quot;]"
            data-placeholder="Search files"
        ></command-palette-mode>
        <command-palette-mode
          data-char="?"
        ></command-palette-mode>
        <command-palette-mode
          data-char="&gt;"
            data-placeholder="Run a command"
        ></command-palette-mode>
        <command-palette-mode
          data-char=""
            data-scope-types="[&quot;&quot;]"
            data-placeholder="Search or jump to..."
        ></command-palette-mode>
        <command-palette-mode
          data-char=""
            data-scope-types="[&quot;owner&quot;]"
            data-placeholder="Search or jump to..."
        ></command-palette-mode>
      <command-palette-mode
        class="js-command-palette-default-mode"
        data-char=""
        data-placeholder="Search or jump to..."
      ></command-palette-mode>

      <command-palette-input placeholder="Search or jump to..."

        data-action="
          command-palette-input:command-palette#onInput
          command-palette-select:command-palette#onSelect
          command-palette-descope:command-palette#onDescope
          command-palette-cleared:command-palette#onInputClear
        "
      >
        <div class="js-search-icon d-flex flex-items-center mr-2" style="height: 26px">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search color-fg-muted">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
        </div>
        <div class="js-spinner d-flex flex-items-center mr-2 color-fg-muted" hidden>
          <svg aria-label="Loading" class="anim-rotate" viewBox="0 0 16 16" fill="none" width="16" height="16">
            <circle
              cx="8"
              cy="8"
              r="7"
              stroke="currentColor"
              stroke-opacity="0.25"
              stroke-width="2"
              vector-effect="non-scaling-stroke"
            ></circle>
            <path
              d="M15 8a7.002 7.002 0 00-7-7"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              vector-effect="non-scaling-stroke"
            ></path>
          </svg>
        </div>
        <command-palette-scope >
          <div data-target="command-palette-scope.placeholder" hidden class="color-fg-subtle">/&nbsp;&nbsp;<span class="text-semibold color-fg-default">...</span>&nbsp;&nbsp;/&nbsp;&nbsp;</div>
              <command-palette-token
                data-text="derpycode"
                data-id="MDQ6VXNlcjEwMDg2NzY2"
                data-type="owner"
                data-value="derpycode"
                data-targets="command-palette-scope.tokens"
                class="color-fg-default text-semibold"
                style="white-space:nowrap;line-height:20px;"
                >derpycode<span class="color-fg-subtle text-normal">&nbsp;&nbsp;/&nbsp;&nbsp;</span></command-palette-token>
              <command-palette-token
                data-text="cgenie.muffin"
                data-id="MDEwOlJlcG9zaXRvcnkxMzM0MjE1ODY="
                data-type="repository"
                data-value="cgenie.muffin"
                data-targets="command-palette-scope.tokens"
                class="color-fg-default text-semibold"
                style="white-space:nowrap;line-height:20px;"
                >cgenie.muffin<span class="color-fg-subtle text-normal">&nbsp;&nbsp;/&nbsp;&nbsp;</span></command-palette-token>
        </command-palette-scope>
        <div class="command-palette-input-group flex-1 form-control border-0 box-shadow-none" style="z-index: 0">
          <div class="command-palette-typeahead position-absolute d-flex flex-items-center Truncate">
            <span class="typeahead-segment input-mirror" data-target="command-palette-input.mirror"></span>
            <span class="Truncate-text" data-target="command-palette-input.typeaheadText"></span>
            <span class="typeahead-segment" data-target="command-palette-input.typeaheadPlaceholder"></span>
          </div>
          <input
            class="js-overlay-input typeahead-input d-none"
            disabled
            tabindex="-1"
            aria-label="Hidden input for typeahead"
          >
          <input
            type="text"
            autocomplete="off"
            autocorrect="off"
            autocapitalize="off"
            spellcheck="false"
            class="js-input typeahead-input form-control border-0 box-shadow-none input-block width-full no-focus-indicator"
            aria-label="Command palette input"
            aria-haspopup="listbox"
            aria-expanded="false"
            aria-autocomplete="list"
            aria-controls="command-palette-page-stack"
            role="combobox"
            data-action="
              input:command-palette-input#onInput
              keydown:command-palette-input#onKeydown
            "
          >
        </div>
          <div data-view-component="true" class="position-relative d-inline-block">
    <button aria-keyshortcuts="Control+Backspace" data-action="click:command-palette-input#onClear keypress:command-palette-input#onClear" data-target="command-palette-input.clearButton" id="command-palette-clear-button" hidden="hidden" type="button" data-view-component="true" class="btn-octicon command-palette-input-clear-button">      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x-circle-fill">
    <path d="M2.343 13.657A8 8 0 1 1 13.658 2.343 8 8 0 0 1 2.343 13.657ZM6.03 4.97a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042L6.94 8 4.97 9.97a.749.749 0 0 0 .326 1.275.749.749 0 0 0 .734-.215L8 9.06l1.97 1.97a.749.749 0 0 0 1.275-.326.749.749 0 0 0-.215-.734L9.06 8l1.97-1.97a.749.749 0 0 0-.326-1.275.749.749 0 0 0-.734.215L8 6.94Z"></path>
</svg>
</button>    <tool-tip id="tooltip-04be403f-944d-402c-a78b-663450ddb68a" for="command-palette-clear-button" data-direction="w" data-type="label" data-view-component="true" class="sr-only position-absolute">Clear Command Palette</tool-tip>
</div>
      </command-palette-input>

      <command-palette-page-stack
        data-default-scope-id="MDEwOlJlcG9zaXRvcnkxMzM0MjE1ODY="
        data-default-scope-type="Repository"
        data-action="command-palette-page-octicons-cached:command-palette-page-stack#cacheOcticons"
      >
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">#</kbd> to search pull requests
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">#</kbd> to search issues
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">#</kbd> to search discussions
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">!</kbd> to search projects
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;owner&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">@</kbd> to search teams
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">@</kbd> to search people and organizations
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type <kbd class="hx_kbd">&gt;</kbd> to activate command mode
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode=""
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Go to your accessibility settings to change your keyboard shortcuts
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode="#"
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type author:@me to search your content
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode="#"
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type is:pr to filter to pull requests
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode="#"
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type is:issue to filter to issues
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
            data-mode="#"
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type is:project to filter to projects
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
          <command-palette-tip
            class="color-fg-muted f6 px-3 py-1 my-2"
              data-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
            data-mode="#"
            data-value="">
            <div class="d-flex flex-items-start flex-justify-between">
              <div>
                <span class="text-bold">Tip:</span>
                  Type is:open to filter to open content
              </div>
              <div class="ml-2 flex-shrink-0">
                Type <kbd class="hx_kbd">?</kbd> for help and tips
              </div>
            </div>
          </command-palette-tip>
        <command-palette-tip class="mx-3 my-2 flash flash-error d-flex flex-items-center" data-scope-types="*" data-on-error>
          <div>
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
          </div>
          <div class="px-2">
            We’ve encountered an error and some results aren't available at this time. Type a new search or try again later.
          </div>
        </command-palette-tip>
        <command-palette-tip class="h4 color-fg-default pl-3 pb-2 pt-3" data-on-empty data-scope-types="*" data-match-mode="[^?]|^$">
          No results matched your search
        </command-palette-tip>

        <div hidden>

            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="arrow-right-color-fg-muted">
              <svg height="16" class="octicon octicon-arrow-right color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="arrow-right-color-fg-default">
              <svg height="16" class="octicon octicon-arrow-right color-fg-default" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="codespaces-color-fg-muted">
              <svg height="16" class="octicon octicon-codespaces color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M0 11.25c0-.966.784-1.75 1.75-1.75h12.5c.966 0 1.75.784 1.75 1.75v3A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm2-9.5C2 .784 2.784 0 3.75 0h8.5C13.216 0 14 .784 14 1.75v5a1.75 1.75 0 0 1-1.75 1.75h-8.5A1.75 1.75 0 0 1 2 6.75Zm1.75-.25a.25.25 0 0 0-.25.25v5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5a.25.25 0 0 0-.25-.25Zm-2 9.5a.25.25 0 0 0-.25.25v3c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-3a.25.25 0 0 0-.25-.25Z"></path><path d="M7 12.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="copy-color-fg-muted">
              <svg height="16" class="octicon octicon-copy color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="dash-color-fg-muted">
              <svg height="16" class="octicon octicon-dash color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M2 7.75A.75.75 0 0 1 2.75 7h10a.75.75 0 0 1 0 1.5h-10A.75.75 0 0 1 2 7.75Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="file-color-fg-muted">
              <svg height="16" class="octicon octicon-file color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="gear-color-fg-muted">
              <svg height="16" class="octicon octicon-gear color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="lock-color-fg-muted">
              <svg height="16" class="octicon octicon-lock color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M4 4a4 4 0 0 1 8 0v2h.25c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 12.25 15h-8.5A1.75 1.75 0 0 1 2 13.25v-5.5C2 6.784 2.784 6 3.75 6H4Zm8.25 3.5h-8.5a.25.25 0 0 0-.25.25v5.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25ZM10.5 6V4a2.5 2.5 0 1 0-5 0v2Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="moon-color-fg-muted">
              <svg height="16" class="octicon octicon-moon color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M9.598 1.591a.749.749 0 0 1 .785-.175 7.001 7.001 0 1 1-8.967 8.967.75.75 0 0 1 .961-.96 5.5 5.5 0 0 0 7.046-7.046.75.75 0 0 1 .175-.786Zm1.616 1.945a7 7 0 0 1-7.678 7.678 5.499 5.499 0 1 0 7.678-7.678Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="person-color-fg-muted">
              <svg height="16" class="octicon octicon-person color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M10.561 8.073a6.005 6.005 0 0 1 3.432 5.142.75.75 0 1 1-1.498.07 4.5 4.5 0 0 0-8.99 0 .75.75 0 0 1-1.498-.07 6.004 6.004 0 0 1 3.431-5.142 3.999 3.999 0 1 1 5.123 0ZM10.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="pencil-color-fg-muted">
              <svg height="16" class="octicon octicon-pencil color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="issue-opened-open">
              <svg height="16" class="octicon octicon-issue-opened open" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="git-pull-request-draft-color-fg-muted">
              <svg height="16" class="octicon octicon-git-pull-request-draft color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M3.25 1A2.25 2.25 0 0 1 4 5.372v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.251 2.251 0 0 1 3.25 1Zm9.5 14a2.25 2.25 0 1 1 0-4.5 2.25 2.25 0 0 1 0 4.5ZM2.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0ZM3.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm9.5 0a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM14 7.5a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Zm0-4.25a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="search-color-fg-muted">
              <svg height="16" class="octicon octicon-search color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="sun-color-fg-muted">
              <svg height="16" class="octicon octicon-sun color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8 12a4 4 0 1 1 0-8 4 4 0 0 1 0 8Zm0-1.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Zm5.657-8.157a.75.75 0 0 1 0 1.061l-1.061 1.06a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.06-1.06a.75.75 0 0 1 1.06 0Zm-9.193 9.193a.75.75 0 0 1 0 1.06l-1.06 1.061a.75.75 0 1 1-1.061-1.06l1.06-1.061a.75.75 0 0 1 1.061 0ZM8 0a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0ZM3 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 3 8Zm13 0a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 16 8Zm-8 5a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 8 13Zm3.536-1.464a.75.75 0 0 1 1.06 0l1.061 1.06a.75.75 0 0 1-1.06 1.061l-1.061-1.06a.75.75 0 0 1 0-1.061ZM2.343 2.343a.75.75 0 0 1 1.061 0l1.06 1.061a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-1.06-1.06a.75.75 0 0 1 0-1.06Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="sync-color-fg-muted">
              <svg height="16" class="octicon octicon-sync color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="trash-color-fg-muted">
              <svg height="16" class="octicon octicon-trash color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="key-color-fg-muted">
              <svg height="16" class="octicon octicon-key color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M10.5 0a5.499 5.499 0 1 1-1.288 10.848l-.932.932a.749.749 0 0 1-.53.22H7v.75a.749.749 0 0 1-.22.53l-.5.5a.749.749 0 0 1-.53.22H5v.75a.749.749 0 0 1-.22.53l-.5.5a.749.749 0 0 1-.53.22h-2A1.75 1.75 0 0 1 0 14.25v-2c0-.199.079-.389.22-.53l4.932-4.932A5.5 5.5 0 0 1 10.5 0Zm-4 5.5c-.001.431.069.86.205 1.269a.75.75 0 0 1-.181.768L1.5 12.56v1.69c0 .138.112.25.25.25h1.69l.06-.06v-1.19a.75.75 0 0 1 .75-.75h1.19l.06-.06v-1.19a.75.75 0 0 1 .75-.75h1.19l1.023-1.025a.75.75 0 0 1 .768-.18A4 4 0 1 0 6.5 5.5ZM11 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="comment-discussion-color-fg-muted">
              <svg height="16" class="octicon octicon-comment-discussion color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1ZM1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="bell-color-fg-muted">
              <svg height="16" class="octicon octicon-bell color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="bell-slash-color-fg-muted">
              <svg height="16" class="octicon octicon-bell-slash color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="m4.182 4.31.016.011 10.104 7.316.013.01 1.375.996a.75.75 0 1 1-.88 1.214L13.626 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947V5.305L.31 3.357a.75.75 0 1 1 .88-1.214Zm7.373 7.19L4.5 6.391v1.556c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01c0 .005.002.009.005.012l.006.004.007.001ZM8 1.5c-.997 0-1.895.416-2.534 1.086A.75.75 0 1 1 4.38 1.55 5 5 0 0 1 13 5v2.373a.75.75 0 0 1-1.5 0V5A3.5 3.5 0 0 0 8 1.5ZM8 16a2 2 0 0 1-1.985-1.75c-.017-.137.097-.25.235-.25h3.5c.138 0 .252.113.235.25A2 2 0 0 1 8 16Z"></path></svg>
            </div>
            <div data-targets="command-palette-page-stack.localOcticons" data-octicon-id="paintbrush-color-fg-muted">
              <svg height="16" class="octicon octicon-paintbrush color-fg-muted" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path d="M11.134 1.535c.7-.509 1.416-.942 2.076-1.155.649-.21 1.463-.267 2.069.34.603.601.568 1.411.368 2.07-.202.668-.624 1.39-1.125 2.096-1.011 1.424-2.496 2.987-3.775 4.249-1.098 1.084-2.132 1.839-3.04 2.3a3.744 3.744 0 0 1-1.055 3.217c-.431.431-1.065.691-1.657.861-.614.177-1.294.287-1.914.357A21.151 21.151 0 0 1 .797 16H.743l.007-.75H.749L.742 16a.75.75 0 0 1-.743-.742l.743-.008-.742.007v-.054a21.25 21.25 0 0 1 .13-2.284c.067-.647.187-1.287.358-1.914.17-.591.43-1.226.86-1.657a3.746 3.746 0 0 1 3.227-1.054c.466-.893 1.225-1.907 2.314-2.982 1.271-1.255 2.833-2.75 4.245-3.777ZM1.62 13.089c-.051.464-.086.929-.104 1.395.466-.018.932-.053 1.396-.104a10.511 10.511 0 0 0 1.668-.309c.526-.151.856-.325 1.011-.48a2.25 2.25 0 1 0-3.182-3.182c-.155.155-.329.485-.48 1.01a10.515 10.515 0 0 0-.309 1.67Zm10.396-10.34c-1.224.89-2.605 2.189-3.822 3.384l1.718 1.718c1.21-1.205 2.51-2.597 3.387-3.833.47-.662.78-1.227.912-1.662.134-.444.032-.551.009-.575h-.001V1.78c-.014-.014-.113-.113-.548.027-.432.14-.995.462-1.655.942Zm-4.832 7.266-.001.001a9.859 9.859 0 0 0 1.63-1.142L7.155 7.216a9.7 9.7 0 0 0-1.161 1.607c.482.302.889.71 1.19 1.192Z"></path></svg>
            </div>

            <command-palette-item-group
              data-group-id="top"
              data-group-title="Top result"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="0"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="commands"
              data-group-title="Commands"
              data-group-hint="Type &gt; to filter"
              data-group-limits="{&quot;static_items_page&quot;:50,&quot;issue&quot;:50,&quot;pull_request&quot;:50,&quot;discussion&quot;:50}"
              data-default-priority="1"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="global_commands"
              data-group-title="Global Commands"
              data-group-hint="Type &gt; to filter"
              data-group-limits="{&quot;issue&quot;:0,&quot;pull_request&quot;:0,&quot;discussion&quot;:0}"
              data-default-priority="2"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="this_page"
              data-group-title="This Page"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="3"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="files"
              data-group-title="Files"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="4"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="default"
              data-group-title="Default"
              data-group-hint=""
              data-group-limits="{&quot;static_items_page&quot;:50}"
              data-default-priority="5"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="pages"
              data-group-title="Pages"
              data-group-hint=""
              data-group-limits="{&quot;repository&quot;:10}"
              data-default-priority="6"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="access_policies"
              data-group-title="Access Policies"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="7"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="organizations"
              data-group-title="Organizations"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="8"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="repositories"
              data-group-title="Repositories"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="9"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="references"
              data-group-title="Issues, pull requests, and discussions"
              data-group-hint="Type # to filter"
              data-group-limits="{}"
              data-default-priority="10"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="teams"
              data-group-title="Teams"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="11"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="users"
              data-group-title="Users"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="12"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="memex_projects"
              data-group-title="Projects"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="13"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="projects"
              data-group-title="Projects (classic)"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="14"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="footer"
              data-group-title="Footer"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="15"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="modes_help"
              data-group-title="Modes"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="16"
            >
            </command-palette-item-group>
            <command-palette-item-group
              data-group-id="filters_help"
              data-group-title="Use filters in issues, pull requests, discussions, and projects"
              data-group-hint=""
              data-group-limits="{}"
              data-default-priority="17"
            >
            </command-palette-item-group>

            <command-palette-page
              data-page-title="derpycode"
              data-scope-id="MDQ6VXNlcjEwMDg2NzY2"
              data-scope-type="owner"
              data-targets="command-palette-page-stack.defaultPages"
              hidden
            >
            </command-palette-page>
            <command-palette-page
              data-page-title="cgenie.muffin"
              data-scope-id="MDEwOlJlcG9zaXRvcnkxMzM0MjE1ODY="
              data-scope-type="repository"
              data-targets="command-palette-page-stack.defaultPages"
              hidden
            >
            </command-palette-page>
        </div>

        <command-palette-page data-is-root>
        </command-palette-page>
          <command-palette-page
            data-page-title="derpycode"
            data-scope-id="MDQ6VXNlcjEwMDg2NzY2"
            data-scope-type="owner"
          >
          </command-palette-page>
          <command-palette-page
            data-page-title="cgenie.muffin"
            data-scope-id="MDEwOlJlcG9zaXRvcnkxMzM0MjE1ODY="
            data-scope-type="repository"
          >
          </command-palette-page>
      </command-palette-page-stack>

      <server-defined-provider data-type="search-links" data-targets="command-palette.serverDefinedProviderElements"></server-defined-provider>
      <server-defined-provider data-type="help" data-targets="command-palette.serverDefinedProviderElements">
          <command-palette-help
            data-group="modes_help"
              data-prefix="#"
              data-scope-types="[&quot;&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Search for <strong>issues</strong> and <strong>pull requests</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">#</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="modes_help"
              data-prefix="#"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Search for <strong>issues, pull requests, discussions,</strong> and <strong>projects</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">#</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="modes_help"
              data-prefix="@"
              data-scope-types="[&quot;&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Search for <strong>organizations, repositories,</strong> and <strong>users</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">@</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="modes_help"
              data-prefix="!"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Search for <strong>projects</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">!</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="modes_help"
              data-prefix="/"
              data-scope-types="[&quot;repository&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Search for <strong>files</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">/</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="modes_help"
              data-prefix="&gt;"
          >
            <span data-target="command-palette-help.titleElement">Activate <strong>command mode</strong></span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd">&gt;</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# author:@me"
          >
            <span data-target="command-palette-help.titleElement">Search your issues, pull requests, and discussions</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># author:@me</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# author:@me"
          >
            <span data-target="command-palette-help.titleElement">Search your issues, pull requests, and discussions</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># author:@me</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# is:pr"
          >
            <span data-target="command-palette-help.titleElement">Filter to pull requests</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># is:pr</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# is:issue"
          >
            <span data-target="command-palette-help.titleElement">Filter to issues</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># is:issue</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# is:discussion"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Filter to discussions</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># is:discussion</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# is:project"
              data-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          >
            <span data-target="command-palette-help.titleElement">Filter to projects</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># is:project</kbd>
              </span>
          </command-palette-help>
          <command-palette-help
            data-group="filters_help"
              data-prefix="# is:open"
          >
            <span data-target="command-palette-help.titleElement">Filter to open issues, pull requests, and discussions</span>
              <span data-target="command-palette-help.hintElement">
                <kbd class="hx_kbd"># is:open</kbd>
              </span>
          </command-palette-help>
      </server-defined-provider>

        <server-defined-provider
          data-type="commands"
          data-fetch-debounce="0"
            data-src="/command_palette/commands"
          data-supported-modes="[]"
            data-supports-commands
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="prefetched"
          data-fetch-debounce="0"
            data-src="/command_palette/jump_to_page_navigation"
          data-supported-modes="[&quot;&quot;]"
            data-supported-scope-types="[&quot;&quot;,&quot;owner&quot;,&quot;repository&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/issues"
          data-supported-modes="[&quot;#&quot;,&quot;#&quot;]"
            data-supported-scope-types="[&quot;owner&quot;,&quot;repository&quot;,&quot;&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/jump_to"
          data-supported-modes="[&quot;@&quot;,&quot;@&quot;]"
            data-supported-scope-types="[&quot;&quot;,&quot;owner&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/jump_to_members_only"
          data-supported-modes="[&quot;@&quot;,&quot;@&quot;,&quot;&quot;,&quot;&quot;]"
            data-supported-scope-types="[&quot;&quot;,&quot;owner&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="prefetched"
          data-fetch-debounce="0"
            data-src="/command_palette/jump_to_members_only_prefetched"
          data-supported-modes="[&quot;@&quot;,&quot;@&quot;,&quot;&quot;,&quot;&quot;]"
            data-supported-scope-types="[&quot;&quot;,&quot;owner&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="files"
          data-fetch-debounce="0"
            data-src="/command_palette/files"
          data-supported-modes="[&quot;/&quot;]"
            data-supported-scope-types="[&quot;repository&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/discussions"
          data-supported-modes="[&quot;#&quot;]"
            data-supported-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/projects"
          data-supported-modes="[&quot;#&quot;,&quot;!&quot;]"
            data-supported-scope-types="[&quot;owner&quot;,&quot;repository&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="prefetched"
          data-fetch-debounce="0"
            data-src="/command_palette/recent_issues"
          data-supported-modes="[&quot;#&quot;,&quot;#&quot;]"
            data-supported-scope-types="[&quot;owner&quot;,&quot;repository&quot;,&quot;&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/teams"
          data-supported-modes="[&quot;@&quot;,&quot;&quot;]"
            data-supported-scope-types="[&quot;owner&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
        <server-defined-provider
          data-type="remote"
          data-fetch-debounce="200"
            data-src="/command_palette/name_with_owner_repository"
          data-supported-modes="[&quot;@&quot;,&quot;@&quot;,&quot;&quot;,&quot;&quot;]"
            data-supported-scope-types="[&quot;&quot;,&quot;owner&quot;]"
          
          data-targets="command-palette.serverDefinedProviderElements"
          ></server-defined-provider>
    </command-palette>
  </details-dialog>
</details>

<div class="position-fixed bottom-0 left-0 ml-5 mb-5 js-command-palette-toasts" style="z-index: 1000">
  <div hidden class="Toast Toast--loading">
    <span class="Toast-icon">
      <svg class="Toast--spinner" viewBox="0 0 32 32" width="18" height="18" aria-hidden="true">
        <path
          fill="#959da5"
          d="M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"
        />
        <path fill="#ffffff" d="M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"></path>
      </svg>
    </span>
    <span class="Toast-content"></span>
  </div>

  <div hidden class="anim-fade-in fast Toast Toast--error">
    <span class="Toast-icon">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-stop">
    <path d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
    </span>
    <span class="Toast-content"></span>
  </div>

  <div hidden class="anim-fade-in fast Toast Toast--warning">
    <span class="Toast-icon">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    </span>
    <span class="Toast-content"></span>
  </div>


  <div hidden class="anim-fade-in fast Toast Toast--success">
    <span class="Toast-icon">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </span>
    <span class="Toast-content"></span>
  </div>

  <div hidden class="anim-fade-in fast Toast">
    <span class="Toast-icon">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-info">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
    </span>
    <span class="Toast-content"></span>
  </div>
</div>


  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container" >
      
  


    






  
  <div id="repository-container-header"  class="pt-3 hide-full-screen" style="background-color: var(--color-page-header-bg);" data-turbo-replace>

      <div class="d-flex flex-wrap flex-justify-end mb-3  px-3 px-md-4 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit mr-3">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/users/derpycode/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/derpycode">
        derpycode
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="/derpycode/cgenie.muffin">cgenie.muffin</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" data-turbo-replace>
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      <li>
  <div class="float-left" >
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form data-turbo="false" action="/derpycode/cgenie.muffin/profile_pin" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="TjIE9CyQ5d9QlllVzdK-52c6xvo_UQRI3W1QGpB4fPCnGajP_Q8yuKyFcqeZBtyvxZ8Tvc8MtoCF6zkAQdI-Sw" autocomplete="off" />
        <button title="Pin this repository to your profile" type="submit" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pin mr-2">
    <path d="M4.456.734a1.75 1.75 0 0 1 2.826.504l.613 1.327a3.08 3.08 0 0 0 2.084 1.707l2.454.584c1.332.317 1.8 1.972.832 2.94L11.06 10l3.72 3.72a.748.748 0 0 1-.332 1.265.75.75 0 0 1-.729-.205L10 11.06l-2.204 2.205c-.968.968-2.623.5-2.94-.832l-.584-2.454a3.08 3.08 0 0 0-1.707-2.084l-1.327-.613a1.75 1.75 0 0 1-.504-2.826ZM5.92 1.866a.253.253 0 0 0-.183-.142.251.251 0 0 0-.221.07L1.794 5.516a.251.251 0 0 0-.07.221c.015.08.068.149.142.183l1.328.613A4.582 4.582 0 0 1 5.73 9.63l.584 2.454a.251.251 0 0 0 .42.12l5.47-5.47a.25.25 0 0 0-.12-.42L9.63 5.73a4.583 4.583 0 0 1-3.098-2.537Z"></path>
</svg>Pin
</button></form>  </div>
</li>


  <li>
        <include-fragment loading="lazy" src="/notifications/133421586/watch_subscription?aria_id_prefix=repository-details&amp;button_block=false&amp;show_count=true">
    <div data-hide-on-error>
        
            <button disabled="disabled" aria-label="Watching a repository" type="button" data-view-component="true" class="tooltipped tooltipped-n Button--secondary Button--small Button">    <span class="Button-content">
        <span class="Button-visual Button-leadingVisual">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-eye">
    <path d="M8 2c1.981 0 3.671.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.45.678-1.367 1.932-2.637 3.023C11.67 13.008 9.981 14 8 14c-1.981 0-3.671-.992-4.933-2.078C1.797 10.83.88 9.576.43 8.898a1.62 1.62 0 0 1 0-1.798c.45-.677 1.367-1.931 2.637-3.022C4.33 2.992 6.019 2 8 2ZM1.679 7.932a.12.12 0 0 0 0 .136c.411.622 1.241 1.75 2.366 2.717C5.176 11.758 6.527 12.5 8 12.5c1.473 0 2.825-.742 3.955-1.715 1.124-.967 1.954-2.096 2.366-2.717a.12.12 0 0 0 0-.136c-.412-.621-1.242-1.75-2.366-2.717C10.824 4.242 9.473 3.5 8 3.5c-1.473 0-2.825.742-3.955 1.715-1.124.967-1.954 2.096-2.366 2.717ZM8 10a2 2 0 1 1-.001-3.999A2 2 0 0 1 8 10Z"></path>
</svg>
        </span>
      <span class="Button-label">Watch</span>
    </span>
</button>  

    </div>
    <p data-show-on-error hidden>
        
          <span class="d-flex pt-1">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert mr-1">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
            Couldn't load subscription status.&nbsp;
              <button data-retry-button="" type="button" data-view-component="true" class="Button--link Button--medium Button">    <span class="Button-content">
      <span class="Button-label">Retry</span>
    </span>
</button>  

          </span>

    </p>
  </include-fragment>
  </li>

  <li>
        <div data-view-component="true" class="d-flex">
        <div data-view-component="true" class="position-relative d-inline-block">
    <a icon="repo-forked" id="fork-button" href="/derpycode/cgenie.muffin/fork" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="97c5d77987ba6e40c97bfba82062c83fd3f90225397868cf3e9ea1b35a8ecf19" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" data-view-component="true" class="btn-sm btn BtnGroup-item border-right-0">      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
          <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="18" data-view-component="true" class="Counter">18</span>
</a>    <tool-tip id="tooltip-53149f6e-ad9f-40d9-8c59-da22999e121c" for="fork-button" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute">Fork your own copy of derpycode/cgenie.muffin</tool-tip>
</div>
      <details group_item="true" id="my-forks-menu-133421586" data-view-component="true" class="details-reset details-overlay BtnGroup-parent d-inline-block position-relative">
              <summary aria-label="See your forks of this repository" data-view-component="true" class="btn-sm btn BtnGroup-item px-2 float-none">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
</summary>
  <details-menu
    class="SelectMenu right-0"
      src="/derpycode/cgenie.muffin/my_forks_menu_content?can_fork=true"
      
      role="menu"
      
>
    <div class="SelectMenu-modal">
        <button class="SelectMenu-closeButton position-absolute right-0 m-2" type="button" aria-label="Close menu" data-toggle-for="details-38bc7f">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </button>
      <div
        id="filter-menu-38bc7f"
        class="d-flex flex-column flex-1 overflow-hidden"
>
        <div
          class="SelectMenu-list"
          >

            <include-fragment class="SelectMenu-loading" aria-label="Loading">
              <svg role="menuitem" style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
            </include-fragment>
        </div>
        
      </div>
    </div>
  </details-menu>
</details></div>
  </li>

  <li>
        <template class="js-unstar-confirmation-dialog-template">
  <div class="Box-header">
    <h2 class="Box-title">Unstar this repository?</h2>
  </div>
  <div class="Box-body">
    <p class="mb-3">
      This will remove {{ repoNameWithOwner }} from the {{ listsWithCount }} that it's been added to.
    </p>
    <div class="form-actions">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-social-confirmation-form" data-turbo="false" action="{{ confirmUrl }}" accept-charset="UTF-8" method="post">
        <input type="hidden" name="authenticity_token" value="{{ confirmCsrfToken }}">
        <input type="hidden" name="confirm" value="true">
          <button data-close-dialog="true" type="submit" data-view-component="true" class="btn-danger btn width-full">    Unstar
</button>
</form>    </div>
  </div>
</template>

  <div data-view-component="true" class="js-toggler-container js-social-container starring-container d-flex">
    <div data-view-component="true" class="starred BtnGroup flex-1">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-social-form BtnGroup-parent flex-auto js-deferred-toggler-target" data-turbo="false" action="/derpycode/cgenie.muffin/unstar" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="9ecUZ2mEHetS9jfjPfNn0iX3HATPiG2suO_n1u2b8Aq5NiGdjvgrE4hZkkdND6ikfWkDdzUx4SWzI-1tGNtYTQ" autocomplete="off" />
          <input type="hidden" value="yrIqtDcv6W707CJUwfXsHLrR9hmM3txrBwH2DgVC2-OGYx9O0FPfli5Dh_CxCSNq4k_panZnUOIMzfy18AJzpA" data-csrf="true" class="js-confirm-csrf-token" />
        <input type="hidden" name="context" value="repository">
          <button data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="9419330f61bc82e30ba89974aaa0d92686f1a4a3b07e36dcbd8ea4330d1addce" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar" aria-label="Unstar this repository (28)" type="submit" data-view-component="true" class="rounded-left-2 btn-sm btn BtnGroup-item">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star-fill starred-button-icon d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Z"></path>
</svg><span data-view-component="true" class="d-inline">
            Starred
</span>            <span id="repo-stars-counter-unstar" aria-label="28 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="28" data-view-component="true" class="Counter js-social-count">28</span>
</button></form>        <details id="details-user-list-133421586-starred" data-view-component="true" class="details-reset details-overlay BtnGroup-parent js-user-list-menu d-inline-block position-relative">
        <summary aria-label="Add this repository to a list" data-view-component="true" class="btn-sm btn BtnGroup-item px-2 float-none">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
</summary>
  <details-menu
    class="SelectMenu right-0"
      src="/derpycode/cgenie.muffin/lists"
      
      role="menu"
      
>
    <div class="SelectMenu-modal">
        <button class="SelectMenu-closeButton position-absolute right-0 m-2" type="button" aria-label="Close menu" data-toggle-for="details-da8aa5">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </button>
      <div
        id="filter-menu-da8aa5"
        class="d-flex flex-column flex-1 overflow-hidden"
>
        <div
          class="SelectMenu-list"
          >

            <include-fragment class="SelectMenu-loading" aria-label="Loading">
              <svg role="menuitem" style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
            </include-fragment>
        </div>
        
      </div>
    </div>
  </details-menu>
</details>
</div>
    <div data-view-component="true" class="unstarred BtnGroup flex-1">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-social-form BtnGroup-parent flex-auto" data-turbo="false" action="/derpycode/cgenie.muffin/star" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="iBqwFjK3QUrK_CMh_2uNLqZobBxG-44C7SjVCDd2lstMSPSCAHicM9oh94Mj3mA8auQaVZJlC2V02DCPZlXTVw" autocomplete="off" />
        <input type="hidden" name="context" value="repository">
          <button data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="4f549e64550172bc6db737a7d704813e51baddfc250df677b54ec05e8b1c3e06" data-ga-click="Repository, click star button, action:blob#show; text:Star" aria-label="Star this repository (28)" type="submit" data-view-component="true" class="js-toggler-target rounded-left-2 btn-sm btn BtnGroup-item">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
            Star
</span>            <span id="repo-stars-counter-star" aria-label="28 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="28" data-view-component="true" class="Counter js-social-count">28</span>
</button></form>        <details id="details-user-list-133421586-unstarred" data-view-component="true" class="details-reset details-overlay BtnGroup-parent js-user-list-menu d-inline-block position-relative">
        <summary aria-label="Add this repository to a list" data-view-component="true" class="btn-sm btn BtnGroup-item px-2 float-none">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
</summary>
  <details-menu
    class="SelectMenu right-0"
      src="/derpycode/cgenie.muffin/lists"
      
      role="menu"
      
>
    <div class="SelectMenu-modal">
        <button class="SelectMenu-closeButton position-absolute right-0 m-2" type="button" aria-label="Close menu" data-toggle-for="details-77e268">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </button>
      <div
        id="filter-menu-77e268"
        class="d-flex flex-column flex-1 overflow-hidden"
>
        <div
          class="SelectMenu-list"
          >

            <include-fragment class="SelectMenu-loading" aria-label="Loading">
              <svg role="menuitem" style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
            </include-fragment>
        </div>
        
      </div>
    </div>
  </details-menu>
</details>
</div></div>
  </li>


    

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace>
</div>


          <nav data-pjax="#js-repo-pjax-container" aria-label="Repository" data-view-component="true" class="js-repo-nav js-sidenav-container-pjax js-responsive-underlinenav overflow-hidden UnderlineNav px-3 px-md-4 px-lg-5">

  <ul data-view-component="true" class="UnderlineNav-body list-style-none">
      <li data-view-component="true" class="d-inline-flex">
  <a id="code-tab" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N" data-tab-item="i0code-tab" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments /derpycode/cgenie.muffin/tree/_DEV_FeNIP2N" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g c" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Code&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" aria-current="page" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item selected">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon d-none d-sm-inline">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        <span data-content="Code">Code</span>
          <span id="code-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="issues-tab" href="/derpycode/cgenie.muffin/issues" data-tab-item="i1issues-tab" data-selected-links="repo_issues repo_labels repo_milestones /derpycode/cgenie.muffin/issues" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g i" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Issues&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        <span data-content="Issues">Issues</span>
          <span id="issues-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="3" data-view-component="true" class="Counter">3</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="pull-requests-tab" href="/derpycode/cgenie.muffin/pulls" data-tab-item="i2pull-requests-tab" data-selected-links="repo_pulls checks /derpycode/cgenie.muffin/pulls" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g p" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Pull requests&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        <span data-content="Pull requests">Pull requests</span>
          <span id="pull-requests-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="1" data-view-component="true" class="Counter">1</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="actions-tab" href="/derpycode/cgenie.muffin/actions" data-tab-item="i3actions-tab" data-selected-links="repo_actions /derpycode/cgenie.muffin/actions" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g a" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Actions&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        <span data-content="Actions">Actions</span>
          <span id="actions-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="projects-tab" href="/derpycode/cgenie.muffin/projects" data-tab-item="i4projects-tab" data-selected-links="repo_projects new_repo_project repo_project /derpycode/cgenie.muffin/projects" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g b" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Projects&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        <span data-content="Projects">Projects</span>
          <span id="projects-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="wiki-tab" href="/derpycode/cgenie.muffin/wiki" data-tab-item="i5wiki-tab" data-selected-links="repo_wiki /derpycode/cgenie.muffin/wiki" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g w" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Wiki&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
        <span data-content="Wiki">Wiki</span>
          <span id="wiki-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="security-tab" href="/derpycode/cgenie.muffin/security" data-tab-item="i6security-tab" data-selected-links="security overview alerts policy token_scanning code_scanning /derpycode/cgenie.muffin/security" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g s" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Security&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield UnderlineNav-octicon d-none d-sm-inline">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span data-content="Security">Security</span>
          <include-fragment src="/derpycode/cgenie.muffin/security/overall-count" accept="text/fragment+html"></include-fragment>

    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="insights-tab" href="/derpycode/cgenie.muffin/pulse" data-tab-item="i7insights-tab" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /derpycode/cgenie.muffin/pulse" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Insights&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        <span data-content="Insights">Insights</span>
          <span id="insights-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="settings-tab" href="/derpycode/cgenie.muffin/settings" data-tab-item="i8settings-tab" data-selected-links="code_review_limits codespaces_repository_settings collaborators custom_tabs hooks integration_installations interaction_limits issue_template_editor key_links_settings notifications repo_actions_settings repo_announcements repo_branch_settings repo_keys_settings repo_pages_settings repo_rule_insights repo_rulesets repo_protected_tags_settings repo_settings reported_content repo_custom_properties repository_actions_settings_add_new_runner repository_actions_settings_general repository_actions_settings_runners repository_environments role_details secrets secrets_settings_actions secrets_settings_codespaces secrets_settings_dependabot security_analysis /derpycode/cgenie.muffin/settings" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Settings&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-gear UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"></path>
</svg>
        <span data-content="Settings">Settings</span>
          <span id="settings-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
</ul>
    <div style="visibility:hidden;" data-view-component="true" class="UnderlineNav-actions js-responsive-underlinenav-overflow position-absolute pr-3 pr-md-4 pr-lg-5 right-0">      <details data-view-component="true" class="details-overlay details-reset position-relative">
  <summary role="button" data-view-component="true">          <div class="UnderlineNav-item mr-0 border-0">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
            <span class="sr-only">More</span>
          </div>
</summary>
  <details-menu role="menu" data-view-component="true" class="dropdown-menu dropdown-menu-sw">          <ul>
              <li data-menu-item="i0code-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item selected dropdown-item" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments /derpycode/cgenie.muffin/tree/_DEV_FeNIP2N" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N">
                  Code
</a>              </li>
              <li data-menu-item="i1issues-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_issues repo_labels repo_milestones /derpycode/cgenie.muffin/issues" href="/derpycode/cgenie.muffin/issues">
                  Issues
</a>              </li>
              <li data-menu-item="i2pull-requests-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_pulls checks /derpycode/cgenie.muffin/pulls" href="/derpycode/cgenie.muffin/pulls">
                  Pull requests
</a>              </li>
              <li data-menu-item="i3actions-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_actions /derpycode/cgenie.muffin/actions" href="/derpycode/cgenie.muffin/actions">
                  Actions
</a>              </li>
              <li data-menu-item="i4projects-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_projects new_repo_project repo_project /derpycode/cgenie.muffin/projects" href="/derpycode/cgenie.muffin/projects">
                  Projects
</a>              </li>
              <li data-menu-item="i5wiki-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_wiki /derpycode/cgenie.muffin/wiki" href="/derpycode/cgenie.muffin/wiki">
                  Wiki
</a>              </li>
              <li data-menu-item="i6security-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="security overview alerts policy token_scanning code_scanning /derpycode/cgenie.muffin/security" href="/derpycode/cgenie.muffin/security">
                  Security
</a>              </li>
              <li data-menu-item="i7insights-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /derpycode/cgenie.muffin/pulse" href="/derpycode/cgenie.muffin/pulse">
                  Insights
</a>              </li>
              <li data-menu-item="i8settings-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="code_review_limits codespaces_repository_settings collaborators custom_tabs hooks integration_installations interaction_limits issue_template_editor key_links_settings notifications repo_actions_settings repo_announcements repo_branch_settings repo_keys_settings repo_pages_settings repo_rule_insights repo_rulesets repo_protected_tags_settings repo_settings reported_content repo_custom_properties repository_actions_settings_add_new_runner repository_actions_settings_general repository_actions_settings_runners repository_environments role_details secrets secrets_settings_actions secrets_settings_codespaces secrets_settings_dependabot security_analysis /derpycode/cgenie.muffin/settings" href="/derpycode/cgenie.muffin/settings">
                  Settings
</a>              </li>
          </ul>
</details-menu>
</details></div>
</nav>

  </div>

  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content " >
      <a href="https://github.dev/" class="d-none js-github-dev-shortcut" data-hotkey=".">Open in github.dev</a>
  <a href="https://github.dev/" class="d-none js-github-dev-new-tab-shortcut" data-hotkey="Shift+.,Shift+&gt;,&gt;" target="_blank">Open in a new github.dev tab</a>



    
      
  <div class="clearfix container-xl px-3 px-md-4 px-lg-5 mt-4">
    
    
<div >
  

  



    
<a class="d-none js-permalink-shortcut" data-hotkey="y" href="/derpycode/cgenie.muffin/blob/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90">Permalink</a>

<div class="d-flex flex-items-start flex-shrink-0 pb-3 flex-wrap flex-md-nowrap flex-justify-between flex-md-justify-start">
  
<div class="position-relative">
  <details
    class="js-branch-select-menu details-reset details-overlay mr-0 mb-0 "
    id="branch-select-menu"
    data-hydro-click-payload="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;REFS_SELECTOR_MENU&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="28bbed79d30c8e13e659c55abb34b242669a1dafa927d5bc042b79846a0b0577">
    <summary class="btn css-truncate"
            data-hotkey="w"
            title="Switch branches or tags">
      <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
      <span class="css-truncate-target" data-menu-button>_DEV_FeNIP2N</span>
      <span class="dropdown-caret"></span>
    </summary>

    
<div class="SelectMenu">
  <div class="SelectMenu-modal">
    <header class="SelectMenu-header">
      <span class="SelectMenu-title">Switch branches/tags</span>
      <button class="SelectMenu-closeButton" type="button" data-toggle-for="branch-select-menu"><svg aria-label="Close menu" aria-hidden="false" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </header>

    <input-demux data-action="tab-container-change:input-demux#storeInput tab-container-changed:input-demux#updateInput">
      <tab-container class="d-flex flex-column js-branches-tags-tabs" style="min-height: 0;">
        <div class="SelectMenu-filter">
          <input data-target="input-demux.source"
                 id="context-commitish-filter-field"
                 class="SelectMenu-input form-control"
                 aria-owns="ref-list-branches"
                 data-controls-ref-menu-id="ref-list-branches"
                 autofocus
                 autocomplete="off"
                 aria-label="Find or create a branch…"
                 placeholder="Find or create a branch…"
                 type="text"
          >
        </div>

        <div class="SelectMenu-tabs" role="tablist" data-target="input-demux.control" >
          <button class="SelectMenu-tab" type="button" role="tab" aria-selected="true">Branches</button>
          <button class="SelectMenu-tab" type="button" role="tab">Tags</button>
        </div>

        <div role="tabpanel" id="ref-list-branches" data-filter-placeholder="Find or create a branch…" tabindex="" class="d-flex flex-column flex-auto overflow-auto">
          <ref-selector
            type="branch"
            data-targets="input-demux.sinks"
            data-action="
              input-entered:ref-selector#inputEntered
              tab-selected:ref-selector#tabSelected
              focus-list:ref-selector#focusFirstListMember
            "
            query-endpoint="/derpycode/cgenie.muffin/refs"
            can-create
            cache-key="v0:1681016321.0"
            current-committish="X0RFVl9GZU5JUDJO"
            default-branch="bWFzdGVy"
            name-with-owner="ZGVycHljb2RlL2NnZW5pZS5tdWZmaW4="
            prefetch-on-mouseover
          >

            <template data-target="ref-selector.fetchFailedTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Could not load branches</div>
            </template>

              <template data-target="ref-selector.noMatchTemplate">
    <create-repo-from-selector
      check-tag-name-exists-path="/derpycode/cgenie.muffin/branches/check_tag_name_exists"
    >
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form data-turbo="false" action="/derpycode/cgenie.muffin/branches" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="3kcJ0CrHsieCQMyPZeb1o_-Vyll9xYYOLPLm_RHM5b9GisCvL2voEnuFb2KZXznA1HdGjCr7iwdq21InXXZR-w" />
        <input data-target="create-repo-from-selector.refName" type="hidden" name="name" value="{{ refName }}">
        <input type="hidden" name="branch"  value="_DEV_FeNIP2N">
        <input type="hidden" name="path_binary" value="Z2VuaWUtc2VkZ2VtL3NyYy9mb3J0cmFuL3NlZGdlbV9ib3hfYmVudGhpYy5mOTA=">

        <button
          class="SelectMenu-item wb-break-word"
          type="submit"
          role="menuitem"
          data-index="{{ index }}"
          data-action="click:create-repo-from-selector#createBranch"
          data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;REFS_SELECTOR_MENU_CREATE_BRANCH&quot;,&quot;repository_id&quot;:133421586,&quot;ref_name&quot;:&quot;{{ refName }}&quot;,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="1b138ae2d3a3a5649842315388af7270a529f730e7de0452e3cd65d4d1b92798">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch SelectMenu-icon flex-self-baseline">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
          <div>
            <span class="text-bold">Create branch: {{ refName }}</span>
            <span class="color-fg-muted">from ‘_DEV_FeNIP2N’</span>
            <input type="hidden" value="1BJDcrFuir-vhS7gEAjj3wNFrDbxMd8xs54wvu3E1yBgT5V20MfdColvgGYP--XrBfziaAgdvPBijWZCx8M9nQ" data-csrf="true" data-target="create-repo-from-selector.checkTagNameExistsPathCsrf" />
          </div>
        </button>
</form>    </create-repo-from-selector>
</template>


            <div data-target="ref-selector.listContainer" role="menu" class="SelectMenu-list " data-turbo-frame="repo-content-turbo-frame">
              <div class="SelectMenu-loading pt-3 pb-0 overflow-hidden" aria-label="Menu is loading">
                <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
              </div>
            </div>

              

<template data-target="ref-selector.itemTemplate">
  <a href="https://github.com/derpycode/cgenie.muffin/blob/{{ urlEncodedRefName }}/genie-sedgem/src/fortran/sedgem_box_benthic.f90" class="SelectMenu-item" role="menuitemradio" rel="nofollow" aria-checked="{{ isCurrent }}" data-index="{{ index }}" >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check SelectMenu-icon SelectMenu-icon--check">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    <span class="flex-1 css-truncate css-truncate-overflow {{ isFilteringClass }}">{{ refName }}</span>
    <span hidden="{{ isNotDefault }}" class="Label Label--secondary flex-self-start">default</span>
  </a>
</template>


              <footer class="SelectMenu-footer"><a href="/derpycode/cgenie.muffin/branches">View all branches</a></footer>
          </ref-selector>

        </div>

        <div role="tabpanel" id="tags-menu" data-filter-placeholder="Find a tag" tabindex="" hidden class="d-flex flex-column flex-auto overflow-auto">
          <ref-selector
            type="tag"
            data-action="
              input-entered:ref-selector#inputEntered
              tab-selected:ref-selector#tabSelected
              focus-list:ref-selector#focusFirstListMember
            "
            data-targets="input-demux.sinks"
            query-endpoint="/derpycode/cgenie.muffin/refs"
            cache-key="v0:1681016321.0"
            current-committish="X0RFVl9GZU5JUDJO"
            default-branch="bWFzdGVy"
            name-with-owner="ZGVycHljb2RlL2NnZW5pZS5tdWZmaW4="
          >

            <template data-target="ref-selector.fetchFailedTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Could not load tags</div>
            </template>

            <template data-target="ref-selector.noMatchTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Nothing to show</div>
            </template>

              

<template data-target="ref-selector.itemTemplate">
  <a href="https://github.com/derpycode/cgenie.muffin/blob/{{ urlEncodedRefName }}/genie-sedgem/src/fortran/sedgem_box_benthic.f90" class="SelectMenu-item" role="menuitemradio" rel="nofollow" aria-checked="{{ isCurrent }}" data-index="{{ index }}" >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check SelectMenu-icon SelectMenu-icon--check">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    <span class="flex-1 css-truncate css-truncate-overflow {{ isFilteringClass }}">{{ refName }}</span>
    <span hidden="{{ isNotDefault }}" class="Label Label--secondary flex-self-start">default</span>
  </a>
</template>


            <div data-target="ref-selector.listContainer" role="menu" class="SelectMenu-list" data-turbo-frame="repo-content-turbo-frame">
              <div class="SelectMenu-loading pt-3 pb-0 overflow-hidden" aria-label="Menu is loading">
                <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
              </div>
            </div>
              <footer class="SelectMenu-footer"><a href="/derpycode/cgenie.muffin/tags">View all tags</a></footer>
          </ref-selector>
        </div>
      </tab-container>
    </input-demux>
  </div>
</div>

  </details>

</div>


<div class="Overlay--hidden Overlay-backdrop--center" data-modal-dialog-overlay>
  <modal-dialog role="dialog" id="warn-tag-match-create-branch-dialog" aria-modal="true" aria-labelledby="warn-tag-match-create-branch-dialog-header" data-view-component="true" class="Overlay Overlay--width-large Overlay--height-auto Overlay--motion-scaleFade">
      <header class="Overlay-header Overlay-header--large Overlay-header--divided">
        <div class="Overlay-headerContentWrap">
          <div class="Overlay-titleWrap">
            <h1 id="warn-tag-match-create-branch-dialog-header" class="Overlay-title">Name already in use</h1>
          </div>
          <div class="Overlay-actionWrap">
            <button data-close-dialog-id="warn-tag-match-create-branch-dialog" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
          </div>
        </div>
      </header>
    <div class="Overlay-body ">
      
          <div data-view-component="true">      A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?
</div>

    </div>
      <footer class="Overlay-footer Overlay-footer--alignEnd">
            <button data-close-dialog-id="warn-tag-match-create-branch-dialog" type="button" data-view-component="true" class="btn">    Cancel
</button>
            <button data-submit-dialog-id="warn-tag-match-create-branch-dialog" type="button" data-view-component="true" class="btn-danger btn">    Create
</button>
      </footer>
</modal-dialog></div>


  <h2 id="blob-path" class="breadcrumb flex-auto flex-self-center min-width-0 text-normal mx-2 width-full width-md-auto flex-order-1 flex-md-order-none mt-3 mt-md-0">
    <span class="js-repo-root text-bold"><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N"><span>cgenie.muffin</span></a></span></span><span class="separator">/</span><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N/genie-sedgem"><span>genie-sedgem</span></a></span><span class="separator">/</span><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N/genie-sedgem/src"><span>src</span></a></span><span class="separator">/</span><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/derpycode/cgenie.muffin/tree/_DEV_FeNIP2N/genie-sedgem/src/fortran"><span>fortran</span></a></span><span class="separator">/</span><strong class="final-path">sedgem_box_benthic.f90</strong>
  </h2>
    <a href="/derpycode/cgenie.muffin/find/_DEV_FeNIP2N" data-pjax="" data-hotkey="t" data-view-component="true" class="btn mr-2 d-none d-md-block">    Go to file
</a>
  <details id="blob-more-options-details" data-view-component="true" class="details-overlay details-reset position-relative">
    <summary role="button" data-view-component="true" class="btn">    <svg aria-label="More options" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</summary>
  <div data-view-component="true">      <ul class="dropdown-menu dropdown-menu-sw">
        <li class="d-block d-md-none">
          <a class="dropdown-item d-flex flex-items-baseline" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FIND_FILE_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="668fc275f54d39655a27ac967d0ed507666a8bb23624dc7890967b6dcfcfa7cc" data-ga-click="Repository, find file, location:repo overview" data-hotkey="t" href="/derpycode/cgenie.muffin/find/_DEV_FeNIP2N">
            <span class="flex-auto">Go to file</span>
            <span class="text-small color-fg-muted" aria-hidden="true">T</span>
</a>        </li>
        <li data-toggle-for="blob-more-options-details">
            <button data-toggle-for="jumpto-line-details-dialog" type="button" data-view-component="true" class="dropdown-item btn-link">    <span class="d-flex flex-items-baseline">
              <span class="flex-auto">Go to line</span>
              <span class="text-small color-fg-muted" aria-hidden="true">L</span>
            </span>
</button>        </li>
        <li class="dropdown-divider" role="none"></li>
        <li>
          <clipboard-copy data-toggle-for="blob-more-options-details" aria-label="Copy path" value="genie-sedgem/src/fortran/sedgem_box_benthic.f90" data-view-component="true" class="dropdown-item cursor-pointer">
    
            Copy path

</clipboard-copy>        </li>
        <li>
          <clipboard-copy data-toggle-for="blob-more-options-details" aria-label="Copy permalink" value="https://github.com/derpycode/cgenie.muffin/blob/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90" data-view-component="true" class="dropdown-item cursor-pointer">
    
            <span class="d-flex flex-items-baseline">
              <span class="flex-auto">Copy permalink</span>
            </span>

</clipboard-copy>        </li>
      </ul>
</div>
</details></div>





    <div id="spoof-warning" class="mt-0 pb-3" hidden aria-hidden>
  <div data-view-component="true" class="flash flash-warn mt-0 clearfix">
  
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert float-left mt-1">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>

      <div class="overflow-hidden">This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.</div>


  
</div></div>

    <include-fragment src="/derpycode/cgenie.muffin/spoofed_commit_check/b47047942d1431bc136db842ad9a68027c3a1949" data-test-selector="spoofed-commit-check"></include-fragment>

    <div class="Box d-flex flex-column flex-shrink-0 mb-3">
  <include-fragment src="/derpycode/cgenie.muffin/contributors/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" class="commit-loader">
    <div class="Box-header d-flex flex-items-center">
      <div class="Skeleton avatar avatar-user flex-shrink-0 ml-n1 mr-n1 mt-n1 mb-n1" style="width:24px;height:24px;"></div>
      <div class="Skeleton Skeleton--text col-5 ml-2">&nbsp;</div>
    </div>

    <div class="Box-body d-flex flex-items-center" >
      <div class="Skeleton Skeleton--text col-1">&nbsp;</div>
      <span class="color-fg-danger h6 loader-error">Cannot retrieve contributors at this time</span>
    </div>
</include-fragment></div>



      








  
    <div data-target="readme-toc.content" class="Box mt-3 position-relative">
      
  <div
    class="Box-header js-blob-header py-2 pr-2 d-flex flex-shrink-0 flex-md-row flex-items-center"
    
  >


  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1">

      4728 lines (3838 sloc)
      <span class="file-info-divider"></span>
    247 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between hide-sm hide-md">
      

    <div class="BtnGroup">
        <a data-permalink-href="/derpycode/cgenie.muffin/raw/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90" href="/derpycode/cgenie.muffin/raw/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" id="raw-url" group_item="true" data-view-component="true" class="js-permalink-replaceable-link Button--secondary Button--small Button">    <span class="Button-content">
      <span class="Button-label">Raw</span>
    </span>
</a>  
          <a data-permalink-href="/derpycode/cgenie.muffin/blame/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90" href="/derpycode/cgenie.muffin/blame/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" group_item="true" data-hotkey="b" data-view-component="true" class="js-update-url-with-hash js-permalink-replaceable-link Button--secondary Button--small Button">    <span class="Button-content">
      <span class="Button-label">Blame</span>
    </span>
</a>  
    </div>

    <div class="d-flex">
        
<div class="ml-1" >
  <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="BtnGroup-parent js-update-url-with-hash " data-turbo="false" action="/derpycode/cgenie.muffin/edit/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="3oI0tmm16gbV_s-KvevqQ3TjvJn0kmwuvaUj7GF9lkBy3E5sGCp3Dzmkp1CMX6WSPGleGYWcqAlSXT7KtHngjw" autocomplete="off" />
      <button title="Edit this file" data-hotkey="e" data-disable-with="" type="submit" data-view-component="true" class="btn-sm BtnGroup-item btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pencil">
    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
</svg>
</button></form>
  <details class="details-reset details-overlay select-menu BtnGroup-parent d-inline-block position-relative">
      <summary data-disable-invalid="" data-disable-with="" data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.more_options_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:133421586,&quot;actor_id&quot;:10086766,&quot;github_dev_enabled&quot;:true,&quot;edit_enabled&quot;:true,&quot;small_screen&quot;:false}}" aria-label="Select additional options" data-view-component="true" class="js-blob-dropdown-click select-menu-button btn-sm btn BtnGroup-item float-none px-2">
</summary>    <div class="SelectMenu right-0">
      <div class="SelectMenu-modal width-full">
        <div class="SelectMenu-list SelectMenu-list--borderless py-2">
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="SelectMenu-item js-update-url-with-hash " data-turbo="false" action="/derpycode/cgenie.muffin/edit/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="ZdEZRT73IG8sY6GrdYK4T2fRXzcmubyozqUrq4KH8gjJj2OfT2i9ZsA5yXFENveeL1u9t1e3eI8hXTaNV4OExw" autocomplete="off" />
              <button title="Edit this file" type="submit" data-view-component="true" class="btn-invisible btn width-full d-flex flex-justify-between color-fg-default text-normal p-0">    <div class="mr-5">Edit this file</div>
              <div class="color-fg-muted">E</div>
</button></form>
            <a aria-label="Open this file in github.dev" data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.dev_link_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:133421586,&quot;actor_id&quot;:10086766,&quot;edit_enabled&quot;:true,&quot;small_screen&quot;:false}}" href="https://github.dev/" data-view-component="true" class="SelectMenu-item js-github-dev-shortcut js-blob-dropdown-click width-full d-flex flex-justify-between color-fg-default f5 text-normal">
              <div class="mr-5 no-wrap">Open in github.dev</div>
              <div class="color-fg-muted">.</div>
</a>
            <a data-platforms="windows,mac" aria-label="Open this file in GitHub Desktop" href="https://desktop.github.com" data-view-component="true" class="SelectMenu-item no-wrap js-remove-unless-platform width-full text-normal color-fg-default f5">
              Open in GitHub Desktop
</a>        </div>
      </div>
    </div>
  </details>
</div>


        
<div >
  <remote-clipboard-copy class="d-inline-block btn-octicon" style="height: 26px" data-src="/derpycode/cgenie.muffin/raw/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90" data-action="click:remote-clipboard-copy#remoteCopy">
  

  <span data-target="remote-clipboard-copy.idle">      <span class="tooltipped tooltipped-nw cursor-pointer" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;COPY_RAW_CONTENTS_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="66cad5e0b2478607660916a164ddf0b206888895218505e8e229115651e7db68" aria-label="Copy raw contents">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</span></span>
  <span data-target="remote-clipboard-copy.fetching" hidden="hidden">      <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
</span>
  <span data-target="remote-clipboard-copy.success" hidden="hidden">      <span class="tooltipped tooltipped-nw" aria-label="Copied!">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
      </span>
</span>
  <span data-target="remote-clipboard-copy.error" hidden="hidden">      <span class="tooltipped tooltipped-nw" aria-label="Something went wrong. Try again.">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert color-fg-attention">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
      </span>
</span>
</remote-clipboard-copy></div>


          <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="inline-form" data-turbo="false" action="/derpycode/cgenie.muffin/delete/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="dc6k73HEW_LTK8Y_5vDPy2eB3DKKaEVybGLQqG93a3jD9bS5XJuOHk960b66I08tBw_-NsZeZ6eLad1FalWx0w" />
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit"
              aria-label="Delete this file" data-disable-with>
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-trash">
    <path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
            </button>
</form>    </div>
  </div>

    <div class="d-flex hide-lg hide-xl flex-order-2 flex-grow-0">
      <details class="dropdown details-reset details-overlay d-inline-block">
        <summary
          class="js-blob-dropdown-click btn-octicon"
          aria-haspopup="true"
          aria-label="possible actions"
          
          data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.more_options_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:133421586,&quot;actor_id&quot;:10086766,&quot;github_dev_enabled&quot;:true,&quot;edit_enabled&quot;:true,&quot;small_screen&quot;:true}}"
        >
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
        </summary>

        <ul class="dropdown-menu dropdown-menu-sw" style="width: 175px">
            <li>
                <a class="dropdown-item tooltipped tooltipped-nw js-remove-unless-platform"
                   data-platforms="windows,mac"
                   href="https://desktop.github.com">
                  Open with Desktop
                </a>
            </li>
          <li>
            <a class="dropdown-item" href="/derpycode/cgenie.muffin/raw/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90">
              View raw
            </a>
          </li>
            <li>
              <remote-clipboard-copy class="dropdown-item" data-src="/derpycode/cgenie.muffin/raw/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90" data-action="click:remote-clipboard-copy#remoteCopy">
  

  <span data-target="remote-clipboard-copy.idle">                  <span class="cursor-pointer" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;COPY_RAW_CONTENTS_BUTTON&quot;,&quot;repository_id&quot;:133421586,&quot;originating_url&quot;:&quot;https://github.com/derpycode/cgenie.muffin/blob/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90&quot;,&quot;user_id&quot;:10086766}}" data-hydro-click-hmac="66cad5e0b2478607660916a164ddf0b206888895218505e8e229115651e7db68">
                    Copy raw contents
</span></span>
  <span data-target="remote-clipboard-copy.fetching" hidden="hidden">                  Copy raw contents
                  <span class="d-inline-block position-relative" style="top: 3px">
                    <svg aria-label="fetching contents…" style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
                  </span>
</span>
  <span data-target="remote-clipboard-copy.success" hidden="hidden">                  Copy raw contents
                  <svg aria-label="Copied!" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
</span>
  <span data-target="remote-clipboard-copy.error" hidden="hidden">                  Copy raw contents
                  <svg aria-label="Something went wrong. Try again." role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert color-fg-attention">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span>
</remote-clipboard-copy>            </li>
            <li>
              <a class="dropdown-item" href="/derpycode/cgenie.muffin/blame/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90">
                View blame
              </a>
            </li>

              <li class="dropdown-divider" role="none"></li>
              <li>
                <a class="dropdown-item" href="/derpycode/cgenie.muffin/edit/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90">Edit file</a>
              </li>
                <li>
                  <a data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.dev_link_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:133421586,&quot;actor_id&quot;:10086766,&quot;edit_enabled&quot;:true,&quot;small_screen&quot;:true}}" href="https://github.dev/" data-view-component="true" class="dropdown-item js-github-dev-shortcut js-blob-dropdown-click">Open with github.dev</a>
                </li>
              <li>
                <a class="dropdown-item menu-item-danger" href="/derpycode/cgenie.muffin/delete/_DEV_FeNIP2N/genie-sedgem/src/fortran/sedgem_box_benthic.f90">Delete file</a>
              </li>
        </ul>
      </details>
    </div>
</div>


      
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-fortran-free-form  gist-border-0">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="Fortran Free Form" data-tagsearch-path="genie-sedgem/src/fortran/sedgem_box_benthic.f90">
        <tr>
          <td id="L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span> ******************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span> sedgem_box_benthic.f90</span></td>
        </tr>
        <tr>
          <td id="L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span> Hülse et al. (2017) GMD - sediment diagenesis routines</span></td>
        </tr>
        <tr>
          <td id="L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span> ******************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="LC5" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="LC6" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">MODULE</span> sedgem_box_benthic</td>
        </tr>
        <tr>
          <td id="L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="LC8" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="LC9" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">use</span> genie_control</td>
        </tr>
        <tr>
          <td id="L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">USE</span> sedgem_lib</td>
        </tr>
        <tr>
          <td id="L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">IMPLICIT NONE</span></td>
        </tr>
        <tr>
          <td id="L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="LC13" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>sediment characteristics</span></td>
        </tr>
        <tr>
          <td id="L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="LC15" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> rho_sed                                <span class="pl-c"><span class="pl-c">!</span> sediment density (g/cm3)</span></td>
        </tr>
        <tr>
          <td id="L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="LC16" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> wdepth                                 <span class="pl-c"><span class="pl-c">!</span> water depth (m)</span></td>
        </tr>
        <tr>
          <td id="L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="LC17" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> w                                      <span class="pl-c"><span class="pl-c">!</span> burial velocity  (cm/yr)</span></td>
        </tr>
        <tr>
          <td id="L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="LC18" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> z0, zox                                <span class="pl-c"><span class="pl-c">!</span> surface</span></td>
        </tr>
        <tr>
          <td id="L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="LC19" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> zbio                                   <span class="pl-c"><span class="pl-c">!</span> bioturbation depth (cm)</span></td>
        </tr>
        <tr>
          <td id="L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="LC20" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="LC21" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> zinf                                   <span class="pl-c"><span class="pl-c">!</span>Inifinity (cm)</span></td>
        </tr>
        <tr>
          <td id="L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="LC22" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> Dbio                                   <span class="pl-c"><span class="pl-c">!</span>bioturbation coefficient (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="LC23" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> Dunbio                                 <span class="pl-c"><span class="pl-c">!</span> 2nd diffusion coefficient in case used for 2nd Layer</span></td>
        </tr>
        <tr>
          <td id="L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="LC24" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> por                                    <span class="pl-c"><span class="pl-c">!</span>porosity (-)</span></td>
        </tr>
        <tr>
          <td id="L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="LC25" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> tort                                   <span class="pl-c"><span class="pl-c">!</span>tortuosity (-)</span></td>
        </tr>
        <tr>
          <td id="L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="LC26" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> irrigationFactor                       <span class="pl-c"><span class="pl-c">!</span>irrigation factor (-)</span></td>
        </tr>
        <tr>
          <td id="L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="LC27" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dispFactor                             <span class="pl-c"><span class="pl-c">!</span>dispersion factor (-)</span></td>
        </tr>
        <tr>
          <td id="L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="LC28" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="LC29" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>stoichiometric factors</span></td>
        </tr>
        <tr>
          <td id="L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="LC30" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> X_C, Y_N, Z_P</td>
        </tr>
        <tr>
          <td id="L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="LC31" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> SD                                     <span class="pl-c"><span class="pl-c">!</span>volume factor solid-&gt;dissolved phase</span></td>
        </tr>
        <tr>
          <td id="L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="LC32" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> OC                                     <span class="pl-c"><span class="pl-c">!</span>O2/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="LC33" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> NC1                                    <span class="pl-c"><span class="pl-c">!</span>N/C first TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="LC34" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> NC2                                    <span class="pl-c"><span class="pl-c">!</span>N/C second TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="LC35" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> PC1                                    <span class="pl-c"><span class="pl-c">!</span>P/C first TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="LC36" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> PC2                                    <span class="pl-c"><span class="pl-c">!</span>P/C second TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="LC37" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> SO4C                                   <span class="pl-c"><span class="pl-c">!</span>SO4/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L38" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="LC38" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> O2H2S                                  <span class="pl-c"><span class="pl-c">!</span>O2/H2S O2 needed to oxidize H2S (mol/mol) </span></td>
        </tr>
        <tr>
          <td id="L39" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="LC39" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DICC1                                  <span class="pl-c"><span class="pl-c">!</span>DIC/C until zSO4 (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L40" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="LC40" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DICC2                                  <span class="pl-c"><span class="pl-c">!</span>DIC/C below zSO$ (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L41" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="41"></td>
          <td id="LC41" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> MC                                     <span class="pl-c"><span class="pl-c">!</span>CH4/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L42" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="42"></td>
          <td id="LC42" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> gamma                                  <span class="pl-c"><span class="pl-c">!</span>fraction of NH4 that is oxidised in oxic layer</span></td>
        </tr>
        <tr>
          <td id="L43" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="43"></td>
          <td id="LC43" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> gammaH2S                               <span class="pl-c"><span class="pl-c">!</span>fraction of H2S that is oxidised in oxic layer</span></td>
        </tr>
        <tr>
          <td id="L44" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="44"></td>
          <td id="LC44" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> gammaCH4                               <span class="pl-c"><span class="pl-c">!</span>fraction of CH4 that is oxidised at SO4</span></td>
        </tr>
        <tr>
          <td id="L45" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="45"></td>
          <td id="LC45" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> satSO4                                 <span class="pl-c"><span class="pl-c">!</span> SO4 saturation</span></td>
        </tr>
        <tr>
          <td id="L46" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="46"></td>
          <td id="LC46" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> NO3CR                                  <span class="pl-c"><span class="pl-c">!</span> NO3 consumed by Denitrification</span></td>
        </tr>
        <tr>
          <td id="L47" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="47"></td>
          <td id="LC47" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Alkalinity productio/consumption from:</span></td>
        </tr>
        <tr>
          <td id="L48" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="48"></td>
          <td id="LC48" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKROX;                                <span class="pl-c"><span class="pl-c">!</span> Aerobic degradation</span></td>
        </tr>
        <tr>
          <td id="L49" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="49"></td>
          <td id="LC49" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRNIT;                               <span class="pl-c"><span class="pl-c">!</span> Nitrification</span></td>
        </tr>
        <tr>
          <td id="L50" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="50"></td>
          <td id="LC50" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRDEN;                               <span class="pl-c"><span class="pl-c">!</span> Denitrification</span></td>
        </tr>
        <tr>
          <td id="L51" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="51"></td>
          <td id="LC51" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRSUL;                               <span class="pl-c"><span class="pl-c">!</span> Sulfato reduction</span></td>
        </tr>
        <tr>
          <td id="L52" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="52"></td>
          <td id="LC52" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRH2S;                               <span class="pl-c"><span class="pl-c">!</span> H2S oxydation (CHECK THIS VALUE!!!)</span></td>
        </tr>
        <tr>
          <td id="L53" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="53"></td>
          <td id="LC53" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRMET;                               <span class="pl-c"><span class="pl-c">!</span> Methanogenesis</span></td>
        </tr>
        <tr>
          <td id="L54" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="54"></td>
          <td id="LC54" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ALKRAOM;                               <span class="pl-c"><span class="pl-c">!</span> AOM</span></td>
        </tr>
        <tr>
          <td id="L55" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="55"></td>
          <td id="LC55" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L56" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="56"></td>
          <td id="LC56" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> zoxgf                                  <span class="pl-c"><span class="pl-c">!</span> cm, rolloff NH4, H2S oxidation for small zox depth</span></td>
        </tr>
        <tr>
          <td id="L57" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="57"></td>
          <td id="LC57" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L58" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="58"></td>
          <td id="LC58" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>bottom water concentrations (initialized locally)</span></td>
        </tr>
        <tr>
          <td id="L59" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="59"></td>
          <td id="LC59" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC1_conc_swi                  <span class="pl-c"><span class="pl-c">!</span>TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L60" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="60"></td>
          <td id="LC60" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC2_conc_swi                  <span class="pl-c"><span class="pl-c">!</span>TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L61" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="61"></td>
          <td id="LC61" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC3_conc_swi                  <span class="pl-c"><span class="pl-c">!</span>TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L62" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="62"></td>
          <td id="LC62" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC1_conc_swi_nonbio           <span class="pl-c"><span class="pl-c">!</span>TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase) not taking into account biodiffusion loss</span></td>
        </tr>
        <tr>
          <td id="L63" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="63"></td>
          <td id="LC63" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC2_conc_swi_nonbio           <span class="pl-c"><span class="pl-c">!</span>TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase) not taking into account biodiffusion loss</span></td>
        </tr>
        <tr>
          <td id="L64" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="64"></td>
          <td id="LC64" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_POC_total_flux_zinf             <span class="pl-c"><span class="pl-c">!</span>total TOC flux at SWI (mol/(cm2 yr)) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L65" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="65"></td>
          <td id="LC65" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_O2                     <span class="pl-c"><span class="pl-c">!</span> O2 concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L66" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="66"></td>
          <td id="LC66" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_SO4                    <span class="pl-c"><span class="pl-c">!</span> SO4 concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L67" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="67"></td>
          <td id="LC67" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_H2S                    <span class="pl-c"><span class="pl-c">!</span> H2S concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L68" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="68"></td>
          <td id="LC68" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_NO3                    <span class="pl-c"><span class="pl-c">!</span> NO3 concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L69" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="69"></td>
          <td id="LC69" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_NH4                    <span class="pl-c"><span class="pl-c">!</span> NH4 concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L70" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="70"></td>
          <td id="LC70" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_PO4                    <span class="pl-c"><span class="pl-c">!</span>PO4 concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L71" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="71"></td>
          <td id="LC71" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiflux_M                      <span class="pl-c"><span class="pl-c">!</span> flux of M to the sediment (mol/(cm2*yr)) -&gt; is converted into concentration (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L72" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="72"></td>
          <td id="LC72" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_DIC                    <span class="pl-c"><span class="pl-c">!</span> DIC concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L73" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="73"></td>
          <td id="LC73" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> dum_swiconc_ALK                    <span class="pl-c"><span class="pl-c">!</span> ALK concentration at SWI (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L74" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="74"></td>
          <td id="LC74" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L75" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="75"></td>
          <td id="LC75" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L76" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="76"></td>
          <td id="LC76" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ORGANIC MATTER</span></td>
        </tr>
        <tr>
          <td id="L77" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="77"></td>
          <td id="LC77" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DC1, DC2                           <span class="pl-c"><span class="pl-c">!</span>TOC diffusion coefficient (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L78" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="78"></td>
          <td id="LC78" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    real C, C1, C2</span></td>
        </tr>
        <tr>
          <td id="L79" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="79"></td>
          <td id="LC79" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> k1                                 <span class="pl-c"><span class="pl-c">!</span>TOC degradation rate constnat (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L80" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="80"></td>
          <td id="LC80" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> k2                                 <span class="pl-c"><span class="pl-c">!</span>TOC degradation rate constant (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L81" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="81"></td>
          <td id="LC81" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L82" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="82"></td>
          <td id="LC82" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> O2</span></td>
        </tr>
        <tr>
          <td id="L83" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="83"></td>
          <td id="LC83" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispO2                            <span class="pl-c"><span class="pl-c">!</span>O2 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L84" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="84"></td>
          <td id="LC84" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispO2                            <span class="pl-c"><span class="pl-c">!</span>O2 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L85" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="85"></td>
          <td id="LC85" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DO21                               <span class="pl-c"><span class="pl-c">!</span>O2 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L86" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="86"></td>
          <td id="LC86" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DO22                               <span class="pl-c"><span class="pl-c">!</span>O2 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L87" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="87"></td>
          <td id="LC87" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> r_zxf                              <span class="pl-c"><span class="pl-c">!</span>roll off oxidation at low zox</span></td>
        </tr>
        <tr>
          <td id="L88" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="88"></td>
          <td id="LC88" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L89" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="89"></td>
          <td id="LC89" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> global constants, variables</span></td>
        </tr>
        <tr>
          <td id="L90" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="90"></td>
          <td id="LC90" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> aa11, bb11, aa21, A11, A21, aa12, bb12, aa22, A12, A22</td>
        </tr>
        <tr>
          <td id="L91" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="91"></td>
          <td id="LC91" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</td>
        </tr>
        <tr>
          <td id="L92" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="92"></td>
          <td id="LC92" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L93" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="93"></td>
          <td id="LC93" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Nitrate (NO3)</span></td>
        </tr>
        <tr>
          <td id="L94" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="94"></td>
          <td id="LC94" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispNO3                   <span class="pl-c"><span class="pl-c">!</span> NO3 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L95" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="95"></td>
          <td id="LC95" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispNO3                   <span class="pl-c"><span class="pl-c">!</span> NO3 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L96" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="96"></td>
          <td id="LC96" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DN1                        <span class="pl-c"><span class="pl-c">!</span> NO3 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L97" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="97"></td>
          <td id="LC97" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DN2                        <span class="pl-c"><span class="pl-c">!</span> NO3 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L98" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="98"></td>
          <td id="LC98" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> zno3</td>
        </tr>
        <tr>
          <td id="L99" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="99"></td>
          <td id="LC99" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> KNH4                       <span class="pl-c"><span class="pl-c">!</span> Adsorption coefficient (same in ocix and anoxic layer) (-)</span></td>
        </tr>
        <tr>
          <td id="L100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="100"></td>
          <td id="LC100" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="101"></td>
          <td id="LC101" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Sulfate (SO4)</span></td>
        </tr>
        <tr>
          <td id="L102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="102"></td>
          <td id="LC102" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispSO4                   <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="103"></td>
          <td id="LC103" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispSO4                   <span class="pl-c"><span class="pl-c">!</span> SO4 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="104"></td>
          <td id="LC104" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DSO41                      <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="105"></td>
          <td id="LC105" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DSO42                      <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="106"></td>
          <td id="LC106" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> zso4</td>
        </tr>
        <tr>
          <td id="L107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="107"></td>
          <td id="LC107" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="108"></td>
          <td id="LC108" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Ammonium (NH4)</span></td>
        </tr>
        <tr>
          <td id="L109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="109"></td>
          <td id="LC109" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispNH4                   <span class="pl-c"><span class="pl-c">!</span> NH4 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="110"></td>
          <td id="LC110" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispNH4                   <span class="pl-c"><span class="pl-c">!</span> NH4 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="111"></td>
          <td id="LC111" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DNH41                      <span class="pl-c"><span class="pl-c">!</span> NH4 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="112"></td>
          <td id="LC112" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DNH42                      <span class="pl-c"><span class="pl-c">!</span> NH4 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="113"></td>
          <td id="LC113" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="114"></td>
          <td id="LC114" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Hydrogen sulfide (H2S)</span></td>
        </tr>
        <tr>
          <td id="L115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="115"></td>
          <td id="LC115" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispH2S                   <span class="pl-c"><span class="pl-c">!</span> H2S diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="116"></td>
          <td id="LC116" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispH2S                   <span class="pl-c"><span class="pl-c">!</span> H2S linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="117"></td>
          <td id="LC117" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DH2S1                      <span class="pl-c"><span class="pl-c">!</span> H2S diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="118"></td>
          <td id="LC118" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DH2S2                      <span class="pl-c"><span class="pl-c">!</span> H2S diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="119"></td>
          <td id="LC119" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="120"></td>
          <td id="LC120" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Phosphate (PO4)</span></td>
        </tr>
        <tr>
          <td id="L121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="121"></td>
          <td id="LC121" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispPO4                   <span class="pl-c"><span class="pl-c">!</span> PO4 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="122"></td>
          <td id="LC122" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispPO4                   <span class="pl-c"><span class="pl-c">!</span> PO4 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="123"></td>
          <td id="LC123" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DPO41                      <span class="pl-c"><span class="pl-c">!</span> PO4 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="124"></td>
          <td id="LC124" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DPO42                      <span class="pl-c"><span class="pl-c">!</span> PO4 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="125"></td>
          <td id="LC125" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> KPO4_ox                    <span class="pl-c"><span class="pl-c">!</span> Adsorption coefficient in oxic layer (-)</span></td>
        </tr>
        <tr>
          <td id="L126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="126"></td>
          <td id="LC126" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> KPO4_anox                  <span class="pl-c"><span class="pl-c">!</span> Adsorption coefficient in anoxic layer (-)</span></td>
        </tr>
        <tr>
          <td id="L127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="127"></td>
          <td id="LC127" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> ksPO4                      <span class="pl-c"><span class="pl-c">!</span> Rate constant for kinetic P sorption (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="128"></td>
          <td id="LC128" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> kmPO4                      <span class="pl-c"><span class="pl-c">!</span> Rate constant for Fe-bound P release upon Fe oxide reduction</span></td>
        </tr>
        <tr>
          <td id="L129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="129"></td>
          <td id="LC129" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> kaPO4                      <span class="pl-c"><span class="pl-c">!</span> Rate constant for authigenic P formation (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="130"></td>
          <td id="LC130" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> PO4s                       <span class="pl-c"><span class="pl-c">!</span> Equilibrium concentration for P sorption (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="131"></td>
          <td id="LC131" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> PO4a                       <span class="pl-c"><span class="pl-c">!</span> Equilibrium concentration for authigenic P formation (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="132"></td>
          <td id="LC132" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> Minf                       <span class="pl-c"><span class="pl-c">!</span> asymptotic concentration for Fe-bound P (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="133"></td>
          <td id="LC133" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="134"></td>
          <td id="LC134" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> DIC</span></td>
        </tr>
        <tr>
          <td id="L135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="135"></td>
          <td id="LC135" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispDIC                   <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="136"></td>
          <td id="LC136" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispDIC                   <span class="pl-c"><span class="pl-c">!</span> DIC linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="137"></td>
          <td id="LC137" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DDIC1                      <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="138"></td>
          <td id="LC138" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DDIC2                      <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="139"></td>
          <td id="LC139" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="140"></td>
          <td id="LC140" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> Alkalinity</span></td>
        </tr>
        <tr>
          <td id="L141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="141"></td>
          <td id="LC141" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> qdispALK                   <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="142"></td>
          <td id="LC142" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> adispALK                   <span class="pl-c"><span class="pl-c">!</span> ALK linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="143"></td>
          <td id="LC143" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DALK1                      <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="144"></td>
          <td id="LC144" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">real</span> DALK2                      <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="145"></td>
          <td id="LC145" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="146"></td>
          <td id="LC146" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SAVE</span></td>
        </tr>
        <tr>
          <td id="L147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="147"></td>
          <td id="LC147" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="148"></td>
          <td id="LC148" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="149"></td>
          <td id="LC149" class="blob-code blob-code-inner js-file-line"><span class="pl-k">CONTAINS</span></td>
        </tr>
        <tr>
          <td id="L150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="150"></td>
          <td id="LC150" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="151"></td>
          <td id="LC151" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="152"></td>
          <td id="LC152" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="153"></td>
          <td id="LC153" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="154"></td>
          <td id="LC154" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="155"></td>
          <td id="LC155" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="156"></td>
          <td id="LC156" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>             Huelse &amp; Arndt et al. 2017 OMEN sediment model</span></td>
        </tr>
        <tr>
          <td id="L157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="157"></td>
          <td id="LC157" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="158"></td>
          <td id="LC158" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="159"></td>
          <td id="LC159" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="160"></td>
          <td id="LC160" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="161"></td>
          <td id="LC161" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="162"></td>
          <td id="LC162" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_main</span> &amp;</td>
        </tr>
        <tr>
          <td id="L163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="163"></td>
          <td id="LC163" class="blob-code blob-code-inner js-file-line">    (dum_i, dum_j, dum_dtyr, dum_D, dum_sed_OM_bur, loc_new_sed, dum_is_POC_frac2, dum_sfcsumocn, dum_sed_pres_fracC, dum_sed_pres_fracP, dum_new_swifluxes, dum_sed_mean_OM, dum_sed_OM_wtpc_bot)</td>
        </tr>
        <tr>
          <td id="L164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="164"></td>
          <td id="LC164" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="165"></td>
          <td id="LC165" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="166"></td>
          <td id="LC166" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   Main subroutine: </span></td>
        </tr>
        <tr>
          <td id="L167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="167"></td>
          <td id="LC167" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   gets SWI POC wtpct and array of concentrations of solutes </span></td>
        </tr>
        <tr>
          <td id="L168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="168"></td>
          <td id="LC168" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   call other subroutines </span></td>
        </tr>
        <tr>
          <td id="L169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="169"></td>
          <td id="LC169" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   passes back fraction of POC preserved in sediments (dum_sed_pres_fracC)</span></td>
        </tr>
        <tr>
          <td id="L170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="170"></td>
          <td id="LC170" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   passess back calculated array of SWI fluxes of solutes</span></td>
        </tr>
        <tr>
          <td id="L171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="171"></td>
          <td id="LC171" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="172"></td>
          <td id="LC172" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="173"></td>
          <td id="LC173" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IMPLICIT NONE</span></td>
        </tr>
        <tr>
          <td id="L174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="174"></td>
          <td id="LC174" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="175"></td>
          <td id="LC175" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_dtyr                               <span class="pl-c"><span class="pl-c">!</span> time-step</span></td>
        </tr>
        <tr>
          <td id="L176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="176"></td>
          <td id="LC176" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_i, dum_j                      <span class="pl-c"><span class="pl-c">!</span> grid point (i,j)</span></td>
        </tr>
        <tr>
          <td id="L177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="177"></td>
          <td id="LC177" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_D                                  <span class="pl-c"><span class="pl-c">!</span> depth</span></td>
        </tr>
        <tr>
          <td id="L178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="178"></td>
          <td id="LC178" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_sed_OM_bur                         <span class="pl-c"><span class="pl-c">!</span> burial rate (w) for OMEN-SED (solid cm3 cm-2 yr-1, NOTE: from previous time-step)</span></td>
        </tr>
        <tr>
          <td id="L179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="179"></td>
          <td id="LC179" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_is_POC_frac2                       <span class="pl-c"><span class="pl-c">!</span> fraction of refractory POC</span></td>
        </tr>
        <tr>
          <td id="L180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="180"></td>
          <td id="LC180" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">DIMENSION</span>(n_sed),<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>loc_new_sed                         <span class="pl-c"><span class="pl-c">!</span> new (sedimenting) top layer material</span></td>
        </tr>
        <tr>
          <td id="L181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="181"></td>
          <td id="LC181" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">DIMENSION</span>(n_ocn),<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_sfcsumocn                     <span class="pl-c"><span class="pl-c">!</span> ocean composition interface array</span></td>
        </tr>
        <tr>
          <td id="L182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="182"></td>
          <td id="LC182" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        real,INTENT(in)::dum_POC1_wtpct_swi, dum_POC2_wtpct_swi             ! POC concentrations at SWI [wt%]</span></td>
        </tr>
        <tr>
          <td id="L183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="183"></td>
          <td id="LC183" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_pres_fracC                              <span class="pl-c"><span class="pl-c">!</span> fraction POC-preserved/POC-deposited [-]</span></td>
        </tr>
        <tr>
          <td id="L184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="184"></td>
          <td id="LC184" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_pres_fracP                              <span class="pl-c"><span class="pl-c">!</span> fraction POP-preserved/POP-deposited [-]</span></td>
        </tr>
        <tr>
          <td id="L185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="185"></td>
          <td id="LC185" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">DIMENSION</span>(n_ocn),<span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_new_swifluxes              <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of solutes, calculated with sediment-model [pos values: flux from sediments to water-column]</span></td>
        </tr>
        <tr>
          <td id="L186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="186"></td>
          <td id="LC186" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_mean_OM                              <span class="pl-c"><span class="pl-c">!</span> mean OM wt% in upper mixed layer</span></td>
        </tr>
        <tr>
          <td id="L187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="187"></td>
          <td id="LC187" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_OM_wtpc_bot                     <span class="pl-c"><span class="pl-c">!</span> POC wt% at bottom of sediment column (geologic preservation)</span></td>
        </tr>
        <tr>
          <td id="L188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="188"></td>
          <td id="LC188" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="189"></td>
          <td id="LC189" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables      </span></td>
        </tr>
        <tr>
          <td id="L190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="190"></td>
          <td id="LC190" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_BW_O2_concentration                               <span class="pl-c"><span class="pl-c">!</span> BW [O2] in muM = 10−6 mol/kg </span></td>
        </tr>
        <tr>
          <td id="L191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="191"></td>
          <td id="LC191" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_BW_O2_anoxia                                      <span class="pl-c"><span class="pl-c">!</span> BW [O2} threshold for zbio switch to 0.01cm </span></td>
        </tr>
        <tr>
          <td id="L192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="192"></td>
          <td id="LC192" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_total_POC_flux                                    <span class="pl-c"><span class="pl-c">!</span> total POC flux at SWI (POC1 + POC2) [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="193"></td>
          <td id="LC193" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_POC1_flux_swi, loc_POC2_flux_swi                  <span class="pl-c"><span class="pl-c">!</span> POC flux at SWI [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="194"></td>
          <td id="LC194" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_POC3_flux_swi                                     <span class="pl-c"><span class="pl-c">!</span> inert/sulfurized POC flux at SWI [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="195"></td>
          <td id="LC195" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_O2_swiflux                                        <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of O2 [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="196"></td>
          <td id="LC196" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_SO4_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of SO4 [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="197"></td>
          <td id="LC197" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_NO3_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of NO3 [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="198"></td>
          <td id="LC198" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_H2S_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of H2S [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="199"></td>
          <td id="LC199" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_NH4_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of H2S [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="200"></td>
          <td id="LC200" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_PO4_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of PO4 [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="201"></td>
          <td id="LC201" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_M_swiflux                                         <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of M - DOES NOT EXIST, JUST FOR DEBUGGING</span></td>
        </tr>
        <tr>
          <td id="L202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="202"></td>
          <td id="LC202" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_DIC_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of DIC [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="203"></td>
          <td id="LC203" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_DIC_13C_swiflux                                   <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of DIC [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="204"></td>
          <td id="LC204" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_ALK_swiflux                                       <span class="pl-c"><span class="pl-c">!</span> SWI return fluxes of ALK [mol/(cm^2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="205"></td>
          <td id="LC205" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_mixed_layer</td>
        </tr>
        <tr>
          <td id="L206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="206"></td>
          <td id="LC206" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_k_apparent</td>
        </tr>
        <tr>
          <td id="L207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="207"></td>
          <td id="LC207" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_POM_S_H2S_swiflux                                 <span class="pl-c"><span class="pl-c">!</span> SWI return flux related to H2S in sulphurised POC</span></td>
        </tr>
        <tr>
          <td id="L208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="208"></td>
          <td id="LC208" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">logical</span><span class="pl-k">::</span>loc_sed_pres_insane                                <span class="pl-c"><span class="pl-c">!</span> true if integration constants are too high -&gt; calculate SWI-flux manually</span></td>
        </tr>
        <tr>
          <td id="L209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="209"></td>
          <td id="LC209" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">logical</span><span class="pl-k">::</span>loc_O2_swiflux_pos</td>
        </tr>
        <tr>
          <td id="L210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="210"></td>
          <td id="LC210" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="211"></td>
          <td id="LC211" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> parameters for temperature dependent rate constants (as in John et al. 2014)</span></td>
        </tr>
        <tr>
          <td id="L212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="212"></td>
          <td id="LC212" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_T                                                 <span class="pl-c"><span class="pl-c">!</span> local temperature</span></td>
        </tr>
        <tr>
          <td id="L213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="213"></td>
          <td id="LC213" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_par_bio_remin_POC_K1, loc_par_bio_remin_POC_K2    <span class="pl-c"><span class="pl-c">!</span> rate constants for temperature dependent degradation</span></td>
        </tr>
        <tr>
          <td id="L214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="214"></td>
          <td id="LC214" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_par_bio_remin_POC_Ea1, loc_par_bio_remin_POC_Ea2  <span class="pl-c"><span class="pl-c">!</span> activation energies</span></td>
        </tr>
        <tr>
          <td id="L215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="215"></td>
          <td id="LC215" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="216"></td>
          <td id="LC216" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_fPOC                                              <span class="pl-c"><span class="pl-c">!</span> Corg flux to the sediment [cm3 cm-2]</span></td>
        </tr>
        <tr>
          <td id="L217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="217"></td>
          <td id="LC217" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_fPOC_13C                                          <span class="pl-c"><span class="pl-c">!</span> 13C of POC flux to the sediment [cm3 cm-2]</span></td>
        </tr>
        <tr>
          <td id="L218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="218"></td>
          <td id="LC218" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        real::dum_POC1_wtpct_swi, dum_POC2_wtpct_swi       ! POC concentrations at SWI [wt%]</span></td>
        </tr>
        <tr>
          <td id="L219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="219"></td>
          <td id="LC219" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">logical</span> <span class="pl-k">::</span> loc_print_results</td>
        </tr>
        <tr>
          <td id="L220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="220"></td>
          <td id="LC220" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">logical</span> <span class="pl-k">::</span> loc_calc_ALK</td>
        </tr>
        <tr>
          <td id="L221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="221"></td>
          <td id="LC221" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="222"></td>
          <td id="LC222" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_new_sed_vol                                       <span class="pl-c"><span class="pl-c">!</span> new sediment volume - settling flux (as SOLID material)</span></td>
        </tr>
        <tr>
          <td id="L223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="223"></td>
          <td id="LC223" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_sed_burial                                        <span class="pl-c"><span class="pl-c">!</span> burial rate (w) - corrected for porosity</span></td>
        </tr>
        <tr>
          <td id="L224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="224"></td>
          <td id="LC224" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        integer:: loc_k = 0</span></td>
        </tr>
        <tr>
          <td id="L225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="225"></td>
          <td id="LC225" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="226"></td>
          <td id="LC226" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> parameters for P-regeneration under anoxia, following Wallmann (2010)</span></td>
        </tr>
        <tr>
          <td id="L227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="227"></td>
          <td id="LC227" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_par_Pregen_Yf, loc_par_Pregen_r, loc_par_Pregen_A</td>
        </tr>
        <tr>
          <td id="L228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="228"></td>
          <td id="LC228" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_PO4_return_max                                        <span class="pl-c"><span class="pl-c">!</span> maximum PO4 return flux from all Porg remineralized</span></td>
        </tr>
        <tr>
          <td id="L229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="229"></td>
          <td id="LC229" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_PO4_return_redox                                      <span class="pl-c"><span class="pl-c">!</span> redox-dependent PO4 return flux </span></td>
        </tr>
        <tr>
          <td id="L230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="230"></td>
          <td id="LC230" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>loc_CP_reg                                                <span class="pl-c"><span class="pl-c">!</span> C/P regeneration ratio as fct. of [O2]</span></td>
        </tr>
        <tr>
          <td id="L231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="231"></td>
          <td id="LC231" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="232"></td>
          <td id="LC232" class="blob-code blob-code-inner js-file-line">        loc_sed_pres_insane <span class="pl-k">=</span> <span class="pl-c1">.false.</span></td>
        </tr>
        <tr>
          <td id="L233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="233"></td>
          <td id="LC233" class="blob-code blob-code-inner js-file-line">        loc_print_results <span class="pl-k">=</span> <span class="pl-c1">.false.</span></td>
        </tr>
        <tr>
          <td id="L234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="234"></td>
          <td id="LC234" class="blob-code blob-code-inner js-file-line">        loc_calc_ALK <span class="pl-k">=</span> <span class="pl-c1">.false.</span></td>
        </tr>
        <tr>
          <td id="L235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="235"></td>
          <td id="LC235" class="blob-code blob-code-inner js-file-line">        loc_O2_swiflux_pos <span class="pl-k">=</span> <span class="pl-c1">.false.</span></td>
        </tr>
        <tr>
          <td id="L236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="236"></td>
          <td id="LC236" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="237"></td>
          <td id="LC237" class="blob-code blob-code-inner js-file-line">        loc_O2_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="238"></td>
          <td id="LC238" class="blob-code blob-code-inner js-file-line">        loc_DIC_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="239"></td>
          <td id="LC239" class="blob-code blob-code-inner js-file-line">        loc_DIC_13C_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="240"></td>
          <td id="LC240" class="blob-code blob-code-inner js-file-line">        loc_ALK_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="241"></td>
          <td id="LC241" class="blob-code blob-code-inner js-file-line">        loc_M_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="242"></td>
          <td id="LC242" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="243"></td>
          <td id="LC243" class="blob-code blob-code-inner js-file-line">        loc_POC1_flux_swi <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="244"></td>
          <td id="LC244" class="blob-code blob-code-inner js-file-line">        loc_POC2_flux_swi <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="245"></td>
          <td id="LC245" class="blob-code blob-code-inner js-file-line">        loc_POC3_flux_swi <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="246"></td>
          <td id="LC246" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="247"></td>
          <td id="LC247" class="blob-code blob-code-inner js-file-line">        loc_POM_S_H2S_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="248"></td>
          <td id="LC248" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="249"></td>
          <td id="LC249" class="blob-code blob-code-inner js-file-line">        por <span class="pl-k">=</span> <span class="pl-c1">0.85</span>                                                  <span class="pl-c"><span class="pl-c">!</span> porosity (-) defined as: porewater_vol./(solid_sed_vol.+porewater_vol.)</span></td>
        </tr>
        <tr>
          <td id="L250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="250"></td>
          <td id="LC250" class="blob-code blob-code-inner js-file-line">        loc_BW_O2_anoxia <span class="pl-k">=</span> <span class="pl-c1">5.0e-9</span>                                   <span class="pl-c"><span class="pl-c">!</span> set to 5.0 nanomol/cm^3 - 5.0e-9 </span></td>
        </tr>
        <tr>
          <td id="L251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="251"></td>
          <td id="LC251" class="blob-code blob-code-inner js-file-line">        loc_mixed_layer <span class="pl-k">=</span> <span class="pl-c1">5.0</span>                                      <span class="pl-c"><span class="pl-c">!</span> mixed layer depth, to compare wt% with observations</span></td>
        </tr>
        <tr>
          <td id="L252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="252"></td>
          <td id="LC252" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="253"></td>
          <td id="LC253" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> set local variables - temperature (K)</span></td>
        </tr>
        <tr>
          <td id="L254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="254"></td>
          <td id="LC254" class="blob-code blob-code-inner js-file-line">        loc_T <span class="pl-k">=</span> dum_sfcsumocn(io_T)</td>
        </tr>
        <tr>
          <td id="L255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="255"></td>
          <td id="LC255" class="blob-code blob-code-inner js-file-line">        loc_par_bio_remin_POC_K1 <span class="pl-k">=</span> <span class="pl-c1">9.0E11</span></td>
        </tr>
        <tr>
          <td id="L256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="256"></td>
          <td id="LC256" class="blob-code blob-code-inner js-file-line">        loc_par_bio_remin_POC_K2 <span class="pl-k">=</span> <span class="pl-c1">1.0E14</span></td>
        </tr>
        <tr>
          <td id="L257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="257"></td>
          <td id="LC257" class="blob-code blob-code-inner js-file-line">        loc_par_bio_remin_POC_Ea1 <span class="pl-k">=</span> <span class="pl-c1">55000.0</span></td>
        </tr>
        <tr>
          <td id="L258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="258"></td>
          <td id="LC258" class="blob-code blob-code-inner js-file-line">        loc_par_bio_remin_POC_Ea2 <span class="pl-k">=</span> <span class="pl-c1">80000.0</span></td>
        </tr>
        <tr>
          <td id="L259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="259"></td>
          <td id="LC259" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="260"></td>
          <td id="LC260" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> set parameters for P-regeneration under anoxia, following Wallmann (2010) - TODO: change these to user-config parameters</span></td>
        </tr>
        <tr>
          <td id="L261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="261"></td>
          <td id="LC261" class="blob-code blob-code-inner js-file-line">        loc_par_Pregen_Yf <span class="pl-k">=</span> <span class="pl-c1">106.0</span>                        <span class="pl-c"><span class="pl-c">!</span> C/P ratio under oxic conditions</span></td>
        </tr>
        <tr>
          <td id="L262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="262"></td>
          <td id="LC262" class="blob-code blob-code-inner js-file-line">        loc_par_Pregen_r <span class="pl-k">=</span> <span class="pl-c1">22.0</span></td>
        </tr>
        <tr>
          <td id="L263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="263"></td>
          <td id="LC263" class="blob-code blob-code-inner js-file-line">        loc_par_Pregen_A <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">95.0</span></td>
        </tr>
        <tr>
          <td id="L264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="264"></td>
          <td id="LC264" class="blob-code blob-code-inner js-file-line">        loc_PO4_return_max <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="265"></td>
          <td id="LC265" class="blob-code blob-code-inner js-file-line">        loc_PO4_return_redox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="266"></td>
          <td id="LC266" class="blob-code blob-code-inner js-file-line">        loc_CP_reg <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="267"></td>
          <td id="LC267" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="268"></td>
          <td id="LC268" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                   print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="269"></td>
          <td id="LC269" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                   print*,&#39;---------- IN OMEN MAIN ----------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="270"></td>
          <td id="LC270" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                   print*,&#39;dum_i, dum_j, dum_D &#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="271"></td>
          <td id="LC271" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="272"></td>
          <td id="LC272" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> initialize BW concentrations </span></td>
        </tr>
        <tr>
          <td id="L273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="273"></td>
          <td id="LC273" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   THE FOLLOWING VALUES WILL BE PASSED DOWN FROM GENIE</span></td>
        </tr>
        <tr>
          <td id="L274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="274"></td>
          <td id="LC274" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="275"></td>
          <td id="LC275" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="276"></td>
          <td id="LC276" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dum_sfcsumocn mol/kg -&gt; SEDIMENT MODEL needs mol/cm^3, assuming 10^3 kg/m^3 as density of seawater</span></td>
        </tr>
        <tr>
          <td id="L277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="277"></td>
          <td id="LC277" class="blob-code blob-code-inner js-file-line">        dum_swiconc_O2 <span class="pl-k">=</span> dum_sfcsumocn(io_O2)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="278"></td>
          <td id="LC278" class="blob-code blob-code-inner js-file-line">        loc_BW_O2_concentration <span class="pl-k">=</span> dum_sfcsumocn(io_O2)<span class="pl-k">*</span><span class="pl-c1">1e+6</span>                <span class="pl-c"><span class="pl-c">!</span> BW [O2] in muM for calculating P-regeneration</span></td>
        </tr>
        <tr>
          <td id="L279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="279"></td>
          <td id="LC279" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_NO3))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="280"></td>
          <td id="LC280" class="blob-code blob-code-inner js-file-line">            dum_swiconc_NO3 <span class="pl-k">=</span> dum_sfcsumocn(io_NO3)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="281"></td>
          <td id="LC281" class="blob-code blob-code-inner js-file-line">            dum_swiconc_NH4 <span class="pl-k">=</span> dum_sfcsumocn(io_NH4)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="282"></td>
          <td id="LC282" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="283"></td>
          <td id="LC283" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_SO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="284"></td>
          <td id="LC284" class="blob-code blob-code-inner js-file-line">            dum_swiconc_SO4 <span class="pl-k">=</span> dum_sfcsumocn(io_SO4)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="285"></td>
          <td id="LC285" class="blob-code blob-code-inner js-file-line">            dum_swiconc_H2S <span class="pl-k">=</span> dum_sfcsumocn(io_H2S)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="286"></td>
          <td id="LC286" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="287"></td>
          <td id="LC287" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_PO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="288"></td>
          <td id="LC288" class="blob-code blob-code-inner js-file-line">            dum_swiconc_PO4 <span class="pl-k">=</span> dum_sfcsumocn(io_PO4)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="289"></td>
          <td id="LC289" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            dum_swiflux_M = 365*0.2e-10 ! Flux input 365*0.2e-10</span></td>
        </tr>
        <tr>
          <td id="L290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="290"></td>
          <td id="LC290" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            dum_swiflux_M = 365*0.2e-10*1/(1-por)*1/w ! Flux concerted to concentration</span></td>
        </tr>
        <tr>
          <td id="L291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="291"></td>
          <td id="LC291" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="292"></td>
          <td id="LC292" class="blob-code blob-code-inner js-file-line">        dum_swiconc_DIC <span class="pl-k">=</span> dum_sfcsumocn(io_DIC)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="293"></td>
          <td id="LC293" class="blob-code blob-code-inner js-file-line">        dum_swiconc_ALK <span class="pl-k">=</span> dum_sfcsumocn(io_ALK)<span class="pl-k">*</span><span class="pl-c1">1e-3</span></td>
        </tr>
        <tr>
          <td id="L294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="294"></td>
          <td id="LC294" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="295"></td>
          <td id="LC295" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_i, dum_j, dum_D &#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="296"></td>
          <td id="LC296" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="297"></td>
          <td id="LC297" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate wt% of mol from POC flux (both fractions)</span></td>
        </tr>
        <tr>
          <td id="L298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="298"></td>
          <td id="LC298" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NOTE: the units of the Corg flux are in (cm3 cm-2 yr-1)</span></td>
        </tr>
        <tr>
          <td id="L299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="299"></td>
          <td id="LC299" class="blob-code blob-code-inner js-file-line">        loc_fPOC <span class="pl-k">=</span> loc_new_sed(is_POC)<span class="pl-k">/</span>dum_dtyr</td>
        </tr>
        <tr>
          <td id="L300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="300"></td>
          <td id="LC300" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> also get flux 13C of POC in (cm3 cm-2 yr-1)</span></td>
        </tr>
        <tr>
          <td id="L301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="301"></td>
          <td id="LC301" class="blob-code blob-code-inner js-file-line">        loc_fPOC_13C <span class="pl-k">=</span> loc_new_sed(is_POC_13C)<span class="pl-k">/</span>dum_dtyr</td>
        </tr>
        <tr>
          <td id="L302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="302"></td>
          <td id="LC302" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="303"></td>
          <td id="LC303" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate sediment accumulation in (cm3 cm-2)</span></td>
        </tr>
        <tr>
          <td id="L304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="304"></td>
          <td id="LC304" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> w after Middelburg</span></td>
        </tr>
        <tr>
          <td id="L305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="305"></td>
          <td id="LC305" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        loc_new_sed_vol=10.0**(-0.87478367-0.00043512*dum_D)*3.3              ! sedimentation rate, cm/yr / burial velocity / advection (Middelburg et al., Deep Sea Res. 1, 1997)</span></td>
        </tr>
        <tr>
          <td id="L306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="306"></td>
          <td id="LC306" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_new_sed_vol Middelburg =&#39;, loc_new_sed_vol</span></td>
        </tr>
        <tr>
          <td id="L307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="307"></td>
          <td id="LC307" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> w from GENIE</span></td>
        </tr>
        <tr>
          <td id="L308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="308"></td>
          <td id="LC308" class="blob-code blob-code-inner js-file-line">        loc_new_sed_vol <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>fun_calc_sed_vol(loc_new_sed(:))            <span class="pl-c"><span class="pl-c">!</span> using sedimentation rate (OLD)</span></td>
        </tr>
        <tr>
          <td id="L309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="309"></td>
          <td id="LC309" class="blob-code blob-code-inner js-file-line">        loc_sed_burial <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>dum_sed_OM_bur                               <span class="pl-c"><span class="pl-c">!</span> new actual burial rate: (Andy mail 11.07.2017)</span></td>
        </tr>
        <tr>
          <td id="L310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="310"></td>
          <td id="LC310" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="311"></td>
          <td id="LC311" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH TODO: some of initialize should be called just once, not for every grid point</span></td>
        </tr>
        <tr>
          <td id="L312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="312"></td>
          <td id="LC312" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_initialize(dum_D, loc_T, loc_sed_burial<span class="pl-k">/</span>dum_dtyr)</td>
        </tr>
        <tr>
          <td id="L313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="313"></td>
          <td id="LC313" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> OLD with settling flux</span></td>
        </tr>
        <tr>
          <td id="L314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="314"></td>
          <td id="LC314" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        call sub_huelseetal2016_initialize(dum_D, loc_T, loc_new_sed_vol/dum_dtyr)</span></td>
        </tr>
        <tr>
          <td id="L315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="315"></td>
          <td id="LC315" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="316"></td>
          <td id="LC316" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="317"></td>
          <td id="LC317" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        Model crashed for low sediment accumulation rates, therefore:</span></td>
        </tr>
        <tr>
          <td id="L318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="318"></td>
          <td id="LC318" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         Check for no detrital flux .OR. No burial rate from previous time-step -&gt; Remineralize everything manually</span></td>
        </tr>
        <tr>
          <td id="L319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="319"></td>
          <td id="LC319" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="320"></td>
          <td id="LC320" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>((loc_new_sed(is_det) <span class="pl-k">.LE.</span> const_real_nullsmall) <span class="pl-k">.OR.</span> (loc_sed_burial <span class="pl-k">.LE.</span> const_real_nullsmall))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="321"></td>
          <td id="LC321" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>!! Remineralize everything manually</span></td>
        </tr>
        <tr>
          <td id="L322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="322"></td>
          <td id="LC322" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="323"></td>
          <td id="LC323" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;no detrital/burial flux !!!!!!&#39;, loc_new_sed(is_det)</span></td>
        </tr>
        <tr>
          <td id="L324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="324"></td>
          <td id="LC324" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                    print*,&#39;dum_D, loc_fPOC &#39;, dum_D, loc_fPOC</span></td>
        </tr>
        <tr>
          <td id="L325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="325"></td>
          <td id="LC325" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                    print*,&#39;initial?? SD, OC, PC1, DICC1, ALKROX&#39;, SD, OC, PC1, DICC1, ALKROX</span></td>
        </tr>
        <tr>
          <td id="L326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="326"></td>
          <td id="LC326" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;1/(1-por)*loc_new_sed(is_det) = &#39;, 1/(1-por)*loc_new_sed(is_det)</span></td>
        </tr>
        <tr>
          <td id="L327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="327"></td>
          <td id="LC327" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="328"></td>
          <td id="LC328" class="blob-code blob-code-inner js-file-line">            dum_sed_pres_fracC <span class="pl-k">=</span> <span class="pl-c1">0.0</span>        <span class="pl-c"><span class="pl-c">!</span> sed POC preservation to zero</span></td>
        </tr>
        <tr>
          <td id="L329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="329"></td>
          <td id="LC329" class="blob-code blob-code-inner js-file-line">            dum_sed_pres_fracP <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="330"></td>
          <td id="LC330" class="blob-code blob-code-inner js-file-line">            dum_sed_OM_wtpc_bot <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="331"></td>
          <td id="LC331" class="blob-code blob-code-inner js-file-line">            loc_O2_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>(<span class="pl-k">-</span>OC<span class="pl-k">/</span>SD)</td>
        </tr>
        <tr>
          <td id="L332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="332"></td>
          <td id="LC332" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(ocn_select(io_NO3))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="333"></td>
          <td id="LC333" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> TODO: change if NO3 is selected</span></td>
        </tr>
        <tr>
          <td id="L334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="334"></td>
          <td id="LC334" class="blob-code blob-code-inner js-file-line">                loc_NO3_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="335"></td>
          <td id="LC335" class="blob-code blob-code-inner js-file-line">                loc_NH4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="336"></td>
          <td id="LC336" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="337"></td>
          <td id="LC337" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(ocn_select(io_SO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="338"></td>
          <td id="LC338" class="blob-code blob-code-inner js-file-line">                loc_SO4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span> <span class="pl-c"><span class="pl-c">!</span>conv_POC_cm3_mol*loc_fPOC*(-SO4C/SD)</span></td>
        </tr>
        <tr>
          <td id="L339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="339"></td>
          <td id="LC339" class="blob-code blob-code-inner js-file-line">                loc_H2S_swiflux <span class="pl-k">=</span> <span class="pl-k">-</span>loc_SO4_swiflux</td>
        </tr>
        <tr>
          <td id="L340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="340"></td>
          <td id="LC340" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="341"></td>
          <td id="LC341" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(ocn_select(io_PO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="342"></td>
          <td id="LC342" class="blob-code blob-code-inner js-file-line">                loc_PO4_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="343"></td>
          <td id="LC343" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="344"></td>
          <td id="LC344" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(ocn_select(io_DIC))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="345"></td>
          <td id="LC345" class="blob-code blob-code-inner js-file-line">                loc_DIC_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>DICC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="346"></td>
          <td id="LC346" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="347"></td>
          <td id="LC347" class="blob-code blob-code-inner js-file-line">             <span class="pl-k">if</span>(ocn_select(io_DIC_13C))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="348"></td>
          <td id="LC348" class="blob-code blob-code-inner js-file-line">                loc_DIC_13C_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC_13C<span class="pl-k">*</span>DICC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="349"></td>
          <td id="LC349" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="350"></td>
          <td id="LC350" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(ocn_select(io_ALK))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="351"></td>
          <td id="LC351" class="blob-code blob-code-inner js-file-line">                loc_ALK_swiflux <span class="pl-k">=</span> <span class="pl-c1">2.0</span><span class="pl-k">*</span>loc_H2S_swiflux <span class="pl-k">+</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>ALKROX<span class="pl-k">/</span>SD   <span class="pl-c"><span class="pl-c">!</span>16/106</span></td>
        </tr>
        <tr>
          <td id="L352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="352"></td>
          <td id="LC352" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="353"></td>
          <td id="LC353" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> Detrital flux &gt; const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="354"></td>
          <td id="LC354" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="355"></td>
          <td id="LC355" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> CHECK new burial rate for lower than detrital flux!</span></td>
        </tr>
        <tr>
          <td id="L356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="356"></td>
          <td id="LC356" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(loc_sed_burial <span class="pl-k">.LE.</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>loc_new_sed(is_det))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="357"></td>
          <td id="LC357" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                          print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="358"></td>
          <td id="LC358" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                              print*,&#39;OMEN burial &lt; detrital !!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span></td>
        </tr>
        <tr>
          <td id="L359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="359"></td>
          <td id="LC359" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;dum_i, dum_j, dum_D&#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="360"></td>
          <td id="LC360" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;loc_new_sed_vol_OLD =&#39;, loc_new_sed_vol</span></td>
        </tr>
        <tr>
          <td id="L361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="361"></td>
          <td id="LC361" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                             print*,&#39;loc_sed_burial =&#39;, loc_sed_burial</span></td>
        </tr>
        <tr>
          <td id="L362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="362"></td>
          <td id="LC362" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                              print*,&#39;1/(1-por)*loc_new_sed(is_det) = &#39;, 1/(1-por)*loc_new_sed(is_det)</span></td>
        </tr>
        <tr>
          <td id="L363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="363"></td>
          <td id="LC363" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;Corg flux to Sediment: loc_fPOC&#39;, loc_fPOC</span></td>
        </tr>
        <tr>
          <td id="L364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="364"></td>
          <td id="LC364" class="blob-code blob-code-inner js-file-line">                loc_sed_burial <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>loc_new_sed(is_det)      <span class="pl-c"><span class="pl-c">!</span> set burial flux as detrital flux</span></td>
        </tr>
        <tr>
          <td id="L365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="365"></td>
          <td id="LC365" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="366"></td>
          <td id="LC366" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="367"></td>
          <td id="LC367" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> CHECK if still lower than 4.0e-4 (5.0e-4 for OAE2), than cut there, as OMEN produces positive O2 SWI-fluxes</span></td>
        </tr>
        <tr>
          <td id="L368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="368"></td>
          <td id="LC368" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(loc_sed_burial <span class="pl-k">.LE.</span> <span class="pl-c1">5.0e-4</span>)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="369"></td>
          <td id="LC369" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="370"></td>
          <td id="LC370" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;OMEN burial &lt; 5.0e-4 !!!!!!!!!!!!!!!!!!!!!!!!!!&#39;</span></td>
        </tr>
        <tr>
          <td id="L371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="371"></td>
          <td id="LC371" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;dum_i, dum_j, dum_D&#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="372"></td>
          <td id="LC372" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;loc_new_sed_vol_OLD =&#39;, loc_new_sed_vol</span></td>
        </tr>
        <tr>
          <td id="L373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="373"></td>
          <td id="LC373" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_sed_burial_NEW before cut=&#39;, loc_sed_burial</span></td>
        </tr>
        <tr>
          <td id="L374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="374"></td>
          <td id="LC374" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;1/(1-por)*loc_new_sed(is_det) = &#39;, 1/(1-por)*loc_new_sed(is_det)</span></td>
        </tr>
        <tr>
          <td id="L375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="375"></td>
          <td id="LC375" class="blob-code blob-code-inner js-file-line">                loc_sed_burial <span class="pl-k">=</span> <span class="pl-c1">5.0e-4</span>     <span class="pl-c"><span class="pl-c">!</span>(5.0e-4 for OAE2; 4.0e-4 for modern)</span></td>
        </tr>
        <tr>
          <td id="L376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="376"></td>
          <td id="LC376" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="377"></td>
          <td id="LC377" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="378"></td>
          <td id="LC378" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        Dom: Old position of initialize:</span></td>
        </tr>
        <tr>
          <td id="L379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="379"></td>
          <td id="LC379" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            ! DH TODO: some of initialize should be called just once, not for every grid point</span></td>
        </tr>
        <tr>
          <td id="L380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="380"></td>
          <td id="LC380" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            call sub_huelseetal2016_initialize(dum_D, loc_T, loc_sed_burial/dum_dtyr)</span></td>
        </tr>
        <tr>
          <td id="L381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="381"></td>
          <td id="LC381" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> Now just update w:</span></td>
        </tr>
        <tr>
          <td id="L382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="382"></td>
          <td id="LC382" class="blob-code blob-code-inner js-file-line">                w <span class="pl-k">=</span> loc_sed_burial<span class="pl-k">/</span>dum_dtyr</td>
        </tr>
        <tr>
          <td id="L383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="383"></td>
          <td id="LC383" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="384"></td>
          <td id="LC384" class="blob-code blob-code-inner js-file-line">             <span class="pl-c"><span class="pl-c">!</span>  NEW version: using TOC-flux, convert units from cm3 to mol</span></td>
        </tr>
        <tr>
          <td id="L385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="385"></td>
          <td id="LC385" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> JUST TWO FRACTIONS:</span></td>
        </tr>
        <tr>
          <td id="L386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="386"></td>
          <td id="LC386" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            loc_POC1_flux_swi = conv_POC_cm3_mol*(1-dum_is_POC_frac2)*loc_fPOC</span></td>
        </tr>
        <tr>
          <td id="L387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="387"></td>
          <td id="LC387" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            loc_POC2_flux_swi = conv_POC_cm3_mol*dum_is_POC_frac2*loc_fPOC</span></td>
        </tr>
        <tr>
          <td id="L388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="388"></td>
          <td id="LC388" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> THIRD INERT/SULFURIZED FRACTION</span></td>
        </tr>
        <tr>
          <td id="L389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="389"></td>
          <td id="LC389" class="blob-code blob-code-inner js-file-line">            loc_POC1_flux_swi <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">*</span>loc_fPOC</td>
        </tr>
        <tr>
          <td id="L390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="390"></td>
          <td id="LC390" class="blob-code blob-code-inner js-file-line">            loc_POC3_flux_swi <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_new_sed(is_POM_S)</td>
        </tr>
        <tr>
          <td id="L391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="391"></td>
          <td id="LC391" class="blob-code blob-code-inner js-file-line">            loc_POC2_flux_swi <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>dum_is_POC_frac2<span class="pl-k">*</span>loc_fPOC<span class="pl-k">-</span>loc_POC3_flux_swi</td>
        </tr>
        <tr>
          <td id="L392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="392"></td>
          <td id="LC392" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="393"></td>
          <td id="LC393" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> make the k1 - k2 relation depth dependent:</span></td>
        </tr>
        <tr>
          <td id="L394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="394"></td>
          <td id="LC394" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            if(dum_D .LE. 1000.0)then</span></td>
        </tr>
        <tr>
          <td id="L395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="395"></td>
          <td id="LC395" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                par_sed_huelse2017_k2_order = 5.0</span></td>
        </tr>
        <tr>
          <td id="L396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="396"></td>
          <td id="LC396" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            elseif (dum_D .LE. 2000.0)then</span></td>
        </tr>
        <tr>
          <td id="L397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="397"></td>
          <td id="LC397" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                par_sed_huelse2017_k2_order = 8.0</span></td>
        </tr>
        <tr>
          <td id="L398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="398"></td>
          <td id="LC398" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            elseif (dum_D .LE. 3000.0)then</span></td>
        </tr>
        <tr>
          <td id="L399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="399"></td>
          <td id="LC399" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                par_sed_huelse2017_k2_order = 12.0</span></td>
        </tr>
        <tr>
          <td id="L400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="400"></td>
          <td id="LC400" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        !                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="401"></td>
          <td id="LC401" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        !                print*,&#39; below 3000&#39;</span></td>
        </tr>
        <tr>
          <td id="L402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="402"></td>
          <td id="LC402" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            !elseif (dum_D .LE. 4000.0)then</span></td>
        </tr>
        <tr>
          <td id="L403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="403"></td>
          <td id="LC403" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            !    par_sed_huelse2017_k2_order = 50.0</span></td>
        </tr>
        <tr>
          <td id="L404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="404"></td>
          <td id="LC404" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            !elseif (dum_D .LE. 5000.0)then</span></td>
        </tr>
        <tr>
          <td id="L405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="405"></td>
          <td id="LC405" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            !    par_sed_huelse2017_k2_order = 100.0</span></td>
        </tr>
        <tr>
          <td id="L406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="406"></td>
          <td id="LC406" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            else</span></td>
        </tr>
        <tr>
          <td id="L407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="407"></td>
          <td id="LC407" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                par_sed_huelse2017_k2_order = 25.0</span></td>
        </tr>
        <tr>
          <td id="L408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="408"></td>
          <td id="LC408" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            end if</span></td>
        </tr>
        <tr>
          <td id="L409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="409"></td>
          <td id="LC409" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="410"></td>
          <td id="LC410" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> use oxic degradation rates</span></td>
        </tr>
        <tr>
          <td id="L411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="411"></td>
          <td id="LC411" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">select case</span> (par_sed_huelse2017_kscheme)</td>
        </tr>
        <tr>
          <td id="L412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="412"></td>
          <td id="LC412" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>boudreau1997<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="413"></td>
          <td id="LC413" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Boudreau 1997 dependent on sediment accumulation rate (w)</span></td>
        </tr>
        <tr>
          <td id="L414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="414"></td>
          <td id="LC414" class="blob-code blob-code-inner js-file-line">                    loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">0.38</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">0.59</span></td>
        </tr>
        <tr>
          <td id="L415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="415"></td>
          <td id="LC415" class="blob-code blob-code-inner js-file-line">                    k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="416"></td>
          <td id="LC416" class="blob-code blob-code-inner js-file-line">                    k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="417"></td>
          <td id="LC417" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="418"></td>
          <td id="LC418" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;boudreau1997 oxic dum_D, k2_order, k1, k2 =&#39;, dum_D, par_sed_huelse2017_k2_order, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="419"></td>
          <td id="LC419" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>tromp1995<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="420"></td>
          <td id="LC420" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Tromp et al. 1995:</span></td>
        </tr>
        <tr>
          <td id="L421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="421"></td>
          <td id="LC421" class="blob-code blob-code-inner js-file-line">                    loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">2.97</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">0.62</span></td>
        </tr>
        <tr>
          <td id="L422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="422"></td>
          <td id="LC422" class="blob-code blob-code-inner js-file-line">                    k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="423"></td>
          <td id="LC423" class="blob-code blob-code-inner js-file-line">                    k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="424"></td>
          <td id="LC424" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;tromp1995 oxic k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="425"></td>
          <td id="LC425" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>stolpovsky2016<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="426"></td>
          <td id="LC426" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Stolpovsky et al. 2015 dependent on sediment accumulation rate (w)</span></td>
        </tr>
        <tr>
          <td id="L427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="427"></td>
          <td id="LC427" class="blob-code blob-code-inner js-file-line">                    loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">1.02</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">0.5</span></td>
        </tr>
        <tr>
          <td id="L428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="428"></td>
          <td id="LC428" class="blob-code blob-code-inner js-file-line">                    k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="429"></td>
          <td id="LC429" class="blob-code blob-code-inner js-file-line">                    k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="430"></td>
          <td id="LC430" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;stolpovsky2016 oxic k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="431"></td>
          <td id="LC431" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>boudreau1997fPOC<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="432"></td>
          <td id="LC432" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> k dependent on OM flux, after Boudreau 1997:</span></td>
        </tr>
        <tr>
          <td id="L433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="433"></td>
          <td id="LC433" class="blob-code blob-code-inner js-file-line">                    loc_total_POC_flux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span><span class="pl-c1">10</span><span class="pl-k">**</span><span class="pl-c1">6</span></td>
        </tr>
        <tr>
          <td id="L434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="434"></td>
          <td id="LC434" class="blob-code blob-code-inner js-file-line">                    k1 <span class="pl-k">=</span> <span class="pl-c1">2.2</span><span class="pl-k">*</span><span class="pl-c1">1e-5</span><span class="pl-k">*</span>loc_total_POC_flux<span class="pl-k">**</span><span class="pl-c1">2.1</span></td>
        </tr>
        <tr>
          <td id="L435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="435"></td>
          <td id="LC435" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>temp_dependent<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="436"></td>
          <td id="LC436" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> k1 and k2 temperature dependent as in John et al. 2014:</span></td>
        </tr>
        <tr>
          <td id="L437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="437"></td>
          <td id="LC437" class="blob-code blob-code-inner js-file-line">                    k1 <span class="pl-k">=</span> loc_par_bio_remin_POC_K1<span class="pl-k">*</span><span class="pl-k">exp</span>(<span class="pl-k">-</span>loc_par_bio_remin_POC_Ea1<span class="pl-k">/</span>(const_R_SI<span class="pl-k">*</span>loc_T))</td>
        </tr>
        <tr>
          <td id="L438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="438"></td>
          <td id="LC438" class="blob-code blob-code-inner js-file-line">                    k2 <span class="pl-k">=</span> loc_par_bio_remin_POC_K2<span class="pl-k">*</span><span class="pl-k">exp</span>(<span class="pl-k">-</span>loc_par_bio_remin_POC_Ea2<span class="pl-k">/</span>(const_R_SI<span class="pl-k">*</span>loc_T))</td>
        </tr>
        <tr>
          <td id="L439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="439"></td>
          <td id="LC439" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>Tmp dep: dum_D, loc_T, k1, k2 =<span class="pl-pds">&#39;</span></span>, dum_D, loc_T, k1, k2</td>
        </tr>
        <tr>
          <td id="L440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="440"></td>
          <td id="LC440" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">case default</span></td>
        </tr>
        <tr>
          <td id="L441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="441"></td>
          <td id="LC441" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> globally invariant k1 and k2 as set in par_sed_huelse2017_k1, par_sed_huelse2017_k2</span></td>
        </tr>
        <tr>
          <td id="L442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="442"></td>
          <td id="LC442" class="blob-code blob-code-inner js-file-line">                    k1<span class="pl-k">=</span>par_sed_huelse2017_k1</td>
        </tr>
        <tr>
          <td id="L443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="443"></td>
          <td id="LC443" class="blob-code blob-code-inner js-file-line">                    k2<span class="pl-k">=</span>par_sed_huelse2017_k2        <span class="pl-c"><span class="pl-c">!</span>0.005</span></td>
        </tr>
        <tr>
          <td id="L444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="444"></td>
          <td id="LC444" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        k2=k1/par_sed_huelse2017_k2_order</span></td>
        </tr>
        <tr>
          <td id="L445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="445"></td>
          <td id="LC445" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="446"></td>
          <td id="LC446" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;oxic default degradation: k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="447"></td>
          <td id="LC447" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> make the k1 - k2 relation depth dependent:</span></td>
        </tr>
        <tr>
          <td id="L448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="448"></td>
          <td id="LC448" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                if(dum_D .LE. 2000.0)then</span></td>
        </tr>
        <tr>
          <td id="L449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="449"></td>
          <td id="LC449" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                    loc_k_apparent = par_sed_huelse2017_k1</span></td>
        </tr>
        <tr>
          <td id="L450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="450"></td>
          <td id="LC450" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                else</span></td>
        </tr>
        <tr>
          <td id="L451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="451"></td>
          <td id="LC451" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                    loc_k_apparent = par_sed_huelse2017_k2</span></td>
        </tr>
        <tr>
          <td id="L452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="452"></td>
          <td id="LC452" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                end if</span></td>
        </tr>
        <tr>
          <td id="L453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="453"></td>
          <td id="LC453" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                k1=loc_k_apparent/((1-dum_is_POC_frac2)+dum_is_POC_frac2/par_sed_huelse2017_k2_order)</span></td>
        </tr>
        <tr>
          <td id="L454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="454"></td>
          <td id="LC454" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                k2=k1/par_sed_huelse2017_k2_order</span></td>
        </tr>
        <tr>
          <td id="L455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="455"></td>
          <td id="LC455" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="456"></td>
          <td id="LC456" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;default oxic dum_D, loc_k_apparent, k1, k2 =&#39;, dum_D, loc_k_apparent, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="457"></td>
          <td id="LC457" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            ! MIN oxic from Arndt et al. 2013</span></td>
        </tr>
        <tr>
          <td id="L458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="458"></td>
          <td id="LC458" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        k1=1.0e-4</span></td>
        </tr>
        <tr>
          <td id="L459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="459"></td>
          <td id="LC459" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        k2=1.0e-6</span></td>
        </tr>
        <tr>
          <td id="L460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="460"></td>
          <td id="LC460" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="461"></td>
          <td id="LC461" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        ! oxic from PALASTANGA ET AL. 2011</span></td>
        </tr>
        <tr>
          <td id="L462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="462"></td>
          <td id="LC462" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        if(dum_D .LE. 2000)then</span></td>
        </tr>
        <tr>
          <td id="L463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="463"></td>
          <td id="LC463" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                            k1=0.01</span></td>
        </tr>
        <tr>
          <td id="L464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="464"></td>
          <td id="LC464" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        else</span></td>
        </tr>
        <tr>
          <td id="L465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="465"></td>
          <td id="LC465" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                            k1=0.005</span></td>
        </tr>
        <tr>
          <td id="L466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="466"></td>
          <td id="LC466" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        end if</span></td>
        </tr>
        <tr>
          <td id="L467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="467"></td>
          <td id="LC467" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end select</span></td>
        </tr>
        <tr>
          <td id="L468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="468"></td>
          <td id="LC468" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> use anoxic rate:</span></td>
        </tr>
        <tr>
          <td id="L469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="469"></td>
          <td id="LC469" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(par_sed_huelse2017_redox)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="470"></td>
          <td id="LC470" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*,&#39;USE anoxic degradation rate&#39;</span></td>
        </tr>
        <tr>
          <td id="L471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="471"></td>
          <td id="LC471" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> if anoxic, decrease zbio and use anoxic degradation rate</span></td>
        </tr>
        <tr>
          <td id="L472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="472"></td>
          <td id="LC472" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(dum_swiconc_O2 <span class="pl-k">.LE.</span> loc_BW_O2_anoxia)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="473"></td>
          <td id="LC473" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> decrease bioturbation depth</span></td>
        </tr>
        <tr>
          <td id="L474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="474"></td>
          <td id="LC474" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;USE anoxic degradation rate&#39;</span></td>
        </tr>
        <tr>
          <td id="L475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="475"></td>
          <td id="LC475" class="blob-code blob-code-inner js-file-line">                    zbio <span class="pl-k">=</span> <span class="pl-c1">0.01</span></td>
        </tr>
        <tr>
          <td id="L476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="476"></td>
          <td id="LC476" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">select case</span> (par_sed_huelse2017_kscheme)</td>
        </tr>
        <tr>
          <td id="L477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="477"></td>
          <td id="LC477" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>boudreau1997<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="478"></td>
          <td id="LC478" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Boudreau 1997 dependent on sediment accumulation rate (w)</span></td>
        </tr>
        <tr>
          <td id="L479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="479"></td>
          <td id="LC479" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> which is actually Toth and Lerman (1977) - as no anoxic rate in Boudreau 1997:</span></td>
        </tr>
        <tr>
          <td id="L480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="480"></td>
          <td id="LC480" class="blob-code blob-code-inner js-file-line">                            loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">0.04</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">2.0</span></td>
        </tr>
        <tr>
          <td id="L481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="481"></td>
          <td id="LC481" class="blob-code blob-code-inner js-file-line">                            k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="482"></td>
          <td id="LC482" class="blob-code blob-code-inner js-file-line">                            k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="483"></td>
          <td id="LC483" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;boudreau1997 anoxic k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="484"></td>
          <td id="LC484" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>tromp1995<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="485"></td>
          <td id="LC485" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Tromp et al. 1995:</span></td>
        </tr>
        <tr>
          <td id="L486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="486"></td>
          <td id="LC486" class="blob-code blob-code-inner js-file-line">                            loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">0.057</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">1.94</span></td>
        </tr>
        <tr>
          <td id="L487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="487"></td>
          <td id="LC487" class="blob-code blob-code-inner js-file-line">                            k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="488"></td>
          <td id="LC488" class="blob-code blob-code-inner js-file-line">                            k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="489"></td>
          <td id="LC489" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>stolpovsky2016<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="490"></td>
          <td id="LC490" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> use parameterisation of Stolpovsky et al. 2015 dependent on sediment accumulation rate (w)</span></td>
        </tr>
        <tr>
          <td id="L491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="491"></td>
          <td id="LC491" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> which is actually Toth and Lerman (1977) - as no anoxic rate in Stolpovsky et al. 2015:</span></td>
        </tr>
        <tr>
          <td id="L492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="492"></td>
          <td id="LC492" class="blob-code blob-code-inner js-file-line">                            loc_k_apparent <span class="pl-k">=</span> <span class="pl-c1">0.04</span><span class="pl-k">*</span>w<span class="pl-k">**</span><span class="pl-c1">2.0</span></td>
        </tr>
        <tr>
          <td id="L493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="493"></td>
          <td id="LC493" class="blob-code blob-code-inner js-file-line">                            k1<span class="pl-k">=</span>loc_k_apparent<span class="pl-k">/</span>((<span class="pl-c1">1</span><span class="pl-k">-</span>dum_is_POC_frac2)<span class="pl-k">+</span>dum_is_POC_frac2<span class="pl-k">/</span>par_sed_huelse2017_k2_order)</td>
        </tr>
        <tr>
          <td id="L494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="494"></td>
          <td id="LC494" class="blob-code blob-code-inner js-file-line">                            k2<span class="pl-k">=</span>k1<span class="pl-k">/</span>par_sed_huelse2017_k2_order</td>
        </tr>
        <tr>
          <td id="L495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="495"></td>
          <td id="LC495" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;stolpovsky2016 anoxic k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="496"></td>
          <td id="LC496" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">case</span> (<span class="pl-s"><span class="pl-pds">&#39;</span>boudreau1997fPOC<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="497"></td>
          <td id="LC497" class="blob-code blob-code-inner js-file-line">                           <span class="pl-c"><span class="pl-c">!</span> ### &lt;INSERT CODE&gt; ####################################################################################################### !</span></td>
        </tr>
        <tr>
          <td id="L498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="498"></td>
          <td id="LC498" class="blob-code blob-code-inner js-file-line">                           <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="499"></td>
          <td id="LC499" class="blob-code blob-code-inner js-file-line">                           <span class="pl-c"><span class="pl-c">!</span> ######################################################################################################################### !</span></td>
        </tr>
        <tr>
          <td id="L500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="500"></td>
          <td id="LC500" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">case default</span></td>
        </tr>
        <tr>
          <td id="L501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="501"></td>
          <td id="LC501" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> globally invariant k1 and k2 as set in par_sed_huelse2017_k1, par_sed_huelse2017_k2</span></td>
        </tr>
        <tr>
          <td id="L502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="502"></td>
          <td id="LC502" class="blob-code blob-code-inner js-file-line">                            k1<span class="pl-k">=</span>par_sed_huelse2017_k1</td>
        </tr>
        <tr>
          <td id="L503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="503"></td>
          <td id="LC503" class="blob-code blob-code-inner js-file-line">                            k2<span class="pl-k">=</span>par_sed_huelse2017_k2_anoxic</td>
        </tr>
        <tr>
          <td id="L504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="504"></td>
          <td id="LC504" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                           print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="505"></td>
          <td id="LC505" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;anoxic default degradation: k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="506"></td>
          <td id="LC506" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> MIN anoxic from Arndt et al. 2013</span></td>
        </tr>
        <tr>
          <td id="L507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="507"></td>
          <td id="LC507" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>            k1=6.0e-7;</span></td>
        </tr>
        <tr>
          <td id="L508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="508"></td>
          <td id="LC508" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>            k2=1.25e-8;</span></td>
        </tr>
        <tr>
          <td id="L509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="509"></td>
          <td id="LC509" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> anoxic from PALASTANGA ET AL. 2011</span></td>
        </tr>
        <tr>
          <td id="L510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="510"></td>
          <td id="LC510" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>            if(dum_D .LE. 2000)then</span></td>
        </tr>
        <tr>
          <td id="L511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="511"></td>
          <td id="LC511" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                k1=0.008</span></td>
        </tr>
        <tr>
          <td id="L512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="512"></td>
          <td id="LC512" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>            else</span></td>
        </tr>
        <tr>
          <td id="L513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="513"></td>
          <td id="LC513" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                k1=0.002</span></td>
        </tr>
        <tr>
          <td id="L514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="514"></td>
          <td id="LC514" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>            end if</span></td>
        </tr>
        <tr>
          <td id="L515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="515"></td>
          <td id="LC515" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end select</span></td>
        </tr>
        <tr>
          <td id="L516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="516"></td>
          <td id="LC516" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> (dum_swiconc_O2 .LE. loc_BW_O2_anoxia)</span></td>
        </tr>
        <tr>
          <td id="L517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="517"></td>
          <td id="LC517" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> use anoxic rate constants</span></td>
        </tr>
        <tr>
          <td id="L518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="518"></td>
          <td id="LC518" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="519"></td>
          <td id="LC519" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;k1, k2 =&#39;, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="520"></td>
          <td id="LC520" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="521"></td>
          <td id="LC521" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Check for no POC deposited -&gt; nothing preserved</span></td>
        </tr>
        <tr>
          <td id="L522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="522"></td>
          <td id="LC522" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(loc_POC1_flux_swi <span class="pl-k">.LE.</span> const_real_nullsmall <span class="pl-k">.AND.</span> loc_POC2_flux_swi <span class="pl-k">.LE.</span> const_real_nullsmall  <span class="pl-k">.AND.</span> loc_POC3_flux_swi <span class="pl-k">.LE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="523"></td>
          <td id="LC523" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;no POC deposited  dum_D &#39;, dum_D, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="524"></td>
          <td id="LC524" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; grid point (i,j) &#39;, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="525"></td>
          <td id="LC525" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="526"></td>
          <td id="LC526" class="blob-code blob-code-inner js-file-line">                dum_sed_pres_fracC <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="527"></td>
          <td id="LC527" class="blob-code blob-code-inner js-file-line">                dum_sed_pres_fracP <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="528"></td>
          <td id="LC528" class="blob-code blob-code-inner js-file-line">                dum_sed_OM_wtpc_bot <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="529"></td>
          <td id="LC529" class="blob-code blob-code-inner js-file-line">                loc_O2_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="530"></td>
          <td id="LC530" class="blob-code blob-code-inner js-file-line">                loc_NO3_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="531"></td>
          <td id="LC531" class="blob-code blob-code-inner js-file-line">                loc_SO4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="532"></td>
          <td id="LC532" class="blob-code blob-code-inner js-file-line">                loc_NH4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="533"></td>
          <td id="LC533" class="blob-code blob-code-inner js-file-line">                loc_H2S_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="534"></td>
          <td id="LC534" class="blob-code blob-code-inner js-file-line">                loc_PO4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="535"></td>
          <td id="LC535" class="blob-code blob-code-inner js-file-line">                loc_DIC_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="536"></td>
          <td id="LC536" class="blob-code blob-code-inner js-file-line">                loc_DIC_13C_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="537"></td>
          <td id="LC537" class="blob-code blob-code-inner js-file-line">                loc_ALK_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="538"></td>
          <td id="LC538" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="539"></td>
          <td id="LC539" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>!!! OLD version: TOC concentration:  call sub_huelseetal2016_zTOC(loc_POC1_wtpct_swi, loc_POC2_wtpct_swi, dum_sed_pres_fracC)</span></td>
        </tr>
        <tr>
          <td id="L540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="540"></td>
          <td id="LC540" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="541"></td>
          <td id="LC541" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(dum_swiconc_O2 <span class="pl-k">.LE.</span> loc_BW_O2_anoxia)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="542"></td>
          <td id="LC542" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> decrease bioturbation depth</span></td>
        </tr>
        <tr>
          <td id="L543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="543"></td>
          <td id="LC543" class="blob-code blob-code-inner js-file-line">                    zbio <span class="pl-k">=</span> <span class="pl-c1">0.01</span></td>
        </tr>
        <tr>
          <td id="L544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="544"></td>
          <td id="LC544" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="545"></td>
          <td id="LC545" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="546"></td>
          <td id="LC546" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_huelseetal2016_zTOC(dum_D, loc_POC1_flux_swi, loc_POC2_flux_swi, loc_POC3_flux_swi, dum_sed_pres_fracC, loc_sed_pres_insane, dum_sed_OM_wtpc_bot)</td>
        </tr>
        <tr>
          <td id="L547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="547"></td>
          <td id="LC547" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> CHECK IF TOC preservation results in insane values, i.e. everything remineralized</span></td>
        </tr>
        <tr>
          <td id="L548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="548"></td>
          <td id="LC548" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> Then calculate SWI-fluxes &quot;manually&quot;</span></td>
        </tr>
        <tr>
          <td id="L549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="549"></td>
          <td id="LC549" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                if(dum_sed_pres_fracC .LE. 0.0)then</span></td>
        </tr>
        <tr>
          <td id="L550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="550"></td>
          <td id="LC550" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="551"></td>
          <td id="LC551" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;!!!!!!!! NEGATIVE POC preservation &#39;, dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="552"></td>
          <td id="LC552" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;dum_D, dum_i, dum_j&#39;, dum_D, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="553"></td>
          <td id="LC553" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                end if</span></td>
        </tr>
        <tr>
          <td id="L554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="554"></td>
          <td id="LC554" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>((dum_sed_pres_fracC <span class="pl-k">.NE.</span> dum_sed_pres_fracC) <span class="pl-k">.OR.</span> (dum_sed_pres_fracC <span class="pl-k">.LE.</span> <span class="pl-c1">0.0</span>) <span class="pl-k">.OR.</span> (dum_sed_pres_fracC &gt; <span class="pl-c1">1.0</span>))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="555"></td>
          <td id="LC555" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="556"></td>
          <td id="LC556" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;weird dum_sed_pres_fracC &#39;, dum_sed_pres_fracC, dum_D, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="557"></td>
          <td id="LC557" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;dum_D, dum_i, dum_j&#39;, dum_D, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="558"></td>
          <td id="LC558" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;loc_sed_burial&#39;, loc_sed_burial</span></td>
        </tr>
        <tr>
          <td id="L559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="559"></td>
          <td id="LC559" class="blob-code blob-code-inner js-file-line">                </td>
        </tr>
        <tr>
          <td id="L560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="560"></td>
          <td id="LC560" class="blob-code blob-code-inner js-file-line">                    dum_sed_pres_fracC <span class="pl-k">=</span> <span class="pl-c1">0.0</span>        <span class="pl-c"><span class="pl-c">!</span> sed TOC preservation to zero</span></td>
        </tr>
        <tr>
          <td id="L561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="561"></td>
          <td id="LC561" class="blob-code blob-code-inner js-file-line">                    dum_sed_pres_fracP <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="562"></td>
          <td id="LC562" class="blob-code blob-code-inner js-file-line">                    dum_sed_OM_wtpc_bot <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="563"></td>
          <td id="LC563" class="blob-code blob-code-inner js-file-line">                    loc_O2_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>(<span class="pl-k">-</span>OC<span class="pl-k">/</span>SD)</td>
        </tr>
        <tr>
          <td id="L564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="564"></td>
          <td id="LC564" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_NO3))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="565"></td>
          <td id="LC565" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> TODO: change if NO3 is selected</span></td>
        </tr>
        <tr>
          <td id="L566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="566"></td>
          <td id="LC566" class="blob-code blob-code-inner js-file-line">                        loc_NO3_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="567"></td>
          <td id="LC567" class="blob-code blob-code-inner js-file-line">                        loc_NH4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="568"></td>
          <td id="LC568" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="569"></td>
          <td id="LC569" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_SO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="570"></td>
          <td id="LC570" class="blob-code blob-code-inner js-file-line">                        loc_SO4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span> <span class="pl-c"><span class="pl-c">!</span>conv_POC_cm3_mol*loc_fPOC*(-SO4C/SD)</span></td>
        </tr>
        <tr>
          <td id="L571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="571"></td>
          <td id="LC571" class="blob-code blob-code-inner js-file-line">                        loc_H2S_swiflux <span class="pl-k">=</span> <span class="pl-k">-</span>loc_SO4_swiflux</td>
        </tr>
        <tr>
          <td id="L572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="572"></td>
          <td id="LC572" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="573"></td>
          <td id="LC573" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_PO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="574"></td>
          <td id="LC574" class="blob-code blob-code-inner js-file-line">                        loc_PO4_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="575"></td>
          <td id="LC575" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="576"></td>
          <td id="LC576" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_DIC))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="577"></td>
          <td id="LC577" class="blob-code blob-code-inner js-file-line">                        loc_DIC_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>DICC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="578"></td>
          <td id="LC578" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="579"></td>
          <td id="LC579" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_DIC_13C))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="580"></td>
          <td id="LC580" class="blob-code blob-code-inner js-file-line">                        loc_DIC_13C_swiflux <span class="pl-k">=</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC_13C<span class="pl-k">*</span>DICC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="581"></td>
          <td id="LC581" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="582"></td>
          <td id="LC582" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_ALK))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="583"></td>
          <td id="LC583" class="blob-code blob-code-inner js-file-line">                        loc_ALK_swiflux <span class="pl-k">=</span> <span class="pl-c1">2.0</span><span class="pl-k">*</span>loc_H2S_swiflux <span class="pl-k">+</span> conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC<span class="pl-k">*</span>ALKROX<span class="pl-k">/</span>SD   <span class="pl-c"><span class="pl-c">!</span>16/106</span></td>
        </tr>
        <tr>
          <td id="L584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="584"></td>
          <td id="LC584" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="585"></td>
          <td id="LC585" class="blob-code blob-code-inner js-file-line">            </td>
        </tr>
        <tr>
          <td id="L586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="586"></td>
          <td id="LC586" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span> <span class="pl-c"><span class="pl-c">!</span> dum_sed_pres_fracC &lt;&gt; NaN: normal OMEN call</span></td>
        </tr>
        <tr>
          <td id="L587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="587"></td>
          <td id="LC587" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;Normal sed_pres &#39;, dum_sed_pres_fracC, dum_D, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="588"></td>
          <td id="LC588" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="589"></td>
          <td id="LC589" class="blob-code blob-code-inner js-file-line">                </td>
        </tr>
        <tr>
          <td id="L590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="590"></td>
          <td id="LC590" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                if(dum_sed_pres_fracC .NE. 0.0)then</span></td>
        </tr>
        <tr>
          <td id="L591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="591"></td>
          <td id="LC591" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;Something is preserved&#39;, dum_sed_pres_fracC, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="592"></td>
          <td id="LC592" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>           !                STOP</span></td>
        </tr>
        <tr>
          <td id="L593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="593"></td>
          <td id="LC593" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                end if</span></td>
        </tr>
        <tr>
          <td id="L594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="594"></td>
          <td id="LC594" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="595"></td>
          <td id="LC595" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;dum_sed_pres_fracC &#39;, dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="596"></td>
          <td id="LC596" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="597"></td>
          <td id="LC597" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="598"></td>
          <td id="LC598" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(dum_swiconc_O2 <span class="pl-k">.LE.</span> const_real_nullsmall) <span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> 10.0E-9</span></td>
        </tr>
        <tr>
          <td id="L599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="599"></td>
          <td id="LC599" class="blob-code blob-code-inner js-file-line">                        loc_O2_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span>            <span class="pl-c"><span class="pl-c">!</span> if negative [O2] -&gt; no SWI flux</span></td>
        </tr>
        <tr>
          <td id="L600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="600"></td>
          <td id="LC600" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;dum_swiconc_O2 = &#39;, dum_swiconc_O2</span></td>
        </tr>
        <tr>
          <td id="L601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="601"></td>
          <td id="LC601" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="602"></td>
          <td id="LC602" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_huelseetal2016_zO2(dum_D, dum_swiconc_O2, loc_O2_swiflux)</td>
        </tr>
        <tr>
          <td id="L603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="603"></td>
          <td id="LC603" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;OMEN loc_O2_swiflux = &#39;, loc_O2_swiflux</span></td>
        </tr>
        <tr>
          <td id="L604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="604"></td>
          <td id="LC604" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span>(loc_O2_swiflux <span class="pl-k">.GE.</span> <span class="pl-c1">0.0</span>)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="605"></td>
          <td id="LC605" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="606"></td>
          <td id="LC606" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>---------- loc_O2_swiflux positiv ----------<span class="pl-pds">&#39;</span></span>, loc_O2_swiflux, dum_i, dum_j, dum_D</td>
        </tr>
        <tr>
          <td id="L607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="607"></td>
          <td id="LC607" class="blob-code blob-code-inner js-file-line">                                loc_O2_swiflux_pos <span class="pl-k">=</span> <span class="pl-c1">.true.</span></td>
        </tr>
        <tr>
          <td id="L608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="608"></td>
          <td id="LC608" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;dum_i, dum_j, dum_D&#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="609"></td>
          <td id="LC609" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;sedimentation flux =&#39;, loc_new_sed_vol</span></td>
        </tr>
        <tr>
          <td id="L610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="610"></td>
          <td id="LC610" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;loc_sed_burial_NEW =&#39;, loc_sed_burial</span></td>
        </tr>
        <tr>
          <td id="L611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="611"></td>
          <td id="LC611" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;1/(1-por)*loc_new_sed(is_det) = &#39;, 1/(1-por)*loc_new_sed(is_det)</span></td>
        </tr>
        <tr>
          <td id="L612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="612"></td>
          <td id="LC612" class="blob-code blob-code-inner js-file-line">                            loc_O2_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="613"></td>
          <td id="LC613" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>                     STOP</span></td>
        </tr>
        <tr>
          <td id="L614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="614"></td>
          <td id="LC614" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="615"></td>
          <td id="LC615" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="616"></td>
          <td id="LC616" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;---------- NEGATIVE O2 SWI-flux----------&#39;</span></td>
        </tr>
        <tr>
          <td id="L617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="617"></td>
          <td id="LC617" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="618"></td>
          <td id="LC618" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="619"></td>
          <td id="LC619" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="620"></td>
          <td id="LC620" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_NO3))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="621"></td>
          <td id="LC621" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_huelseetal2016_zNO3(dum_swiconc_NO3, loc_NO3_swiflux)</td>
        </tr>
        <tr>
          <td id="L622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="622"></td>
          <td id="LC622" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="623"></td>
          <td id="LC623" class="blob-code blob-code-inner js-file-line">                        zno3 <span class="pl-k">=</span> zox</td>
        </tr>
        <tr>
          <td id="L624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="624"></td>
          <td id="LC624" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;OMEN zno3 = &#39;, zno3</span></td>
        </tr>
        <tr>
          <td id="L625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="625"></td>
          <td id="LC625" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="626"></td>
          <td id="LC626" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="627"></td>
          <td id="LC627" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> here check for SWI concentration, as problem with root-finding</span></td>
        </tr>
        <tr>
          <td id="L628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="628"></td>
          <td id="LC628" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> when is zero. And as no SO4 produced no need to call subroutine anyway</span></td>
        </tr>
        <tr>
          <td id="L629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="629"></td>
          <td id="LC629" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_SO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="630"></td>
          <td id="LC630" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span>(dum_swiconc_SO4 &gt; const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="631"></td>
          <td id="LC631" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span>               Hack</span></td>
        </tr>
        <tr>
          <td id="L632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="632"></td>
          <td id="LC632" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span>                    loc_SO4_swiflux = loc_new_sed(is_POC)*conv_POC_cm3_mol*(-138.0/212.0)</span></td>
        </tr>
        <tr>
          <td id="L633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="633"></td>
          <td id="LC633" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">call</span> sub_huelseetal2016_zSO4(dum_swiconc_SO4, loc_SO4_swiflux)</td>
        </tr>
        <tr>
          <td id="L634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="634"></td>
          <td id="LC634" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;OMEN loc_SO4_swiflux = &#39;, loc_SO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="635"></td>
          <td id="LC635" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">if</span>(loc_SO4_swiflux &gt; <span class="pl-c1">0.0</span>)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="636"></td>
          <td id="LC636" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="637"></td>
          <td id="LC637" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>---------- loc_SO4_swiflux positiv ----------<span class="pl-pds">&#39;</span></span>, loc_SO4_swiflux</td>
        </tr>
        <tr>
          <td id="L638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="638"></td>
          <td id="LC638" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_i, dum_j, dum_D<span class="pl-pds">&#39;</span></span>, dum_i, dum_j, dum_D</td>
        </tr>
        <tr>
          <td id="L639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="639"></td>
          <td id="LC639" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>loc_sed_burial_NEW =<span class="pl-pds">&#39;</span></span>, loc_sed_burial</td>
        </tr>
        <tr>
          <td id="L640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="640"></td>
          <td id="LC640" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>1/(1-por)*loc_new_sed(is_det) = <span class="pl-pds">&#39;</span></span>, <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>loc_new_sed(is_det)</td>
        </tr>
        <tr>
          <td id="L641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="641"></td>
          <td id="LC641" class="blob-code blob-code-inner js-file-line">                                loc_SO4_swiflux <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="642"></td>
          <td id="LC642" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span>                    !                STOP</span></td>
        </tr>
        <tr>
          <td id="L643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="643"></td>
          <td id="LC643" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="644"></td>
          <td id="LC644" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="645"></td>
          <td id="LC645" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="646"></td>
          <td id="LC646" class="blob-code blob-code-inner js-file-line">                            zso4 <span class="pl-k">=</span> zno3</td>
        </tr>
        <tr>
          <td id="L647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="647"></td>
          <td id="LC647" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="648"></td>
          <td id="LC648" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="649"></td>
          <td id="LC649" class="blob-code blob-code-inner js-file-line">                        zso4 <span class="pl-k">=</span> zno3</td>
        </tr>
        <tr>
          <td id="L650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="650"></td>
          <td id="LC650" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="651"></td>
          <td id="LC651" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="652"></td>
          <td id="LC652" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_NH4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="653"></td>
          <td id="LC653" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_huelseetal2016_zNH4(dum_swiconc_NH4, loc_NH4_swiflux)</td>
        </tr>
        <tr>
          <td id="L654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="654"></td>
          <td id="LC654" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="655"></td>
          <td id="LC655" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="656"></td>
          <td id="LC656" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="657"></td>
          <td id="LC657" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="658"></td>
          <td id="LC658" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_H2S))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="659"></td>
          <td id="LC659" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>               Hack</span></td>
        </tr>
        <tr>
          <td id="L660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="660"></td>
          <td id="LC660" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span>                    loc_H2S_swiflux = loc_new_sed(is_POC)*conv_POC_cm3_mol*(138.0/212.0)</span></td>
        </tr>
        <tr>
          <td id="L661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="661"></td>
          <td id="LC661" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_huelseetal2016_zH2S(dum_swiconc_H2S, loc_H2S_swiflux)</td>
        </tr>
        <tr>
          <td id="L662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="662"></td>
          <td id="LC662" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                    print*,&#39;OMEN loc_H2S_swiflux = &#39;, loc_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="663"></td>
          <td id="LC663" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> Now check for H2S in sulphurised OM which is given back to BIOGEM (in 1:1 ratio)</span></td>
        </tr>
        <tr>
          <td id="L664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="664"></td>
          <td id="LC664" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> in order to conserve S balance</span></td>
        </tr>
        <tr>
          <td id="L665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="665"></td>
          <td id="LC665" class="blob-code blob-code-inner js-file-line">                           <span class="pl-c"><span class="pl-c">!</span> We decided to bury the H2S and &#39;remove&#39; just the associated ALK (Email POC-S 05.09.2017)</span></td>
        </tr>
        <tr>
          <td id="L666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="666"></td>
          <td id="LC666" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    if(loc_new_sed(is_POM_S) .GE. const_real_nullsmall)then</span></td>
        </tr>
        <tr>
          <td id="L667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="667"></td>
          <td id="LC667" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                     loc_POM_S_H2S_swiflux = loc_new_sed(is_POM_S)*conv_POC_cm3_mol*1.0</span></td>
        </tr>
        <tr>
          <td id="L668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="668"></td>
          <td id="LC668" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                     loc_H2S_swiflux = loc_H2S_swiflux + loc_POM_S_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="669"></td>
          <td id="LC669" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    !    print*,&#39;NEW loc_H2S_swiflux &#39;, loc_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="670"></td>
          <td id="LC670" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                    end if</span></td>
        </tr>
        <tr>
          <td id="L671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="671"></td>
          <td id="LC671" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="672"></td>
          <td id="LC672" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="673"></td>
          <td id="LC673" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="674"></td>
          <td id="LC674" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="675"></td>
          <td id="LC675" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="676"></td>
          <td id="LC676" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_PO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="677"></td>
          <td id="LC677" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> calculate maximum return flux of PO4 from Porg in sediment cell</span></td>
        </tr>
        <tr>
          <td id="L678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="678"></td>
          <td id="LC678" class="blob-code blob-code-inner js-file-line">                        loc_PO4_return_max <span class="pl-k">=</span> loc_fPOC<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="679"></td>
          <td id="LC679" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span>(par_sed_huelse2017_P_cycle)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="680"></td>
          <td id="LC680" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> explicit PO4 calculation</span></td>
        </tr>
        <tr>
          <td id="L681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="681"></td>
          <td id="LC681" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">call</span> sub_huelseetal2016_zPO4_M(dum_swiconc_PO4, loc_PO4_swiflux, dum_swiflux_M, loc_M_swiflux)</td>
        </tr>
        <tr>
          <td id="L682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="682"></td>
          <td id="LC682" class="blob-code blob-code-inner js-file-line">                            dum_sed_pres_fracP <span class="pl-k">=</span> (loc_PO4_return_max<span class="pl-k">-</span>loc_PO4_swiflux)<span class="pl-k">/</span>loc_PO4_return_max</td>
        </tr>
        <tr>
          <td id="L683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="683"></td>
          <td id="LC683" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;explicit OMEN loc_PO4_swiflux = &#39;, loc_PO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="684"></td>
          <td id="LC684" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;Hack OMEN loc_PO4_swiflux     = &#39;, loc_fPOC*conv_POC_cm3_mol*1.0/106.0</span></td>
        </tr>
        <tr>
          <td id="L685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="685"></td>
          <td id="LC685" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39; &#39;                            </span></td>
        </tr>
        <tr>
          <td id="L686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="686"></td>
          <td id="LC686" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="687"></td>
          <td id="LC687" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;Do not use OMEN P-cycle &#39;</span></td>
        </tr>
        <tr>
          <td id="L688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="688"></td>
          <td id="LC688" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">if</span>(par_sed_huelse2017_sim_P_loss)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="689"></td>
          <td id="LC689" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-c"><span class="pl-c">!</span> PO4 hack: remineralise just the non-sulfurised POC and calculate PO4 return flux</span></td>
        </tr>
        <tr>
          <td id="L690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="690"></td>
          <td id="LC690" class="blob-code blob-code-inner js-file-line">                                        loc_PO4_swiflux <span class="pl-k">=</span> (loc_POC1_flux_swi<span class="pl-k">+</span>loc_POC2_flux_swi)<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="691"></td>
          <td id="LC691" class="blob-code blob-code-inner js-file-line">                                        dum_sed_pres_fracP <span class="pl-k">=</span> (loc_PO4_return_max<span class="pl-k">-</span>loc_PO4_swiflux)<span class="pl-k">/</span>loc_PO4_return_max</td>
        </tr>
        <tr>
          <td id="L692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="692"></td>
          <td id="LC692" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;Sim P-loss PO4 = &#39;, loc_PO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="693"></td>
          <td id="LC693" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-k">if</span>(par_sed_huelse2017_sim_P_loss_pres_fracC)<span class="pl-k">then</span>        <span class="pl-c"><span class="pl-c">!</span> preserve same fraction as Corg</span></td>
        </tr>
        <tr>
          <td id="L694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="694"></td>
          <td id="LC694" class="blob-code blob-code-inner js-file-line">                                                loc_PO4_swiflux <span class="pl-k">=</span> loc_fPOC<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD<span class="pl-k">*</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>dum_sed_pres_fracC)</td>
        </tr>
        <tr>
          <td id="L695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="695"></td>
          <td id="LC695" class="blob-code blob-code-inner js-file-line">                                                dum_sed_pres_fracP <span class="pl-k">=</span> dum_sed_pres_fracC</td>
        </tr>
        <tr>
          <td id="L696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="696"></td>
          <td id="LC696" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="697"></td>
          <td id="LC697" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39; same as Corg&#39;</span></td>
        </tr>
        <tr>
          <td id="L698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="698"></td>
          <td id="LC698" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;(1-dum_sed_pres_fracC) = &#39;, (1-dum_sed_pres_fracC)</span></td>
        </tr>
        <tr>
          <td id="L699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="699"></td>
          <td id="LC699" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_PO4_swiflux = &#39;, loc_PO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="700"></td>
          <td id="LC700" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="701"></td>
          <td id="LC701" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-c"><span class="pl-c">!</span> simulate P-regeneration under anoxia:</span></td>
        </tr>
        <tr>
          <td id="L702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="702"></td>
          <td id="LC702" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-k">if</span>(par_sed_huelse2017_sim_P_regeneration)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="703"></td>
          <td id="LC703" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39; enhanced P-regeneration&#39;</span></td>
        </tr>
        <tr>
          <td id="L704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="704"></td>
          <td id="LC704" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;TOTAL POC3_flux   = &#39;, loc_POC1_flux_swi+loc_POC2_flux_swi+loc_POC3_flux_swi</span></td>
        </tr>
        <tr>
          <td id="L705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="705"></td>
          <td id="LC705" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_fPOC*conv_POC_cm3_mol, conv_POC_cm3_mol   = &#39;, loc_fPOC*conv_POC_cm3_mol, conv_POC_cm3_mol</span></td>
        </tr>
        <tr>
          <td id="L706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="706"></td>
          <td id="LC706" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                    print*,&#39;Fraction POC-pres =&#39; , dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="707"></td>
          <td id="LC707" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_BW_O2_concentration =&#39; , loc_BW_O2_concentration</span></td>
        </tr>
        <tr>
          <td id="L708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="708"></td>
          <td id="LC708" class="blob-code blob-code-inner js-file-line">                                                <span class="pl-k">if</span>(loc_BW_O2_concentration <span class="pl-k">.LE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="709"></td>
          <td id="LC709" class="blob-code blob-code-inner js-file-line">                                                        <span class="pl-c"><span class="pl-c">!</span> set C/P regeneration ratio under full anoxia</span></td>
        </tr>
        <tr>
          <td id="L710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="710"></td>
          <td id="LC710" class="blob-code blob-code-inner js-file-line">                                                        loc_CP_reg <span class="pl-k">=</span> loc_par_Pregen_Yf <span class="pl-k">+</span> loc_par_Pregen_A</td>
        </tr>
        <tr>
          <td id="L711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="711"></td>
          <td id="LC711" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                        print*,&#39;anoxic loc_CP_reg = &#39;, loc_CP_reg</span></td>
        </tr>
        <tr>
          <td id="L712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="712"></td>
          <td id="LC712" class="blob-code blob-code-inner js-file-line">                                                <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="713"></td>
          <td id="LC713" class="blob-code blob-code-inner js-file-line">                                                        <span class="pl-c"><span class="pl-c">!</span> calculate C/P regeneration ratio </span></td>
        </tr>
        <tr>
          <td id="L714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="714"></td>
          <td id="LC714" class="blob-code blob-code-inner js-file-line">                                                        loc_CP_reg <span class="pl-k">=</span> loc_par_Pregen_Yf <span class="pl-k">+</span> loc_par_Pregen_A<span class="pl-k">*</span><span class="pl-k">exp</span>(<span class="pl-k">-</span>loc_BW_O2_concentration<span class="pl-k">/</span>loc_par_Pregen_r)</td>
        </tr>
        <tr>
          <td id="L715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="715"></td>
          <td id="LC715" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                        print*,&#39;oxic loc_CP_reg = &#39;, loc_CP_reg</span></td>
        </tr>
        <tr>
          <td id="L716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="716"></td>
          <td id="LC716" class="blob-code blob-code-inner js-file-line">                                                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="717"></td>
          <td id="LC717" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="718"></td>
          <td id="LC718" class="blob-code blob-code-inner js-file-line">                                                <span class="pl-c"><span class="pl-c">!</span> calculate PO4 return flux using redox-dependent C/P ratio</span></td>
        </tr>
        <tr>
          <td id="L719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="719"></td>
          <td id="LC719" class="blob-code blob-code-inner js-file-line">                                                loc_PO4_return_redox <span class="pl-k">=</span> loc_fPOC<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>dum_sed_pres_fracC)<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>loc_CP_reg</td>
        </tr>
        <tr>
          <td id="L720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="720"></td>
          <td id="LC720" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_PO4_return_redox = &#39;, loc_PO4_return_redox</span></td>
        </tr>
        <tr>
          <td id="L721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="721"></td>
          <td id="LC721" class="blob-code blob-code-inner js-file-line">                                                <span class="pl-c"><span class="pl-c">!</span> minimum of both is return ! TODO: Check for below zero!!</span></td>
        </tr>
        <tr>
          <td id="L722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="722"></td>
          <td id="LC722" class="blob-code blob-code-inner js-file-line">                                                loc_PO4_swiflux <span class="pl-k">=</span> <span class="pl-k">min</span>(loc_PO4_return_max,loc_PO4_return_redox)</td>
        </tr>
        <tr>
          <td id="L723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="723"></td>
          <td id="LC723" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;loc_PO4_swiflux = &#39;, loc_PO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="724"></td>
          <td id="LC724" class="blob-code blob-code-inner js-file-line">                                                dum_sed_pres_fracP <span class="pl-k">=</span> (loc_PO4_return_max<span class="pl-k">-</span>loc_PO4_swiflux)<span class="pl-k">/</span>loc_PO4_return_max</td>
        </tr>
        <tr>
          <td id="L725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="725"></td>
          <td id="LC725" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;dum_sed_pres_fracP = &#39;, dum_sed_pres_fracP</span></td>
        </tr>
        <tr>
          <td id="L726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="726"></td>
          <td id="LC726" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                                print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="727"></td>
          <td id="LC727" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="728"></td>
          <td id="LC728" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">else</span>                                                                </td>
        </tr>
        <tr>
          <td id="L729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="729"></td>
          <td id="LC729" class="blob-code blob-code-inner js-file-line">                                        <span class="pl-c"><span class="pl-c">!</span> PO4 hack: remineralise all POC and calculate PO4 return flux</span></td>
        </tr>
        <tr>
          <td id="L730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="730"></td>
          <td id="LC730" class="blob-code blob-code-inner js-file-line">                                        loc_PO4_swiflux <span class="pl-k">=</span> loc_fPOC<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span>PC1<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="731"></td>
          <td id="LC731" class="blob-code blob-code-inner js-file-line">                                        dum_sed_pres_fracP <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="732"></td>
          <td id="LC732" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;all PO4 returned = &#39;, loc_PO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="733"></td>
          <td id="LC733" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="734"></td>
          <td id="LC734" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> par_sed_huelse2017_P_cycle                       </span></td>
        </tr>
        <tr>
          <td id="L735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="735"></td>
          <td id="LC735" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="736"></td>
          <td id="LC736" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="737"></td>
          <td id="LC737" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="738"></td>
          <td id="LC738" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="739"></td>
          <td id="LC739" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="740"></td>
          <td id="LC740" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_DIC))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="741"></td>
          <td id="LC741" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_huelseetal2016_zDIC(dum_swiconc_DIC, loc_DIC_swiflux)</td>
        </tr>
        <tr>
          <td id="L742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="742"></td>
          <td id="LC742" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="743"></td>
          <td id="LC743" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;loc_DIC_swiflux =&#39;, loc_DIC_swiflux</span></td>
        </tr>
        <tr>
          <td id="L744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="744"></td>
          <td id="LC744" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;HACK loc_DIC_swiflux = &#39;, loc_fPOC*conv_POC_cm3_mol*DICC1/SD*(1-dum_sed_pres_fracC)</span></td>
        </tr>
        <tr>
          <td id="L745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="745"></td>
          <td id="LC745" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                    print*,&#39;OMEN loc_POC_swiflux = &#39;, conv_POC_cm3_mol*loc_fPOC</span></td>
        </tr>
        <tr>
          <td id="L746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="746"></td>
          <td id="LC746" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                loc_DIC_swiflux = loc_new_sed(is_POC)*conv_POC_cm3_mol*(1-dum_sed_pres_fracC) ! DIC HACK </span></td>
        </tr>
        <tr>
          <td id="L747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="747"></td>
          <td id="LC747" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                loc_DIC_swiflux = loc_new_sed(is_POC)*conv_POC_cm3_mol ! *SD   DIC HACK all returned</span></td>
        </tr>
        <tr>
          <td id="L748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="748"></td>
          <td id="LC748" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        if(loc_O2_swiflux_pos)then</span></td>
        </tr>
        <tr>
          <td id="L749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="749"></td>
          <td id="LC749" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;loc_new_sed(is_POC) = &#39;, loc_new_sed(is_POC)*conv_POC_cm3_mol</span></td>
        </tr>
        <tr>
          <td id="L750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="750"></td>
          <td id="LC750" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;dum_sed_pres_fracC = &#39;, dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="751"></td>
          <td id="LC751" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;(1-dum_sed_pres_fracC)*POCin = &#39;, (1-dum_sed_pres_fracC)*loc_new_sed(is_POC)*conv_POC_cm3_mol</span></td>
        </tr>
        <tr>
          <td id="L752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="752"></td>
          <td id="LC752" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;loc_DIC_swiflux =&#39;, loc_DIC_swiflux</span></td>
        </tr>
        <tr>
          <td id="L753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="753"></td>
          <td id="LC753" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        end if</span></td>
        </tr>
        <tr>
          <td id="L754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="754"></td>
          <td id="LC754" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="755"></td>
          <td id="LC755" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="756"></td>
          <td id="LC756" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="757"></td>
          <td id="LC757" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="758"></td>
          <td id="LC758" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(ocn_select(io_DIC_13C))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="759"></td>
          <td id="LC759" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        call sub_huelseetal2016_zDIC(dum_swiconc_DIC, loc_DIC_swiflux)</span></td>
        </tr>
        <tr>
          <td id="L760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="760"></td>
          <td id="LC760" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> not explicitly modelled - assume no fractionation during remineralisation in sediment</span></td>
        </tr>
        <tr>
          <td id="L761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="761"></td>
          <td id="LC761" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> calculate as DIC_flux_OUT / POC_flux_IN * POC_13C_IN</span></td>
        </tr>
        <tr>
          <td id="L762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="762"></td>
          <td id="LC762" class="blob-code blob-code-inner js-file-line">                        loc_DIC_13C_swiflux <span class="pl-k">=</span> loc_DIC_swiflux<span class="pl-k">/</span>(conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC)<span class="pl-k">*</span>(conv_POC_cm3_mol<span class="pl-k">*</span>loc_fPOC_13C)</td>
        </tr>
        <tr>
          <td id="L763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="763"></td>
          <td id="LC763" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                    print*,&#39;OMEN OUT: loc_DIC_13C_swiflux = &#39;, loc_DIC_13C_swiflux</span></td>
        </tr>
        <tr>
          <td id="L764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="764"></td>
          <td id="LC764" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                loc_DIC_swiflux = loc_new_sed(is_POC)*conv_POC_cm3_mol ! *SD   DIC hack</span></td>
        </tr>
        <tr>
          <td id="L765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="765"></td>
          <td id="LC765" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="766"></td>
          <td id="LC766" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="767"></td>
          <td id="LC767" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="768"></td>
          <td id="LC768" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="769"></td>
          <td id="LC769" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(loc_calc_ALK)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="770"></td>
          <td id="LC770" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span>(ocn_select(io_ALK))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="771"></td>
          <td id="LC771" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">call</span> sub_huelseetal2016_zALK(dum_swiconc_ALK, loc_ALK_swiflux)</td>
        </tr>
        <tr>
          <td id="L772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="772"></td>
          <td id="LC772" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;CAL loc_ALK_swiflux = &#39;, loc_ALK_swiflux</span></td>
        </tr>
        <tr>
          <td id="L773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="773"></td>
          <td id="LC773" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;POC burial = &#39;, dum_POC_total_flux_zinf*ALKROX/SD</span></td>
        </tr>
        <tr>
          <td id="L774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="774"></td>
          <td id="LC774" class="blob-code blob-code-inner js-file-line">                            loc_ALK_swiflux <span class="pl-k">=</span> loc_ALK_swiflux <span class="pl-k">+</span> dum_POC_total_flux_zinf<span class="pl-k">*</span>ALKROX<span class="pl-k">/</span>SD</td>
        </tr>
        <tr>
          <td id="L775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="775"></td>
          <td id="LC775" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39;FINAL loc_ALK_swiflux = &#39;, loc_ALK_swiflux</span></td>
        </tr>
        <tr>
          <td id="L776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="776"></td>
          <td id="LC776" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="777"></td>
          <td id="LC777" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">if</span>(par_sed_huelse2017_remove_impl_sulALK)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="778"></td>
          <td id="LC778" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> JUST FOR CLOSED-SYSTEM: Account for burial of negative ALK with OM</span></td>
        </tr>
        <tr>
          <td id="L779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="779"></td>
          <td id="LC779" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> will just the the sulf affect on OM-burial</span></td>
        </tr>
        <tr>
          <td id="L780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="780"></td>
          <td id="LC780" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> We decided to bury the H2S and &#39;remove&#39; just the associated ALK (Email POC-S 05.09.2017)</span></td>
        </tr>
        <tr>
          <td id="L781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="781"></td>
          <td id="LC781" class="blob-code blob-code-inner js-file-line">                                    <span class="pl-k">if</span>(loc_new_sed(is_POM_S) <span class="pl-k">.GE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="782"></td>
          <td id="LC782" class="blob-code blob-code-inner js-file-line">                                        loc_POM_S_H2S_swiflux <span class="pl-k">=</span> loc_new_sed(is_POM_S)<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span><span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="783"></td>
          <td id="LC783" class="blob-code blob-code-inner js-file-line">                                        loc_ALK_swiflux <span class="pl-k">=</span> loc_ALK_swiflux <span class="pl-k">-</span> <span class="pl-c1">2</span><span class="pl-k">*</span>loc_POM_S_H2S_swiflux</td>
        </tr>
        <tr>
          <td id="L784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="784"></td>
          <td id="LC784" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;loc_POM_S_H2S_swiflux &#39;, loc_POM_S_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="785"></td>
          <td id="LC785" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39;NEW loc_ALK_swiflux &#39;, loc_ALK_swiflux</span></td>
        </tr>
        <tr>
          <td id="L786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="786"></td>
          <td id="LC786" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="787"></td>
          <td id="LC787" class="blob-code blob-code-inner js-file-line">                                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="788"></td>
          <td id="LC788" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="789"></td>
          <td id="LC789" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="790"></td>
          <td id="LC790" class="blob-code blob-code-inner js-file-line">                            <span class="pl-c"><span class="pl-c">!</span> If not selected nothing needs to be done</span></td>
        </tr>
        <tr>
          <td id="L791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="791"></td>
          <td id="LC791" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="792"></td>
          <td id="LC792" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> use ALK hack</span></td>
        </tr>
        <tr>
          <td id="L793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="793"></td>
          <td id="LC793" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;ALK HACK &#39;</span></td>
        </tr>
        <tr>
          <td id="L794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="794"></td>
          <td id="LC794" class="blob-code blob-code-inner js-file-line">                        loc_ALK_swiflux <span class="pl-k">=</span> <span class="pl-c1">2.0</span><span class="pl-k">*</span>loc_H2S_swiflux <span class="pl-k">+</span> loc_new_sed(is_POC)<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span>ALKROX<span class="pl-k">/</span>SD  <span class="pl-c"><span class="pl-c">!</span>16/106 !NC1</span></td>
        </tr>
        <tr>
          <td id="L795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="795"></td>
          <td id="LC795" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">if</span>(par_sed_huelse2017_remove_impl_sulALK)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="796"></td>
          <td id="LC796" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> JUST FOR CLOSED-SYSTEM: Account for burial of negative ALK with OM</span></td>
        </tr>
        <tr>
          <td id="L797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="797"></td>
          <td id="LC797" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> will just the the sulf affect on OM-burial</span></td>
        </tr>
        <tr>
          <td id="L798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="798"></td>
          <td id="LC798" class="blob-code blob-code-inner js-file-line">                                <span class="pl-c"><span class="pl-c">!</span> We decided to bury the H2S and &#39;remove&#39; just the associated ALK (Email POC-S 05.09.2017)</span></td>
        </tr>
        <tr>
          <td id="L799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="799"></td>
          <td id="LC799" class="blob-code blob-code-inner js-file-line">                                    <span class="pl-k">if</span>(loc_new_sed(is_POM_S) <span class="pl-k">.GE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="800"></td>
          <td id="LC800" class="blob-code blob-code-inner js-file-line">                                        loc_POM_S_H2S_swiflux <span class="pl-k">=</span> loc_new_sed(is_POM_S)<span class="pl-k">*</span>conv_POC_cm3_mol<span class="pl-k">*</span><span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="801"></td>
          <td id="LC801" class="blob-code blob-code-inner js-file-line">                                        loc_ALK_swiflux <span class="pl-k">=</span> loc_ALK_swiflux <span class="pl-k">-</span> <span class="pl-c1">2</span><span class="pl-k">*</span>loc_POM_S_H2S_swiflux</td>
        </tr>
        <tr>
          <td id="L802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="802"></td>
          <td id="LC802" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                                        print*,&#39;ALK hack - remove impl ALk&#39;</span></td>
        </tr>
        <tr>
          <td id="L803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="803"></td>
          <td id="LC803" class="blob-code blob-code-inner js-file-line">                                    <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="804"></td>
          <td id="LC804" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="805"></td>
          <td id="LC805" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span>      <span class="pl-c"><span class="pl-c">!</span> loc_calc_ALK</span></td>
        </tr>
        <tr>
          <td id="L806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="806"></td>
          <td id="LC806" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="807"></td>
          <td id="LC807" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> dum_sed_pres_fracC &lt;&gt; NaN</span></td>
        </tr>
        <tr>
          <td id="L808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="808"></td>
          <td id="LC808" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="809"></td>
          <td id="LC809" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> loc_POC1/2_wtpct_swi .LE. const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="810"></td>
          <td id="LC810" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="811"></td>
          <td id="LC811" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span> <span class="pl-c"><span class="pl-c">!</span> (loc_new_sed(is_det) .LE. const_real_nullsmall)</span></td>
        </tr>
        <tr>
          <td id="L812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="812"></td>
          <td id="LC812" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        ! SO4 drift check:</span></td>
        </tr>
        <tr>
          <td id="L813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="813"></td>
          <td id="LC813" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(abs(loc_SO4_swiflux) .NE. abs(loc_H2S_swiflux))then</span></td>
        </tr>
        <tr>
          <td id="L814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="814"></td>
          <td id="LC814" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;Fluxes SO4 &lt;&gt; H2S &#39;, loc_SO4_swiflux, loc_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="815"></td>
          <td id="LC815" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        else</span></td>
        </tr>
        <tr>
          <td id="L816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="816"></td>
          <td id="LC816" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;.&#39;</span></td>
        </tr>
        <tr>
          <td id="L817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="817"></td>
          <td id="LC817" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="818"></td>
          <td id="LC818" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="819"></td>
          <td id="LC819" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(loc_O2_swiflux &gt; 0.0)then</span></td>
        </tr>
        <tr>
          <td id="L820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="820"></td>
          <td id="LC820" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="821"></td>
          <td id="LC821" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;---------- loc_O2_swiflux positiv ----------&#39;</span></td>
        </tr>
        <tr>
          <td id="L822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="822"></td>
          <td id="LC822" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_O2_swiflux &#39;, loc_O2_swiflux</span></td>
        </tr>
        <tr>
          <td id="L823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="823"></td>
          <td id="LC823" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_SO4_swiflux &#39;, loc_SO4_swiflux</span></td>
        </tr>
        <tr>
          <td id="L824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="824"></td>
          <td id="LC824" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_H2S_swiflux &#39;, loc_H2S_swiflux</span></td>
        </tr>
        <tr>
          <td id="L825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="825"></td>
          <td id="LC825" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_ALK_swiflux &#39;, loc_ALK_swiflux</span></td>
        </tr>
        <tr>
          <td id="L826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="826"></td>
          <td id="LC826" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;dum_i, dum_j, dum_D&#39;, dum_i, dum_j, dum_D</span></td>
        </tr>
        <tr>
          <td id="L827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="827"></td>
          <td id="LC827" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="828"></td>
          <td id="LC828" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="829"></td>
          <td id="LC829" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="830"></td>
          <td id="LC830" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Now pass back the values to the global field</span></td>
        </tr>
        <tr>
          <td id="L831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="831"></td>
          <td id="LC831" class="blob-code blob-code-inner js-file-line">        dum_new_swifluxes(io_O2) <span class="pl-k">=</span> loc_O2_swiflux                                   <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="832"></td>
          <td id="LC832" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_NO3))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="833"></td>
          <td id="LC833" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_NO3) <span class="pl-k">=</span> loc_NO3_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="834"></td>
          <td id="LC834" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_NH4) <span class="pl-k">=</span> loc_NH4_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="835"></td>
          <td id="LC835" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="836"></td>
          <td id="LC836" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_SO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="837"></td>
          <td id="LC837" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_SO4) <span class="pl-k">=</span> loc_SO4_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="838"></td>
          <td id="LC838" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_H2S) <span class="pl-k">=</span> loc_H2S_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="839"></td>
          <td id="LC839" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="840"></td>
          <td id="LC840" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_PO4))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="841"></td>
          <td id="LC841" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_PO4) <span class="pl-k">=</span> loc_PO4_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="842"></td>
          <td id="LC842" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="843"></td>
          <td id="LC843" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_DIC))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="844"></td>
          <td id="LC844" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_DIC) <span class="pl-k">=</span> loc_DIC_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="845"></td>
          <td id="LC845" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="846"></td>
          <td id="LC846" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_DIC_13C))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="847"></td>
          <td id="LC847" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_DIC_13C) <span class="pl-k">=</span> loc_DIC_13C_swiflux                     <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="848"></td>
          <td id="LC848" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="849"></td>
          <td id="LC849" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(loc_calc_ALK)then</span></td>
        </tr>
        <tr>
          <td id="L850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="850"></td>
          <td id="LC850" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ocn_select(io_ALK))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="851"></td>
          <td id="LC851" class="blob-code blob-code-inner js-file-line">            dum_new_swifluxes(io_ALK) <span class="pl-k">=</span> loc_ALK_swiflux                             <span class="pl-c"><span class="pl-c">!</span> Dom TODO convert mol*cm^-2 yr^-1 (SEDIMENT) -&gt; mol yr^-1 (GENIE)</span></td>
        </tr>
        <tr>
          <td id="L852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="852"></td>
          <td id="LC852" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="853"></td>
          <td id="LC853" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if      ! loc_calc_ALK</span></td>
        </tr>
        <tr>
          <td id="L854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="854"></td>
          <td id="LC854" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="855"></td>
          <td id="LC855" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="856"></td>
          <td id="LC856" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_D = &#39;, dum_D</span></td>
        </tr>
        <tr>
          <td id="L857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="857"></td>
          <td id="LC857" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_POC_flux_swi_total [mol/(cm^2 yr)] = &#39;, loc_POC1_flux_swi + loc_POC2_flux_swi</span></td>
        </tr>
        <tr>
          <td id="L858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="858"></td>
          <td id="LC858" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;FINAL DIC SWI flux [mol/(cm^2 yr)] = &#39;, dum_new_swifluxes(io_DIC)</span></td>
        </tr>
        <tr>
          <td id="L859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="859"></td>
          <td id="LC859" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;CALCU DIC SWI flux [mol/(cm^2 yr)] = &#39; , (1-dum_sed_pres_fracC)*(loc_POC1_flux_swi + loc_POC2_flux_swi)</span></td>
        </tr>
        <tr>
          <td id="L860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="860"></td>
          <td id="LC860" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_sed_pres_fracC =&#39; , dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="861"></td>
          <td id="LC861" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="862"></td>
          <td id="LC862" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(loc_print_results) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="863"></td>
          <td id="LC863" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            if(dum_D &lt; 1000.0)then</span></td>
        </tr>
        <tr>
          <td id="L864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="864"></td>
          <td id="LC864" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            if(loc_O2_swiflux &gt; 0.0)then</span></td>
        </tr>
        <tr>
          <td id="L865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="865"></td>
          <td id="LC865" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;dum_D = &#39;, dum_D</span></td>
        </tr>
        <tr>
          <td id="L866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="866"></td>
          <td id="LC866" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39; grid point (i,j) = &#39;, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="867"></td>
          <td id="LC867" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>Temp C =<span class="pl-pds">&#39;</span></span>, dum_sfcsumocn(io_T) <span class="pl-k">-</span> <span class="pl-c1">273.15</span></td>
        </tr>
        <tr>
          <td id="L868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="868"></td>
          <td id="LC868" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>loc_POC1_flux_swi = <span class="pl-pds">&#39;</span></span>, loc_POC1_flux_swi</td>
        </tr>
        <tr>
          <td id="L869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="869"></td>
          <td id="LC869" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>loc_POC2_flux_swi = <span class="pl-pds">&#39;</span></span>, loc_POC2_flux_swi</td>
        </tr>
        <tr>
          <td id="L870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="870"></td>
          <td id="LC870" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>loc_POC3_flux_swi = <span class="pl-pds">&#39;</span></span>, loc_POC3_flux_swi</td>
        </tr>
        <tr>
          <td id="L871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="871"></td>
          <td id="LC871" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>TOTAL POC3_flux   = <span class="pl-pds">&#39;</span></span>, loc_POC1_flux_swi<span class="pl-k">+</span>loc_POC2_flux_swi<span class="pl-k">+</span>loc_POC3_flux_swi</td>
        </tr>
        <tr>
          <td id="L872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="872"></td>
          <td id="LC872" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>Fraction POC-pres =<span class="pl-pds">&#39;</span></span> , dum_sed_pres_fracC</td>
        </tr>
        <tr>
          <td id="L873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="873"></td>
          <td id="LC873" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>(1-presC)*POCin   = <span class="pl-pds">&#39;</span></span>, (<span class="pl-c1">1</span><span class="pl-k">-</span>dum_sed_pres_fracC)<span class="pl-k">*</span>(loc_POC1_flux_swi<span class="pl-k">+</span>loc_POC2_flux_swi<span class="pl-k">+</span>loc_POC3_flux_swi)</td>
        </tr>
        <tr>
          <td id="L874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="874"></td>
          <td id="LC874" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL DIC SWI flx = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_DIC)</td>
        </tr>
        <tr>
          <td id="L875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="875"></td>
          <td id="LC875" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>loc_sed_burial    = <span class="pl-pds">&#39;</span></span>, loc_sed_burial<span class="pl-k">/</span>dum_dtyr</td>
        </tr>
        <tr>
          <td id="L876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="876"></td>
          <td id="LC876" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_O2 = <span class="pl-pds">&#39;</span></span>, dum_swiconc_O2</td>
        </tr>
        <tr>
          <td id="L877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="877"></td>
          <td id="LC877" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_SO4 = <span class="pl-pds">&#39;</span></span>, dum_swiconc_SO4</td>
        </tr>
        <tr>
          <td id="L878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="878"></td>
          <td id="LC878" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_H2S = <span class="pl-pds">&#39;</span></span>, dum_swiconc_H2S</td>
        </tr>
        <tr>
          <td id="L879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="879"></td>
          <td id="LC879" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_PO4 = <span class="pl-pds">&#39;</span></span>, dum_swiconc_PO4</td>
        </tr>
        <tr>
          <td id="L880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="880"></td>
          <td id="LC880" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiflux_M = <span class="pl-pds">&#39;</span></span>, dum_swiflux_M</td>
        </tr>
        <tr>
          <td id="L881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="881"></td>
          <td id="LC881" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_DIC = <span class="pl-pds">&#39;</span></span>, dum_swiconc_DIC</td>
        </tr>
        <tr>
          <td id="L882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="882"></td>
          <td id="LC882" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_ALK = <span class="pl-pds">&#39;</span></span>, dum_swiconc_ALK</td>
        </tr>
        <tr>
          <td id="L883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="883"></td>
          <td id="LC883" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="884"></td>
          <td id="LC884" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> <span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="885"></td>
          <td id="LC885" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>zox = <span class="pl-pds">&#39;</span></span>, zox</td>
        </tr>
        <tr>
          <td id="L886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="886"></td>
          <td id="LC886" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL O2 SWI flux = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_O2)</td>
        </tr>
        <tr>
          <td id="L887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="887"></td>
          <td id="LC887" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>zno3 = <span class="pl-pds">&#39;</span></span>, zno3</td>
        </tr>
        <tr>
          <td id="L888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="888"></td>
          <td id="LC888" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL NO3 SWI flux = <span class="pl-pds">&#39;</span></span>, loc_NO3_swiflux</td>
        </tr>
        <tr>
          <td id="L889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="889"></td>
          <td id="LC889" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>zso4 = <span class="pl-pds">&#39;</span></span>, zso4</td>
        </tr>
        <tr>
          <td id="L890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="890"></td>
          <td id="LC890" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL SO4 SWI flux = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_SO4)</td>
        </tr>
        <tr>
          <td id="L891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="891"></td>
          <td id="LC891" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL NH4 SWI flux = <span class="pl-pds">&#39;</span></span>, loc_NH4_swiflux</td>
        </tr>
        <tr>
          <td id="L892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="892"></td>
          <td id="LC892" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL H2S SWI flux = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_H2S)</td>
        </tr>
        <tr>
          <td id="L893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="893"></td>
          <td id="LC893" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL PO4 SWI flux = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_PO4)</td>
        </tr>
        <tr>
          <td id="L894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="894"></td>
          <td id="LC894" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL M SWI flux = <span class="pl-pds">&#39;</span></span>, loc_M_swiflux</td>
        </tr>
        <tr>
          <td id="L895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="895"></td>
          <td id="LC895" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL DIC SWI flux = <span class="pl-pds">&#39;</span></span>, dum_new_swifluxes(io_DIC)</td>
        </tr>
        <tr>
          <td id="L896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="896"></td>
          <td id="LC896" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FINAL ALK SWI flux = <span class="pl-pds">&#39;</span></span>, loc_ALK_swiflux</td>
        </tr>
        <tr>
          <td id="L897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="897"></td>
          <td id="LC897" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>Fraction POC-preserved/POC-deposited =<span class="pl-pds">&#39;</span></span> , dum_sed_pres_fracC</td>
        </tr>
        <tr>
          <td id="L898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="898"></td>
          <td id="LC898" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> <span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="899"></td>
          <td id="LC899" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="900"></td>
          <td id="LC900" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_new_sed(is_CaCO3)= &#39;, loc_new_sed(is_CaCO3)</span></td>
        </tr>
        <tr>
          <td id="L901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="901"></td>
          <td id="LC901" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_new_sed(is_opal)= &#39;, loc_new_sed(is_opal)</span></td>
        </tr>
        <tr>
          <td id="L902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="902"></td>
          <td id="LC902" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;loc_wtpct = &#39;, loc_wtpct</span></td>
        </tr>
        <tr>
          <td id="L903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="903"></td>
          <td id="LC903" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;SWI wt% POC frac 1 = &#39;, loc_POC1_wtpct_swi</span></td>
        </tr>
        <tr>
          <td id="L904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="904"></td>
          <td id="LC904" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;SWI wt% POC frac 2 = &#39;, loc_POC2_wtpct_swi</span></td>
        </tr>
        <tr>
          <td id="L905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="905"></td>
          <td id="LC905" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                STOP</span></td>
        </tr>
        <tr>
          <td id="L906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="906"></td>
          <td id="LC906" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="907"></td>
          <td id="LC907" class="blob-code blob-code-inner js-file-line">            </td>
        </tr>
        <tr>
          <td id="L908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="908"></td>
          <td id="LC908" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>loc_filename=trim(par_outdir_name)//&#39;ecogem_series_resources_&#39;//fun_conv_num_char_n(2,i)//fun_conv_num_char_n(2,j)</span></td>
        </tr>
        <tr>
          <td id="L909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="909"></td>
          <td id="LC909" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>OPEN(88,file=loc_filename,action=&#39;write&#39;,position=&#39;append&#39;,iostat=ios)</span></td>
        </tr>
        <tr>
          <td id="L910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="910"></td>
          <td id="LC910" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>CALL check_iostat(ios,__LINE__,__FILE__)</span></td>
        </tr>
        <tr>
          <td id="L911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="911"></td>
          <td id="LC911" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>WRITE(88,fmt=&#39;(f12.3,2e15.7)&#39;,iostat=ios) &amp;</span></td>
        </tr>
        <tr>
          <td id="L912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="912"></td>
          <td id="LC912" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>    &amp; dum_t-(dum_dtyr*par_data_save_slice_n)/2, &amp;</span></td>
        </tr>
        <tr>
          <td id="L913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="913"></td>
          <td id="LC913" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>    &amp; int_resources(loc,:)</span></td>
        </tr>
        <tr>
          <td id="L914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="914"></td>
          <td id="LC914" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>CALL check_iostat(ios,__LINE__,__FILE__)</span></td>
        </tr>
        <tr>
          <td id="L915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="915"></td>
          <td id="LC915" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>CLOSE(88,iostat=ios)</span></td>
        </tr>
        <tr>
          <td id="L916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="916"></td>
          <td id="LC916" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>CALL check_iostat(ios,__LINE__,__FILE__)</span></td>
        </tr>
        <tr>
          <td id="L917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="917"></td>
          <td id="LC917" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            end if</span></td>
        </tr>
        <tr>
          <td id="L918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="918"></td>
          <td id="LC918" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="919"></td>
          <td id="LC919" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="920"></td>
          <td id="LC920" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        dum_sed_pres_fracP = dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="921"></td>
          <td id="LC921" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="922"></td>
          <td id="LC922" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate mean OM concentration [wt%] in upper x cm</span></td>
        </tr>
        <tr>
          <td id="L923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="923"></td>
          <td id="LC923" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> convert from mol/cm3 to wt%</span></td>
        </tr>
        <tr>
          <td id="L924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="924"></td>
          <td id="LC924" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> just two fractions:</span></td>
        </tr>
        <tr>
          <td id="L925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="925"></td>
          <td id="LC925" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_sed_mean_OM = 1.0/loc_mixed_layer * 100.0*12.0/rho_sed*FUN_calcOM(0.0, loc_mixed_layer, 1.0, 1.0)</span></td>
        </tr>
        <tr>
          <td id="L926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="926"></td>
          <td id="LC926" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="927"></td>
          <td id="LC927" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> with third inert/sulfurised fraction</span></td>
        </tr>
        <tr>
          <td id="L928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="928"></td>
          <td id="LC928" class="blob-code blob-code-inner js-file-line">        dum_sed_mean_OM <span class="pl-k">=</span> <span class="pl-c1">1.0</span><span class="pl-k">/</span>loc_mixed_layer <span class="pl-k">*</span> <span class="pl-c1">100.0</span><span class="pl-k">*</span><span class="pl-c1">12.0</span><span class="pl-k">/</span>rho_sed<span class="pl-k">*</span>FUN_calcOM(<span class="pl-c1">0.0</span>, loc_mixed_layer, <span class="pl-c1">1.0</span>, <span class="pl-c1">1.0</span>) <span class="pl-k">+</span> <span class="pl-c1">100.0</span><span class="pl-k">*</span><span class="pl-c1">12.0</span><span class="pl-k">/</span>rho_sed<span class="pl-k">*</span>dum_POC3_conc_swi</td>
        </tr>
        <tr>
          <td id="L929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="929"></td>
          <td id="LC929" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>       print*,&#39;dum_sed_mean_OM = &#39;, dum_sed_mean_OM</span></td>
        </tr>
        <tr>
          <td id="L930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="930"></td>
          <td id="LC930" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>       print*,&#39;POC3_wtprc  &#39;, 100.0*12.0/rho_sed*dum_POC3_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="931"></td>
          <td id="LC931" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        if(isnan(dum_sed_mean_OM))then</span></td>
        </tr>
        <tr>
          <td id="L932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="932"></td>
          <td id="LC932" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;NNNNNNNNNNNNAAAAAAAAAAAAAAAANNNNNNNNNNN dum_sed_mean_OM = &#39;, dum_sed_mean_OM</span></td>
        </tr>
        <tr>
          <td id="L933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="933"></td>
          <td id="LC933" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="934"></td>
          <td id="LC934" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;END dum_sed_OM_wtpc_bot = &#39;, dum_sed_OM_wtpc_bot</span></td>
        </tr>
        <tr>
          <td id="L935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="935"></td>
          <td id="LC935" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="936"></td>
          <td id="LC936" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_main</span></td>
        </tr>
        <tr>
          <td id="L937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="937"></td>
          <td id="LC937" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="938"></td>
          <td id="LC938" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="939"></td>
          <td id="LC939" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="940"></td>
          <td id="LC940" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="941"></td>
          <td id="LC941" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="942"></td>
          <td id="LC942" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           INITIALIZE</span></td>
        </tr>
        <tr>
          <td id="L943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="943"></td>
          <td id="LC943" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="944"></td>
          <td id="LC944" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="945"></td>
          <td id="LC945" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="946"></td>
          <td id="LC946" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="947"></td>
          <td id="LC947" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="948"></td>
          <td id="LC948" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_initialize</span>(<span class="pl-v">dum_D</span>, <span class="pl-v">dum_TempK</span>, <span class="pl-v">dum_depos_rate</span>)</td>
        </tr>
        <tr>
          <td id="L949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="949"></td>
          <td id="LC949" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="950"></td>
          <td id="LC950" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="951"></td>
          <td id="LC951" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   initalize</span></td>
        </tr>
        <tr>
          <td id="L952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="952"></td>
          <td id="LC952" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="953"></td>
          <td id="LC953" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="954"></td>
          <td id="LC954" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_D                      <span class="pl-c"><span class="pl-c">!</span> ocean depth (m) +vs downwards</span></td>
        </tr>
        <tr>
          <td id="L955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="955"></td>
          <td id="LC955" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_TempK                  <span class="pl-c"><span class="pl-c">!</span> temperature (K)</span></td>
        </tr>
        <tr>
          <td id="L956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="956"></td>
          <td id="LC956" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_depos_rate             <span class="pl-c"><span class="pl-c">!</span> sedimentation rate, cm/yr / advection</span></td>
        </tr>
        <tr>
          <td id="L957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="957"></td>
          <td id="LC957" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="958"></td>
          <td id="LC958" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="959"></td>
          <td id="LC959" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_TempC                            <span class="pl-c"><span class="pl-c">!</span> temperature (degree C)         </span></td>
        </tr>
        <tr>
          <td id="L960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="960"></td>
          <td id="LC960" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="961"></td>
          <td id="LC961" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="962"></td>
          <td id="LC962" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;----------- start sub_huelseetal2016_initialize --------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="963"></td>
          <td id="LC963" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="964"></td>
          <td id="LC964" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="965"></td>
          <td id="LC965" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> *********************************************************************************</span></td>
        </tr>
        <tr>
          <td id="L966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="966"></td>
          <td id="LC966" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="967"></td>
          <td id="LC967" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> initialize globally (so just once in the very beginning)</span></td>
        </tr>
        <tr>
          <td id="L968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="968"></td>
          <td id="LC968" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="969"></td>
          <td id="LC969" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> *********************************************************************************       </span></td>
        </tr>
        <tr>
          <td id="L970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="970"></td>
          <td id="LC970" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="971"></td>
          <td id="LC971" class="blob-code blob-code-inner js-file-line">        rho_sed <span class="pl-k">=</span> <span class="pl-c1">2.6</span>                                       <span class="pl-c"><span class="pl-c">!</span> sediment density (g/cm3)</span></td>
        </tr>
        <tr>
          <td id="L972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="972"></td>
          <td id="LC972" class="blob-code blob-code-inner js-file-line">        z0 <span class="pl-k">=</span> <span class="pl-c1">0.0</span>                                            <span class="pl-c"><span class="pl-c">!</span> top of the sediments</span></td>
        </tr>
        <tr>
          <td id="L973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="973"></td>
          <td id="LC973" class="blob-code blob-code-inner js-file-line">        zox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="974"></td>
          <td id="LC974" class="blob-code blob-code-inner js-file-line">        zno3 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="975"></td>
          <td id="LC975" class="blob-code blob-code-inner js-file-line">        zso4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="976"></td>
          <td id="LC976" class="blob-code blob-code-inner js-file-line">        zinf <span class="pl-k">=</span> <span class="pl-c1">100.0</span>                                        <span class="pl-c"><span class="pl-c">!</span> Inifinity - bottom of the sediments (cm)</span></td>
        </tr>
        <tr>
          <td id="L977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="977"></td>
          <td id="LC977" class="blob-code blob-code-inner js-file-line">        zbio <span class="pl-k">=</span> <span class="pl-c1">10.0</span>                                        <span class="pl-c"><span class="pl-c">!</span> bioturbation depth (cm)</span></td>
        </tr>
        <tr>
          <td id="L978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="978"></td>
          <td id="LC978" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="979"></td>
          <td id="LC979" class="blob-code blob-code-inner js-file-line">        Dbio <span class="pl-k">=</span> <span class="pl-c1">5.2</span><span class="pl-k">*</span>(<span class="pl-c1">10.0</span><span class="pl-k">**</span>(<span class="pl-c1">0.7624-0.0003972</span><span class="pl-k">*</span>dum_D))        <span class="pl-c"><span class="pl-c">!</span>bioturbation coefficient (cm2/yr) - after Middelburg at al. 1997</span></td>
        </tr>
        <tr>
          <td id="L980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="980"></td>
          <td id="LC980" class="blob-code blob-code-inner js-file-line">        Dunbio <span class="pl-k">=</span> <span class="pl-c1">0.01</span>                                       <span class="pl-c"><span class="pl-c">!</span> &quot;diffusion coefficient&quot; for unbioturbated layer - in case we use it</span></td>
        </tr>
        <tr>
          <td id="L981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="981"></td>
          <td id="LC981" class="blob-code blob-code-inner js-file-line">        tort <span class="pl-k">=</span> <span class="pl-c1">3.0</span>                                          <span class="pl-c"><span class="pl-c">!</span> tortuosity (-)</span></td>
        </tr>
        <tr>
          <td id="L982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="982"></td>
          <td id="LC982" class="blob-code blob-code-inner js-file-line">        irrigationFactor <span class="pl-k">=</span> <span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="983"></td>
          <td id="LC983" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="984"></td>
          <td id="LC984" class="blob-code blob-code-inner js-file-line">        gamma <span class="pl-k">=</span> <span class="pl-c1">0.9</span>                                         <span class="pl-c"><span class="pl-c">!</span> fraction of NH4 that is oxidised in oxic layer</span></td>
        </tr>
        <tr>
          <td id="L985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="985"></td>
          <td id="LC985" class="blob-code blob-code-inner js-file-line">        gammaH2S <span class="pl-k">=</span> <span class="pl-c1">0.95</span>                                     <span class="pl-c"><span class="pl-c">!</span> fraction of H2S that is oxidised in oxic layer</span></td>
        </tr>
        <tr>
          <td id="L986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="986"></td>
          <td id="LC986" class="blob-code blob-code-inner js-file-line">        gammaCH4 <span class="pl-k">=</span> <span class="pl-c1">1.0</span>     <span class="pl-c"><span class="pl-c">!</span>0.99                            ! fraction of CH4 that is oxidised at SO4</span></td>
        </tr>
        <tr>
          <td id="L987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="987"></td>
          <td id="LC987" class="blob-code blob-code-inner js-file-line">        satSO4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span>                                        <span class="pl-c"><span class="pl-c">!</span> SO4 saturation</span></td>
        </tr>
        <tr>
          <td id="L988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="988"></td>
          <td id="LC988" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="989"></td>
          <td id="LC989" class="blob-code blob-code-inner js-file-line">        KNH4 <span class="pl-k">=</span> <span class="pl-c1">1.3</span>                                          <span class="pl-c"><span class="pl-c">!</span>Adsorption coefficient (same in oxic and anoxic layer) (-)</span></td>
        </tr>
        <tr>
          <td id="L990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="990"></td>
          <td id="LC990" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="991"></td>
          <td id="LC991" class="blob-code blob-code-inner js-file-line">        zoxgf <span class="pl-k">=</span> <span class="pl-c1">0.1</span>            <span class="pl-c"><span class="pl-c">!</span> was 0.1                             ! cm, rolloff NH4, H2S oxidation for small zox depth</span></td>
        </tr>
        <tr>
          <td id="L992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="992"></td>
          <td id="LC992" class="blob-code blob-code-inner js-file-line">        r_zxf<span class="pl-k">=</span><span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="993"></td>
          <td id="LC993" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="994"></td>
          <td id="LC994" class="blob-code blob-code-inner js-file-line">        dispFactor<span class="pl-k">=</span>por<span class="pl-k">**</span>(tort<span class="pl-c1">-1.0</span>)<span class="pl-k">*</span>irrigationFactor             <span class="pl-c"><span class="pl-c">!</span> dispersion factor (-) - Ausbreitung - type of mixing that accompanies hydrodynamic                                    ! flows -&gt; ~builds out paths of flow</span></td>
        </tr>
        <tr>
          <td id="L995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="995"></td>
          <td id="LC995" class="blob-code blob-code-inner js-file-line">        SD<span class="pl-k">=</span>(<span class="pl-c1">1.0</span><span class="pl-k">-</span>por)<span class="pl-k">/</span>por                                          <span class="pl-c"><span class="pl-c">!</span> volume factor solid-&gt;dissolved phase</span></td>
        </tr>
        <tr>
          <td id="L996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="996"></td>
          <td id="LC996" class="blob-code blob-code-inner js-file-line">        OC<span class="pl-k">=</span> SD<span class="pl-k">*</span>(<span class="pl-c1">138.0</span><span class="pl-k">/</span><span class="pl-c1">106.0</span>)<span class="pl-c"><span class="pl-c">!</span>1.0*SD                                               ! O2/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="997"></td>
          <td id="LC997" class="blob-code blob-code-inner js-file-line">        NC1<span class="pl-k">=</span><span class="pl-c1">0.0</span> <span class="pl-c"><span class="pl-c">!</span>16.0/106.0*SD  ! 0.1509*SD                                        ! N/C first TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="998"></td>
          <td id="LC998" class="blob-code blob-code-inner js-file-line">        NC2<span class="pl-k">=</span><span class="pl-c1">0.0</span> <span class="pl-c"><span class="pl-c">!</span>16.0/106.0*SD  !0.13333*SD                                          ! N/C second TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="999"></td>
          <td id="LC999" class="blob-code blob-code-inner js-file-line">        PC1<span class="pl-k">=</span>SD<span class="pl-k">*</span><span class="pl-c1">1.0</span><span class="pl-k">/</span><span class="pl-c1">106.0</span> <span class="pl-c"><span class="pl-c">!</span>0.0094*SD                                          ! P/C first TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1000"></td>
          <td id="LC1000" class="blob-code blob-code-inner js-file-line">        PC2<span class="pl-k">=</span>SD<span class="pl-k">*</span><span class="pl-c1">1.0</span><span class="pl-k">/</span><span class="pl-c1">106.0</span> <span class="pl-c"><span class="pl-c">!</span>0.0094*SD                                          ! P/C second TOC fraction (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1001"></td>
          <td id="LC1001" class="blob-code blob-code-inner js-file-line">        SO4C<span class="pl-k">=</span>SD<span class="pl-k">*</span>(<span class="pl-c1">138.0</span><span class="pl-k">/</span><span class="pl-c1">212.0</span>)<span class="pl-c"><span class="pl-c">!</span>0.5*SD                                             ! SO4/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1002"></td>
          <td id="LC1002" class="blob-code blob-code-inner js-file-line">        O2H2S<span class="pl-k">=</span><span class="pl-c1">2.0</span>                                               <span class="pl-c"><span class="pl-c">!</span> 2 mole O2 oxidize 1 mole H2S</span></td>
        </tr>
        <tr>
          <td id="L1003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1003"></td>
          <td id="LC1003" class="blob-code blob-code-inner js-file-line">        DICC1<span class="pl-k">=</span><span class="pl-c1">1.0</span><span class="pl-k">*</span>SD                                           <span class="pl-c"><span class="pl-c">!</span> DIC/C until zSO4 (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1004"></td>
          <td id="LC1004" class="blob-code blob-code-inner js-file-line">        DICC2<span class="pl-k">=</span><span class="pl-c1">0.5</span><span class="pl-k">*</span>SD                                           <span class="pl-c"><span class="pl-c">!</span> DIC/C below zSO4 (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1005"></td>
          <td id="LC1005" class="blob-code blob-code-inner js-file-line">        MC<span class="pl-k">=</span><span class="pl-c1">0.5</span><span class="pl-k">*</span>SD                                              <span class="pl-c"><span class="pl-c">!</span> CH4/C (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L1006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1006"></td>
          <td id="LC1006" class="blob-code blob-code-inner js-file-line">        NO3CR<span class="pl-k">=</span>(<span class="pl-c1">94.4</span><span class="pl-k">/</span><span class="pl-c1">106.0</span>)<span class="pl-k">*</span>SD                                    <span class="pl-c"><span class="pl-c">!</span> NO3 consumed by Denitrification</span></td>
        </tr>
        <tr>
          <td id="L1007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1007"></td>
          <td id="LC1007" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1008"></td>
          <td id="LC1008" class="blob-code blob-code-inner js-file-line">        X_C<span class="pl-k">=</span><span class="pl-c1">106.0</span>                                                 <span class="pl-c"><span class="pl-c">!</span> Carbon Redfield stoichiometry</span></td>
        </tr>
        <tr>
          <td id="L1009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1009"></td>
          <td id="LC1009" class="blob-code blob-code-inner js-file-line">        Y_N<span class="pl-k">=</span><span class="pl-c1">16.0</span>                                                  <span class="pl-c"><span class="pl-c">!</span> Nitrogen Redfield stoichiometry</span></td>
        </tr>
        <tr>
          <td id="L1010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1010"></td>
          <td id="LC1010" class="blob-code blob-code-inner js-file-line">        Z_P<span class="pl-k">=</span><span class="pl-c1">1.0</span>                                                   <span class="pl-c"><span class="pl-c">!</span> Phosphorous Redfield stoichiometry</span></td>
        </tr>
        <tr>
          <td id="L1011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1011"></td>
          <td id="LC1011" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1012"></td>
          <td id="LC1012" class="blob-code blob-code-inner js-file-line">        ALKROX<span class="pl-k">=</span> <span class="pl-k">-</span>((Y_N)<span class="pl-k">/</span>X_C)<span class="pl-k">*</span>SD                 <span class="pl-c"><span class="pl-c">!</span> Aerobic degradation -16/106*SD</span></td>
        </tr>
        <tr>
          <td id="L1013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1013"></td>
          <td id="LC1013" class="blob-code blob-code-inner js-file-line">        ALKRNIT<span class="pl-k">=</span><span class="pl-c1">0.0</span>                             <span class="pl-c"><span class="pl-c">!</span> Nitrification explicit -2.0</span></td>
        </tr>
        <tr>
          <td id="L1014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1014"></td>
          <td id="LC1014" class="blob-code blob-code-inner js-file-line">        ALKRDEN<span class="pl-k">=</span><span class="pl-c1">0.0</span>                             <span class="pl-c"><span class="pl-c">!</span> Denitrification explicit: (4*X_C+3*Y_N-10*Z_P)/(5*X_C)*SD</span></td>
        </tr>
        <tr>
          <td id="L1015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1015"></td>
          <td id="LC1015" class="blob-code blob-code-inner js-file-line">        ALKRSUL<span class="pl-k">=</span> ((X_C<span class="pl-k">+</span>Y_N)<span class="pl-k">/</span>X_C)<span class="pl-k">*</span>SD       <span class="pl-c"><span class="pl-c">!</span> ((X_C+Y_N)/X_C)*SD = +122/106*SD!,  Sulfate reduction (N explicit: ((X_C+Y_N-2*Z_P)/X_C)*SD = +120/106*SD)</span></td>
        </tr>
        <tr>
          <td id="L1016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1016"></td>
          <td id="LC1016" class="blob-code blob-code-inner js-file-line">        ALKRH2S<span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">2.0</span>                           <span class="pl-c"><span class="pl-c">!</span> H2S oxydation</span></td>
        </tr>
        <tr>
          <td id="L1017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1017"></td>
          <td id="LC1017" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        ALKRH2S= 0.0       ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L1018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1018"></td>
          <td id="LC1018" class="blob-code blob-code-inner js-file-line">        ALKRMET<span class="pl-k">=</span> <span class="pl-k">-</span>((Y_N)<span class="pl-k">/</span>X_C)<span class="pl-k">*</span>SD   <span class="pl-c"><span class="pl-c">!</span>0.0    ! Methanogenesis explicitly: ((Y_N-2*Z_P)/X_C)*SD</span></td>
        </tr>
        <tr>
          <td id="L1019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1019"></td>
          <td id="LC1019" class="blob-code blob-code-inner js-file-line">        ALKRAOM<span class="pl-k">=</span> <span class="pl-c1">2.0</span>     <span class="pl-c"><span class="pl-c">!</span>0.0                   ! AOM</span></td>
        </tr>
        <tr>
          <td id="L1020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1020"></td>
          <td id="LC1020" class="blob-code blob-code-inner js-file-line">        </td>
        </tr>
        <tr>
          <td id="L1021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1021"></td>
          <td id="LC1021" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ORGANIC MATTER</span></td>
        </tr>
        <tr>
          <td id="L1022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1022"></td>
          <td id="LC1022" class="blob-code blob-code-inner js-file-line">        DC1 <span class="pl-k">=</span> Dbio</td>
        </tr>
        <tr>
          <td id="L1023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1023"></td>
          <td id="LC1023" class="blob-code blob-code-inner js-file-line">        DC2 <span class="pl-k">=</span> Dunbio</td>
        </tr>
        <tr>
          <td id="L1024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1024"></td>
          <td id="LC1024" class="blob-code blob-code-inner js-file-line">               </td>
        </tr>
        <tr>
          <td id="L1025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1025"></td>
          <td id="LC1025" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(dum_D&lt;1000)then</span></td>
        </tr>
        <tr>
          <td id="L1026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1026"></td>
          <td id="LC1026" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;dum_D, dum_depos_rate, k1, k2 &#39;, dum_D, dum_depos_rate, k1, k2</span></td>
        </tr>
        <tr>
          <td id="L1027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1027"></td>
          <td id="LC1027" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L1028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1028"></td>
          <td id="LC1028" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1029"></td>
          <td id="LC1029" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> GLOBAL DIFFUSION COEFFICIENTS</span></td>
        </tr>
        <tr>
          <td id="L1030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1030"></td>
          <td id="LC1030" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> O2</span></td>
        </tr>
        <tr>
          <td id="L1031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1031"></td>
          <td id="LC1031" class="blob-code blob-code-inner js-file-line">        qdispO2<span class="pl-k">=</span><span class="pl-c1">348.62172</span></td>
        </tr>
        <tr>
          <td id="L1032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1032"></td>
          <td id="LC1032" class="blob-code blob-code-inner js-file-line">        adispO2<span class="pl-k">=</span><span class="pl-c1">14.08608</span></td>
        </tr>
        <tr>
          <td id="L1033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1033"></td>
          <td id="LC1033" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1034"></td>
          <td id="LC1034" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Nitrate (NO3)</span></td>
        </tr>
        <tr>
          <td id="L1035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1035"></td>
          <td id="LC1035" class="blob-code blob-code-inner js-file-line">        qdispNO3<span class="pl-k">=</span><span class="pl-c1">308.42208</span></td>
        </tr>
        <tr>
          <td id="L1036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1036"></td>
          <td id="LC1036" class="blob-code blob-code-inner js-file-line">        adispNO3<span class="pl-k">=</span><span class="pl-c1">12.2640</span></td>
        </tr>
        <tr>
          <td id="L1037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1037"></td>
          <td id="LC1037" class="blob-code blob-code-inner js-file-line">        qdispNH4<span class="pl-k">=</span><span class="pl-c1">309.0528</span></td>
        </tr>
        <tr>
          <td id="L1038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1038"></td>
          <td id="LC1038" class="blob-code blob-code-inner js-file-line">        adispNH4<span class="pl-k">=</span><span class="pl-c1">12.2640</span></td>
        </tr>
        <tr>
          <td id="L1039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1039"></td>
          <td id="LC1039" class="blob-code blob-code-inner js-file-line">                </td>
        </tr>
        <tr>
          <td id="L1040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1040"></td>
          <td id="LC1040" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Sulfate (SO4) - Hydrogen sulfide (H2S)</span></td>
        </tr>
        <tr>
          <td id="L1041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1041"></td>
          <td id="LC1041" class="blob-code blob-code-inner js-file-line">        qdispSO4<span class="pl-k">=</span><span class="pl-c1">157.68</span>                 <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in water at 0 degree C  (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1042"></td>
          <td id="LC1042" class="blob-code blob-code-inner js-file-line">        adispSO4<span class="pl-k">=</span><span class="pl-c1">7.884</span>                  <span class="pl-c"><span class="pl-c">!</span> SO4 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L1043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1043"></td>
          <td id="LC1043" class="blob-code blob-code-inner js-file-line">        qdispH2S<span class="pl-k">=</span><span class="pl-c1">307.476</span></td>
        </tr>
        <tr>
          <td id="L1044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1044"></td>
          <td id="LC1044" class="blob-code blob-code-inner js-file-line">        adispH2S<span class="pl-k">=</span><span class="pl-c1">9.636</span></td>
        </tr>
        <tr>
          <td id="L1045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1045"></td>
          <td id="LC1045" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1046"></td>
          <td id="LC1046" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Phosphate (PO4)</span></td>
        </tr>
        <tr>
          <td id="L1047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1047"></td>
          <td id="LC1047" class="blob-code blob-code-inner js-file-line">        qdispPO4<span class="pl-k">=</span><span class="pl-c1">112.90764</span></td>
        </tr>
        <tr>
          <td id="L1048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1048"></td>
          <td id="LC1048" class="blob-code blob-code-inner js-file-line">        adispPO4<span class="pl-k">=</span><span class="pl-c1">5.586252</span></td>
        </tr>
        <tr>
          <td id="L1049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1049"></td>
          <td id="LC1049" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1050"></td>
          <td id="LC1050" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DIC</span></td>
        </tr>
        <tr>
          <td id="L1051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1051"></td>
          <td id="LC1051" class="blob-code blob-code-inner js-file-line">        qdispDIC<span class="pl-k">=</span><span class="pl-c1">151.69</span>                 <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1052"></td>
          <td id="LC1052" class="blob-code blob-code-inner js-file-line">        adispDIC<span class="pl-k">=</span><span class="pl-c1">7.93</span>                   <span class="pl-c"><span class="pl-c">!</span> DIC linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L1053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1053"></td>
          <td id="LC1053" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1054"></td>
          <td id="LC1054" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Alkalinity</span></td>
        </tr>
        <tr>
          <td id="L1055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1055"></td>
          <td id="LC1055" class="blob-code blob-code-inner js-file-line">        qdispALK<span class="pl-k">=</span><span class="pl-c1">151.69</span>                 <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1056"></td>
          <td id="LC1056" class="blob-code blob-code-inner js-file-line">        adispALK<span class="pl-k">=</span><span class="pl-c1">7.93</span>                   <span class="pl-c"><span class="pl-c">!</span> ALK linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L1057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1057"></td>
          <td id="LC1057" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1058"></td>
          <td id="LC1058" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1059"></td>
          <td id="LC1059" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> *********************************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1060"></td>
          <td id="LC1060" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1061"></td>
          <td id="LC1061" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> initialize locally</span></td>
        </tr>
        <tr>
          <td id="L1062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1062"></td>
          <td id="LC1062" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1063"></td>
          <td id="LC1063" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> *********************************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1064"></td>
          <td id="LC1064" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1065"></td>
          <td id="LC1065" class="blob-code blob-code-inner js-file-line">        loc_TempC <span class="pl-k">=</span> dum_TempK <span class="pl-k">-</span> <span class="pl-c1">273.15</span></td>
        </tr>
        <tr>
          <td id="L1066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1066"></td>
          <td id="LC1066" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1067"></td>
          <td id="LC1067" class="blob-code blob-code-inner js-file-line">        w <span class="pl-k">=</span> dum_depos_rate              <span class="pl-c"><span class="pl-c">!</span> sedimentation rate, cm/yr / burial velocity / advection</span></td>
        </tr>
        <tr>
          <td id="L1068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1068"></td>
          <td id="LC1068" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        w=10.0**(-0.87478367-0.00043512*dum_D)*3.3              ! sedimentation rate, cm/yr / burial velocity / advection (Middelburg et al., Deep Sea Res. 1, 1997)</span></td>
        </tr>
        <tr>
          <td id="L1069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1069"></td>
          <td id="LC1069" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1070"></td>
          <td id="LC1070" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1071"></td>
          <td id="LC1071" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Diffusion coefficients</span></td>
        </tr>
        <tr>
          <td id="L1072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1072"></td>
          <td id="LC1072" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> O2</span></td>
        </tr>
        <tr>
          <td id="L1073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1073"></td>
          <td id="LC1073" class="blob-code blob-code-inner js-file-line">        DO21<span class="pl-k">=</span>(qdispO2<span class="pl-k">+</span>adispO2<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio        <span class="pl-c"><span class="pl-c">!</span> O2 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1074"></td>
          <td id="LC1074" class="blob-code blob-code-inner js-file-line">        DO22<span class="pl-k">=</span>(qdispO2<span class="pl-k">+</span>adispO2<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor             <span class="pl-c"><span class="pl-c">!</span> O2 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1075"></td>
          <td id="LC1075" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1076"></td>
          <td id="LC1076" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1077"></td>
          <td id="LC1077" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Nitrate (NO3) - Ammonium (NH4)        </span></td>
        </tr>
        <tr>
          <td id="L1078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1078"></td>
          <td id="LC1078" class="blob-code blob-code-inner js-file-line">        DN1<span class="pl-k">=</span>(qdispNO3<span class="pl-k">+</span>adispNO3<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio</td>
        </tr>
        <tr>
          <td id="L1079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1079"></td>
          <td id="LC1079" class="blob-code blob-code-inner js-file-line">        DN2<span class="pl-k">=</span>(qdispNO3<span class="pl-k">+</span>adispNO3<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor</td>
        </tr>
        <tr>
          <td id="L1080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1080"></td>
          <td id="LC1080" class="blob-code blob-code-inner js-file-line">        DNH41<span class="pl-k">=</span>((qdispNH4<span class="pl-k">+</span>adispNH4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio)<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4)</td>
        </tr>
        <tr>
          <td id="L1081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1081"></td>
          <td id="LC1081" class="blob-code blob-code-inner js-file-line">        DNH42<span class="pl-k">=</span>((qdispNH4<span class="pl-k">+</span>adispNH4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor)<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4)</td>
        </tr>
        <tr>
          <td id="L1082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1082"></td>
          <td id="LC1082" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1083"></td>
          <td id="LC1083" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Sulfate (SO4) - Hydrogen sulfide (H2S)</span></td>
        </tr>
        <tr>
          <td id="L1084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1084"></td>
          <td id="LC1084" class="blob-code blob-code-inner js-file-line">        DSO41<span class="pl-k">=</span>(qdispSO4<span class="pl-k">+</span>adispSO4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio     <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1085"></td>
          <td id="LC1085" class="blob-code blob-code-inner js-file-line">        DSO42<span class="pl-k">=</span>(qdispSO4<span class="pl-k">+</span>adispSO4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor          <span class="pl-c"><span class="pl-c">!</span> SO4 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1086"></td>
          <td id="LC1086" class="blob-code blob-code-inner js-file-line">        DH2S1<span class="pl-k">=</span>(qdispH2S<span class="pl-k">+</span>adispH2S<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio</td>
        </tr>
        <tr>
          <td id="L1087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1087"></td>
          <td id="LC1087" class="blob-code blob-code-inner js-file-line">        DH2S2<span class="pl-k">=</span>(qdispH2S<span class="pl-k">+</span>adispH2S<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor</td>
        </tr>
        <tr>
          <td id="L1088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1088"></td>
          <td id="LC1088" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1089"></td>
          <td id="LC1089" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Phosphate (PO4)</span></td>
        </tr>
        <tr>
          <td id="L1090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1090"></td>
          <td id="LC1090" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">=</span>((qdispPO4<span class="pl-k">+</span>adispPO4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio)               <span class="pl-c"><span class="pl-c">!</span> PO4 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1091"></td>
          <td id="LC1091" class="blob-code blob-code-inner js-file-line">        DPO42<span class="pl-k">=</span>((qdispPO4<span class="pl-k">+</span>adispPO4<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor);                   <span class="pl-c"><span class="pl-c">!</span> PO4 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1092"></td>
          <td id="LC1092" class="blob-code blob-code-inner js-file-line">        KPO4_ox <span class="pl-k">=</span> <span class="pl-c1">200.0</span>   <span class="pl-c"><span class="pl-c">!</span> 0.0                 ! Adsorption coefficient in oxic layer (-)</span></td>
        </tr>
        <tr>
          <td id="L1093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1093"></td>
          <td id="LC1093" class="blob-code blob-code-inner js-file-line">        KPO4_anox <span class="pl-k">=</span> <span class="pl-c1">1.3</span>   <span class="pl-c"><span class="pl-c">!</span> 0.0                ! Adsorption coefficient in anoxic layer (-)</span></td>
        </tr>
        <tr>
          <td id="L1094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1094"></td>
          <td id="LC1094" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1095"></td>
          <td id="LC1095" class="blob-code blob-code-inner js-file-line">        dum_swiflux_M <span class="pl-k">=</span> <span class="pl-c1">365</span><span class="pl-k">*</span><span class="pl-c1">0.2e-10</span>     <span class="pl-c"><span class="pl-c">!</span> Flux input 365*0.2e-10 flux of M to the sediment (mol/(cm2*yr)) - this needs to equal advective flux in sediment z=0</span></td>
        </tr>
        <tr>
          <td id="L1096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1096"></td>
          <td id="LC1096" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dum_swiflux_M = 365.0*0.2e-10*1/(1-por)*1/w ! Flux converted to concentration (NOT NEEDED!!!)</span></td>
        </tr>
        <tr>
          <td id="L1097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1097"></td>
          <td id="LC1097" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1098"></td>
          <td id="LC1098" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>       WAS BEFORE:</span></td>
        </tr>
        <tr>
          <td id="L1099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1099"></td>
          <td id="LC1099" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        ksPO4 = 1.0       ! 0.0  !          ! Rate constant for kinetic P sorption (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L1100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1100"></td>
          <td id="LC1100" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        kmPO4 = 2.2e-6*24*365  ! 0.0                 ! Rate constant for Fe-bound P release upon Fe oxide reduction</span></td>
        </tr>
        <tr>
          <td id="L1101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1101"></td>
          <td id="LC1101" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        kaPO4 = 10.0      ! 0.0             ! Rate constant for authigenic P formation (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L1102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1102"></td>
          <td id="LC1102" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        PO4s = 1.0e-9     ! 0.0               ! Equilibrium concentration for P sorption (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1103"></td>
          <td id="LC1103" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        PO4a = 3.7e-9     ! 0.0              ! Equilibrium concentration for authigenic P formation (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1104"></td>
          <td id="LC1104" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        Minf = 1.99e-10    ! 0.0                ! asymptotic concentration for Fe-bound P (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1105"></td>
          <td id="LC1105" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1106"></td>
          <td id="LC1106" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Palastanga et al. (2011)</span></td>
        </tr>
        <tr>
          <td id="L1107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1107"></td>
          <td id="LC1107" class="blob-code blob-code-inner js-file-line">        kmPO4 <span class="pl-k">=</span> <span class="pl-c1">0.19</span>  <span class="pl-c"><span class="pl-c">!</span> 0.05               ! Rate constant for Fe-bound P release upon Fe oxide reduction (from Slomp et al. (1996)</span></td>
        </tr>
        <tr>
          <td id="L1108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1108"></td>
          <td id="LC1108" class="blob-code blob-code-inner js-file-line">        kaPO4 <span class="pl-k">=</span> <span class="pl-c1">0.37</span>      <span class="pl-c"><span class="pl-c">!</span> 0.0             ! Rate constant for authigenic P formation (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L1109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1109"></td>
          <td id="LC1109" class="blob-code blob-code-inner js-file-line">        PO4a <span class="pl-k">=</span> <span class="pl-c1">3.7e-9</span>     <span class="pl-c"><span class="pl-c">!</span> 0.0              ! Equilibrium concentration for authigenic P formation (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1110"></td>
          <td id="LC1110" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(dum_D <span class="pl-k">.LE.</span> <span class="pl-c1">2000</span>)<span class="pl-k">then</span>     <span class="pl-c"><span class="pl-c">!</span> sediment margins</span></td>
        </tr>
        <tr>
          <td id="L1111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1111"></td>
          <td id="LC1111" class="blob-code blob-code-inner js-file-line">            ksPO4 <span class="pl-k">=</span> <span class="pl-c1">36.5</span>       <span class="pl-c"><span class="pl-c">!</span> 0.0            ! Rate constant for kinetic P sorption (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L1112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1112"></td>
          <td id="LC1112" class="blob-code blob-code-inner js-file-line">            PO4s <span class="pl-k">=</span> <span class="pl-c1">2.0e-9</span>     <span class="pl-c"><span class="pl-c">!</span> 0.0               ! Equilibrium concentration for P sorption (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1113"></td>
          <td id="LC1113" class="blob-code blob-code-inner js-file-line">            Minf <span class="pl-k">=</span> <span class="pl-c1">5.2e-15</span>    <span class="pl-c"><span class="pl-c">!</span> 2.0e-15                ! asymptotic concentration for Fe-bound P (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1114"></td>
          <td id="LC1114" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>        <span class="pl-c"><span class="pl-c">!</span> deep sea sediments</span></td>
        </tr>
        <tr>
          <td id="L1115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1115"></td>
          <td id="LC1115" class="blob-code blob-code-inner js-file-line">            ksPO4 <span class="pl-k">=</span> <span class="pl-c1">3.65</span>       <span class="pl-c"><span class="pl-c">!</span> lower sorption rate for deep sea   ! Rate constant for kinetic P sorption (1/yr)</span></td>
        </tr>
        <tr>
          <td id="L1116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1116"></td>
          <td id="LC1116" class="blob-code blob-code-inner js-file-line">            PO4s <span class="pl-k">=</span> <span class="pl-c1">2.0e-9</span>     <span class="pl-c"><span class="pl-c">!</span> DH 09/07/18 was 12.0e-9 (but too high)             ! Equilibrium concentration for P sorption (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1117"></td>
          <td id="LC1117" class="blob-code blob-code-inner js-file-line">            Minf <span class="pl-k">=</span> <span class="pl-c1">5.2e-15</span>       <span class="pl-c"><span class="pl-c">!</span> Palastanga: 5.2e-9 ! 0.0                ! asymptotic concentration for Fe-bound P (mol/cm3)</span></td>
        </tr>
        <tr>
          <td id="L1118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1118"></td>
          <td id="LC1118" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1119"></td>
          <td id="LC1119" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1120"></td>
          <td id="LC1120" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DIC</span></td>
        </tr>
        <tr>
          <td id="L1121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1121"></td>
          <td id="LC1121" class="blob-code blob-code-inner js-file-line">        DDIC1<span class="pl-k">=</span>(qdispDIC<span class="pl-k">+</span>adispDIC<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio                 <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1122"></td>
          <td id="LC1122" class="blob-code blob-code-inner js-file-line">        DDIC2<span class="pl-k">=</span>(qdispDIC<span class="pl-k">+</span>adispDIC<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor                      <span class="pl-c"><span class="pl-c">!</span> DIC diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1123"></td>
          <td id="LC1123" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1124"></td>
          <td id="LC1124" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Alkalinity</span></td>
        </tr>
        <tr>
          <td id="L1125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1125"></td>
          <td id="LC1125" class="blob-code blob-code-inner js-file-line">        DALK1<span class="pl-k">=</span>(qdispALK<span class="pl-k">+</span>adispALK<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor<span class="pl-k">+</span>Dbio;                <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1126"></td>
          <td id="LC1126" class="blob-code blob-code-inner js-file-line">        DALK2<span class="pl-k">=</span>(qdispALK<span class="pl-k">+</span>adispALK<span class="pl-k">*</span>loc_TempC)<span class="pl-k">*</span>dispFactor;                     <span class="pl-c"><span class="pl-c">!</span> ALK diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1127"></td>
          <td id="LC1127" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1128"></td>
          <td id="LC1128" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_initialize</span></td>
        </tr>
        <tr>
          <td id="L1129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1129"></td>
          <td id="LC1129" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L1130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1130"></td>
          <td id="LC1130" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1131"></td>
          <td id="LC1131" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1132"></td>
          <td id="LC1132" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1133"></td>
          <td id="LC1133" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1134"></td>
          <td id="LC1134" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1135"></td>
          <td id="LC1135" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           TOC</span></td>
        </tr>
        <tr>
          <td id="L1136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1136"></td>
          <td id="LC1136" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1137"></td>
          <td id="LC1137" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1138"></td>
          <td id="LC1138" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1139"></td>
          <td id="LC1139" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1140"></td>
          <td id="LC1140" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1141"></td>
          <td id="LC1141" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zTOC</span>(<span class="pl-v">dum_D</span>, <span class="pl-v">dum_POC1_flux_swi</span>, <span class="pl-v">dum_POC2_flux_swi</span>, <span class="pl-v">dum_POC3_flux_swi</span>, <span class="pl-v">dum_sed_pres_fracC</span>, <span class="pl-v">dum_sed_pres_insane</span>, <span class="pl-v">dum_sed_OM_wtpc_bot</span>)</td>
        </tr>
        <tr>
          <td id="L1142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1142"></td>
          <td id="LC1142" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L1143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1143"></td>
          <td id="LC1143" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L1144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1144"></td>
          <td id="LC1144" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   calculate benthic burial/recycling fluxes (see documentation for details!)</span></td>
        </tr>
        <tr>
          <td id="L1145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1145"></td>
          <td id="LC1145" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L1146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1146"></td>
          <td id="LC1146" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1147"></td>
          <td id="LC1147" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   organic matter burial 2 fractions</span></td>
        </tr>
        <tr>
          <td id="L1148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1148"></td>
          <td id="LC1148" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1149"></td>
          <td id="LC1149" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L1150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1150"></td>
          <td id="LC1150" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_POC1_flux_swi, dum_POC2_flux_swi, dum_POC3_flux_swi   <span class="pl-c"><span class="pl-c">!</span> POC flux at SWI   [mol/(cm2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L1151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1151"></td>
          <td id="LC1151" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_pres_fracC                              <span class="pl-c"><span class="pl-c">!</span> POC concentrations at zinf</span></td>
        </tr>
        <tr>
          <td id="L1152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1152"></td>
          <td id="LC1152" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">REAL</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_D                                     <span class="pl-c"><span class="pl-c">!</span> depth</span></td>
        </tr>
        <tr>
          <td id="L1153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1153"></td>
          <td id="LC1153" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">logical</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>) <span class="pl-k">::</span> dum_sed_pres_insane                       <span class="pl-c"><span class="pl-c">!</span> true if integration constants are too high -&gt; calculate SWI-flux manually</span></td>
        </tr>
        <tr>
          <td id="L1154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1154"></td>
          <td id="LC1154" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_OM_wtpc_bot                     <span class="pl-c"><span class="pl-c">!</span> POC wt% at bottom of sediment column (geologic preservation)</span></td>
        </tr>
        <tr>
          <td id="L1155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1155"></td>
          <td id="LC1155" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L1156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1156"></td>
          <td id="LC1156" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        real loc_POC1_conc_swi, dum_POC2_conc_swi                           ! POC concentration at SWI   [mol/cm3]</span></td>
        </tr>
        <tr>
          <td id="L1157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1157"></td>
          <td id="LC1157" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_POC1_conc_zinf, loc_POC2_conc_zinf</td>
        </tr>
        <tr>
          <td id="L1158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1158"></td>
          <td id="LC1158" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real aa11, bb11, aa21, A11, A21, aa12, bb12, aa22, A12, A22</span></td>
        </tr>
        <tr>
          <td id="L1159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1159"></td>
          <td id="LC1159" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> dC1dz, C1flx, dC2dz, C2flx, Cflx                             <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L1160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1160"></td>
          <td id="LC1160" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> F_TOC1, F_TOC2, F_TOC                                        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column</span></td>
        </tr>
        <tr>
          <td id="L1161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1161"></td>
          <td id="LC1161" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1162"></td>
          <td id="LC1162" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1163"></td>
          <td id="LC1163" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1164"></td>
          <td id="LC1164" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*,&#39; ------------------ START zTOC ---------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L1165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1165"></td>
          <td id="LC1165" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                       print*,&#39; sedimentation rate/burial velocity w = &#39;, w</span></td>
        </tr>
        <tr>
          <td id="L1166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1166"></td>
          <td id="LC1166" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*,&#39;dum_D,  w = &#39;, dum_D, w</span></td>
        </tr>
        <tr>
          <td id="L1167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1167"></td>
          <td id="LC1167" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*, &#39;dum_POC1_flux_swi&#39;, char(9), dum_POC1_flux_swi</span></td>
        </tr>
        <tr>
          <td id="L1168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1168"></td>
          <td id="LC1168" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>               print*, &#39;dum_POC2_flux_swi&#39;, char(9), dum_POC2_flux_swi</span></td>
        </tr>
        <tr>
          <td id="L1169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1169"></td>
          <td id="LC1169" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1170"></td>
          <td id="LC1170" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Dom: Use this when comparing with MATLAB, here we use wt% of g -&gt; *1/12</span></td>
        </tr>
        <tr>
          <td id="L1171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1171"></td>
          <td id="LC1171" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        loc_POC1_conc_swi=0.01*dum_POC1_wtpct_swi/12.0*rho_sed              ! %TOC concentration frac1 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L1172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1172"></td>
          <td id="LC1172" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_POC2_conc_swi=0.01*dum_POC2_wtpct_swi/12.0*rho_sed              ! %TOC concentration frac2 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L1173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1173"></td>
          <td id="LC1173" class="blob-code blob-code-inner js-file-line">                </td>
        </tr>
        <tr>
          <td id="L1174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1174"></td>
          <td id="LC1174" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1175"></td>
          <td id="LC1175" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate concentration (mol/cm3) at very top of sediments not accounting for biodiffusion (just account for advection)</span></td>
        </tr>
        <tr>
          <td id="L1176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1176"></td>
          <td id="LC1176" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NOTE: this is needed when calculating final fraction of POC preservation</span></td>
        </tr>
        <tr>
          <td id="L1177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1177"></td>
          <td id="LC1177" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> if taking [POC] at SWI including biodiffusion term (e.g. dum_POC1_conc_swi) </span></td>
        </tr>
        <tr>
          <td id="L1178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1178"></td>
          <td id="LC1178" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the preservation is too high (as not all incoming POC is accounted for)</span></td>
        </tr>
        <tr>
          <td id="L1179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1179"></td>
          <td id="LC1179" class="blob-code blob-code-inner js-file-line">        dum_POC1_conc_swi_nonbio <span class="pl-k">=</span> dum_POC1_flux_swi<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>w</td>
        </tr>
        <tr>
          <td id="L1180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1180"></td>
          <td id="LC1180" class="blob-code blob-code-inner js-file-line">        dum_POC2_conc_swi_nonbio <span class="pl-k">=</span> dum_POC2_flux_swi<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>w</td>
        </tr>
        <tr>
          <td id="L1181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1181"></td>
          <td id="LC1181" class="blob-code blob-code-inner js-file-line">        dum_POC3_conc_swi <span class="pl-k">=</span> dum_POC3_flux_swi<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span><span class="pl-c1">1</span><span class="pl-k">/</span>w</td>
        </tr>
        <tr>
          <td id="L1182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1182"></td>
          <td id="LC1182" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1183"></td>
          <td id="LC1183" class="blob-code blob-code-inner js-file-line">        aa11 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L1184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1184"></td>
          <td id="LC1184" class="blob-code blob-code-inner js-file-line">        bb11 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L1185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1185"></td>
          <td id="LC1185" class="blob-code blob-code-inner js-file-line">        aa21 <span class="pl-k">=</span> (<span class="pl-k">-</span>k1<span class="pl-k">/</span>w)</td>
        </tr>
        <tr>
          <td id="L1186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1186"></td>
          <td id="LC1186" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1187"></td>
          <td id="LC1187" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1188"></td>
          <td id="LC1188" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate TOC SWI concentration from flux</span></td>
        </tr>
        <tr>
          <td id="L1189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1189"></td>
          <td id="LC1189" class="blob-code blob-code-inner js-file-line">        dum_POC1_conc_swi <span class="pl-k">=</span> (dum_POC1_flux_swi<span class="pl-k">*</span>(<span class="pl-k">-</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1190"></td>
          <td id="LC1190" class="blob-code blob-code-inner js-file-line">        DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> w<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1191"></td>
          <td id="LC1191" class="blob-code blob-code-inner js-file-line">        w<span class="pl-k">*</span>por<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>por<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))</td>
        </tr>
        <tr>
          <td id="L1192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1192"></td>
          <td id="LC1192" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1193"></td>
          <td id="LC1193" class="blob-code blob-code-inner js-file-line">        A11 <span class="pl-k">=</span> <span class="pl-k">-</span>(dum_POC1_conc_swi<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall) !/100000000)</span></td>
        </tr>
        <tr>
          <td id="L1194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1194"></td>
          <td id="LC1194" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(exp(aa21*zbio) &gt; const_real_nullsmall) then</span></td>
        </tr>
        <tr>
          <td id="L1195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1195"></td>
          <td id="LC1195" class="blob-code blob-code-inner js-file-line">        A21<span class="pl-k">=</span>(A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall) !/100000000)</span></td>
        </tr>
        <tr>
          <td id="L1196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1196"></td>
          <td id="LC1196" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        else</span></td>
        </tr>
        <tr>
          <td id="L1197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1197"></td>
          <td id="LC1197" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            A21=(A11*(exp(aa11*zbio)-exp(bb11*zbio))+dum_POC1_conc_swi*exp(bb11*zbio))/const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L1198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1198"></td>
          <td id="LC1198" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;in small exp(aa21*zbio)&#39;, +exp(aa21*zbio)</span></td>
        </tr>
        <tr>
          <td id="L1199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1199"></td>
          <td id="LC1199" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L1200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1200"></td>
          <td id="LC1200" class="blob-code blob-code-inner js-file-line">        aa12 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L1201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1201"></td>
          <td id="LC1201" class="blob-code blob-code-inner js-file-line">        bb12 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L1202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1202"></td>
          <td id="LC1202" class="blob-code blob-code-inner js-file-line">        aa22 <span class="pl-k">=</span> (<span class="pl-k">-</span>k2<span class="pl-k">/</span>w)</td>
        </tr>
        <tr>
          <td id="L1203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1203"></td>
          <td id="LC1203" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1204"></td>
          <td id="LC1204" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate TOC SWI concentration from flux</span></td>
        </tr>
        <tr>
          <td id="L1205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1205"></td>
          <td id="LC1205" class="blob-code blob-code-inner js-file-line">        dum_POC2_conc_swi <span class="pl-k">=</span> (dum_POC2_flux_swi<span class="pl-k">*</span>(<span class="pl-k">-</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1206"></td>
          <td id="LC1206" class="blob-code blob-code-inner js-file-line">        DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> w<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1207"></td>
          <td id="LC1207" class="blob-code blob-code-inner js-file-line">        w<span class="pl-k">*</span>por<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>por<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))</td>
        </tr>
        <tr>
          <td id="L1208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1208"></td>
          <td id="LC1208" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1209"></td>
          <td id="LC1209" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1210"></td>
          <td id="LC1210" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_POC1_conc_swi = &#39;, 100.0*12.0/rho_sed*dum_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L1211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1211"></td>
          <td id="LC1211" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_POC2_conc_swi = &#39;, 100.0*12.0/rho_sed*dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L1212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1212"></td>
          <td id="LC1212" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_POC3_conc_swi = &#39;, 100.0*12.0/rho_sed*dum_POC3_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L1213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1213"></td>
          <td id="LC1213" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1214"></td>
          <td id="LC1214" class="blob-code blob-code-inner js-file-line">        A12<span class="pl-k">=-</span>(dum_POC2_conc_swi<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall) !/100000000)</span></td>
        </tr>
        <tr>
          <td id="L1215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1215"></td>
          <td id="LC1215" class="blob-code blob-code-inner js-file-line">        A22<span class="pl-k">=</span>(A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall) !/100000000)</span></td>
        </tr>
        <tr>
          <td id="L1216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1216"></td>
          <td id="LC1216" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1217"></td>
          <td id="LC1217" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;const_real_nullsmall&#39;, const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L1218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1218"></td>
          <td id="LC1218" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1219"></td>
          <td id="LC1219" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1220"></td>
          <td id="LC1220" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!! no need for this as this is SWI concentration for z0 = 0!</span></td>
        </tr>
        <tr>
          <td id="L1221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1221"></td>
          <td id="LC1221" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    ! % Calculate concentration at z0</span></td>
        </tr>
        <tr>
          <td id="L1222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1222"></td>
          <td id="LC1222" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    if(z0&lt;=zbio) then</span></td>
        </tr>
        <tr>
          <td id="L1223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1223"></td>
          <td id="LC1223" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A11*(exp(aa11*z0)-exp(bb11*z0))+dum_POC1_conc_swi*exp(bb11*z0)</span></td>
        </tr>
        <tr>
          <td id="L1224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1224"></td>
          <td id="LC1224" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A12*(exp(aa12*z0)-exp(bb12*z0))+dum_POC2_conc_swi*exp(bb12*z0)</span></td>
        </tr>
        <tr>
          <td id="L1225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1225"></td>
          <td id="LC1225" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    else</span></td>
        </tr>
        <tr>
          <td id="L1226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1226"></td>
          <td id="LC1226" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A21*exp(aa21*z0)</span></td>
        </tr>
        <tr>
          <td id="L1227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1227"></td>
          <td id="LC1227" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A22*exp(aa22*z0)</span></td>
        </tr>
        <tr>
          <td id="L1228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1228"></td>
          <td id="LC1228" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    end if</span></td>
        </tr>
        <tr>
          <td id="L1229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1229"></td>
          <td id="LC1229" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    C = C1 + C2</span></td>
        </tr>
        <tr>
          <td id="L1230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1230"></td>
          <td id="LC1230" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!</span></td>
        </tr>
        <tr>
          <td id="L1231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1231"></td>
          <td id="LC1231" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39;C = C1 + C2 &#39;, C</span></td>
        </tr>
        <tr>
          <td id="L1232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1232"></td>
          <td id="LC1232" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1233"></td>
          <td id="LC1233" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1234"></td>
          <td id="LC1234" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L1235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1235"></td>
          <td id="LC1235" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(z0 &lt; zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L1236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1236"></td>
          <td id="LC1236" class="blob-code blob-code-inner js-file-line">            dC1dz <span class="pl-k">=</span>  A11<span class="pl-k">*</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L1237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1237"></td>
          <td id="LC1237" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC1dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC1_conc_swi)</td>
        </tr>
        <tr>
          <td id="L1238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1238"></td>
          <td id="LC1238" class="blob-code blob-code-inner js-file-line">            dC2dz <span class="pl-k">=</span>  A12<span class="pl-k">*</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L1239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1239"></td>
          <td id="LC1239" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC2dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC2_conc_swi)</td>
        </tr>
        <tr>
          <td id="L1240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1240"></td>
          <td id="LC1240" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1241"></td>
          <td id="LC1241" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC1_conc_swi</td>
        </tr>
        <tr>
          <td id="L1242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1242"></td>
          <td id="LC1242" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC2_conc_swi</td>
        </tr>
        <tr>
          <td id="L1243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1243"></td>
          <td id="LC1243" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1244"></td>
          <td id="LC1244" class="blob-code blob-code-inner js-file-line">        Cflx <span class="pl-k">=</span> C1flx <span class="pl-k">+</span> C2flx</td>
        </tr>
        <tr>
          <td id="L1245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1245"></td>
          <td id="LC1245" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1246"></td>
          <td id="LC1246" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;Cflx swi&#39;, char(9), Cflx</span></td>
        </tr>
        <tr>
          <td id="L1247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1247"></td>
          <td id="LC1247" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C1flx swi&#39;, char(9), C1flx</span></td>
        </tr>
        <tr>
          <td id="L1248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1248"></td>
          <td id="LC1248" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C2flx swi&#39;, char(9), C2flx</span></td>
        </tr>
        <tr>
          <td id="L1249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1249"></td>
          <td id="LC1249" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1250"></td>
          <td id="LC1250" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1251"></td>
          <td id="LC1251" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column (Dom 08.02.2018 was -(1-por)*w*A21*exp(aa21*zinf))</span></td>
        </tr>
        <tr>
          <td id="L1252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1252"></td>
          <td id="LC1252" class="blob-code blob-code-inner js-file-line">        F_TOC1 <span class="pl-k">=</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1253"></td>
          <td id="LC1253" class="blob-code blob-code-inner js-file-line">        F_TOC2 <span class="pl-k">=</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1254"></td>
          <td id="LC1254" class="blob-code blob-code-inner js-file-line">        F_TOC <span class="pl-k">=</span> F_TOC1 <span class="pl-k">+</span> F_TOC2</td>
        </tr>
        <tr>
          <td id="L1255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1255"></td>
          <td id="LC1255" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC1 zinf&#39;, char(9), F_TOC1</span></td>
        </tr>
        <tr>
          <td id="L1256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1256"></td>
          <td id="LC1256" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC2 zinf&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L1257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1257"></td>
          <td id="LC1257" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC zinf&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L1258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1258"></td>
          <td id="LC1258" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1259"></td>
          <td id="LC1259" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Concentration at lower boundary zinf</span></td>
        </tr>
        <tr>
          <td id="L1260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1260"></td>
          <td id="LC1260" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zinf<span class="pl-k">&lt;</span>zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L1261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1261"></td>
          <td id="LC1261" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1262"></td>
          <td id="LC1262" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1263"></td>
          <td id="LC1263" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1264"></td>
          <td id="LC1264" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1265"></td>
          <td id="LC1265" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L1266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1266"></td>
          <td id="LC1266" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1267"></td>
          <td id="LC1267" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1268"></td>
          <td id="LC1268" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: need to give back fraction buried of initially deposited (so fraction of the input values to this subroutine)</span></td>
        </tr>
        <tr>
          <td id="L1269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1269"></td>
          <td id="LC1269" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC1_conc_zinf &#39;, char(9), loc_POC1_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L1270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1270"></td>
          <td id="LC1270" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC2_conc_zinf &#39;, char(9), loc_POC2_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L1271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1271"></td>
          <td id="LC1271" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1272"></td>
          <td id="LC1272" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> just two fractions</span></td>
        </tr>
        <tr>
          <td id="L1273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1273"></td>
          <td id="LC1273" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_sed_pres_fracC = (loc_POC1_conc_zinf+loc_POC2_conc_zinf)/(dum_POC1_conc_swi+dum_POC2_conc_swi) !+const_real_nullsmall)</span></td>
        </tr>
        <tr>
          <td id="L1274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1274"></td>
          <td id="LC1274" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> with third inert/sulfurised fraction</span></td>
        </tr>
        <tr>
          <td id="L1275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1275"></td>
          <td id="LC1275" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, mol cm^-2 yr^-1</span></td>
        </tr>
        <tr>
          <td id="L1276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1276"></td>
          <td id="LC1276" class="blob-code blob-code-inner js-file-line">        dum_POC_total_flux_zinf <span class="pl-k">=</span> F_TOC1 <span class="pl-k">+</span> F_TOC2 <span class="pl-k">+</span> dum_POC3_flux_swi</td>
        </tr>
        <tr>
          <td id="L1277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1277"></td>
          <td id="LC1277" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC1, F_TOC2, dum_POC3_flux_swi&#39;, F_TOC1, F_TOC2, dum_POC3_flux_swi</span></td>
        </tr>
        <tr>
          <td id="L1278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1278"></td>
          <td id="LC1278" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1279"></td>
          <td id="LC1279" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1280"></td>
          <td id="LC1280" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> new, correct preservation:</span></td>
        </tr>
        <tr>
          <td id="L1281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1281"></td>
          <td id="LC1281" class="blob-code blob-code-inner js-file-line">        dum_sed_pres_fracC <span class="pl-k">=</span> (loc_POC1_conc_zinf<span class="pl-k">+</span>loc_POC2_conc_zinf<span class="pl-k">+</span>dum_POC3_conc_swi)<span class="pl-k">/</span>(dum_POC1_conc_swi_nonbio<span class="pl-k">+</span>dum_POC2_conc_swi_nonbio<span class="pl-k">+</span>dum_POC3_conc_swi) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall)</span></td>
        </tr>
        <tr>
          <td id="L1282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1282"></td>
          <td id="LC1282" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> old wrong preservation:</span></td>
        </tr>
        <tr>
          <td id="L1283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1283"></td>
          <td id="LC1283" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        dum_sed_pres_fracC = (loc_POC1_conc_zinf+loc_POC2_conc_zinf+dum_POC3_conc_swi)/(dum_POC1_conc_swi+dum_POC2_conc_swi+dum_POC3_conc_swi) !+const_real_nullsmall)</span></td>
        </tr>
        <tr>
          <td id="L1284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1284"></td>
          <td id="LC1284" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1285"></td>
          <td id="LC1285" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*, &#39;dum_sed_pres_fracC&#39;, dum_sed_pres_fracC</span></td>
        </tr>
        <tr>
          <td id="L1286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1286"></td>
          <td id="LC1286" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1287"></td>
          <td id="LC1287" class="blob-code blob-code-inner js-file-line">        dum_sed_OM_wtpc_bot <span class="pl-k">=</span> <span class="pl-c1">100.0</span><span class="pl-k">*</span><span class="pl-c1">12.0</span><span class="pl-k">/</span>rho_sed<span class="pl-k">*</span>(loc_POC1_conc_zinf<span class="pl-k">+</span>loc_POC2_conc_zinf<span class="pl-k">+</span>dum_POC3_conc_swi)</td>
        </tr>
        <tr>
          <td id="L1288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1288"></td>
          <td id="LC1288" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1289"></td>
          <td id="LC1289" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>       ! this catches too many cases, sometimes A2i is large but Corg preservation can still be calculated</span></td>
        </tr>
        <tr>
          <td id="L1290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1290"></td>
          <td id="LC1290" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        if(abs(A21) .GE. 1/const_real_nullsmall .OR. abs(A22) .GE. 1/const_real_nullsmall)then</span></td>
        </tr>
        <tr>
          <td id="L1291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1291"></td>
          <td id="LC1291" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            dum_sed_pres_insane = .TRUE.</span></td>
        </tr>
        <tr>
          <td id="L1292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1292"></td>
          <td id="LC1292" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;1. dum_sed_pres_insane, A21 or A22 HUGE: abs(A21), abs(A22) &#39;, abs(A21), abs(A22), dum_D</span></td>
        </tr>
        <tr>
          <td id="L1293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1293"></td>
          <td id="LC1293" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L1294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1294"></td>
          <td id="LC1294" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1295"></td>
          <td id="LC1295" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1296"></td>
          <td id="LC1296" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC2&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L1297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1297"></td>
          <td id="LC1297" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L1298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1298"></td>
          <td id="LC1298" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1299"></td>
          <td id="LC1299" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1300"></td>
          <td id="LC1300" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_zTOC</span></td>
        </tr>
        <tr>
          <td id="L1301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1301"></td>
          <td id="LC1301" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1302"></td>
          <td id="LC1302" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1303"></td>
          <td id="LC1303" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1304"></td>
          <td id="LC1304" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1305"></td>
          <td id="LC1305" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1306"></td>
          <td id="LC1306" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1307"></td>
          <td id="LC1307" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1308"></td>
          <td id="LC1308" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                               Oxygen</span></td>
        </tr>
        <tr>
          <td id="L1309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1309"></td>
          <td id="LC1309" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1310"></td>
          <td id="LC1310" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1311"></td>
          <td id="LC1311" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1312"></td>
          <td id="LC1312" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1313"></td>
          <td id="LC1313" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1314"></td>
          <td id="LC1314" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zO2</span>(<span class="pl-v">dum_D</span>, <span class="pl-v">dum_swiconc_O2</span>, <span class="pl-v">loc_new_swiflux_O2</span>)</td>
        </tr>
        <tr>
          <td id="L1315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1315"></td>
          <td id="LC1315" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1316"></td>
          <td id="LC1316" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L1317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1317"></td>
          <td id="LC1317" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        integer,intent(in) :: dum_i, dum_j                      ! grid point (i,j)</span></td>
        </tr>
        <tr>
          <td id="L1318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1318"></td>
          <td id="LC1318" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_D                      <span class="pl-c"><span class="pl-c">!</span> ocean depth (m) +vs downwards</span></td>
        </tr>
        <tr>
          <td id="L1319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1319"></td>
          <td id="LC1319" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_O2          <span class="pl-c"><span class="pl-c">!</span> O2 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L1320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1320"></td>
          <td id="LC1320" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_O2      <span class="pl-c"><span class="pl-c">!</span> O2 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L1321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1321"></td>
          <td id="LC1321" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1322"></td>
          <td id="LC1322" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L1323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1323"></td>
          <td id="LC1323" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> flxzox, conczox, loc_conczinf, fun0, zL, tol</td>
        </tr>
        <tr>
          <td id="L1324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1324"></td>
          <td id="LC1324" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> bctype</td>
        </tr>
        <tr>
          <td id="L1325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1325"></td>
          <td id="LC1325" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1326"></td>
          <td id="LC1326" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1327"></td>
          <td id="LC1327" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1328"></td>
          <td id="LC1328" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;---------------------- START zO2 ------------------------ &#39;</span></td>
        </tr>
        <tr>
          <td id="L1329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1329"></td>
          <td id="LC1329" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;--- SWI O2 =&#39;, dum_swiconc_O2</span></td>
        </tr>
        <tr>
          <td id="L1330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1330"></td>
          <td id="LC1330" class="blob-code blob-code-inner js-file-line">        zox <span class="pl-k">=</span> <span class="pl-c1">1e-10</span></td>
        </tr>
        <tr>
          <td id="L1331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1331"></td>
          <td id="LC1331" class="blob-code blob-code-inner js-file-line">        flxzox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1332"></td>
          <td id="LC1332" class="blob-code blob-code-inner js-file-line">        conczox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1333"></td>
          <td id="LC1333" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1334"></td>
          <td id="LC1334" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_O2 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1335"></td>
          <td id="LC1335" class="blob-code blob-code-inner js-file-line">        fun0 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1336"></td>
          <td id="LC1336" class="blob-code blob-code-inner js-file-line">        zL <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1337"></td>
          <td id="LC1337" class="blob-code blob-code-inner js-file-line">        tol <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1338"></td>
          <td id="LC1338" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        flxswi = 0.0</span></td>
        </tr>
        <tr>
          <td id="L1339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1339"></td>
          <td id="LC1339" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1340"></td>
          <td id="LC1340" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    call sub_huelseetal2016_zO2_calcbc(zox, bctype, flxzox, conczox, flxswi, r_zxf)</span></td>
        </tr>
        <tr>
          <td id="L1341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1341"></td>
          <td id="LC1341" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1342"></td>
          <td id="LC1342" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    fun0 = flxzox + calcFO2(zox)</span></td>
        </tr>
        <tr>
          <td id="L1343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1343"></td>
          <td id="LC1343" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;!!!!!!!!!!!! fun0&#39;, fun0</span></td>
        </tr>
        <tr>
          <td id="L1344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1344"></td>
          <td id="LC1344" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1345"></td>
          <td id="LC1345" class="blob-code blob-code-inner js-file-line">        fun0 <span class="pl-k">=</span> FUN_zO2(zox)</td>
        </tr>
        <tr>
          <td id="L1346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1346"></td>
          <td id="LC1346" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; fun0&#39;, fun0</span></td>
        </tr>
        <tr>
          <td id="L1347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1347"></td>
          <td id="LC1347" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1348"></td>
          <td id="LC1348" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1349"></td>
          <td id="LC1349" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;Try zero flux at zinf and see if we have any O2 left&#39;</span></td>
        </tr>
        <tr>
          <td id="L1350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1350"></td>
          <td id="LC1350" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Try zero flux at zinf and see if we have any O2 left</span></td>
        </tr>
        <tr>
          <td id="L1351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1351"></td>
          <td id="LC1351" class="blob-code blob-code-inner js-file-line">        bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1352"></td>
          <td id="LC1352" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;Try zero flux at zinf: &#39;</span></td>
        </tr>
        <tr>
          <td id="L1353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1353"></td>
          <td id="LC1353" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zO2_calcbc(dum_D, zinf, bctype, flxzox, loc_conczinf, loc_new_swiflux_O2, r_zxf);</td>
        </tr>
        <tr>
          <td id="L1354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1354"></td>
          <td id="LC1354" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;flxzox&#39;, flxzox</span></td>
        </tr>
        <tr>
          <td id="L1355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1355"></td>
          <td id="LC1355" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;conczox at zinf &#39;, conczox</span></td>
        </tr>
        <tr>
          <td id="L1356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1356"></td>
          <td id="LC1356" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;flxswi&#39;, flxswi</span></td>
        </tr>
        <tr>
          <td id="L1357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1357"></td>
          <td id="LC1357" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1358"></td>
          <td id="LC1358" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (fun0 <span class="pl-k">.ge.</span> <span class="pl-c1">0.0</span>)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> eg zero oxygen at swi</span></td>
        </tr>
        <tr>
          <td id="L1359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1359"></td>
          <td id="LC1359" class="blob-code blob-code-inner js-file-line">            zox <span class="pl-k">=</span> <span class="pl-c1">0.0</span>   <span class="pl-c"><span class="pl-c">!</span> DH 241016 was 1e-10</span></td>
        </tr>
        <tr>
          <td id="L1360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1360"></td>
          <td id="LC1360" class="blob-code blob-code-inner js-file-line">            bctype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L1361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1361"></td>
          <td id="LC1361" class="blob-code blob-code-inner js-file-line">            loc_conczinf <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1362"></td>
          <td id="LC1362" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">elseif</span> (loc_conczinf <span class="pl-k">.ge.</span> <span class="pl-c1">0.0</span>)<span class="pl-k">then</span>      <span class="pl-c"><span class="pl-c">!</span> still O2 at zinf -&gt; zox = zinf</span></td>
        </tr>
        <tr>
          <td id="L1363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1363"></td>
          <td id="LC1363" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;in here mate: dum_i, dum_j &#39;, dum_i, dum_j</span></td>
        </tr>
        <tr>
          <td id="L1364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1364"></td>
          <td id="LC1364" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;dum_POC1_conc_swi &#39;, dum_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L1365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1365"></td>
          <td id="LC1365" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;dum_POC2_conc_swi &#39;, dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L1366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1366"></td>
          <td id="LC1366" class="blob-code blob-code-inner js-file-line">            zox <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1367"></td>
          <td id="LC1367" class="blob-code blob-code-inner js-file-line">            zno3 <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1368"></td>
          <td id="LC1368" class="blob-code blob-code-inner js-file-line">            bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1369"></td>
          <td id="LC1369" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>                        <span class="pl-c"><span class="pl-c">!</span> search zox in the interval</span></td>
        </tr>
        <tr>
          <td id="L1370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1370"></td>
          <td id="LC1370" class="blob-code blob-code-inner js-file-line">            bctype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L1371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1371"></td>
          <td id="LC1371" class="blob-code blob-code-inner js-file-line">            zL<span class="pl-k">=</span><span class="pl-c1">1e-10</span></td>
        </tr>
        <tr>
          <td id="L1372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1372"></td>
          <td id="LC1372" class="blob-code blob-code-inner js-file-line">            tol<span class="pl-k">=</span><span class="pl-c1">1e-16</span></td>
        </tr>
        <tr>
          <td id="L1373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1373"></td>
          <td id="LC1373" class="blob-code blob-code-inner js-file-line">            zox <span class="pl-k">=</span> FUN_zbrent(FUN_zO2, zL, zinf, tol)</td>
        </tr>
        <tr>
          <td id="L1374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1374"></td>
          <td id="LC1374" class="blob-code blob-code-inner js-file-line">            zno3 <span class="pl-k">=</span> zox</td>
        </tr>
        <tr>
          <td id="L1375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1375"></td>
          <td id="LC1375" class="blob-code blob-code-inner js-file-line">            loc_conczinf <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1376"></td>
          <td id="LC1376" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            stop</span></td>
        </tr>
        <tr>
          <td id="L1377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1377"></td>
          <td id="LC1377" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1378"></td>
          <td id="LC1378" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1379"></td>
          <td id="LC1379" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zO2_calcbc(dum_D, zox, bctype, flxzox, conczox, loc_new_swiflux_O2, r_zxf)</td>
        </tr>
        <tr>
          <td id="L1380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1380"></td>
          <td id="LC1380" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1381"></td>
          <td id="LC1381" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_O2 <span class="pl-k">=</span> loc_new_swiflux_O2 <span class="pl-k">-</span> por<span class="pl-k">*</span>w<span class="pl-k">*</span>(dum_swiconc_O2<span class="pl-k">-</span>loc_conczinf)</td>
        </tr>
        <tr>
          <td id="L1382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1382"></td>
          <td id="LC1382" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; loc_new_swiflux_O2&#39;, loc_new_swiflux_O2</span></td>
        </tr>
        <tr>
          <td id="L1383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1383"></td>
          <td id="LC1383" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; dum_swiconc_O2&#39;, dum_swiconc_O2</span></td>
        </tr>
        <tr>
          <td id="L1384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1384"></td>
          <td id="LC1384" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; loc_conczinf&#39;, loc_conczinf</span></td>
        </tr>
        <tr>
          <td id="L1385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1385"></td>
          <td id="LC1385" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;---------- FINAL RESULTS zO2 --------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L1386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1386"></td>
          <td id="LC1386" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zox &#39;, char(9), zox</span></td>
        </tr>
        <tr>
          <td id="L1387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1387"></td>
          <td id="LC1387" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;r_zxf&#39;, char(9), r_zxf</span></td>
        </tr>
        <tr>
          <td id="L1388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1388"></td>
          <td id="LC1388" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1389"></td>
          <td id="LC1389" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flxzox&#39;, char(9), flxzox</span></td>
        </tr>
        <tr>
          <td id="L1390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1390"></td>
          <td id="LC1390" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;conczox&#39;, char(9), conczox</span></td>
        </tr>
        <tr>
          <td id="L1391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1391"></td>
          <td id="LC1391" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_new_swiflux_O2&#39;, char(9), loc_new_swiflux_O2</span></td>
        </tr>
        <tr>
          <td id="L1392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1392"></td>
          <td id="LC1392" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1393"></td>
          <td id="LC1393" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1394"></td>
          <td id="LC1394" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zO2</span></td>
        </tr>
        <tr>
          <td id="L1395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1395"></td>
          <td id="LC1395" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1396"></td>
          <td id="LC1396" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1397"></td>
          <td id="LC1397" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1398"></td>
          <td id="LC1398" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1399"></td>
          <td id="LC1399" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1400"></td>
          <td id="LC1400" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1401"></td>
          <td id="LC1401" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zO2_calcbc</span>(<span class="pl-v">dum_D</span>, <span class="pl-v">zox</span>, <span class="pl-v">bctype</span>, <span class="pl-v">flxzox</span>, <span class="pl-v">conczox</span>, <span class="pl-v">flxswi</span>,<span class="pl-v">r_zxf</span>)</td>
        </tr>
        <tr>
          <td id="L1402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1402"></td>
          <td id="LC1402" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1403"></td>
          <td id="LC1403" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   Solve O2</span></td>
        </tr>
        <tr>
          <td id="L1404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1404"></td>
          <td id="LC1404" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_D                      <span class="pl-c"><span class="pl-c">!</span> ocean depth (m) +vs downwards</span></td>
        </tr>
        <tr>
          <td id="L1405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1405"></td>
          <td id="LC1405" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>zox</td>
        </tr>
        <tr>
          <td id="L1406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1406"></td>
          <td id="LC1406" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        real, intent(in)::loc_swiconc_O2</span></td>
        </tr>
        <tr>
          <td id="L1407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1407"></td>
          <td id="LC1407" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span>, <span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>bctype</td>
        </tr>
        <tr>
          <td id="L1408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1408"></td>
          <td id="LC1408" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>flxzox, conczox, flxswi, r_zxf</td>
        </tr>
        <tr>
          <td id="L1409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1409"></td>
          <td id="LC1409" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   local variables</span></td>
        </tr>
        <tr>
          <td id="L1410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1410"></td>
          <td id="LC1410" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1411"></td>
          <td id="LC1411" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real qdispO2                          !O2 diffusion coefficient in water (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1412"></td>
          <td id="LC1412" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real adispO2                          !O2 linear coefficient for temperature dependence (cm2/yr/oC)</span></td>
        </tr>
        <tr>
          <td id="L1413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1413"></td>
          <td id="LC1413" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real DO21                             !O2 diffusion coefficient in bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1414"></td>
          <td id="LC1414" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real DO22                             !O2 diffusion coefficient in non-bioturbated layer (cm2/yr)</span></td>
        </tr>
        <tr>
          <td id="L1415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1415"></td>
          <td id="LC1415" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1, reac2 <span class="pl-c"><span class="pl-c">!</span>ls , z0, zox</span></td>
        </tr>
        <tr>
          <td id="L1416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1416"></td>
          <td id="LC1416" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype</td>
        </tr>
        <tr>
          <td id="L1417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1417"></td>
          <td id="LC1417" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</td>
        </tr>
        <tr>
          <td id="L1418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1418"></td>
          <td id="LC1418" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_0, dedz_0, f_0, dfdz_0, g_0, dgdz_0</td>
        </tr>
        <tr>
          <td id="L1419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1419"></td>
          <td id="LC1419" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zox, dedz_zox, f_zox, dfdz_zox, g_zox, dgdz_zox</td>
        </tr>
        <tr>
          <td id="L1420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1420"></td>
          <td id="LC1420" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real bctype1_AO2, bctype1_BO2, bctype2_AO2, bctype2_BO2</span></td>
        </tr>
        <tr>
          <td id="L1421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1421"></td>
          <td id="LC1421" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1422"></td>
          <td id="LC1422" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rO2_AO2, rO2_BO2, Dzox, Dswi</td>
        </tr>
        <tr>
          <td id="L1423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1423"></td>
          <td id="LC1423" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1424"></td>
          <td id="LC1424" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real FO2</span></td>
        </tr>
        <tr>
          <td id="L1425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1425"></td>
          <td id="LC1425" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1426"></td>
          <td id="LC1426" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    qdispO2=348.5750</span></td>
        </tr>
        <tr>
          <td id="L1427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1427"></td>
          <td id="LC1427" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    adispO2=14.0890</span></td>
        </tr>
        <tr>
          <td id="L1428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1428"></td>
          <td id="LC1428" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1429"></td>
          <td id="LC1429" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    DO21=(qdispO2+adispO2*T)*dispFactor+Dbio</span></td>
        </tr>
        <tr>
          <td id="L1430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1430"></td>
          <td id="LC1430" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    DO22=(qdispO2+adispO2*T)*dispFactor</span></td>
        </tr>
        <tr>
          <td id="L1431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1431"></td>
          <td id="LC1431" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1432"></td>
          <td id="LC1432" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1433"></td>
          <td id="LC1433" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   reactive terms: OM degradation (-) and nitrification (-)</span></td>
        </tr>
        <tr>
          <td id="L1434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1434"></td>
          <td id="LC1434" class="blob-code blob-code-inner js-file-line">        reac1<span class="pl-k">=-</span>OC<span class="pl-c1">-2</span><span class="pl-k">*</span>gamma<span class="pl-k">*</span>NC1</td>
        </tr>
        <tr>
          <td id="L1435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1435"></td>
          <td id="LC1435" class="blob-code blob-code-inner js-file-line">        reac2<span class="pl-k">=-</span>OC<span class="pl-c1">-2</span><span class="pl-k">*</span>gamma<span class="pl-k">*</span>NC2</td>
        </tr>
        <tr>
          <td id="L1436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1436"></td>
          <td id="LC1436" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1437"></td>
          <td id="LC1437" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1438"></td>
          <td id="LC1438" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------- START sub_huelseetal2016_zO2_calcbc ----- zox:&#39;, zox</span></td>
        </tr>
        <tr>
          <td id="L1439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1439"></td>
          <td id="LC1439" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1440"></td>
          <td id="LC1440" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate solution for given zox</span></td>
        </tr>
        <tr>
          <td id="L1441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1441"></td>
          <td id="LC1441" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1442"></td>
          <td id="LC1442" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;Preparation: sort out solution-matching across bioturbation boundary (if necessary)&#39;</span></td>
        </tr>
        <tr>
          <td id="L1443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1443"></td>
          <td id="LC1443" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: sort out solution-matching across bioturbation boundary (if necessary)</span></td>
        </tr>
        <tr>
          <td id="L1444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1444"></td>
          <td id="LC1444" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac1, reac2, <span class="pl-c1">0.0</span>, z0, zox, DO21, DO22, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, ltype)</td>
        </tr>
        <tr>
          <td id="L1445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1445"></td>
          <td id="LC1445" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1446"></td>
          <td id="LC1446" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at upper boundary</span></td>
        </tr>
        <tr>
          <td id="L1447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1447"></td>
          <td id="LC1447" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;z0, reac1, reac2 &#39;, z0, reac1, reac2</span></td>
        </tr>
        <tr>
          <td id="L1448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1448"></td>
          <td id="LC1448" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, DO21, DO22&#39;, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, DO21, DO22</span></td>
        </tr>
        <tr>
          <td id="L1449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1449"></td>
          <td id="LC1449" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;ltype, DO21, DO22, ltype&#39;, ltype, DO21, DO22, ltype</span></td>
        </tr>
        <tr>
          <td id="L1450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1450"></td>
          <td id="LC1450" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(z0, reac1, reac2, <span class="pl-c1">0.0</span>, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, DO21, DO22, ltype, &amp;</td>
        </tr>
        <tr>
          <td id="L1451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1451"></td>
          <td id="LC1451" class="blob-code blob-code-inner js-file-line">        e_0, dedz_0, f_0, dfdz_0, g_0, dgdz_0)</td>
        </tr>
        <tr>
          <td id="L1452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1452"></td>
          <td id="LC1452" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1453"></td>
          <td id="LC1453" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and lower boundary</span></td>
        </tr>
        <tr>
          <td id="L1454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1454"></td>
          <td id="LC1454" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, reac1, reac2, <span class="pl-c1">0.0</span>, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, DO21, DO22, ltype, e_zox, dedz_zox,&amp;</td>
        </tr>
        <tr>
          <td id="L1455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1455"></td>
          <td id="LC1455" class="blob-code blob-code-inner js-file-line">        f_zox, dfdz_zox, g_zox, dgdz_zox)</td>
        </tr>
        <tr>
          <td id="L1456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1456"></td>
          <td id="LC1456" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1457"></td>
          <td id="LC1457" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for AO2, BO2 given boundary conditions (expressed in terms of transformed soln)</span></td>
        </tr>
        <tr>
          <td id="L1458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1458"></td>
          <td id="LC1458" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1459"></td>
          <td id="LC1459" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(bctype<span class="pl-k">==</span><span class="pl-c1">1</span>)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1460"></td>
          <td id="LC1460" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Case 1 zero concentration at zox</span></td>
        </tr>
        <tr>
          <td id="L1461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1461"></td>
          <td id="LC1461" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> AO2*e_zox   +   BO2*f_zox  + g_zox = 0;</span></td>
        </tr>
        <tr>
          <td id="L1462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1462"></td>
          <td id="LC1462" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> AO2*e_0     +   BO2*f_0     + g_0  = swi.O20;</span></td>
        </tr>
        <tr>
          <td id="L1463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1463"></td>
          <td id="LC1463" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1464"></td>
          <td id="LC1464" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> | e_zox f_zox |  |AO2|   = | -g_zox         |</span></td>
        </tr>
        <tr>
          <td id="L1465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1465"></td>
          <td id="LC1465" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> | e_0   f_0   |  |BO2|     | swi.O20 - gt_0 |</span></td>
        </tr>
        <tr>
          <td id="L1466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1466"></td>
          <td id="LC1466" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1467"></td>
          <td id="LC1467" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_solve2eqn(e_zox, f_zox, e_0, f_0, <span class="pl-k">-</span>g_zox, dum_swiconc_O2 <span class="pl-k">-</span> g_0, rO2_AO2, rO2_BO2)</td>
        </tr>
        <tr>
          <td id="L1468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1468"></td>
          <td id="LC1468" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1469"></td>
          <td id="LC1469" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Case  2 zero flux at zox</span></td>
        </tr>
        <tr>
          <td id="L1470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1470"></td>
          <td id="LC1470" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> AO2*dedz_zox +  BO2*dfz_zox + dgz_zox = 0;</span></td>
        </tr>
        <tr>
          <td id="L1471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1471"></td>
          <td id="LC1471" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> AO2*e_0     +   BO2*f_0     + g_0     = swi.O20;</span></td>
        </tr>
        <tr>
          <td id="L1472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1472"></td>
          <td id="LC1472" class="blob-code blob-code-inner js-file-line">                         <span class="pl-c"><span class="pl-c">!</span> a            b       c   d       e           f</span></td>
        </tr>
        <tr>
          <td id="L1473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1473"></td>
          <td id="LC1473" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;dedz_zox, dfdz_zox, e_0, f_0, -dgdz_zox, dum_swiconc_O2 - g_0:&#39;, dedz_zox, dfdz_zox, e_0, f_0, -dgdz_zox, dum_swiconc_O2 - g_0</span></td>
        </tr>
        <tr>
          <td id="L1474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1474"></td>
          <td id="LC1474" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;dum_swiconc_O2, g_0:&#39;, dum_swiconc_O2, g_0</span></td>
        </tr>
        <tr>
          <td id="L1475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1475"></td>
          <td id="LC1475" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_solve2eqn(dedz_zox, dfdz_zox, e_0, f_0, <span class="pl-k">-</span>dgdz_zox, dum_swiconc_O2 <span class="pl-k">-</span> g_0, rO2_AO2, rO2_BO2)</td>
        </tr>
        <tr>
          <td id="L1476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1476"></td>
          <td id="LC1476" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1477"></td>
          <td id="LC1477" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1478"></td>
          <td id="LC1478" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox &lt; zbio)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1479"></td>
          <td id="LC1479" class="blob-code blob-code-inner js-file-line">            Dzox <span class="pl-k">=</span> DO21</td>
        </tr>
        <tr>
          <td id="L1480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1480"></td>
          <td id="LC1480" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1481"></td>
          <td id="LC1481" class="blob-code blob-code-inner js-file-line">            Dzox <span class="pl-k">=</span> DO22</td>
        </tr>
        <tr>
          <td id="L1482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1482"></td>
          <td id="LC1482" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1483"></td>
          <td id="LC1483" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1484"></td>
          <td id="LC1484" class="blob-code blob-code-inner js-file-line">        flxzox <span class="pl-k">=</span>  Dzox<span class="pl-k">*</span>(rO2_AO2<span class="pl-k">*</span>dedz_zox <span class="pl-k">+</span> rO2_BO2<span class="pl-k">*</span>dfdz_zox <span class="pl-k">+</span> dgdz_zox)         <span class="pl-c"><span class="pl-c">!</span> no por factor as this is per cm^2 pore area</span></td>
        </tr>
        <tr>
          <td id="L1485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1485"></td>
          <td id="LC1485" class="blob-code blob-code-inner js-file-line">        conczox <span class="pl-k">=</span> rO2_AO2<span class="pl-k">*</span>e_zox <span class="pl-k">+</span> rO2_BO2 <span class="pl-k">*</span> f_zox <span class="pl-k">+</span> g_zox</td>
        </tr>
        <tr>
          <td id="L1486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1486"></td>
          <td id="LC1486" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;conczox:&#39;, conczox</span></td>
        </tr>
        <tr>
          <td id="L1487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1487"></td>
          <td id="LC1487" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox:&#39;, rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox</span></td>
        </tr>
        <tr>
          <td id="L1488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1488"></td>
          <td id="LC1488" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1489"></td>
          <td id="LC1489" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(<span class="pl-c1">0</span> &lt; zbio)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L1490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1490"></td>
          <td id="LC1490" class="blob-code blob-code-inner js-file-line">            Dswi <span class="pl-k">=</span> DO21</td>
        </tr>
        <tr>
          <td id="L1491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1491"></td>
          <td id="LC1491" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1492"></td>
          <td id="LC1492" class="blob-code blob-code-inner js-file-line">            Dswi <span class="pl-k">=</span> DO22</td>
        </tr>
        <tr>
          <td id="L1493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1493"></td>
          <td id="LC1493" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1494"></td>
          <td id="LC1494" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1495"></td>
          <td id="LC1495" class="blob-code blob-code-inner js-file-line">        flxswi <span class="pl-k">=</span> por<span class="pl-k">*</span>(Dswi<span class="pl-k">*</span>(rO2_AO2<span class="pl-k">*</span>dedz_0<span class="pl-k">+</span>rO2_BO2<span class="pl-k">*</span>dfdz_0 <span class="pl-k">+</span> dgdz_0)) <span class="pl-c"><span class="pl-c">!</span> just diffusive flux - w*dum_swiconc_O2)   ! por fac so this is per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L1496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1496"></td>
          <td id="LC1496" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1497"></td>
          <td id="LC1497" class="blob-code blob-code-inner js-file-line">        r_zxf <span class="pl-k">=</span> zox<span class="pl-k">/</span>(zoxgf <span class="pl-k">+</span> zox) <span class="pl-c"><span class="pl-c">!</span> + const_real_nullsmall)   ! roll off oxidation at low zox</span></td>
        </tr>
        <tr>
          <td id="L1498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1498"></td>
          <td id="LC1498" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> TODO: ASK STUART or ANDY</span></td>
        </tr>
        <tr>
          <td id="L1499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1499"></td>
          <td id="LC1499" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>( &amp;</td>
        </tr>
        <tr>
          <td id="L1500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1500"></td>
          <td id="LC1500" class="blob-code blob-code-inner js-file-line">        (flxzox <span class="pl-k">/=</span> flxzox) <span class="pl-k">.OR.</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1501"></td>
          <td id="LC1501" class="blob-code blob-code-inner js-file-line">        (conczox <span class="pl-k">/=</span> conczox) <span class="pl-k">.OR.</span> &amp;</td>
        </tr>
        <tr>
          <td id="L1502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1502"></td>
          <td id="LC1502" class="blob-code blob-code-inner js-file-line">        (flxswi <span class="pl-k">/=</span> flxswi)) <span class="pl-k">then</span> <span class="pl-c"><span class="pl-c">!</span>check for NaN if then give value as in matlab.....</span></td>
        </tr>
        <tr>
          <td id="L1503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1503"></td>
          <td id="LC1503" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> <span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1504"></td>
          <td id="LC1504" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> <span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1505"></td>
          <td id="LC1505" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>------ zO2_calcbc --------- flxzox is INFFFFFFFFFFFFFFFF<span class="pl-pds">&#39;</span></span>, dum_D</td>
        </tr>
        <tr>
          <td id="L1506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1506"></td>
          <td id="LC1506" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> zox tested<span class="pl-pds">&#39;</span></span>, zox</td>
        </tr>
        <tr>
          <td id="L1507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1507"></td>
          <td id="LC1507" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>flxzox <span class="pl-pds">&#39;</span></span>, flxzox</td>
        </tr>
        <tr>
          <td id="L1508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1508"></td>
          <td id="LC1508" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>conczox <span class="pl-pds">&#39;</span></span>, conczox</td>
        </tr>
        <tr>
          <td id="L1509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1509"></td>
          <td id="LC1509" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>flxswi <span class="pl-pds">&#39;</span></span>, flxswi</td>
        </tr>
        <tr>
          <td id="L1510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1510"></td>
          <td id="LC1510" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>dum_swiconc_O2 <span class="pl-pds">&#39;</span></span>, dum_swiconc_O2</td>
        </tr>
        <tr>
          <td id="L1511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1511"></td>
          <td id="LC1511" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;Dzox, rO2_AO2, dedz_zox, rO2_BO2, dfdz_zox, dgdz_zox&#39;, Dzox, rO2_AO2, dedz_zox, rO2_BO2, dfdz_zox, dgdz_zox</span></td>
        </tr>
        <tr>
          <td id="L1512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1512"></td>
          <td id="LC1512" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox&#39;, rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox</span></td>
        </tr>
        <tr>
          <td id="L1513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1513"></td>
          <td id="LC1513" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span> <span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1514"></td>
          <td id="LC1514" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1515"></td>
          <td id="LC1515" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            IF(bctype==1)THEN</span></td>
        </tr>
        <tr>
          <td id="L1516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1516"></td>
          <td id="LC1516" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; 1: solve2eqn(e_zox, f_zox, e_0, f_0, -g_zox, dum_swiconc_O2, -g_0&#39;, e_zox, f_zox, e_0, f_0, -g_zox, dum_swiconc_O2, -g_0</span></td>
        </tr>
        <tr>
          <td id="L1517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1517"></td>
          <td id="LC1517" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        ELSE</span></td>
        </tr>
        <tr>
          <td id="L1518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1518"></td>
          <td id="LC1518" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>             print*,&#39; 2: solve2eqn(dedz_zox, dfdz_zox, e_0, f_0, -dgdz_zox, dum_swiconc_O2, - g_0&#39;, dedz_zox, dfdz_zox, e_0, f_0, -dgdz_zox, dum_swiconc_O2, - g_0</span></td>
        </tr>
        <tr>
          <td id="L1519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1519"></td>
          <td id="LC1519" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        END IF</span></td>
        </tr>
        <tr>
          <td id="L1520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1520"></td>
          <td id="LC1520" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            flxzox = 0.0</span></td>
        </tr>
        <tr>
          <td id="L1521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1521"></td>
          <td id="LC1521" class="blob-code blob-code-inner js-file-line">            conczox <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L1522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1522"></td>
          <td id="LC1522" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            flxswi = 0.0</span></td>
        </tr>
        <tr>
          <td id="L1523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1523"></td>
          <td id="LC1523" class="blob-code blob-code-inner js-file-line">            flxzox <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L1524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1524"></td>
          <td id="LC1524" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            stop</span></td>
        </tr>
        <tr>
          <td id="L1525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1525"></td>
          <td id="LC1525" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L1526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1526"></td>
          <td id="LC1526" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1527"></td>
          <td id="LC1527" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        if(flxswi /= flxswi)then !check for NaN if then give value as in matlab.....</span></td>
        </tr>
        <tr>
          <td id="L1528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1528"></td>
          <td id="LC1528" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1529"></td>
          <td id="LC1529" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1530"></td>
          <td id="LC1530" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;------ zO2_calcbc --------- flxswi is INFFFFFFFFFFFFFFFF&#39;, dum_D</span></td>
        </tr>
        <tr>
          <td id="L1531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1531"></td>
          <td id="LC1531" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flxzox &#39;, flxzox</span></td>
        </tr>
        <tr>
          <td id="L1532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1532"></td>
          <td id="LC1532" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;conczox &#39;, conczox</span></td>
        </tr>
        <tr>
          <td id="L1533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1533"></td>
          <td id="LC1533" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flxswi &#39;, flxswi</span></td>
        </tr>
        <tr>
          <td id="L1534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1534"></td>
          <td id="LC1534" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1535"></td>
          <td id="LC1535" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1536"></td>
          <td id="LC1536" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            flxswi = 0.0</span></td>
        </tr>
        <tr>
          <td id="L1537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1537"></td>
          <td id="LC1537" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            flxzox = -1.2e6</span></td>
        </tr>
        <tr>
          <td id="L1538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1538"></td>
          <td id="LC1538" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            conczox = -1.2e6</span></td>
        </tr>
        <tr>
          <td id="L1539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1539"></td>
          <td id="LC1539" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            stop</span></td>
        </tr>
        <tr>
          <td id="L1540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1540"></td>
          <td id="LC1540" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L1541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1541"></td>
          <td id="LC1541" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1542"></td>
          <td id="LC1542" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    FO2 = calcFO2()</span></td>
        </tr>
        <tr>
          <td id="L1543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1543"></td>
          <td id="LC1543" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1544"></td>
          <td id="LC1544" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;END zO2_calcbc: flxzox&#39;, flxzox</span></td>
        </tr>
        <tr>
          <td id="L1545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1545"></td>
          <td id="LC1545" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;conczox&#39;, conczox</span></td>
        </tr>
        <tr>
          <td id="L1546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1546"></td>
          <td id="LC1546" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox&#39;, rO2_AO2, e_zox, rO2_BO2, f_zox, g_zox</span></td>
        </tr>
        <tr>
          <td id="L1547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1547"></td>
          <td id="LC1547" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1548"></td>
          <td id="LC1548" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_zO2_calcbc</span></td>
        </tr>
        <tr>
          <td id="L1549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1549"></td>
          <td id="LC1549" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1550"></td>
          <td id="LC1550" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L1551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1551"></td>
          <td id="LC1551" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1552"></td>
          <td id="LC1552" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1553"></td>
          <td id="LC1553" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1554"></td>
          <td id="LC1554" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1555"></td>
          <td id="LC1555" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_huelseetal2016_calcFO2</span>(<span class="pl-v">z</span>)</td>
        </tr>
        <tr>
          <td id="L1556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1556"></td>
          <td id="LC1556" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1557"></td>
          <td id="LC1557" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_huelseetal2016_calcFO2, z, tmpreac1, tmpreac2</td>
        </tr>
        <tr>
          <td id="L1558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1558"></td>
          <td id="LC1558" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1559"></td>
          <td id="LC1559" class="blob-code blob-code-inner js-file-line">        FUN_huelseetal2016_calcFO2 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1560"></td>
          <td id="LC1560" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Oxydation of reduced species at zox (NEED A RATIO for ODU! and add NH4</span></td>
        </tr>
        <tr>
          <td id="L1561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1561"></td>
          <td id="LC1561" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> adsporption!</span></td>
        </tr>
        <tr>
          <td id="L1562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1562"></td>
          <td id="LC1562" class="blob-code blob-code-inner js-file-line">        tmpreac1<span class="pl-k">=</span>gammaH2S<span class="pl-k">*</span>O2H2S<span class="pl-k">*</span>SO4C<span class="pl-c1">+2.0</span><span class="pl-k">*</span>gamma<span class="pl-k">*</span>NC1</td>
        </tr>
        <tr>
          <td id="L1563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1563"></td>
          <td id="LC1563" class="blob-code blob-code-inner js-file-line">        tmpreac2<span class="pl-k">=</span>gammaH2S<span class="pl-k">*</span>O2H2S<span class="pl-k">*</span>SO4C<span class="pl-c1">+2.0</span><span class="pl-k">*</span>gamma<span class="pl-k">*</span>NC2</td>
        </tr>
        <tr>
          <td id="L1564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1564"></td>
          <td id="LC1564" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1565"></td>
          <td id="LC1565" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1566"></td>
          <td id="LC1566" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;..... START calcFO2&#39;</span></td>
        </tr>
        <tr>
          <td id="L1567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1567"></td>
          <td id="LC1567" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1568"></td>
          <td id="LC1568" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>tmpreac1=OC+2*gamma*NC1</span></td>
        </tr>
        <tr>
          <td id="L1569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1569"></td>
          <td id="LC1569" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>tmpreac2=OC+2*gamma*NC2</span></td>
        </tr>
        <tr>
          <td id="L1570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1570"></td>
          <td id="LC1570" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>FLUX of NH4 and Reduced species from ZOX to ZINF</span></td>
        </tr>
        <tr>
          <td id="L1571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1571"></td>
          <td id="LC1571" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        FUN_huelseetal2016_calcFO2 = 0.0    ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L1572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1572"></td>
          <td id="LC1572" class="blob-code blob-code-inner js-file-line">        FUN_huelseetal2016_calcFO2 <span class="pl-k">=</span> z<span class="pl-k">/</span>(zoxgf <span class="pl-k">+</span> z) <span class="pl-k">*</span> FUN_calcReac(z, zinf, tmpreac1, tmpreac2)   <span class="pl-c"><span class="pl-c">!</span> had in denominator: ... + const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L1573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1573"></td>
          <td id="LC1573" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1574"></td>
          <td id="LC1574" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;calcFO2&#39;, calcFO2</span></td>
        </tr>
        <tr>
          <td id="L1575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1575"></td>
          <td id="LC1575" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1576"></td>
          <td id="LC1576" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_huelseetal2016_calcFO2</span></td>
        </tr>
        <tr>
          <td id="L1577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1577"></td>
          <td id="LC1577" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1578"></td>
          <td id="LC1578" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L1579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1579"></td>
          <td id="LC1579" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1580"></td>
          <td id="LC1580" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1581"></td>
          <td id="LC1581" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1582"></td>
          <td id="LC1582" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1583"></td>
          <td id="LC1583" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zO2</span>(<span class="pl-v">z</span>)</td>
        </tr>
        <tr>
          <td id="L1584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1584"></td>
          <td id="LC1584" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1585"></td>
          <td id="LC1585" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_zO2, z, flxzox, conczox, flxswi, r_zxf</td>
        </tr>
        <tr>
          <td id="L1586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1586"></td>
          <td id="LC1586" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> bctype</td>
        </tr>
        <tr>
          <td id="L1587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1587"></td>
          <td id="LC1587" class="blob-code blob-code-inner js-file-line">        flxzox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1588"></td>
          <td id="LC1588" class="blob-code blob-code-inner js-file-line">        conczox <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1589"></td>
          <td id="LC1589" class="blob-code blob-code-inner js-file-line">        flxswi <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1590"></td>
          <td id="LC1590" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1591"></td>
          <td id="LC1591" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;..... START FUN_zO2&#39;</span></td>
        </tr>
        <tr>
          <td id="L1592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1592"></td>
          <td id="LC1592" class="blob-code blob-code-inner js-file-line">        bctype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L1593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1593"></td>
          <td id="LC1593" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zO2_calcbc(<span class="pl-c1">9999.9</span>, z, bctype, flxzox, conczox, flxswi, r_zxf)</td>
        </tr>
        <tr>
          <td id="L1594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1594"></td>
          <td id="LC1594" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1595"></td>
          <td id="LC1595" class="blob-code blob-code-inner js-file-line">        FUN_zO2 <span class="pl-k">=</span> flxzox <span class="pl-k">+</span> FUN_huelseetal2016_calcFO2(z)</td>
        </tr>
        <tr>
          <td id="L1596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1596"></td>
          <td id="LC1596" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1597"></td>
          <td id="LC1597" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FUN_zO2, flxzox, calcFO2(z)&#39;, FUN_zO2, flxzox, calcFO2(z)</span></td>
        </tr>
        <tr>
          <td id="L1598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1598"></td>
          <td id="LC1598" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1599"></td>
          <td id="LC1599" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zO2</span></td>
        </tr>
        <tr>
          <td id="L1600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1600"></td>
          <td id="LC1600" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1601"></td>
          <td id="LC1601" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1602"></td>
          <td id="LC1602" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1603"></td>
          <td id="LC1603" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1604"></td>
          <td id="LC1604" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1605"></td>
          <td id="LC1605" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                       Nitrate</span></td>
        </tr>
        <tr>
          <td id="L1606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1606"></td>
          <td id="LC1606" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1607"></td>
          <td id="LC1607" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1608"></td>
          <td id="LC1608" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1609"></td>
          <td id="LC1609" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1610"></td>
          <td id="LC1610" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1611"></td>
          <td id="LC1611" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNO3</span>(<span class="pl-v">dum_swiconc_NO3</span>, <span class="pl-v">loc_new_swiflux_NO3</span>)</td>
        </tr>
        <tr>
          <td id="L1612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1612"></td>
          <td id="LC1612" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1613"></td>
          <td id="LC1613" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L1614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1614"></td>
          <td id="LC1614" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L1615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1615"></td>
          <td id="LC1615" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_NO3                <span class="pl-c"><span class="pl-c">!</span> NO3 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L1616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1616"></td>
          <td id="LC1616" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_NO3         <span class="pl-c"><span class="pl-c">!</span> NO3 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L1617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1617"></td>
          <td id="LC1617" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1618"></td>
          <td id="LC1618" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> flxzinf, conczinf, flxzno3, conczno3, zL, tol</td>
        </tr>
        <tr>
          <td id="L1619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1619"></td>
          <td id="LC1619" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> bctype</td>
        </tr>
        <tr>
          <td id="L1620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1620"></td>
          <td id="LC1620" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1621"></td>
          <td id="LC1621" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1622"></td>
          <td id="LC1622" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L1623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1623"></td>
          <td id="LC1623" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zNO3 ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L1624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1624"></td>
          <td id="LC1624" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1625"></td>
          <td id="LC1625" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Try zero flux at zinf and see if we have any NO3 left - in</span></td>
        </tr>
        <tr>
          <td id="L1626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1626"></td>
          <td id="LC1626" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the rare case of zox &lt; zinf but zNO3 = zinf, also</span></td>
        </tr>
        <tr>
          <td id="L1627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1627"></td>
          <td id="LC1627" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate [NO3] at zinf for advective loss</span></td>
        </tr>
        <tr>
          <td id="L1628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1628"></td>
          <td id="LC1628" class="blob-code blob-code-inner js-file-line">        bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1629"></td>
          <td id="LC1629" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zNO3_calcbc(zinf, bctype, flxzinf, conczinf, loc_new_swiflux_NO3)</td>
        </tr>
        <tr>
          <td id="L1630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1630"></td>
          <td id="LC1630" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1631"></td>
          <td id="LC1631" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox == zinf)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1632"></td>
          <td id="LC1632" class="blob-code blob-code-inner js-file-line">            zno3 <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1633"></td>
          <td id="LC1633" class="blob-code blob-code-inner js-file-line">            bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1634"></td>
          <td id="LC1634" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1635"></td>
          <td id="LC1635" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;RESULTS Try zero flux at zinf zNO3_calcbc flxzinf, conczinf, loc_new_swiflux_NO3&#39;, flxzinf, conczinf, loc_new_swiflux_NO3</span></td>
        </tr>
        <tr>
          <td id="L1636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1636"></td>
          <td id="LC1636" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1637"></td>
          <td id="LC1637" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">IF</span> (conczinf &gt; <span class="pl-c1">0.0</span>) <span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1638"></td>
          <td id="LC1638" class="blob-code blob-code-inner js-file-line">                zno3 <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1639"></td>
          <td id="LC1639" class="blob-code blob-code-inner js-file-line">                bctype <span class="pl-k">=</span> <span class="pl-c1">2</span>;</td>
        </tr>
        <tr>
          <td id="L1640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1640"></td>
          <td id="LC1640" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1641"></td>
          <td id="LC1641" class="blob-code blob-code-inner js-file-line">                zL<span class="pl-k">=</span><span class="pl-c1">1e-10</span></td>
        </tr>
        <tr>
          <td id="L1642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1642"></td>
          <td id="LC1642" class="blob-code blob-code-inner js-file-line">                tol<span class="pl-k">=</span><span class="pl-c1">1e-16</span></td>
        </tr>
        <tr>
          <td id="L1643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1643"></td>
          <td id="LC1643" class="blob-code blob-code-inner js-file-line">                zno3 <span class="pl-k">=</span> FUN_zbrent(FUN_zNO3, <span class="pl-k">max</span>(zL,zox), zinf, tol)</td>
        </tr>
        <tr>
          <td id="L1644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1644"></td>
          <td id="LC1644" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;$$$$ calculated zno3 =&#39;, zno3</span></td>
        </tr>
        <tr>
          <td id="L1645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1645"></td>
          <td id="LC1645" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>        zno3 = 7.4319         ! use qualifier d0 fuer double: 7.4319d0</span></td>
        </tr>
        <tr>
          <td id="L1646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1646"></td>
          <td id="LC1646" class="blob-code blob-code-inner js-file-line">                bctype <span class="pl-k">=</span> <span class="pl-c1">1</span>;</td>
        </tr>
        <tr>
          <td id="L1647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1647"></td>
          <td id="LC1647" class="blob-code blob-code-inner js-file-line">                conczinf <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1648"></td>
          <td id="LC1648" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1649"></td>
          <td id="LC1649" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span> <span class="pl-c"><span class="pl-c">!</span> (zox == zinf)</span></td>
        </tr>
        <tr>
          <td id="L1650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1650"></td>
          <td id="LC1650" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1651"></td>
          <td id="LC1651" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zNO3_calcbc(zno3, bctype, flxzno3, conczno3, loc_new_swiflux_NO3)</td>
        </tr>
        <tr>
          <td id="L1652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1652"></td>
          <td id="LC1652" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_NO3 <span class="pl-k">=</span> loc_new_swiflux_NO3 <span class="pl-k">-</span> por<span class="pl-k">*</span>w<span class="pl-k">*</span>(dum_swiconc_NO3<span class="pl-k">-</span>conczinf)</td>
        </tr>
        <tr>
          <td id="L1653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1653"></td>
          <td id="LC1653" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1654"></td>
          <td id="LC1654" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        IF(ABS(loc_new_swiflux_NO3) .LE. const_real_nullsmall)then</span></td>
        </tr>
        <tr>
          <td id="L1655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1655"></td>
          <td id="LC1655" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            !            print*,&#39;small loc_new_swiflux_NO3&#39;, loc_new_swiflux_NO3</span></td>
        </tr>
        <tr>
          <td id="L1656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1656"></td>
          <td id="LC1656" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            loc_new_swiflux_NO3 = 0.0</span></td>
        </tr>
        <tr>
          <td id="L1657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1657"></td>
          <td id="LC1657" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        END IF</span></td>
        </tr>
        <tr>
          <td id="L1658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1658"></td>
          <td id="LC1658" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1659"></td>
          <td id="LC1659" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1660"></td>
          <td id="LC1660" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; ---- FINAL RESULTS zNO3: ----&#39;</span></td>
        </tr>
        <tr>
          <td id="L1661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1661"></td>
          <td id="LC1661" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;zno3&#39;, char(9), zno3</span></td>
        </tr>
        <tr>
          <td id="L1662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1662"></td>
          <td id="LC1662" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1663"></td>
          <td id="LC1663" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;flxzno3&#39;, char(9), flxzno3</span></td>
        </tr>
        <tr>
          <td id="L1664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1664"></td>
          <td id="LC1664" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;conczno3&#39;, char(9), conczno3</span></td>
        </tr>
        <tr>
          <td id="L1665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1665"></td>
          <td id="LC1665" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;loc_new_swiflux_NO3&#39;, char(9), loc_new_swiflux_NO3</span></td>
        </tr>
        <tr>
          <td id="L1666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1666"></td>
          <td id="LC1666" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1667"></td>
          <td id="LC1667" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNO3</span></td>
        </tr>
        <tr>
          <td id="L1668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1668"></td>
          <td id="LC1668" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1669"></td>
          <td id="LC1669" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1670"></td>
          <td id="LC1670" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1671"></td>
          <td id="LC1671" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1672"></td>
          <td id="LC1672" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1673"></td>
          <td id="LC1673" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1674"></td>
          <td id="LC1674" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1675"></td>
          <td id="LC1675" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNO3_calcbc</span>(<span class="pl-v">zNO3</span>, <span class="pl-v">bctype</span>, <span class="pl-v">flxzno3</span>, <span class="pl-v">conczno3</span>, <span class="pl-v">loc_new_swiflux_NO3</span>)</td>
        </tr>
        <tr>
          <td id="L1676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1676"></td>
          <td id="LC1676" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1677"></td>
          <td id="LC1677" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zNO3, flxzno3, conczNO3, loc_new_swiflux_NO3</td>
        </tr>
        <tr>
          <td id="L1678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1678"></td>
          <td id="LC1678" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> bctype, ltype1, ltype2</td>
        </tr>
        <tr>
          <td id="L1679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1679"></td>
          <td id="LC1679" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L1680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1680"></td>
          <td id="LC1680" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L1681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1681"></td>
          <td id="LC1681" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</td>
        </tr>
        <tr>
          <td id="L1682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1682"></td>
          <td id="LC1682" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox</td>
        </tr>
        <tr>
          <td id="L1683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1683"></td>
          <td id="LC1683" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox</td>
        </tr>
        <tr>
          <td id="L1684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1684"></td>
          <td id="LC1684" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</td>
        </tr>
        <tr>
          <td id="L1685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1685"></td>
          <td id="LC1685" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L1686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1686"></td>
          <td id="LC1686" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L1687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1687"></td>
          <td id="LC1687" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> bctype1_A2, bctype1_B2, bctype2_A2, bctype2_B2</td>
        </tr>
        <tr>
          <td id="L1688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1688"></td>
          <td id="LC1688" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rNO3_A2, rNO3_B2, rNO3_A1, rNO3_B1</td>
        </tr>
        <tr>
          <td id="L1689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1689"></td>
          <td id="LC1689" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1690"></td>
          <td id="LC1690" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FNH4</td>
        </tr>
        <tr>
          <td id="L1691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1691"></td>
          <td id="LC1691" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1692"></td>
          <td id="LC1692" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate trial solution for given zno3, matching boundary conditions from layer-by-layer solutions</span></td>
        </tr>
        <tr>
          <td id="L1693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1693"></td>
          <td id="LC1693" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1694"></td>
          <td id="LC1694" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1695"></td>
          <td id="LC1695" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution - matching across bioturbation boundary (if necessary)</span></td>
        </tr>
        <tr>
          <td id="L1696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1696"></td>
          <td id="LC1696" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zox, nitrification</span></td>
        </tr>
        <tr>
          <td id="L1697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1697"></td>
          <td id="LC1697" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    sub_prepfg_l12(reac1, reac2,  ktemp ,     zU , zL , D1,  D2)</span></td>
        </tr>
        <tr>
          <td id="L1698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1698"></td>
          <td id="LC1698" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(gamma<span class="pl-k">*</span>NC1, gamma<span class="pl-k">*</span>NC2,  <span class="pl-c1">0.0</span>,  <span class="pl-c1">0.0</span>, zox, DN1, DN2, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L1699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1699"></td>
          <td id="LC1699" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1700"></td>
          <td id="LC1700" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;1. sub_prepfg_l12 RESULTS: ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1&#39;, ls_a1, ls_b1, ls_c1, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1701"></td>
          <td id="LC1701" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>           &amp; ls_d1, ls_e1, ls_f1, ltype1</span></td>
        </tr>
        <tr>
          <td id="L1702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1702"></td>
          <td id="LC1702" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zox &lt; z &lt; zno3, denitrification</span></td>
        </tr>
        <tr>
          <td id="L1703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1703"></td>
          <td id="LC1703" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-k">-</span>NO3CR, <span class="pl-k">-</span>NO3CR, <span class="pl-c1">0.0</span>,  zox, zNO3, DN1, DN2, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L1704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1704"></td>
          <td id="LC1704" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1705"></td>
          <td id="LC1705" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;2. sub_prepfg_l12 RESULTS: ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2&#39;, ls_a2, ls_b2, ls_c2, ls_d2, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1706"></td>
          <td id="LC1706" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            &amp; ls_e2, ls_f2, ltype2</span></td>
        </tr>
        <tr>
          <td id="L1707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1707"></td>
          <td id="LC1707" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1708"></td>
          <td id="LC1708" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1709"></td>
          <td id="LC1709" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L1710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1710"></td>
          <td id="LC1710" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 2 zno3</span></td>
        </tr>
        <tr>
          <td id="L1711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1711"></td>
          <td id="LC1711" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, <span class="pl-k">-</span>NO3CR, <span class="pl-k">-</span>NO3CR, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DN1, DN2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L1712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1712"></td>
          <td id="LC1712" class="blob-code blob-code-inner js-file-line">        e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3)</td>
        </tr>
        <tr>
          <td id="L1713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1713"></td>
          <td id="LC1713" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1714"></td>
          <td id="LC1714" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity, flux discontinuity from NH4 -&gt; NO3 source)</span></td>
        </tr>
        <tr>
          <td id="L1715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1715"></td>
          <td id="LC1715" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1716"></td>
          <td id="LC1716" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L1717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1717"></td>
          <td id="LC1717" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, gamma<span class="pl-k">*</span>NC1, gamma<span class="pl-k">*</span>NC2, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DN1, DN2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L1718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1718"></td>
          <td id="LC1718" class="blob-code blob-code-inner js-file-line">        e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox)</td>
        </tr>
        <tr>
          <td id="L1719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1719"></td>
          <td id="LC1719" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1720"></td>
          <td id="LC1720" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L1721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1721"></td>
          <td id="LC1721" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1722"></td>
          <td id="LC1722" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-k">-</span>NO3CR, <span class="pl-k">-</span>NO3CR, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DN1, DN2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L1723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1723"></td>
          <td id="LC1723" class="blob-code blob-code-inner js-file-line">        e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox)</td>
        </tr>
        <tr>
          <td id="L1724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1724"></td>
          <td id="LC1724" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1725"></td>
          <td id="LC1725" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of NH4 to zox  TODO NH4 production by denitrification?</span></td>
        </tr>
        <tr>
          <td id="L1726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1726"></td>
          <td id="LC1726" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1727"></td>
          <td id="LC1727" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1728"></td>
          <td id="LC1728" class="blob-code blob-code-inner js-file-line">        FNH4 <span class="pl-k">=</span> FUN_calcReac(zno3, zinf, NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4))   <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L1729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1729"></td>
          <td id="LC1729" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;FNH4 = &#39;, FNH4</span></td>
        </tr>
        <tr>
          <td id="L1730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1730"></td>
          <td id="LC1730" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1731"></td>
          <td id="LC1731" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration, flux discontinuity from H2S ox</span></td>
        </tr>
        <tr>
          <td id="L1732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1732"></td>
          <td id="LC1732" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1733"></td>
          <td id="LC1733" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    call sub_matchsoln(e_zbio_l1, f_zbio_l1, g_zbio_l1, D1*dedz_zbio_l1, D1*dfdz_zbio_l1, D1*dgdz_zbio_l1, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1734"></td>
          <td id="LC1734" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                         &amp; e_zbio_l2, f_zbio_l2, g_zbio_l2, D2*dedz_zbio_l2, D2*dfdz_zbio_l2, D2*dgdz_zbio_l2, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1735"></td>
          <td id="LC1735" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                0.0, 0.0, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f)</span></td>
        </tr>
        <tr>
          <td id="L1736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1736"></td>
          <td id="LC1736" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox <span class="pl-k">.le.</span> zbio)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L1737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1737"></td>
          <td id="LC1737" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L1738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1738"></td>
          <td id="LC1738" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L1739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1739"></td>
          <td id="LC1739" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>gamma<span class="pl-k">*</span>FNH4<span class="pl-k">/</span>DN1, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L1740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1740"></td>
          <td id="LC1740" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1741"></td>
          <td id="LC1741" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zox&lt;= zbio: RESULTS:  zox_a, zox_b, zox_c, zox_d, zox_e, zox_f&#39;, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</span></td>
        </tr>
        <tr>
          <td id="L1742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1742"></td>
          <td id="LC1742" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1743"></td>
          <td id="LC1743" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L1744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1744"></td>
          <td id="LC1744" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L1745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1745"></td>
          <td id="LC1745" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>gamma<span class="pl-k">*</span>FNH4<span class="pl-k">/</span>DN2, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L1746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1746"></td>
          <td id="LC1746" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1747"></td>
          <td id="LC1747" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zox&gt; zbio: RESULTS:  zox_a, zox_b, zox_c, zox_d, zox_e, zox_f&#39;, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</span></td>
        </tr>
        <tr>
          <td id="L1748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1748"></td>
          <td id="LC1748" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1749"></td>
          <td id="LC1749" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1750"></td>
          <td id="LC1750" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L1751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1751"></td>
          <td id="LC1751" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, gamma<span class="pl-k">*</span>NC1, gamma<span class="pl-k">*</span>NC2, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DN1, DN2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L1752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1752"></td>
          <td id="LC1752" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L1753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1753"></td>
          <td id="LC1753" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1754"></td>
          <td id="LC1754" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;top of layer 1; sub_calcfg_l12: RESULTS:  e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00&#39;, e1_00, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1755"></td>
          <td id="LC1755" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            &amp; dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00</span></td>
        </tr>
        <tr>
          <td id="L1756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1756"></td>
          <td id="LC1756" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1757"></td>
          <td id="LC1757" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l2</span></td>
        </tr>
        <tr>
          <td id="L1758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1758"></td>
          <td id="LC1758" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f, &amp;</td>
        </tr>
        <tr>
          <td id="L1759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1759"></td>
          <td id="LC1759" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L1760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1760"></td>
          <td id="LC1760" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L1761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1761"></td>
          <td id="LC1761" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;transform to use coeffs from l2; sub_xformsoln: RESULTS:  e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0&#39;, e1_0, &amp;</span></td>
        </tr>
        <tr>
          <td id="L1762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1762"></td>
          <td id="LC1762" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            &amp; f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0</span></td>
        </tr>
        <tr>
          <td id="L1763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1763"></td>
          <td id="LC1763" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1764"></td>
          <td id="LC1764" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for ANO3, BNO3 given boundary conditions (expressed in terms of transformed basis fns, layer 2 A, B)</span></td>
        </tr>
        <tr>
          <td id="L1765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1765"></td>
          <td id="LC1765" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1766"></td>
          <td id="LC1766" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Case 1 zero concentration at zno3</span></td>
        </tr>
        <tr>
          <td id="L1767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1767"></td>
          <td id="LC1767" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANO3*e2_zno3   +  BNO3*f2_zno3  + g2_zno3 = 0;</span></td>
        </tr>
        <tr>
          <td id="L1768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1768"></td>
          <td id="LC1768" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANO3*e1_0     +   BNO3*f1_0     + g1_0  = swi.dum_swiconc_NO3;</span></td>
        </tr>
        <tr>
          <td id="L1769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1769"></td>
          <td id="LC1769" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1770"></td>
          <td id="LC1770" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | e2_zno3 f2_zno3 |  |ANO3|   = | -g2_zno3       |</span></td>
        </tr>
        <tr>
          <td id="L1771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1771"></td>
          <td id="LC1771" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | e1_0     f1_0   |  |BNO3|     | swi.dum_swiconc_NO3 - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L1772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1772"></td>
          <td id="LC1772" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1773"></td>
          <td id="LC1773" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(e2_zno3, f2_zno3, e1_0, f1_0, <span class="pl-k">-</span>g2_zno3, dum_swiconc_NO3 <span class="pl-k">-</span> g1_0, bctype1_A2, bctype1_B2)</td>
        </tr>
        <tr>
          <td id="L1774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1774"></td>
          <td id="LC1774" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1775"></td>
          <td id="LC1775" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Case  2 zero flux at zno3</span></td>
        </tr>
        <tr>
          <td id="L1776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1776"></td>
          <td id="LC1776" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANO3*de2dz_zno3   +  BNO3*dfdz2_zno3  + dgdz2_zno3 = 0;</span></td>
        </tr>
        <tr>
          <td id="L1777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1777"></td>
          <td id="LC1777" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANO3*e1_0         +   BNO3*f1_0       + g1_0       = swi.dum_swiconc_NO3;</span></td>
        </tr>
        <tr>
          <td id="L1778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1778"></td>
          <td id="LC1778" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1779"></td>
          <td id="LC1779" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz2_zno3, dfdz2_zno3, e1_0, f1_0, <span class="pl-k">-</span>dgdz2_zno3, dum_swiconc_NO3 <span class="pl-k">-</span> g1_0, bctype2_A2, bctype2_B2)</td>
        </tr>
        <tr>
          <td id="L1780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1780"></td>
          <td id="LC1780" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1781"></td>
          <td id="LC1781" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Choose type of solution requested</span></td>
        </tr>
        <tr>
          <td id="L1782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1782"></td>
          <td id="LC1782" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(bctype<span class="pl-k">==</span><span class="pl-c1">1</span>) <span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1783"></td>
          <td id="LC1783" class="blob-code blob-code-inner js-file-line">            rNO3_A2 <span class="pl-k">=</span> bctype1_A2</td>
        </tr>
        <tr>
          <td id="L1784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1784"></td>
          <td id="LC1784" class="blob-code blob-code-inner js-file-line">            rNO3_B2 <span class="pl-k">=</span> bctype1_B2</td>
        </tr>
        <tr>
          <td id="L1785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1785"></td>
          <td id="LC1785" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1786"></td>
          <td id="LC1786" class="blob-code blob-code-inner js-file-line">            rNO3_A2 <span class="pl-k">=</span> bctype2_A2</td>
        </tr>
        <tr>
          <td id="L1787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1787"></td>
          <td id="LC1787" class="blob-code blob-code-inner js-file-line">            rNO3_B2 <span class="pl-k">=</span> bctype2_B2</td>
        </tr>
        <tr>
          <td id="L1788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1788"></td>
          <td id="LC1788" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1789"></td>
          <td id="LC1789" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1790"></td>
          <td id="LC1790" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate flux at zno3</span></td>
        </tr>
        <tr>
          <td id="L1791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1791"></td>
          <td id="LC1791" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zno3 <span class="pl-k">.le.</span> zbio) <span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1792"></td>
          <td id="LC1792" class="blob-code blob-code-inner js-file-line">            flxzno3 <span class="pl-k">=</span> DN1<span class="pl-k">*</span>(rNO3_A2<span class="pl-k">*</span>dedz2_zno3<span class="pl-k">+</span>rNO3_B2<span class="pl-k">*</span>dfdz2_zno3 <span class="pl-k">+</span> dgdz2_zno3)      <span class="pl-c"><span class="pl-c">!</span> includes 1/por ie flux per (cm^2 pore area)</span></td>
        </tr>
        <tr>
          <td id="L1793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1793"></td>
          <td id="LC1793" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1794"></td>
          <td id="LC1794" class="blob-code blob-code-inner js-file-line">            flxzno3 <span class="pl-k">=</span> DN2<span class="pl-k">*</span>(rNO3_A2<span class="pl-k">*</span>dedz2_zno3<span class="pl-k">+</span>rNO3_B2<span class="pl-k">*</span>dfdz2_zno3 <span class="pl-k">+</span> dgdz2_zno3)      <span class="pl-c"><span class="pl-c">!</span> includes 1/por ie flux per (cm^2 pore area)</span></td>
        </tr>
        <tr>
          <td id="L1795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1795"></td>
          <td id="LC1795" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1796"></td>
          <td id="LC1796" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1797"></td>
          <td id="LC1797" class="blob-code blob-code-inner js-file-line">        conczno3 <span class="pl-k">=</span> rNO3_A2<span class="pl-k">*</span>e2_zno3<span class="pl-k">+</span>rNO3_B2<span class="pl-k">*</span>f2_zno3 <span class="pl-k">+</span> g2_zno3</td>
        </tr>
        <tr>
          <td id="L1798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1798"></td>
          <td id="LC1798" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L1799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1799"></td>
          <td id="LC1799" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_NO3 <span class="pl-k">=</span> por<span class="pl-k">*</span>(DN1<span class="pl-k">*</span>(rNO3_A2<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rNO3_B2<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0)) <span class="pl-c"><span class="pl-c">!</span> - w*dum_swiconc_NO3)              ! NB: use A2, B2 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L1800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1800"></td>
          <td id="LC1800" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1801"></td>
          <td id="LC1801" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;flxzno3&#39;, flxzno3</span></td>
        </tr>
        <tr>
          <td id="L1802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1802"></td>
          <td id="LC1802" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;conczno3&#39;, conczno3</span></td>
        </tr>
        <tr>
          <td id="L1803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1803"></td>
          <td id="LC1803" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;loc_new_swiflux_NO3&#39;, loc_new_swiflux_NO3</span></td>
        </tr>
        <tr>
          <td id="L1804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1804"></td>
          <td id="LC1804" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1805"></td>
          <td id="LC1805" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layer 1</span></td>
        </tr>
        <tr>
          <td id="L1806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1806"></td>
          <td id="LC1806" class="blob-code blob-code-inner js-file-line">        rNO3_A1 <span class="pl-k">=</span> zox_a<span class="pl-k">*</span>rNO3_A2 <span class="pl-k">+</span> zox_b<span class="pl-k">*</span>rNO3_B2 <span class="pl-k">+</span> zox_e</td>
        </tr>
        <tr>
          <td id="L1807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1807"></td>
          <td id="LC1807" class="blob-code blob-code-inner js-file-line">        rNO3_B1 <span class="pl-k">=</span> zox_c<span class="pl-k">*</span>rNO3_A2 <span class="pl-k">+</span> zox_d<span class="pl-k">*</span>rNO3_B2 <span class="pl-k">+</span> zox_f</td>
        </tr>
        <tr>
          <td id="L1808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1808"></td>
          <td id="LC1808" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1809"></td>
          <td id="LC1809" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rNO3_A1, rNO3_B1&#39;, rNO3_A1, rNO3_B1</span></td>
        </tr>
        <tr>
          <td id="L1810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1810"></td>
          <td id="LC1810" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1811"></td>
          <td id="LC1811" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNO3_calcbc</span></td>
        </tr>
        <tr>
          <td id="L1812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1812"></td>
          <td id="LC1812" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1813"></td>
          <td id="LC1813" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L1814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1814"></td>
          <td id="LC1814" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1815"></td>
          <td id="LC1815" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1816"></td>
          <td id="LC1816" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1817"></td>
          <td id="LC1817" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1818"></td>
          <td id="LC1818" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zNO3</span>(<span class="pl-v">z</span>)</td>
        </tr>
        <tr>
          <td id="L1819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1819"></td>
          <td id="LC1819" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1820"></td>
          <td id="LC1820" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_zNO3, z, flxzno3, conczno3, flxswi</td>
        </tr>
        <tr>
          <td id="L1821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1821"></td>
          <td id="LC1821" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1822"></td>
          <td id="LC1822" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1823"></td>
          <td id="LC1823" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;..... START FUN_zNO3&#39;</span></td>
        </tr>
        <tr>
          <td id="L1824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1824"></td>
          <td id="LC1824" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1825"></td>
          <td id="LC1825" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zNO3_calcbc(z, <span class="pl-c1">1</span>, flxzno3, conczno3, flxswi)</td>
        </tr>
        <tr>
          <td id="L1826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1826"></td>
          <td id="LC1826" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1827"></td>
          <td id="LC1827" class="blob-code blob-code-inner js-file-line">        FUN_zNO3 <span class="pl-k">=</span> <span class="pl-k">-</span>flxzno3</td>
        </tr>
        <tr>
          <td id="L1828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1828"></td>
          <td id="LC1828" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1829"></td>
          <td id="LC1829" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FUN_zNO3&#39;, FUN_zNO3</span></td>
        </tr>
        <tr>
          <td id="L1830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1830"></td>
          <td id="LC1830" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1831"></td>
          <td id="LC1831" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zNO3</span></td>
        </tr>
        <tr>
          <td id="L1832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1832"></td>
          <td id="LC1832" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1833"></td>
          <td id="LC1833" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1834"></td>
          <td id="LC1834" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1835"></td>
          <td id="LC1835" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1836"></td>
          <td id="LC1836" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1837"></td>
          <td id="LC1837" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1838"></td>
          <td id="LC1838" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           Sulfate</span></td>
        </tr>
        <tr>
          <td id="L1839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1839"></td>
          <td id="LC1839" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1840"></td>
          <td id="LC1840" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1841"></td>
          <td id="LC1841" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1842"></td>
          <td id="LC1842" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1843"></td>
          <td id="LC1843" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1844"></td>
          <td id="LC1844" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zSO4</span>(<span class="pl-v">dum_swiconc_SO4</span>, <span class="pl-v">loc_new_swiflux_SO4</span>)</td>
        </tr>
        <tr>
          <td id="L1845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1845"></td>
          <td id="LC1845" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L1846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1846"></td>
          <td id="LC1846" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L1847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1847"></td>
          <td id="LC1847" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_SO4                <span class="pl-c"><span class="pl-c">!</span> SO4 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L1848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1848"></td>
          <td id="LC1848" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_SO4         <span class="pl-c"><span class="pl-c">!</span> SO4 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L1849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1849"></td>
          <td id="LC1849" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1850"></td>
          <td id="LC1850" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1851"></td>
          <td id="LC1851" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L1852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1852"></td>
          <td id="LC1852" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> flxzso4, conczso4, loc_conczinf, zL, tol</td>
        </tr>
        <tr>
          <td id="L1853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1853"></td>
          <td id="LC1853" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> bctype</td>
        </tr>
        <tr>
          <td id="L1854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1854"></td>
          <td id="LC1854" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1855"></td>
          <td id="LC1855" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1856"></td>
          <td id="LC1856" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L1857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1857"></td>
          <td id="LC1857" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;---------------------- START zSO4 ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L1858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1858"></td>
          <td id="LC1858" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; BWI SO4 concentration = &#39;, dum_swiconc_SO4</span></td>
        </tr>
        <tr>
          <td id="L1859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1859"></td>
          <td id="LC1859" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1860"></td>
          <td id="LC1860" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Iteratively solve for zso4</span></td>
        </tr>
        <tr>
          <td id="L1861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1861"></td>
          <td id="LC1861" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1862"></td>
          <td id="LC1862" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> try zero flux at zinf and see if we have any SO4 left, also</span></td>
        </tr>
        <tr>
          <td id="L1863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1863"></td>
          <td id="LC1863" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate [SO4] at zinf for advective loss</span></td>
        </tr>
        <tr>
          <td id="L1864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1864"></td>
          <td id="LC1864" class="blob-code blob-code-inner js-file-line">        bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1865"></td>
          <td id="LC1865" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zSO4_calcbc(zinf, bctype, flxzso4, loc_conczinf, loc_new_swiflux_SO4)</td>
        </tr>
        <tr>
          <td id="L1866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1866"></td>
          <td id="LC1866" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1867"></td>
          <td id="LC1867" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1868"></td>
          <td id="LC1868" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zno3 == zinf)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1869"></td>
          <td id="LC1869" class="blob-code blob-code-inner js-file-line">            zso4 <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1870"></td>
          <td id="LC1870" class="blob-code blob-code-inner js-file-line">            bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1871"></td>
          <td id="LC1871" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1872"></td>
          <td id="LC1872" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1873"></td>
          <td id="LC1873" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;conczso4 at zinf&#39;, char(9), conczso4</span></td>
        </tr>
        <tr>
          <td id="L1874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1874"></td>
          <td id="LC1874" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1875"></td>
          <td id="LC1875" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">IF</span>(loc_conczinf <span class="pl-k">.ge.</span> <span class="pl-c1">0</span>)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L1876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1876"></td>
          <td id="LC1876" class="blob-code blob-code-inner js-file-line">                zso4 <span class="pl-k">=</span> zinf</td>
        </tr>
        <tr>
          <td id="L1877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1877"></td>
          <td id="LC1877" class="blob-code blob-code-inner js-file-line">                bctype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1878"></td>
          <td id="LC1878" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L1879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1879"></td>
          <td id="LC1879" class="blob-code blob-code-inner js-file-line">                bctype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L1880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1880"></td>
          <td id="LC1880" class="blob-code blob-code-inner js-file-line">                loc_conczinf <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1881"></td>
          <td id="LC1881" class="blob-code blob-code-inner js-file-line">                zL<span class="pl-k">=</span><span class="pl-c1">1e-10</span></td>
        </tr>
        <tr>
          <td id="L1882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1882"></td>
          <td id="LC1882" class="blob-code blob-code-inner js-file-line">                tol<span class="pl-k">=</span><span class="pl-c1">1e-16</span></td>
        </tr>
        <tr>
          <td id="L1883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1883"></td>
          <td id="LC1883" class="blob-code blob-code-inner js-file-line">                zso4 <span class="pl-k">=</span> FUN_zbrent(FUN_zSO4, <span class="pl-k">max</span>(zno3,zL), zinf, tol)</td>
        </tr>
        <tr>
          <td id="L1884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1884"></td>
          <td id="LC1884" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>                print*,&#39;CALCULATE zso4 = &#39;, zso4</span></td>
        </tr>
        <tr>
          <td id="L1885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1885"></td>
          <td id="LC1885" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1886"></td>
          <td id="LC1886" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;bctype, zso4 &#39;, bctype, zso4</span></td>
        </tr>
        <tr>
          <td id="L1887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1887"></td>
          <td id="LC1887" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span> <span class="pl-c"><span class="pl-c">!</span>(zno3 == zinf)</span></td>
        </tr>
        <tr>
          <td id="L1888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1888"></td>
          <td id="LC1888" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zSO4_calcbc(zso4, bctype, flxzso4, conczso4, loc_new_swiflux_SO4)</td>
        </tr>
        <tr>
          <td id="L1889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1889"></td>
          <td id="LC1889" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_SO4 <span class="pl-k">=</span> loc_new_swiflux_SO4 <span class="pl-k">-</span> por<span class="pl-k">*</span>w<span class="pl-k">*</span>(dum_swiconc_SO4 <span class="pl-k">-</span> loc_conczinf)</td>
        </tr>
        <tr>
          <td id="L1890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1890"></td>
          <td id="LC1890" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1891"></td>
          <td id="LC1891" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(<span class="pl-k">ABS</span>(loc_new_swiflux_SO4) <span class="pl-k">.LE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L1892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1892"></td>
          <td id="LC1892" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;small loc_new_swiflux_SO4&#39;, loc_new_swiflux_SO4</span></td>
        </tr>
        <tr>
          <td id="L1893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1893"></td>
          <td id="LC1893" class="blob-code blob-code-inner js-file-line">            loc_new_swiflux_SO4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L1894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1894"></td>
          <td id="LC1894" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L1895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1895"></td>
          <td id="LC1895" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1896"></td>
          <td id="LC1896" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1897"></td>
          <td id="LC1897" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1898"></td>
          <td id="LC1898" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;-------------------------------- FINAL RESULTS zSO4 --------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L1899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1899"></td>
          <td id="LC1899" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zso4&#39;, char(9), zso4</span></td>
        </tr>
        <tr>
          <td id="L1900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1900"></td>
          <td id="LC1900" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1901"></td>
          <td id="LC1901" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flxzso4&#39;, char(9), flxzso4</span></td>
        </tr>
        <tr>
          <td id="L1902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1902"></td>
          <td id="LC1902" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;conczso4&#39;, char(9), conczso4</span></td>
        </tr>
        <tr>
          <td id="L1903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1903"></td>
          <td id="LC1903" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_new_swiflux_SO4&#39;, char(9), loc_new_swiflux_SO4</span></td>
        </tr>
        <tr>
          <td id="L1904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1904"></td>
          <td id="LC1904" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1905"></td>
          <td id="LC1905" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zSO4</span></td>
        </tr>
        <tr>
          <td id="L1906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1906"></td>
          <td id="LC1906" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1907"></td>
          <td id="LC1907" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1908"></td>
          <td id="LC1908" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1909"></td>
          <td id="LC1909" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L1910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1910"></td>
          <td id="LC1910" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L1911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1911"></td>
          <td id="LC1911" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1912"></td>
          <td id="LC1912" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zSO4_calcbc</span>(<span class="pl-v">zso4</span>, <span class="pl-v">bctype</span>, <span class="pl-v">flxzso4</span>, <span class="pl-v">conczso4</span>, <span class="pl-v">flxswi</span>)</td>
        </tr>
        <tr>
          <td id="L1913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1913"></td>
          <td id="LC1913" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1914"></td>
          <td id="LC1914" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>zso4</td>
        </tr>
        <tr>
          <td id="L1915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1915"></td>
          <td id="LC1915" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span>, <span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>bctype</td>
        </tr>
        <tr>
          <td id="L1916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1916"></td>
          <td id="LC1916" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>flxzso4, conczso4, flxswi</td>
        </tr>
        <tr>
          <td id="L1917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1917"></td>
          <td id="LC1917" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1918"></td>
          <td id="LC1918" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variable</span></td>
        </tr>
        <tr>
          <td id="L1919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1919"></td>
          <td id="LC1919" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype1, ltype2, ltype3</td>
        </tr>
        <tr>
          <td id="L1920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1920"></td>
          <td id="LC1920" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1_so4, reac2_so4</td>
        </tr>
        <tr>
          <td id="L1921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1921"></td>
          <td id="LC1921" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L1922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1922"></td>
          <td id="LC1922" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L1923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1923"></td>
          <td id="LC1923" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3</td>
        </tr>
        <tr>
          <td id="L1924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1924"></td>
          <td id="LC1924" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4</td>
        </tr>
        <tr>
          <td id="L1925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1925"></td>
          <td id="LC1925" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</td>
        </tr>
        <tr>
          <td id="L1926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1926"></td>
          <td id="LC1926" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3</td>
        </tr>
        <tr>
          <td id="L1927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1927"></td>
          <td id="LC1927" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f</td>
        </tr>
        <tr>
          <td id="L1928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1928"></td>
          <td id="LC1928" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox</td>
        </tr>
        <tr>
          <td id="L1929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1929"></td>
          <td id="LC1929" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox0, f2_zox0, g2_zox0, dedz2_zox0, dfdz2_zox0, dgdz2_zox0</td>
        </tr>
        <tr>
          <td id="L1930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1930"></td>
          <td id="LC1930" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox</td>
        </tr>
        <tr>
          <td id="L1931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1931"></td>
          <td id="LC1931" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</td>
        </tr>
        <tr>
          <td id="L1932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1932"></td>
          <td id="LC1932" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L1933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1933"></td>
          <td id="LC1933" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L1934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1934"></td>
          <td id="LC1934" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> bctype1_A3, bctype1_B3, bctype2_A3, bctype2_B3</td>
        </tr>
        <tr>
          <td id="L1935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1935"></td>
          <td id="LC1935" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rSO4_A1, rSO4_B1, rSO4_A2, rSO4_B2, rSO4_A3, rSO4_B3</td>
        </tr>
        <tr>
          <td id="L1936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1936"></td>
          <td id="LC1936" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1937"></td>
          <td id="LC1937" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FH2S</td>
        </tr>
        <tr>
          <td id="L1938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1938"></td>
          <td id="LC1938" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1939"></td>
          <td id="LC1939" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1940"></td>
          <td id="LC1940" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zSO4_calcbc ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L1941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1941"></td>
          <td id="LC1941" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1942"></td>
          <td id="LC1942" class="blob-code blob-code-inner js-file-line">        reac1_so4<span class="pl-k">=-</span>SO4C</td>
        </tr>
        <tr>
          <td id="L1943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1943"></td>
          <td id="LC1943" class="blob-code blob-code-inner js-file-line">        reac2_so4<span class="pl-k">=-</span>SO4C</td>
        </tr>
        <tr>
          <td id="L1944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1944"></td>
          <td id="LC1944" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1945"></td>
          <td id="LC1945" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate trial solution for given zso4, matching boundary conditions from layer-by-layer solutions</span></td>
        </tr>
        <tr>
          <td id="L1946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1946"></td>
          <td id="LC1946" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1947"></td>
          <td id="LC1947" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1948"></td>
          <td id="LC1948" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L1949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1949"></td>
          <td id="LC1949" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zox, passive diffn</span></td>
        </tr>
        <tr>
          <td id="L1950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1950"></td>
          <td id="LC1950" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>      ls =      sub_prepfg_l12( bsd, swi, r, reac1,     reac2,     ktemp, zU, zL, D1,        D2)</span></td>
        </tr>
        <tr>
          <td id="L1951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1951"></td>
          <td id="LC1951" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1952"></td>
          <td id="LC1952" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, DSO41, DSO42, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L1953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1953"></td>
          <td id="LC1953" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1954"></td>
          <td id="LC1954" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zox &lt; z &lt; zno3, passive diffn</span></td>
        </tr>
        <tr>
          <td id="L1955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1955"></td>
          <td id="LC1955" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, zno3, DSO41, DSO42, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L1956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1956"></td>
          <td id="LC1956" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1957"></td>
          <td id="LC1957" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 3: zno3 &lt; z &lt; zso4, SO4 consumption by OM oxidation</span></td>
        </tr>
        <tr>
          <td id="L1958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1958"></td>
          <td id="LC1958" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>rSO4.ls3 = r.zTOC.sub_prepfg_l12(bsd, swi, r, reac1, reac2, 0, r.zno3, zso4, DSO41, DSO42)</span></td>
        </tr>
        <tr>
          <td id="L1959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1959"></td>
          <td id="LC1959" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac1_so4, reac2_so4, <span class="pl-c1">0.0</span>, zno3, zso4, DSO41, DSO42, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, ltype3)</td>
        </tr>
        <tr>
          <td id="L1960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1960"></td>
          <td id="LC1960" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1961"></td>
          <td id="LC1961" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1962"></td>
          <td id="LC1962" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L1963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1963"></td>
          <td id="LC1963" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 3 zso4</span></td>
        </tr>
        <tr>
          <td id="L1964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1964"></td>
          <td id="LC1964" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1965"></td>
          <td id="LC1965" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac1_so4, reac2_so4, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DSO41, DSO42, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L1966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1966"></td>
          <td id="LC1966" class="blob-code blob-code-inner js-file-line">        e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4)</td>
        </tr>
        <tr>
          <td id="L1967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1967"></td>
          <td id="LC1967" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1968"></td>
          <td id="LC1968" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zno3, layer 2 - layer 3 (continuity and flux)</span></td>
        </tr>
        <tr>
          <td id="L1969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1969"></td>
          <td id="LC1969" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 2</span></td>
        </tr>
        <tr>
          <td id="L1970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1970"></td>
          <td id="LC1970" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DSO41, DSO42, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L1971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1971"></td>
          <td id="LC1971" class="blob-code blob-code-inner js-file-line">        e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3)</td>
        </tr>
        <tr>
          <td id="L1972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1972"></td>
          <td id="LC1972" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1973"></td>
          <td id="LC1973" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 3</span></td>
        </tr>
        <tr>
          <td id="L1974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1974"></td>
          <td id="LC1974" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, reac1_so4, reac2_so4, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DSO41, DSO42, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L1975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1975"></td>
          <td id="LC1975" class="blob-code blob-code-inner js-file-line">        e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3)</td>
        </tr>
        <tr>
          <td id="L1976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1976"></td>
          <td id="LC1976" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1977"></td>
          <td id="LC1977" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zno3 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L1978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1978"></td>
          <td id="LC1978" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    [zno3.a, zno3.b, zno3.c, zno3.d, zno3.e, zno3.f] = benthic_utils.sub_matchsoln(e2_zno3, f2_zno3, g2_zno3, dedz2_zno3, dfdz2_zno3, dgdz2_zno3, ...</span></td>
        </tr>
        <tr>
          <td id="L1979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1979"></td>
          <td id="LC1979" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                                                e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3, ...</span></td>
        </tr>
        <tr>
          <td id="L1980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1980"></td>
          <td id="LC1980" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                                                0, 0);</span></td>
        </tr>
        <tr>
          <td id="L1981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1981"></td>
          <td id="LC1981" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e2_zno3, f2_zno3, g2_zno3, dedz2_zno3, dfdz2_zno3, dgdz2_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L1982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1982"></td>
          <td id="LC1982" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L1983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1983"></td>
          <td id="LC1983" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f)</td>
        </tr>
        <tr>
          <td id="L1984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1984"></td>
          <td id="LC1984" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1985"></td>
          <td id="LC1985" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1986"></td>
          <td id="LC1986" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity, flux discontinuity from H2S source)</span></td>
        </tr>
        <tr>
          <td id="L1987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1987"></td>
          <td id="LC1987" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of H2S to oxic interface (Source of SO4)</span></td>
        </tr>
        <tr>
          <td id="L1988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1988"></td>
          <td id="LC1988" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NB: include methane region as AOM will produce sulphide as well..</span></td>
        </tr>
        <tr>
          <td id="L1989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1989"></td>
          <td id="LC1989" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1990"></td>
          <td id="LC1990" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        FH2S = 0.0  !FUN_calcReac(zno3, zso4, SO4C, SO4C) + 0.0  ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L1991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1991"></td>
          <td id="LC1991" class="blob-code blob-code-inner js-file-line">        FH2S <span class="pl-k">=</span> FUN_calcReac(zno3, zso4, SO4C, SO4C) &amp; <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L1992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1992"></td>
          <td id="LC1992" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> gammaCH4<span class="pl-k">*</span>FUN_calcReac(zso4, zinf, MC, MC)</td>
        </tr>
        <tr>
          <td id="L1993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1993"></td>
          <td id="LC1993" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1994"></td>
          <td id="LC1994" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L1995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1995"></td>
          <td id="LC1995" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FH2S &#39;, FH2S</span></td>
        </tr>
        <tr>
          <td id="L1996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1996"></td>
          <td id="LC1996" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1997"></td>
          <td id="LC1997" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L1998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1998"></td>
          <td id="LC1998" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DSO41, DSO42, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L1999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1999"></td>
          <td id="LC1999" class="blob-code blob-code-inner js-file-line">        e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox)</td>
        </tr>
        <tr>
          <td id="L2000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2000"></td>
          <td id="LC2000" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2001"></td>
          <td id="LC2001" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2002"></td>
          <td id="LC2002" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DSO41, DSO42, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2003"></td>
          <td id="LC2003" class="blob-code blob-code-inner js-file-line">        e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0)</td>
        </tr>
        <tr>
          <td id="L2004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2004"></td>
          <td id="LC2004" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2005"></td>
          <td id="LC2005" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l3</span></td>
        </tr>
        <tr>
          <td id="L2006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2006"></td>
          <td id="LC2006" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e2_zox0, f2_zox0, g2_zox0, dedz2_zox0, dfdz2_zox0, dgdz2_zox0, &amp;</td>
        </tr>
        <tr>
          <td id="L2007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2007"></td>
          <td id="LC2007" class="blob-code blob-code-inner js-file-line">        zno3_a , zno3_b , zno3_c , zno3_d , zno3_e ,zno3_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2008"></td>
          <td id="LC2008" class="blob-code blob-code-inner js-file-line">        e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox )</td>
        </tr>
        <tr>
          <td id="L2009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2009"></td>
          <td id="LC2009" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2010"></td>
          <td id="LC2010" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration, flux discontinuity from H2S ox</span></td>
        </tr>
        <tr>
          <td id="L2011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2011"></td>
          <td id="LC2011" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox <span class="pl-k">.le.</span> zbio)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L2012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2012"></td>
          <td id="LC2012" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2013"></td>
          <td id="LC2013" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2014"></td>
          <td id="LC2014" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>gammaH2S<span class="pl-k">*</span>FH2S<span class="pl-k">/</span>DSO41, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2015"></td>
          <td id="LC2015" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L2016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2016"></td>
          <td id="LC2016" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2017"></td>
          <td id="LC2017" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2018"></td>
          <td id="LC2018" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>gammaH2S<span class="pl-k">*</span>FH2S<span class="pl-k">/</span>DSO42, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2019"></td>
          <td id="LC2019" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2020"></td>
          <td id="LC2020" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2021"></td>
          <td id="LC2021" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2022"></td>
          <td id="LC2022" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DSO41, DSO42, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2023"></td>
          <td id="LC2023" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L2024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2024"></td>
          <td id="LC2024" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2025"></td>
          <td id="LC2025" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l3</span></td>
        </tr>
        <tr>
          <td id="L2026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2026"></td>
          <td id="LC2026" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2027"></td>
          <td id="LC2027" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L2028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2028"></td>
          <td id="LC2028" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2029"></td>
          <td id="LC2029" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find solutions for two possible types of lower bc</span></td>
        </tr>
        <tr>
          <td id="L2030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2030"></td>
          <td id="LC2030" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  case 1  zero concentration at zso4</span></td>
        </tr>
        <tr>
          <td id="L2031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2031"></td>
          <td id="LC2031" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for ASO4, BSO4 given boundary conditions (expressed in terms of transformed basis fns, layer 3 A, B)</span></td>
        </tr>
        <tr>
          <td id="L2032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2032"></td>
          <td id="LC2032" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ASO4*e3_zso4   +  BSO4*f3_zso4  + g3_zso4 = 0;</span></td>
        </tr>
        <tr>
          <td id="L2033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2033"></td>
          <td id="LC2033" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ASO4*e1_0     +   BSO4*f1_0     + g1_0  = swi.dum_swiconc_SO4</span></td>
        </tr>
        <tr>
          <td id="L2034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2034"></td>
          <td id="LC2034" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2035"></td>
          <td id="LC2035" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | e3_zso4 f3_zso4 |  |ASO4|   = | -g3_zso4       |</span></td>
        </tr>
        <tr>
          <td id="L2036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2036"></td>
          <td id="LC2036" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | e1_0     f1_0   |  |BSO4|     | swi.dum_swiconc_SO4 - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L2037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2037"></td>
          <td id="LC2037" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2038"></td>
          <td id="LC2038" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(e3_zso4, f3_zso4, e1_0, f1_0, <span class="pl-k">-</span>g3_zso4, dum_swiconc_SO4 <span class="pl-k">-</span> g1_0, bctype1_A3, bctype1_B3)</td>
        </tr>
        <tr>
          <td id="L2039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2039"></td>
          <td id="LC2039" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2040"></td>
          <td id="LC2040" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> case  2 zero flux at zso4</span></td>
        </tr>
        <tr>
          <td id="L2041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2041"></td>
          <td id="LC2041" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ASO4*de3dz_zso4   +  BSO4*dfdz3_zso4  + dgdz3_zso4 = 0;</span></td>
        </tr>
        <tr>
          <td id="L2042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2042"></td>
          <td id="LC2042" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ASO4*e1_0         +   BSO4*f1_0       + g1_0       = swi.dum_swiconc_SO4;</span></td>
        </tr>
        <tr>
          <td id="L2043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2043"></td>
          <td id="LC2043" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz3_zso4, dfdz3_zso4, e1_0, f1_0, <span class="pl-k">-</span>dgdz3_zso4, dum_swiconc_SO4 <span class="pl-k">-</span> g1_0, bctype2_A3, bctype2_B3)</td>
        </tr>
        <tr>
          <td id="L2044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2044"></td>
          <td id="LC2044" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2045"></td>
          <td id="LC2045" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Choose type of solution requested</span></td>
        </tr>
        <tr>
          <td id="L2046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2046"></td>
          <td id="LC2046" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>rSO4.A3 = (bctype==1).*bctype1_A3 + (bctype==2).*bctype2_A3;</span></td>
        </tr>
        <tr>
          <td id="L2047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2047"></td>
          <td id="LC2047" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        rSO4.B3 = (bctype==1).*bctype1_B3 + (bctype==2).*bctype2_B3;</span></td>
        </tr>
        <tr>
          <td id="L2048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2048"></td>
          <td id="LC2048" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(bctype<span class="pl-k">==</span><span class="pl-c1">1</span>)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L2049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2049"></td>
          <td id="LC2049" class="blob-code blob-code-inner js-file-line">            rSO4_A3<span class="pl-k">=</span>bctype1_A3</td>
        </tr>
        <tr>
          <td id="L2050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2050"></td>
          <td id="LC2050" class="blob-code blob-code-inner js-file-line">            rSO4_B3<span class="pl-k">=</span>bctype1_B3</td>
        </tr>
        <tr>
          <td id="L2051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2051"></td>
          <td id="LC2051" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L2052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2052"></td>
          <td id="LC2052" class="blob-code blob-code-inner js-file-line">            rSO4_A3<span class="pl-k">=</span>bctype2_A3</td>
        </tr>
        <tr>
          <td id="L2053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2053"></td>
          <td id="LC2053" class="blob-code blob-code-inner js-file-line">            rSO4_B3<span class="pl-k">=</span>bctype2_B3</td>
        </tr>
        <tr>
          <td id="L2054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2054"></td>
          <td id="LC2054" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2055"></td>
          <td id="LC2055" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2056"></td>
          <td id="LC2056" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate conc and flux at zso4</span></td>
        </tr>
        <tr>
          <td id="L2057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2057"></td>
          <td id="LC2057" class="blob-code blob-code-inner js-file-line">        conczso4 <span class="pl-k">=</span> rSO4_A3<span class="pl-k">*</span>e3_zso4<span class="pl-k">+</span>rSO4_B3<span class="pl-k">*</span>f3_zso4 <span class="pl-k">+</span> g3_zso4</td>
        </tr>
        <tr>
          <td id="L2058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2058"></td>
          <td id="LC2058" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>D = (zso4 &lt;= zbio).*DSO41 + (zso4 &gt; zbio).*DSO42</span></td>
        </tr>
        <tr>
          <td id="L2059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2059"></td>
          <td id="LC2059" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zso4 <span class="pl-k">.le.</span> zbio)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L2060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2060"></td>
          <td id="LC2060" class="blob-code blob-code-inner js-file-line">            flxzso4 <span class="pl-k">=</span> DSO41<span class="pl-k">*</span>(rSO4_A3<span class="pl-k">*</span>dedz3_zso4<span class="pl-k">+</span>rSO4_B3<span class="pl-k">*</span>dfdz3_zso4 <span class="pl-k">+</span> dgdz3_zso4)        <span class="pl-c"><span class="pl-c">!</span> includes 1/por ie flux per (cm^2 pore area)</span></td>
        </tr>
        <tr>
          <td id="L2061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2061"></td>
          <td id="LC2061" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L2062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2062"></td>
          <td id="LC2062" class="blob-code blob-code-inner js-file-line">            flxzso4 <span class="pl-k">=</span> DSO42<span class="pl-k">*</span>(rSO4_A3<span class="pl-k">*</span>dedz3_zso4<span class="pl-k">+</span>rSO4_B3<span class="pl-k">*</span>dfdz3_zso4 <span class="pl-k">+</span> dgdz3_zso4)</td>
        </tr>
        <tr>
          <td id="L2063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2063"></td>
          <td id="LC2063" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2064"></td>
          <td id="LC2064" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2065"></td>
          <td id="LC2065" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L2066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2066"></td>
          <td id="LC2066" class="blob-code blob-code-inner js-file-line">        flxswi <span class="pl-k">=</span> por<span class="pl-k">*</span>(DSO41<span class="pl-k">*</span>(rSO4_A3<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rSO4_B3<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0)) <span class="pl-c"><span class="pl-c">!</span> - w*dum_swiconc_SO4)   ! NB: use A3, B3 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L2067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2067"></td>
          <td id="LC2067" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2068"></td>
          <td id="LC2068" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2069"></td>
          <td id="LC2069" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;RESULTS zso4_calcbc_: conczso4, flxzso4, flxswi&#39;, conczso4, flxzso4, flxswi</span></td>
        </tr>
        <tr>
          <td id="L2070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2070"></td>
          <td id="LC2070" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2071"></td>
          <td id="LC2071" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layers 2 and 1</span></td>
        </tr>
        <tr>
          <td id="L2072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2072"></td>
          <td id="LC2072" class="blob-code blob-code-inner js-file-line">        rSO4_A2 <span class="pl-k">=</span> zno3_a<span class="pl-k">*</span>rSO4_A3 <span class="pl-k">+</span> zno3_b<span class="pl-k">*</span>rSO4_B3 <span class="pl-k">+</span> zno3_e</td>
        </tr>
        <tr>
          <td id="L2073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2073"></td>
          <td id="LC2073" class="blob-code blob-code-inner js-file-line">        rSO4_B2 <span class="pl-k">=</span> zno3_c<span class="pl-k">*</span>rSO4_A3 <span class="pl-k">+</span> zno3_d<span class="pl-k">*</span>rSO4_B3 <span class="pl-k">+</span> zno3_f</td>
        </tr>
        <tr>
          <td id="L2074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2074"></td>
          <td id="LC2074" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2075"></td>
          <td id="LC2075" class="blob-code blob-code-inner js-file-line">        rSO4_A1 <span class="pl-k">=</span> zox_a<span class="pl-k">*</span>rSO4_A3 <span class="pl-k">+</span> zox_b<span class="pl-k">*</span>rSO4_B3 <span class="pl-k">+</span> zox_e</td>
        </tr>
        <tr>
          <td id="L2076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2076"></td>
          <td id="LC2076" class="blob-code blob-code-inner js-file-line">        rSO4_B1 <span class="pl-k">=</span> zox_c<span class="pl-k">*</span>rSO4_A3 <span class="pl-k">+</span> zox_d<span class="pl-k">*</span>rSO4_B3 <span class="pl-k">+</span> zox_f</td>
        </tr>
        <tr>
          <td id="L2077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2077"></td>
          <td id="LC2077" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2078"></td>
          <td id="LC2078" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rSO4_A3, rSO4_B3, rSO4_A2, rSO4_B2, rSO4_A1, rSO4_B1&#39;, rSO4_A3, rSO4_B3, rSO4_A2, rSO4_B2, rSO4_A1, rSO4_B1</span></td>
        </tr>
        <tr>
          <td id="L2079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2079"></td>
          <td id="LC2079" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2080"></td>
          <td id="LC2080" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2081"></td>
          <td id="LC2081" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zSO4_calcbc</span></td>
        </tr>
        <tr>
          <td id="L2082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2082"></td>
          <td id="LC2082" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2083"></td>
          <td id="LC2083" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L2084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2084"></td>
          <td id="LC2084" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2085"></td>
          <td id="LC2085" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2086"></td>
          <td id="LC2086" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2087"></td>
          <td id="LC2087" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2088"></td>
          <td id="LC2088" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcFSO4</span>(<span class="pl-v">z</span>)</td>
        </tr>
        <tr>
          <td id="L2089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2089"></td>
          <td id="LC2089" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2090"></td>
          <td id="LC2090" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcFSO4, z, tmpreac1, tmpreac2</td>
        </tr>
        <tr>
          <td id="L2091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2091"></td>
          <td id="LC2091" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2092"></td>
          <td id="LC2092" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate SO4 consumption below zso4, by organic matter and indirectly via methane oxidation</span></td>
        </tr>
        <tr>
          <td id="L2093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2093"></td>
          <td id="LC2093" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2094"></td>
          <td id="LC2094" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2095"></td>
          <td id="LC2095" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;..... START FUN_calcFSO4&#39;</span></td>
        </tr>
        <tr>
          <td id="L2096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2096"></td>
          <td id="LC2096" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2097"></td>
          <td id="LC2097" class="blob-code blob-code-inner js-file-line">        tmpreac1    <span class="pl-k">=</span> MC<span class="pl-k">*</span>gammaCH4</td>
        </tr>
        <tr>
          <td id="L2098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2098"></td>
          <td id="LC2098" class="blob-code blob-code-inner js-file-line">        tmpreac2    <span class="pl-k">=</span> MC<span class="pl-k">*</span>gammaCH4</td>
        </tr>
        <tr>
          <td id="L2099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2099"></td>
          <td id="LC2099" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        FUN_calcFSO4 = 0.0 ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L2100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2100"></td>
          <td id="LC2100" class="blob-code blob-code-inner js-file-line">        FUN_calcFSO4 <span class="pl-k">=</span> FUN_calcReac(z, zinf, tmpreac1, tmpreac2)</td>
        </tr>
        <tr>
          <td id="L2101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2101"></td>
          <td id="LC2101" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> TODO confirm (1-por)*  has been added (to k1 &amp; k2 ?)</span></td>
        </tr>
        <tr>
          <td id="L2102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2102"></td>
          <td id="LC2102" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;=============== IN FUN_calcFSO4 =====&#39;, FUN_calcFSO4</span></td>
        </tr>
        <tr>
          <td id="L2103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2103"></td>
          <td id="LC2103" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2104"></td>
          <td id="LC2104" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcFSO4</span></td>
        </tr>
        <tr>
          <td id="L2105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2105"></td>
          <td id="LC2105" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2106"></td>
          <td id="LC2106" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L2107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2107"></td>
          <td id="LC2107" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2108"></td>
          <td id="LC2108" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2109"></td>
          <td id="LC2109" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2110"></td>
          <td id="LC2110" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2111"></td>
          <td id="LC2111" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zSO4</span>(<span class="pl-v">z</span>)</td>
        </tr>
        <tr>
          <td id="L2112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2112"></td>
          <td id="LC2112" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2113"></td>
          <td id="LC2113" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_zSO4, z, flxzso4, conczso4, flxswi</td>
        </tr>
        <tr>
          <td id="L2114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2114"></td>
          <td id="LC2114" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2115"></td>
          <td id="LC2115" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2116"></td>
          <td id="LC2116" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;..... START FUN_zSO4&#39;</span></td>
        </tr>
        <tr>
          <td id="L2117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2117"></td>
          <td id="LC2117" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2118"></td>
          <td id="LC2118" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_huelseetal2016_zSO4_calcbc(z, <span class="pl-c1">1</span>, flxzso4, conczso4, flxswi)</td>
        </tr>
        <tr>
          <td id="L2119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2119"></td>
          <td id="LC2119" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2120"></td>
          <td id="LC2120" class="blob-code blob-code-inner js-file-line">        FUN_zSO4 <span class="pl-k">=</span> <span class="pl-k">-</span>flxzso4 <span class="pl-k">-</span> FUN_calcFSO4(z)</td>
        </tr>
        <tr>
          <td id="L2121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2121"></td>
          <td id="LC2121" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2122"></td>
          <td id="LC2122" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FUN_zSO4, flxzso4, FUN_calcFSO4(z)&#39;, FUN_zSO4, flxzso4, FUN_calcFSO4(z)</span></td>
        </tr>
        <tr>
          <td id="L2123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2123"></td>
          <td id="LC2123" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2124"></td>
          <td id="LC2124" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zSO4</span></td>
        </tr>
        <tr>
          <td id="L2125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2125"></td>
          <td id="LC2125" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2126"></td>
          <td id="LC2126" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2127"></td>
          <td id="LC2127" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2128"></td>
          <td id="LC2128" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2129"></td>
          <td id="LC2129" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2130"></td>
          <td id="LC2130" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                       Ammonium</span></td>
        </tr>
        <tr>
          <td id="L2131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2131"></td>
          <td id="LC2131" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2132"></td>
          <td id="LC2132" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2133"></td>
          <td id="LC2133" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2134"></td>
          <td id="LC2134" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2135"></td>
          <td id="LC2135" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2136"></td>
          <td id="LC2136" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNH4</span>(<span class="pl-v">dum_swiconc_NH4</span>, <span class="pl-v">loc_new_swiflux_NH4</span>)</td>
        </tr>
        <tr>
          <td id="L2137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2137"></td>
          <td id="LC2137" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2138"></td>
          <td id="LC2138" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L2139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2139"></td>
          <td id="LC2139" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_NH4                <span class="pl-c"><span class="pl-c">!</span> NH4 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2140"></td>
          <td id="LC2140" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_NH4         <span class="pl-c"><span class="pl-c">!</span> NH4 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L2141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2141"></td>
          <td id="LC2141" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2142"></td>
          <td id="LC2142" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2143"></td>
          <td id="LC2143" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2144"></td>
          <td id="LC2144" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real, intent(in)::zox, zno3</span></td>
        </tr>
        <tr>
          <td id="L2145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2145"></td>
          <td id="LC2145" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2146"></td>
          <td id="LC2146" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L2147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2147"></td>
          <td id="LC2147" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_conczinf</td>
        </tr>
        <tr>
          <td id="L2148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2148"></td>
          <td id="LC2148" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype1, ltype2, ltype3</td>
        </tr>
        <tr>
          <td id="L2149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2149"></td>
          <td id="LC2149" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L2150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2150"></td>
          <td id="LC2150" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L2151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2151"></td>
          <td id="LC2151" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3</td>
        </tr>
        <tr>
          <td id="L2152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2152"></td>
          <td id="LC2152" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zinf, dedz3_zinf, f3_zinf, dfdz3_zinf, g3_zinf, dgdz3_zinf</td>
        </tr>
        <tr>
          <td id="L2153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2153"></td>
          <td id="LC2153" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</td>
        </tr>
        <tr>
          <td id="L2154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2154"></td>
          <td id="LC2154" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3</td>
        </tr>
        <tr>
          <td id="L2155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2155"></td>
          <td id="LC2155" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f</td>
        </tr>
        <tr>
          <td id="L2156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2156"></td>
          <td id="LC2156" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox</td>
        </tr>
        <tr>
          <td id="L2157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2157"></td>
          <td id="LC2157" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0</td>
        </tr>
        <tr>
          <td id="L2158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2158"></td>
          <td id="LC2158" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox</td>
        </tr>
        <tr>
          <td id="L2159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2159"></td>
          <td id="LC2159" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</td>
        </tr>
        <tr>
          <td id="L2160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2160"></td>
          <td id="LC2160" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L2161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2161"></td>
          <td id="LC2161" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L2162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2162"></td>
          <td id="LC2162" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rNH4_A3, rNH4_B3</td>
        </tr>
        <tr>
          <td id="L2163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2163"></td>
          <td id="LC2163" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rNH4_A2, rNH4_B2</td>
        </tr>
        <tr>
          <td id="L2164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2164"></td>
          <td id="LC2164" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rNH4_A1, rNH4_B1</td>
        </tr>
        <tr>
          <td id="L2165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2165"></td>
          <td id="LC2165" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2166"></td>
          <td id="LC2166" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FNH4</td>
        </tr>
        <tr>
          <td id="L2167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2167"></td>
          <td id="LC2167" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2168"></td>
          <td id="LC2168" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2169"></td>
          <td id="LC2169" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L2170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2170"></td>
          <td id="LC2170" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zNH4 ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2171"></td>
          <td id="LC2171" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2172"></td>
          <td id="LC2172" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L2173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2173"></td>
          <td id="LC2173" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zox, NH4 prod (remaining after oxidation)</span></td>
        </tr>
        <tr>
          <td id="L2174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2174"></td>
          <td id="LC2174" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>      ls =      sub_prepfg_l12( bsd, swi, r, reac1,     reac2,     ktemp, zU, zL, D1,        D2)</span></td>
        </tr>
        <tr>
          <td id="L2175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2175"></td>
          <td id="LC2175" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12((<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4),(<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4),<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, DNH41, DNH42, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L2176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2176"></td>
          <td id="LC2176" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2177"></td>
          <td id="LC2177" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zox &lt; z &lt; zno3, passive diffn TODO NH4 from denitrification?</span></td>
        </tr>
        <tr>
          <td id="L2178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2178"></td>
          <td id="LC2178" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, zno3, DNH41, DNH42, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L2179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2179"></td>
          <td id="LC2179" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2180"></td>
          <td id="LC2180" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 3: zno3 &lt; z &lt; zinf, NH4 production</span></td>
        </tr>
        <tr>
          <td id="L2181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2181"></td>
          <td id="LC2181" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), <span class="pl-c1">0.0</span>, zno3, zinf, DNH41, DNH42, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, ltype3)</td>
        </tr>
        <tr>
          <td id="L2182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2182"></td>
          <td id="LC2182" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2183"></td>
          <td id="LC2183" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L2184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2184"></td>
          <td id="LC2184" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 3 zinf</span></td>
        </tr>
        <tr>
          <td id="L2185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2185"></td>
          <td id="LC2185" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zinf, NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DNH41, DNH42, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L2186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2186"></td>
          <td id="LC2186" class="blob-code blob-code-inner js-file-line">        e3_zinf, dedz3_zinf, f3_zinf, dfdz3_zinf, g3_zinf, dgdz3_zinf)</td>
        </tr>
        <tr>
          <td id="L2187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2187"></td>
          <td id="LC2187" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2188"></td>
          <td id="LC2188" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zno3, layer 2 - layer 3 (continuity and flux)</span></td>
        </tr>
        <tr>
          <td id="L2189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2189"></td>
          <td id="LC2189" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2190"></td>
          <td id="LC2190" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DNH41, DNH42, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2191"></td>
          <td id="LC2191" class="blob-code blob-code-inner js-file-line">        e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3)</td>
        </tr>
        <tr>
          <td id="L2192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2192"></td>
          <td id="LC2192" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2193"></td>
          <td id="LC2193" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 3</span></td>
        </tr>
        <tr>
          <td id="L2194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2194"></td>
          <td id="LC2194" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DNH41, DNH42, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L2195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2195"></td>
          <td id="LC2195" class="blob-code blob-code-inner js-file-line">        e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3)</td>
        </tr>
        <tr>
          <td id="L2196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2196"></td>
          <td id="LC2196" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2197"></td>
          <td id="LC2197" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zno3 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2198"></td>
          <td id="LC2198" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e2_zno3, f2_zno3, g2_zno3, dedz2_zno3, dfdz2_zno3, dgdz2_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L2199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2199"></td>
          <td id="LC2199" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L2200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2200"></td>
          <td id="LC2200" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f)</td>
        </tr>
        <tr>
          <td id="L2201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2201"></td>
          <td id="LC2201" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2202"></td>
          <td id="LC2202" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity, flux discontinuity from NH4 sink)</span></td>
        </tr>
        <tr>
          <td id="L2203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2203"></td>
          <td id="LC2203" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of NH4 to oxic interface  TODO NH4 prod by denitrification?</span></td>
        </tr>
        <tr>
          <td id="L2204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2204"></td>
          <td id="LC2204" class="blob-code blob-code-inner js-file-line">        FNH4 <span class="pl-k">=</span> FUN_calcReac(zno3, zinf, NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4))   <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L2205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2205"></td>
          <td id="LC2205" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2206"></td>
          <td id="LC2206" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2207"></td>
          <td id="LC2207" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, (<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4),(<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4) , <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DNH41, DNH42, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2208"></td>
          <td id="LC2208" class="blob-code blob-code-inner js-file-line">        e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox)</td>
        </tr>
        <tr>
          <td id="L2209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2209"></td>
          <td id="LC2209" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2210"></td>
          <td id="LC2210" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DNH41, DNH42, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2211"></td>
          <td id="LC2211" class="blob-code blob-code-inner js-file-line">        e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0)</td>
        </tr>
        <tr>
          <td id="L2212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2212"></td>
          <td id="LC2212" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2213"></td>
          <td id="LC2213" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l3</span></td>
        </tr>
        <tr>
          <td id="L2214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2214"></td>
          <td id="LC2214" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e2_zox0, f2_zox0, g2_zox0, dedz2_zox0, dfdz2_zox0, dgdz2_zox0, &amp;</td>
        </tr>
        <tr>
          <td id="L2215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2215"></td>
          <td id="LC2215" class="blob-code blob-code-inner js-file-line">        zno3_a , zno3_b , zno3_c , zno3_d , zno3_e ,zno3_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2216"></td>
          <td id="LC2216" class="blob-code blob-code-inner js-file-line">        e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox)</td>
        </tr>
        <tr>
          <td id="L2217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2217"></td>
          <td id="LC2217" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2218"></td>
          <td id="LC2218" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration, flux discontinuity from NH4 ox</span></td>
        </tr>
        <tr>
          <td id="L2219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2219"></td>
          <td id="LC2219" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox <span class="pl-k">.le.</span> zbio)<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L2220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2220"></td>
          <td id="LC2220" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2221"></td>
          <td id="LC2221" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2222"></td>
          <td id="LC2222" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, r_zxf<span class="pl-k">*</span>gamma<span class="pl-k">*</span>FNH4<span class="pl-k">/</span>DNH41, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2223"></td>
          <td id="LC2223" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L2224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2224"></td>
          <td id="LC2224" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2225"></td>
          <td id="LC2225" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2226"></td>
          <td id="LC2226" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, r_zxf<span class="pl-k">*</span>gamma<span class="pl-k">*</span>FNH4<span class="pl-k">/</span>DNH42, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2227"></td>
          <td id="LC2227" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2228"></td>
          <td id="LC2228" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2229"></td>
          <td id="LC2229" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2230"></td>
          <td id="LC2230" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2231"></td>
          <td id="LC2231" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, (<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC1<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), (<span class="pl-c1">1</span><span class="pl-k">-</span>gamma)<span class="pl-k">*</span>NC2<span class="pl-k">/</span>(<span class="pl-c1">1.0</span><span class="pl-k">+</span>KNH4), <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DNH41, DNH42, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2232"></td>
          <td id="LC2232" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L2233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2233"></td>
          <td id="LC2233" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2234"></td>
          <td id="LC2234" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l3</span></td>
        </tr>
        <tr>
          <td id="L2235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2235"></td>
          <td id="LC2235" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, &amp;</td>
        </tr>
        <tr>
          <td id="L2236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2236"></td>
          <td id="LC2236" class="blob-code blob-code-inner js-file-line">        zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2237"></td>
          <td id="LC2237" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L2238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2238"></td>
          <td id="LC2238" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2239"></td>
          <td id="LC2239" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for ANH4, BNH4 given boundary conditions (expressed in terms of transformed basis fns, layer 3 A, B)</span></td>
        </tr>
        <tr>
          <td id="L2240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2240"></td>
          <td id="LC2240" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANH4*dedz3_zinf   +  BNH4*dfdz3_zinf  + dgdz3_zinf = 0;</span></td>
        </tr>
        <tr>
          <td id="L2241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2241"></td>
          <td id="LC2241" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ANH4*e1_0     +   BNH4*f1_0     + g1_0  = swi.;</span></td>
        </tr>
        <tr>
          <td id="L2242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2242"></td>
          <td id="LC2242" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2243"></td>
          <td id="LC2243" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | dedz3_zinf dfdz3_zinf |  |ANH4|   = | -dgdz3_zinf       |</span></td>
        </tr>
        <tr>
          <td id="L2244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2244"></td>
          <td id="LC2244" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | e1_0     f1_0         |  |BNH4|     | swi. - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L2245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2245"></td>
          <td id="LC2245" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2246"></td>
          <td id="LC2246" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz3_zinf, dfdz3_zinf, e1_0, f1_0, <span class="pl-k">-</span>dgdz3_zinf,  <span class="pl-k">-</span> g1_0, rNH4_A3, rNH4_B3)</td>
        </tr>
        <tr>
          <td id="L2247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2247"></td>
          <td id="LC2247" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2248"></td>
          <td id="LC2248" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>calculate concentration at zinf</span></td>
        </tr>
        <tr>
          <td id="L2249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2249"></td>
          <td id="LC2249" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> rNH4_A3<span class="pl-k">*</span>e3_zinf<span class="pl-k">+</span>rNH4_B3<span class="pl-k">*</span>f3_zinf <span class="pl-k">+</span> g3_zinf</td>
        </tr>
        <tr>
          <td id="L2250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2250"></td>
          <td id="LC2250" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2251"></td>
          <td id="LC2251" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2252"></td>
          <td id="LC2252" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L2253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2253"></td>
          <td id="LC2253" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_NH4 <span class="pl-k">=</span> por<span class="pl-k">*</span>(DNH41<span class="pl-k">*</span>(rNH4_A3<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rNH4_B3<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0) <span class="pl-k">-</span> w<span class="pl-k">*</span>(dum_swiconc_NH4 <span class="pl-k">-</span> loc_conczinf))   <span class="pl-c"><span class="pl-c">!</span> NB: use A3, B3 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L2254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2254"></td>
          <td id="LC2254" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(<span class="pl-k">ABS</span>(loc_new_swiflux_NH4) <span class="pl-k">.LE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L2255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2255"></td>
          <td id="LC2255" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;small loc_new_swiflux_NH4&#39;, loc_new_swiflux_NH4</span></td>
        </tr>
        <tr>
          <td id="L2256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2256"></td>
          <td id="LC2256" class="blob-code blob-code-inner js-file-line">            loc_new_swiflux_NH4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2257"></td>
          <td id="LC2257" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2258"></td>
          <td id="LC2258" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2259"></td>
          <td id="LC2259" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layers 2 and 1</span></td>
        </tr>
        <tr>
          <td id="L2260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2260"></td>
          <td id="LC2260" class="blob-code blob-code-inner js-file-line">        rNH4_A2 <span class="pl-k">=</span> zno3_a<span class="pl-k">*</span>rNH4_A3 <span class="pl-k">+</span> zno3_b<span class="pl-k">*</span>rNH4_B3 <span class="pl-k">+</span> zno3_e</td>
        </tr>
        <tr>
          <td id="L2261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2261"></td>
          <td id="LC2261" class="blob-code blob-code-inner js-file-line">        rNH4_B2 <span class="pl-k">=</span> zno3_c<span class="pl-k">*</span>rNH4_A3 <span class="pl-k">+</span> zno3_d<span class="pl-k">*</span>rNH4_B3 <span class="pl-k">+</span> zno3_f</td>
        </tr>
        <tr>
          <td id="L2262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2262"></td>
          <td id="LC2262" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2263"></td>
          <td id="LC2263" class="blob-code blob-code-inner js-file-line">        rNH4_A1 <span class="pl-k">=</span> zox_a<span class="pl-k">*</span>rNH4_A3 <span class="pl-k">+</span> zox_b<span class="pl-k">*</span>rNH4_B3 <span class="pl-k">+</span> zox_e</td>
        </tr>
        <tr>
          <td id="L2264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2264"></td>
          <td id="LC2264" class="blob-code blob-code-inner js-file-line">        rNH4_B1 <span class="pl-k">=</span> zox_c<span class="pl-k">*</span>rNH4_A3 <span class="pl-k">+</span> zox_d<span class="pl-k">*</span>rNH4_B3 <span class="pl-k">+</span> zox_f</td>
        </tr>
        <tr>
          <td id="L2265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2265"></td>
          <td id="LC2265" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2266"></td>
          <td id="LC2266" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2267"></td>
          <td id="LC2267" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;INPUT1: por, DNH41, rNH4_A3, dedz1_0, rNH4_B3, dfdz1_0 , dgdz1_0&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2268"></td>
          <td id="LC2268" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; por, DNH41, rNH4_A3, dedz1_0, rNH4_B3, dfdz1_0 , dgdz1_0</span></td>
        </tr>
        <tr>
          <td id="L2269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2269"></td>
          <td id="LC2269" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;INPUT2: zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2270"></td>
          <td id="LC2270" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f</span></td>
        </tr>
        <tr>
          <td id="L2271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2271"></td>
          <td id="LC2271" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2272"></td>
          <td id="LC2272" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; ---------------- RESULTS: benthic_zNH4 ---------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2273"></td>
          <td id="LC2273" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;loc_new_swiflux_NH4&#39;, char(9), loc_new_swiflux_NH4</span></td>
        </tr>
        <tr>
          <td id="L2274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2274"></td>
          <td id="LC2274" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2275"></td>
          <td id="LC2275" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rNH4_A3, rNH4_B3, rNH4_A2, rNH4_B2, rNH4_A1, rNH4_B1&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2276"></td>
          <td id="LC2276" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>          &amp;  rNH4_A3, rNH4_B3, rNH4_A2, rNH4_B2, rNH4_A1, rNH4_B1</span></td>
        </tr>
        <tr>
          <td id="L2277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2277"></td>
          <td id="LC2277" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2278"></td>
          <td id="LC2278" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2279"></td>
          <td id="LC2279" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zNH4</span></td>
        </tr>
        <tr>
          <td id="L2280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2280"></td>
          <td id="LC2280" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="L2281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2281"></td>
          <td id="LC2281" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2282"></td>
          <td id="LC2282" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2283"></td>
          <td id="LC2283" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2284"></td>
          <td id="LC2284" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2285"></td>
          <td id="LC2285" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           Hydrogen Sulfide</span></td>
        </tr>
        <tr>
          <td id="L2286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2286"></td>
          <td id="LC2286" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2287"></td>
          <td id="LC2287" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2288"></td>
          <td id="LC2288" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2289"></td>
          <td id="LC2289" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2290"></td>
          <td id="LC2290" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2291"></td>
          <td id="LC2291" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zH2S</span>(<span class="pl-v">dum_swiconc_H2S</span>, <span class="pl-v">loc_new_swiflux_H2S</span>)</td>
        </tr>
        <tr>
          <td id="L2292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2292"></td>
          <td id="LC2292" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2293"></td>
          <td id="LC2293" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L2294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2294"></td>
          <td id="LC2294" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_H2S                <span class="pl-c"><span class="pl-c">!</span> SO4 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2295"></td>
          <td id="LC2295" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_H2S         <span class="pl-c"><span class="pl-c">!</span> SO4 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L2296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2296"></td>
          <td id="LC2296" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2297"></td>
          <td id="LC2297" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2298"></td>
          <td id="LC2298" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L2299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2299"></td>
          <td id="LC2299" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_conczinf</td>
        </tr>
        <tr>
          <td id="L2300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2300"></td>
          <td id="LC2300" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1_h2s, reac2_h2s                 <span class="pl-c"><span class="pl-c">!</span> reactive terms: OM degradation</span></td>
        </tr>
        <tr>
          <td id="L2301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2301"></td>
          <td id="LC2301" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype1, ltype2, ltype3, ltype4</td>
        </tr>
        <tr>
          <td id="L2302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2302"></td>
          <td id="LC2302" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L2303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2303"></td>
          <td id="LC2303" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L2304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2304"></td>
          <td id="LC2304" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3</td>
        </tr>
        <tr>
          <td id="L2305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2305"></td>
          <td id="LC2305" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4</td>
        </tr>
        <tr>
          <td id="L2306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2306"></td>
          <td id="LC2306" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e4_zinf, dedz4_zinf, f4_zinf, dfdz4_zinf, g4_zinf, dgdz4_zinf</td>
        </tr>
        <tr>
          <td id="L2307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2307"></td>
          <td id="LC2307" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4</td>
        </tr>
        <tr>
          <td id="L2308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2308"></td>
          <td id="LC2308" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4</td>
        </tr>
        <tr>
          <td id="L2309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2309"></td>
          <td id="LC2309" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f</td>
        </tr>
        <tr>
          <td id="L2310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2310"></td>
          <td id="LC2310" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</td>
        </tr>
        <tr>
          <td id="L2311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2311"></td>
          <td id="LC2311" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30</td>
        </tr>
        <tr>
          <td id="L2312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2312"></td>
          <td id="LC2312" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3</td>
        </tr>
        <tr>
          <td id="L2313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2313"></td>
          <td id="LC2313" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f</td>
        </tr>
        <tr>
          <td id="L2314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2314"></td>
          <td id="LC2314" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox</td>
        </tr>
        <tr>
          <td id="L2315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2315"></td>
          <td id="LC2315" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0</td>
        </tr>
        <tr>
          <td id="L2316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2316"></td>
          <td id="LC2316" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox</td>
        </tr>
        <tr>
          <td id="L2317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2317"></td>
          <td id="LC2317" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</td>
        </tr>
        <tr>
          <td id="L2318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2318"></td>
          <td id="LC2318" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L2319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2319"></td>
          <td id="LC2319" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L2320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2320"></td>
          <td id="LC2320" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2321"></td>
          <td id="LC2321" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rH2S_A4, rH2S_B4</td>
        </tr>
        <tr>
          <td id="L2322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2322"></td>
          <td id="LC2322" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rH2S_A3, rH2S_B3</td>
        </tr>
        <tr>
          <td id="L2323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2323"></td>
          <td id="LC2323" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rH2S_A2, rH2S_B2</td>
        </tr>
        <tr>
          <td id="L2324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2324"></td>
          <td id="LC2324" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rH2S_A1, rH2S_B1</td>
        </tr>
        <tr>
          <td id="L2325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2325"></td>
          <td id="LC2325" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2326"></td>
          <td id="LC2326" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4FH2S, zoxFH2S</td>
        </tr>
        <tr>
          <td id="L2327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2327"></td>
          <td id="LC2327" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real flxswiH2S</span></td>
        </tr>
        <tr>
          <td id="L2328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2328"></td>
          <td id="LC2328" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2329"></td>
          <td id="LC2329" class="blob-code blob-code-inner js-file-line">        reac1_h2s<span class="pl-k">=</span>SO4C</td>
        </tr>
        <tr>
          <td id="L2330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2330"></td>
          <td id="LC2330" class="blob-code blob-code-inner js-file-line">        reac2_h2s<span class="pl-k">=</span>SO4C</td>
        </tr>
        <tr>
          <td id="L2331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2331"></td>
          <td id="LC2331" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2332"></td>
          <td id="LC2332" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2333"></td>
          <td id="LC2333" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L2334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2334"></td>
          <td id="LC2334" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zH2S ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2335"></td>
          <td id="LC2335" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; BWI H2S concentration = &#39;, dum_swiconc_H2S</span></td>
        </tr>
        <tr>
          <td id="L2336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2336"></td>
          <td id="LC2336" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2337"></td>
          <td id="LC2337" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate H2S</span></td>
        </tr>
        <tr>
          <td id="L2338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2338"></td>
          <td id="LC2338" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2339"></td>
          <td id="LC2339" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L2340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2340"></td>
          <td id="LC2340" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zox, passive diffn</span></td>
        </tr>
        <tr>
          <td id="L2341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2341"></td>
          <td id="LC2341" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  ls =      sub_prepfg_l12( bsd, swi, r, reac1,     reac2,     ktemp, zU, zL, D1,        D2)</span></td>
        </tr>
        <tr>
          <td id="L2342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2342"></td>
          <td id="LC2342" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, DH2S1, DH2S2, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L2343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2343"></td>
          <td id="LC2343" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2344"></td>
          <td id="LC2344" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zox &lt; z &lt; zno3, passive diffn</span></td>
        </tr>
        <tr>
          <td id="L2345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2345"></td>
          <td id="LC2345" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, zno3, DH2S1, DH2S2, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L2346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2346"></td>
          <td id="LC2346" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2347"></td>
          <td id="LC2347" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 3: zno3 &lt; z &lt; zso4, H2S consumption by OM oxidation</span></td>
        </tr>
        <tr>
          <td id="L2348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2348"></td>
          <td id="LC2348" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac1_h2s, reac2_h2s, <span class="pl-c1">0.0</span>, zno3, zso4, DH2S1, DH2S2, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, ltype3)</td>
        </tr>
        <tr>
          <td id="L2349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2349"></td>
          <td id="LC2349" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2350"></td>
          <td id="LC2350" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 4: zso4 &lt; z &lt; zinf, passive diffn</span></td>
        </tr>
        <tr>
          <td id="L2351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2351"></td>
          <td id="LC2351" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zso4, zinf, DH2S1, DH2S2, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, ltype4)</td>
        </tr>
        <tr>
          <td id="L2352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2352"></td>
          <td id="LC2352" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2353"></td>
          <td id="LC2353" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L2354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2354"></td>
          <td id="LC2354" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 4 zinf</span></td>
        </tr>
        <tr>
          <td id="L2355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2355"></td>
          <td id="LC2355" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zinf, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, DH2S1, DH2S2, ltype4, &amp;</td>
        </tr>
        <tr>
          <td id="L2356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2356"></td>
          <td id="LC2356" class="blob-code blob-code-inner js-file-line">        e4_zinf, dedz4_zinf, f4_zinf, dfdz4_zinf, g4_zinf, dgdz4_zinf)</td>
        </tr>
        <tr>
          <td id="L2357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2357"></td>
          <td id="LC2357" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2358"></td>
          <td id="LC2358" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zso4, layer 3 - layer 4 (continuity and flux with AOM production)</span></td>
        </tr>
        <tr>
          <td id="L2359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2359"></td>
          <td id="LC2359" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 3</span></td>
        </tr>
        <tr>
          <td id="L2360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2360"></td>
          <td id="LC2360" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac1_h2s, reac2_h2s, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DH2S1, DH2S2, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L2361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2361"></td>
          <td id="LC2361" class="blob-code blob-code-inner js-file-line">        e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4)</td>
        </tr>
        <tr>
          <td id="L2362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2362"></td>
          <td id="LC2362" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2363"></td>
          <td id="LC2363" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4 &#39;, e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4</span></td>
        </tr>
        <tr>
          <td id="L2364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2364"></td>
          <td id="LC2364" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2365"></td>
          <td id="LC2365" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 4</span></td>
        </tr>
        <tr>
          <td id="L2366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2366"></td>
          <td id="LC2366" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, <span class="pl-c1">0.0</span>,  <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, DH2S1, DH2S2, ltype4, &amp;</td>
        </tr>
        <tr>
          <td id="L2367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2367"></td>
          <td id="LC2367" class="blob-code blob-code-inner js-file-line">        e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4)</td>
        </tr>
        <tr>
          <td id="L2368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2368"></td>
          <td id="LC2368" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4 &#39;, e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4</span></td>
        </tr>
        <tr>
          <td id="L2369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2369"></td>
          <td id="LC2369" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2370"></td>
          <td id="LC2370" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of H2S produced by AOM interface (Source of H2S)</span></td>
        </tr>
        <tr>
          <td id="L2371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2371"></td>
          <td id="LC2371" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        zso4FH2S = 0.0 ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L2372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2372"></td>
          <td id="LC2372" class="blob-code blob-code-inner js-file-line">        zso4FH2S <span class="pl-k">=</span> FUN_calcReac(zso4, zinf, MC, MC) <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L2373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2373"></td>
          <td id="LC2373" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   print*,&#39;flux of H2S produced by AOM interface zso4FH2S = &#39;, zso4FH2S</span></td>
        </tr>
        <tr>
          <td id="L2374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2374"></td>
          <td id="LC2374" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2375"></td>
          <td id="LC2375" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zso4 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2376"></td>
          <td id="LC2376" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e3_zso4, f3_zso4, g3_zso4, dedz3_zso4, dfdz3_zso4, dgdz3_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2377"></td>
          <td id="LC2377" class="blob-code blob-code-inner js-file-line">        e4_zso4, f4_zso4, g4_zso4, dedz4_zso4, dfdz4_zso4, dgdz4_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2378"></td>
          <td id="LC2378" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>gammaCH4<span class="pl-k">*</span>zso4FH2S<span class="pl-k">/</span>DH2S2, zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f)</td>
        </tr>
        <tr>
          <td id="L2379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2379"></td>
          <td id="LC2379" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f &#39;, zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f</span></td>
        </tr>
        <tr>
          <td id="L2380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2380"></td>
          <td id="LC2380" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2381"></td>
          <td id="LC2381" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zno3, layer 2 - layer 3 (continuity and flux)</span></td>
        </tr>
        <tr>
          <td id="L2382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2382"></td>
          <td id="LC2382" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2383"></td>
          <td id="LC2383" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DH2S1, DH2S2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2384"></td>
          <td id="LC2384" class="blob-code blob-code-inner js-file-line">        e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3)</td>
        </tr>
        <tr>
          <td id="L2385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2385"></td>
          <td id="LC2385" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3 &#39;, e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</span></td>
        </tr>
        <tr>
          <td id="L2386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2386"></td>
          <td id="LC2386" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2387"></td>
          <td id="LC2387" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 3</span></td>
        </tr>
        <tr>
          <td id="L2388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2388"></td>
          <td id="LC2388" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, reac1_h2s, reac2_h2s, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DH2S1, DH2S2, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L2389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2389"></td>
          <td id="LC2389" class="blob-code blob-code-inner js-file-line">        e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30)</td>
        </tr>
        <tr>
          <td id="L2390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2390"></td>
          <td id="LC2390" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30 &#39;, e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30</span></td>
        </tr>
        <tr>
          <td id="L2391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2391"></td>
          <td id="LC2391" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2392"></td>
          <td id="LC2392" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... transformed to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L2393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2393"></td>
          <td id="LC2393" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e3_zno30, f3_zno30, g3_zno30, dedz3_zno30, dfdz3_zno30, dgdz3_zno30, &amp;</td>
        </tr>
        <tr>
          <td id="L2394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2394"></td>
          <td id="LC2394" class="blob-code blob-code-inner js-file-line">        zso4_a , zso4_b , zso4_c , zso4_d , zso4_e ,zso4_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2395"></td>
          <td id="LC2395" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3)</td>
        </tr>
        <tr>
          <td id="L2396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2396"></td>
          <td id="LC2396" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3 &#39;, e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3</span></td>
        </tr>
        <tr>
          <td id="L2397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2397"></td>
          <td id="LC2397" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2398"></td>
          <td id="LC2398" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2399"></td>
          <td id="LC2399" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zno3 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2400"></td>
          <td id="LC2400" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e2_zno3, f2_zno3, g2_zno3, dedz2_zno3, dfdz2_zno3, dgdz2_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L2401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2401"></td>
          <td id="LC2401" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L2402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2402"></td>
          <td id="LC2402" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f)</td>
        </tr>
        <tr>
          <td id="L2403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2403"></td>
          <td id="LC2403" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f &#39;, zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f</span></td>
        </tr>
        <tr>
          <td id="L2404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2404"></td>
          <td id="LC2404" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2405"></td>
          <td id="LC2405" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2406"></td>
          <td id="LC2406" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity, flux discontinuity from H2S source)</span></td>
        </tr>
        <tr>
          <td id="L2407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2407"></td>
          <td id="LC2407" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of H2S to oxic interface (from all sources of H2S below)</span></td>
        </tr>
        <tr>
          <td id="L2408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2408"></td>
          <td id="LC2408" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NB: include methane region as AOM will produce sulphide as well..</span></td>
        </tr>
        <tr>
          <td id="L2409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2409"></td>
          <td id="LC2409" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        zoxFH2S = 0.0   !FUN_calcReac(zno3, zso4, SO4C, SO4C)  + 0.0   ! no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L2410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2410"></td>
          <td id="LC2410" class="blob-code blob-code-inner js-file-line">        zoxFH2S <span class="pl-k">=</span> FUN_calcReac(zno3, zso4, SO4C, SO4C)  <span class="pl-k">+</span> FUN_calcReac(zso4, zinf, MC, MC)</td>
        </tr>
        <tr>
          <td id="L2411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2411"></td>
          <td id="LC2411" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2412"></td>
          <td id="LC2412" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;flux of H2S to oxic interface zoxFH2S = &#39;, zoxFH2S</span></td>
        </tr>
        <tr>
          <td id="L2413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2413"></td>
          <td id="LC2413" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2414"></td>
          <td id="LC2414" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2415"></td>
          <td id="LC2415" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2416"></td>
          <td id="LC2416" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DH2S1, DH2S2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2417"></td>
          <td id="LC2417" class="blob-code blob-code-inner js-file-line">        e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox)</td>
        </tr>
        <tr>
          <td id="L2418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2418"></td>
          <td id="LC2418" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2419"></td>
          <td id="LC2419" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2420"></td>
          <td id="LC2420" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DH2S1, DH2S2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2421"></td>
          <td id="LC2421" class="blob-code blob-code-inner js-file-line">        e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0)</td>
        </tr>
        <tr>
          <td id="L2422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2422"></td>
          <td id="LC2422" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2423"></td>
          <td id="LC2423" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   transform to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L2424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2424"></td>
          <td id="LC2424" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e2_zox0, f2_zox0, g2_zox0, dedz2_zox0, dfdz2_zox0, dgdz2_zox0, &amp;</td>
        </tr>
        <tr>
          <td id="L2425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2425"></td>
          <td id="LC2425" class="blob-code blob-code-inner js-file-line">        zno3_a , zno3_b , zno3_c , zno3_d , zno3_e ,zno3_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2426"></td>
          <td id="LC2426" class="blob-code blob-code-inner js-file-line">        e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox)</td>
        </tr>
        <tr>
          <td id="L2427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2427"></td>
          <td id="LC2427" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2428"></td>
          <td id="LC2428" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration, flux discontinuity from H2S ox</span></td>
        </tr>
        <tr>
          <td id="L2429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2429"></td>
          <td id="LC2429" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2430"></td>
          <td id="LC2430" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox <span class="pl-k">.le.</span> zbio) <span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L2431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2431"></td>
          <td id="LC2431" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2432"></td>
          <td id="LC2432" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2433"></td>
          <td id="LC2433" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, r_zxf<span class="pl-k">*</span>gammaH2S<span class="pl-k">*</span>zoxFH2S<span class="pl-k">/</span>DH2S1, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2434"></td>
          <td id="LC2434" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L2435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2435"></td>
          <td id="LC2435" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2436"></td>
          <td id="LC2436" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2437"></td>
          <td id="LC2437" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, r_zxf<span class="pl-k">*</span>gammaH2S<span class="pl-k">*</span>zoxFH2S<span class="pl-k">/</span>DH2S2, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L2438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2438"></td>
          <td id="LC2438" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2439"></td>
          <td id="LC2439" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2440"></td>
          <td id="LC2440" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2441"></td>
          <td id="LC2441" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DH2S1, DH2S2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2442"></td>
          <td id="LC2442" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L2443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2443"></td>
          <td id="LC2443" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2444"></td>
          <td id="LC2444" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L2445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2445"></td>
          <td id="LC2445" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, &amp;</td>
        </tr>
        <tr>
          <td id="L2446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2446"></td>
          <td id="LC2446" class="blob-code blob-code-inner js-file-line">        zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2447"></td>
          <td id="LC2447" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L2448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2448"></td>
          <td id="LC2448" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2449"></td>
          <td id="LC2449" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for AH2S, BH2S given boundary conditions (expressed in terms of transformed basis fns, layer 4 A, B)</span></td>
        </tr>
        <tr>
          <td id="L2450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2450"></td>
          <td id="LC2450" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  AH2S*dedz4_zinf   +  BH2S*dfz4_zinf  + dgz4_zinf = 0;          % zero flux at zinf</span></td>
        </tr>
        <tr>
          <td id="L2451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2451"></td>
          <td id="LC2451" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  AH2S*e1_0     +   BH2S*f1_0     + g1_0  = swi.dum_swiconc_H2S;</span></td>
        </tr>
        <tr>
          <td id="L2452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2452"></td>
          <td id="LC2452" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2453"></td>
          <td id="LC2453" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | dedz4_zinf dfdz4_zinf |  |AH2S|   = | -dgz4_zinf       |</span></td>
        </tr>
        <tr>
          <td id="L2454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2454"></td>
          <td id="LC2454" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | e1_0     f1_0         |  |BH2S|     | swi.dum_swiconc_H2S - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L2455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2455"></td>
          <td id="LC2455" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2456"></td>
          <td id="LC2456" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz4_zinf, dfdz4_zinf, e1_0, f1_0, <span class="pl-k">-</span>dgdz4_zinf, dum_swiconc_H2S <span class="pl-k">-</span> g1_0, rH2S_A4, rH2S_B4)</td>
        </tr>
        <tr>
          <td id="L2457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2457"></td>
          <td id="LC2457" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   print*,&#39; dedz4_zinf, dfdz4_zinf, e1_0, f1_0, dgdz4_zinf, dum_swiconc_H2S, g1_0 &#39;,  dedz4_zinf, dfdz4_zinf, e1_0, f1_0, dgdz4_zinf, dum_swiconc_H2S, g1_0</span></td>
        </tr>
        <tr>
          <td id="L2458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2458"></td>
          <td id="LC2458" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2459"></td>
          <td id="LC2459" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate concentration at zinf</span></td>
        </tr>
        <tr>
          <td id="L2460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2460"></td>
          <td id="LC2460" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> rH2S_A4<span class="pl-k">*</span>e4_zinf<span class="pl-k">+</span>rH2S_B4<span class="pl-k">*</span>f4_zinf <span class="pl-k">+</span> g4_zinf</td>
        </tr>
        <tr>
          <td id="L2461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2461"></td>
          <td id="LC2461" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2462"></td>
          <td id="LC2462" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L2463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2463"></td>
          <td id="LC2463" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_H2S <span class="pl-k">=</span> por<span class="pl-k">*</span>(DH2S1<span class="pl-k">*</span>(rH2S_A4<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rH2S_B4<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0) <span class="pl-k">-</span> w<span class="pl-k">*</span>(dum_swiconc_H2S <span class="pl-k">-</span> loc_conczinf))   <span class="pl-c"><span class="pl-c">!</span> NB: use A4, B4 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L2464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2464"></td>
          <td id="LC2464" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(<span class="pl-k">ABS</span>(loc_new_swiflux_H2S) <span class="pl-k">.LE.</span> const_real_nullsmall)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L2465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2465"></td>
          <td id="LC2465" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;small loc_new_swiflux_H2S&#39;, loc_new_swiflux_H2S</span></td>
        </tr>
        <tr>
          <td id="L2466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2466"></td>
          <td id="LC2466" class="blob-code blob-code-inner js-file-line">            loc_new_swiflux_H2S <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2467"></td>
          <td id="LC2467" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L2468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2468"></td>
          <td id="LC2468" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2469"></td>
          <td id="LC2469" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2470"></td>
          <td id="LC2470" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layers 3, 2 and 1</span></td>
        </tr>
        <tr>
          <td id="L2471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2471"></td>
          <td id="LC2471" class="blob-code blob-code-inner js-file-line">        rH2S_A3 <span class="pl-k">=</span> zso4_a<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zso4_b<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zso4_e</td>
        </tr>
        <tr>
          <td id="L2472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2472"></td>
          <td id="LC2472" class="blob-code blob-code-inner js-file-line">        rH2S_B3 <span class="pl-k">=</span> zso4_c<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zso4_d<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zso4_f</td>
        </tr>
        <tr>
          <td id="L2473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2473"></td>
          <td id="LC2473" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2474"></td>
          <td id="LC2474" class="blob-code blob-code-inner js-file-line">        rH2S_A2 <span class="pl-k">=</span> zno3_a<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zno3_b<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zno3_e</td>
        </tr>
        <tr>
          <td id="L2475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2475"></td>
          <td id="LC2475" class="blob-code blob-code-inner js-file-line">        rH2S_B2 <span class="pl-k">=</span> zno3_c<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zno3_d<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zno3_f</td>
        </tr>
        <tr>
          <td id="L2476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2476"></td>
          <td id="LC2476" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2477"></td>
          <td id="LC2477" class="blob-code blob-code-inner js-file-line">        rH2S_A1 <span class="pl-k">=</span> zox_a<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zox_b<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zox_e</td>
        </tr>
        <tr>
          <td id="L2478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2478"></td>
          <td id="LC2478" class="blob-code blob-code-inner js-file-line">        rH2S_B1 <span class="pl-k">=</span> zox_c<span class="pl-k">*</span>rH2S_A4 <span class="pl-k">+</span> zox_d<span class="pl-k">*</span>rH2S_B4 <span class="pl-k">+</span> zox_f</td>
        </tr>
        <tr>
          <td id="L2479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2479"></td>
          <td id="LC2479" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2480"></td>
          <td id="LC2480" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; ---------------- RESULTS: benthic_zH2S ---------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2481"></td>
          <td id="LC2481" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;loc_new_swiflux_H2S &#39;, char(9), loc_new_swiflux_H2S</span></td>
        </tr>
        <tr>
          <td id="L2482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2482"></td>
          <td id="LC2482" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rH2S_A4, rH2S_B4, rH2S_A3, rH2S_B3, rH2S_A2, rH2S_B2, rH2S_A1, rH2S_B1&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2483"></td>
          <td id="LC2483" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>          &amp;  rH2S_A4, rH2S_B4, rH2S_A3, rH2S_B3, rH2S_A2, rH2S_B2, rH2S_A1, rH2S_B1</span></td>
        </tr>
        <tr>
          <td id="L2484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2484"></td>
          <td id="LC2484" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2485"></td>
          <td id="LC2485" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2486"></td>
          <td id="LC2486" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   print*,&#39;INPUT1: dedz4_zinf, dfdz4_zinf, e1_0, f1_0, -dgdz4_zinf, dum_swiconc_H2S - g1_0&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2487"></td>
          <td id="LC2487" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>           &amp; dedz4_zinf, dfdz4_zinf, e1_0, f1_0, -dgdz4_zinf, dum_swiconc_H2S - g1_0</span></td>
        </tr>
        <tr>
          <td id="L2488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2488"></td>
          <td id="LC2488" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;INPUT2: zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2489"></td>
          <td id="LC2489" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f</span></td>
        </tr>
        <tr>
          <td id="L2490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2490"></td>
          <td id="LC2490" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;RESULTS:  rH2S_A4, rH2S_B4&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2491"></td>
          <td id="LC2491" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; rH2S_A4, rH2S_B4</span></td>
        </tr>
        <tr>
          <td id="L2492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2492"></td>
          <td id="LC2492" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2493"></td>
          <td id="LC2493" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zH2S</span></td>
        </tr>
        <tr>
          <td id="L2494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2494"></td>
          <td id="LC2494" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2495"></td>
          <td id="LC2495" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2496"></td>
          <td id="LC2496" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2497"></td>
          <td id="LC2497" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2498"></td>
          <td id="LC2498" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2499"></td>
          <td id="LC2499" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2500"></td>
          <td id="LC2500" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           Phosphate and Fe-bound P</span></td>
        </tr>
        <tr>
          <td id="L2501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2501"></td>
          <td id="LC2501" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2502"></td>
          <td id="LC2502" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2503"></td>
          <td id="LC2503" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2504"></td>
          <td id="LC2504" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2505"></td>
          <td id="LC2505" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2506"></td>
          <td id="LC2506" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zPO4_M</span>(<span class="pl-v">dum_swiconc_PO4</span>, <span class="pl-v">loc_new_swiflux_PO4</span>, <span class="pl-v">dum_swiflux_M</span>, <span class="pl-v">loc_new_swiflux_M</span>)</td>
        </tr>
        <tr>
          <td id="L2507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2507"></td>
          <td id="LC2507" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2508"></td>
          <td id="LC2508" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L2509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2509"></td>
          <td id="LC2509" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_PO4                <span class="pl-c"><span class="pl-c">!</span> PO4 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2510"></td>
          <td id="LC2510" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_PO4         <span class="pl-c"><span class="pl-c">!</span> PO4 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L2511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2511"></td>
          <td id="LC2511" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiflux_M                <span class="pl-c"><span class="pl-c">!</span> PO4 concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2512"></td>
          <td id="LC2512" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_M         <span class="pl-c"><span class="pl-c">!</span> PO4 flux: TODO check! (+) sediment -&gt; bottom waters</span></td>
        </tr>
        <tr>
          <td id="L2513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2513"></td>
          <td id="LC2513" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2514"></td>
          <td id="LC2514" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L2515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2515"></td>
          <td id="LC2515" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_conczinf</td>
        </tr>
        <tr>
          <td id="L2516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2516"></td>
          <td id="LC2516" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Integration constants</span></td>
        </tr>
        <tr>
          <td id="L2517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2517"></td>
          <td id="LC2517" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rPO4_M_A2, rPO4_M_B2, rPO4_M_C2, rPO4_M_D2</td>
        </tr>
        <tr>
          <td id="L2518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2518"></td>
          <td id="LC2518" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2519"></td>
          <td id="LC2519" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> dum_ltype1, dum_ltype2</td>
        </tr>
        <tr>
          <td id="L2520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2520"></td>
          <td id="LC2520" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">4</span>, <span class="pl-c1">4</span>) <span class="pl-k">::</span> dum_mat_C1, dum_mat_C2</td>
        </tr>
        <tr>
          <td id="L2521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2521"></td>
          <td id="LC2521" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span>  dum_vec_D1, dum_vec_D2</td>
        </tr>
        <tr>
          <td id="L2522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2522"></td>
          <td id="LC2522" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> loc_i, loc_j</td>
        </tr>
        <tr>
          <td id="L2523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2523"></td>
          <td id="LC2523" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2524"></td>
          <td id="LC2524" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1_po4_ox, reac2_po4_ox, reac1_po4_anox, reac2_po4_anox                 <span class="pl-c"><span class="pl-c">!</span> reactive terms: OM degradation</span></td>
        </tr>
        <tr>
          <td id="L2525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2525"></td>
          <td id="LC2525" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2526"></td>
          <td id="LC2526" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> all the base functions for boundary matching</span></td>
        </tr>
        <tr>
          <td id="L2527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2527"></td>
          <td id="LC2527" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> i.e. ODE solutions (E, F, P, Q) and the particulat integral (G) and their derivatives</span></td>
        </tr>
        <tr>
          <td id="L2528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2528"></td>
          <td id="LC2528" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> at zinf</span></td>
        </tr>
        <tr>
          <td id="L2529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2529"></td>
          <td id="LC2529" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zinf_P, dedz2_zinf_P, f2_zinf_P, dfdz2_zinf_P, g2_zinf_P, dgdz2_zinf_P</td>
        </tr>
        <tr>
          <td id="L2530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2530"></td>
          <td id="LC2530" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p2_zinf_P, dpdz2_zinf_P, q2_zinf_P, dqdz2_zinf_P</td>
        </tr>
        <tr>
          <td id="L2531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2531"></td>
          <td id="LC2531" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zinf_M, dedz2_zinf_M, f2_zinf_M, dfdz2_zinf_M, g2_zinf_M, dgdz2_zinf_M</td>
        </tr>
        <tr>
          <td id="L2532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2532"></td>
          <td id="LC2532" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p2_zinf_M, dpdz2_zinf_M, q2_zinf_M, dqdz2_zinf_M</td>
        </tr>
        <tr>
          <td id="L2533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2533"></td>
          <td id="LC2533" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> at zox (above)</span></td>
        </tr>
        <tr>
          <td id="L2534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2534"></td>
          <td id="LC2534" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox_P, dedz1_zox_P, f1_zox_P, dfdz1_zox_P, g1_zox_P, dgdz1_zox_P</td>
        </tr>
        <tr>
          <td id="L2535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2535"></td>
          <td id="LC2535" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p1_zox_P, dpdz1_zox_P, q1_zox_P, dqdz1_zox_P</td>
        </tr>
        <tr>
          <td id="L2536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2536"></td>
          <td id="LC2536" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox_M, dedz1_zox_M, f1_zox_M, dfdz1_zox_M, g1_zox_M, dgdz1_zox_M</td>
        </tr>
        <tr>
          <td id="L2537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2537"></td>
          <td id="LC2537" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p1_zox_M, dpdz1_zox_M, q1_zox_M, dqdz1_zox_M</td>
        </tr>
        <tr>
          <td id="L2538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2538"></td>
          <td id="LC2538" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> at zox (below)</span></td>
        </tr>
        <tr>
          <td id="L2539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2539"></td>
          <td id="LC2539" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox_P, dedz2_zox_P, f2_zox_P, dfdz2_zox_P, g2_zox_P, dgdz2_zox_P</td>
        </tr>
        <tr>
          <td id="L2540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2540"></td>
          <td id="LC2540" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p2_zox_P, dpdz2_zox_P, q2_zox_P, dqdz2_zox_P</td>
        </tr>
        <tr>
          <td id="L2541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2541"></td>
          <td id="LC2541" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox_M, dedz2_zox_M, f2_zox_M, dfdz2_zox_M, g2_zox_M, dgdz2_zox_M</td>
        </tr>
        <tr>
          <td id="L2542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2542"></td>
          <td id="LC2542" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p2_zox_M, dpdz2_zox_M, q2_zox_M, dqdz2_zox_M</td>
        </tr>
        <tr>
          <td id="L2543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2543"></td>
          <td id="LC2543" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> at SWI (z0)</span></td>
        </tr>
        <tr>
          <td id="L2544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2544"></td>
          <td id="LC2544" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_z0_P, dedz1_z0_P, f1_z0_P, dfdz1_z0_P, g1_z0_P, dgdz1_z0_P</td>
        </tr>
        <tr>
          <td id="L2545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2545"></td>
          <td id="LC2545" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p1_z0_P, dpdz1_z0_P, q1_z0_P, dqdz1_z0_P</td>
        </tr>
        <tr>
          <td id="L2546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2546"></td>
          <td id="LC2546" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_z0_M, dedz1_z0_M, f1_z0_M, dfdz1_z0_M, g1_z0_M, dgdz1_z0_M</td>
        </tr>
        <tr>
          <td id="L2547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2547"></td>
          <td id="LC2547" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p1_z0_M, dpdz1_z0_M, q1_z0_M, dqdz1_z0_M</td>
        </tr>
        <tr>
          <td id="L2548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2548"></td>
          <td id="LC2548" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the final g&#39;s (other are saved in matrices, e.g. loc_EFPQ_P_t, ...)</span></td>
        </tr>
        <tr>
          <td id="L2549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2549"></td>
          <td id="LC2549" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> g_P, dgdz_P</td>
        </tr>
        <tr>
          <td id="L2550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2550"></td>
          <td id="LC2550" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> g_M, dgdz_M</td>
        </tr>
        <tr>
          <td id="L2551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2551"></td>
          <td id="LC2551" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2552"></td>
          <td id="LC2552" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2553"></td>
          <td id="LC2553" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_Vb, loc_Fb                                   <span class="pl-c"><span class="pl-c">!</span> discontinuity constants</span></td>
        </tr>
        <tr>
          <td id="L2554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2554"></td>
          <td id="LC2554" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>,<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_mat_X_4x4, loc_mat_Y_4x4</td>
        </tr>
        <tr>
          <td id="L2555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2555"></td>
          <td id="LC2555" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span>  loc_vec_Z_4</td>
        </tr>
        <tr>
          <td id="L2556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2556"></td>
          <td id="LC2556" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">3</span>,<span class="pl-c1">1</span>:<span class="pl-c1">3</span>) <span class="pl-k">::</span> loc_mat_X_3x3, loc_mat_Y_3x3</td>
        </tr>
        <tr>
          <td id="L2557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2557"></td>
          <td id="LC2557" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">3</span>) <span class="pl-k">::</span>  loc_vec_Z_3</td>
        </tr>
        <tr>
          <td id="L2558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2558"></td>
          <td id="LC2558" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2559"></td>
          <td id="LC2559" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Matrix/Vector calculated by sub_matchsoln_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L2560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2560"></td>
          <td id="LC2560" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">4</span>, <span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_mat_C_4x4</td>
        </tr>
        <tr>
          <td id="L2561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2561"></td>
          <td id="LC2561" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span>  loc_vec_D_4</td>
        </tr>
        <tr>
          <td id="L2562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2562"></td>
          <td id="LC2562" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">3</span>, <span class="pl-c1">3</span>) <span class="pl-k">::</span> loc_mat_C_3x3</td>
        </tr>
        <tr>
          <td id="L2563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2563"></td>
          <td id="LC2563" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">3</span>) <span class="pl-k">::</span>  loc_vec_D_3</td>
        </tr>
        <tr>
          <td id="L2564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2564"></td>
          <td id="LC2564" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> loc_dim</td>
        </tr>
        <tr>
          <td id="L2565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2565"></td>
          <td id="LC2565" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2566"></td>
          <td id="LC2566" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save the ODE solutions in vectors to make calculation easier (DH?: however, is this faster?)</span></td>
        </tr>
        <tr>
          <td id="L2567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2567"></td>
          <td id="LC2567" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_EFPQ_P, loc_dEFPQdz_P, loc_EFPQ_M, loc_dEFPQdz_M</td>
        </tr>
        <tr>
          <td id="L2568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2568"></td>
          <td id="LC2568" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the transformed ODE solutions coming from sub_xformsoln_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L2569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2569"></td>
          <td id="LC2569" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_EFPQ_P_t, loc_dEFPQdz_P_t, loc_EFPQ_M_t, loc_dEFPQdz_M_t</td>
        </tr>
        <tr>
          <td id="L2570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2570"></td>
          <td id="LC2570" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2571"></td>
          <td id="LC2571" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculated integration constants for Layer 1 &amp; 2 - in case we want to calculate profiles later - calculated first as vector to save code</span></td>
        </tr>
        <tr>
          <td id="L2572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2572"></td>
          <td id="LC2572" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_Layer1_IC, loc_Layer2_IC</td>
        </tr>
        <tr>
          <td id="L2573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2573"></td>
          <td id="LC2573" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2574"></td>
          <td id="LC2574" class="blob-code blob-code-inner js-file-line">        reac1_po4_ox <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox)<span class="pl-k">*</span>PC1</td>
        </tr>
        <tr>
          <td id="L2575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2575"></td>
          <td id="LC2575" class="blob-code blob-code-inner js-file-line">        reac2_po4_ox <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox)<span class="pl-k">*</span>PC2</td>
        </tr>
        <tr>
          <td id="L2576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2576"></td>
          <td id="LC2576" class="blob-code blob-code-inner js-file-line">        reac1_po4_anox <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox)<span class="pl-k">*</span>PC1</td>
        </tr>
        <tr>
          <td id="L2577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2577"></td>
          <td id="LC2577" class="blob-code blob-code-inner js-file-line">        reac2_po4_anox <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox)<span class="pl-k">*</span>PC2</td>
        </tr>
        <tr>
          <td id="L2578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2578"></td>
          <td id="LC2578" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2579"></td>
          <td id="LC2579" class="blob-code blob-code-inner js-file-line">        loc_Vb <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2580"></td>
          <td id="LC2580" class="blob-code blob-code-inner js-file-line">        loc_Fb <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2581"></td>
          <td id="LC2581" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2582"></td>
          <td id="LC2582" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Initialize loc_mat_C_4x4 &amp; loc_vec_D_4 with zeros as, so I don&#39;t need to add them later manually ...</span></td>
        </tr>
        <tr>
          <td id="L2583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2583"></td>
          <td id="LC2583" class="blob-code blob-code-inner js-file-line">        loc_mat_C_4x4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2584"></td>
          <td id="LC2584" class="blob-code blob-code-inner js-file-line">        loc_vec_D_4 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2585"></td>
          <td id="LC2585" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2586"></td>
          <td id="LC2586" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2587"></td>
          <td id="LC2587" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L2588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2588"></td>
          <td id="LC2588" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zPO4_M ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2589"></td>
          <td id="LC2589" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2590"></td>
          <td id="LC2590" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L2591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2591"></td>
          <td id="LC2591" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2592"></td>
          <td id="LC2592" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   layer 1: 0 &lt; z &lt; zox, OM degradation (-) Sorption to sediment Fe-oxides (ktemp)</span></td>
        </tr>
        <tr>
          <td id="L2593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2593"></td>
          <td id="LC2593" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2594"></td>
          <td id="LC2594" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12_PO4_M(reac1_po4_ox, reac2_po4_ox, ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), PO4s<span class="pl-k">*</span>ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), <span class="pl-c1">0.0</span>, zox, &amp;</td>
        </tr>
        <tr>
          <td id="L2595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2595"></td>
          <td id="LC2595" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, Dbio, <span class="pl-c1">0.0</span>, (<span class="pl-c1">1</span><span class="pl-k">/</span>SD)<span class="pl-k">*</span>ksPO4, &amp;</td>
        </tr>
        <tr>
          <td id="L2596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2596"></td>
          <td id="LC2596" class="blob-code blob-code-inner js-file-line">        dum_mat_C1, dum_vec_D1, dum_ltype1)</td>
        </tr>
        <tr>
          <td id="L2597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2597"></td>
          <td id="LC2597" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2598"></td>
          <td id="LC2598" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   layer 2: zox &lt; z &lt; zinf,</span></td>
        </tr>
        <tr>
          <td id="L2599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2599"></td>
          <td id="LC2599" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   OM degradation (-) authigenic P formation (ktemp) (+) P desorption due to Fe-bound P release upon Fe oxide reduction</span></td>
        </tr>
        <tr>
          <td id="L2600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2600"></td>
          <td id="LC2600" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>       rPO4_M.ls2 = r.zTOC.sub_prepfg_l12_PO4_M(bsd, swi, r, reac1_anox, reac2_anox, kaPO4/(1+KPO4_anox), PO4a*kaPO4/(1+KPO4_anox), r.zox, zinf, DPO41/(1+KPO4_anox), DPO42/(1+KPO4_anox), SD*kmPO4/(1+KPO4_anox), ...</span></td>
        </tr>
        <tr>
          <td id="L2601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2601"></td>
          <td id="LC2601" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                                           kmPO4, kmPO4.*Minf, Dbio, 0, 0);</span></td>
        </tr>
        <tr>
          <td id="L2602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2602"></td>
          <td id="LC2602" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12_PO4_M(reac1_po4_anox, reac2_po4_anox, kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), PO4a<span class="pl-k">*</span>kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), zox, zinf, &amp;</td>
        </tr>
        <tr>
          <td id="L2603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2603"></td>
          <td id="LC2603" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), SD<span class="pl-k">*</span>kmPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), kmPO4, kmPO4<span class="pl-k">*</span>Minf, Dbio, &amp;</td>
        </tr>
        <tr>
          <td id="L2604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2604"></td>
          <td id="LC2604" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, dum_mat_C2, dum_vec_D2, dum_ltype2)</td>
        </tr>
        <tr>
          <td id="L2605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2605"></td>
          <td id="LC2605" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2606"></td>
          <td id="LC2606" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L2607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2607"></td>
          <td id="LC2607" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 2 zinf</span></td>
        </tr>
        <tr>
          <td id="L2608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2608"></td>
          <td id="LC2608" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12_PO4_M(zinf, reac1_po4_anox, reac2_po4_anox, kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), PO4a<span class="pl-k">*</span>kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), &amp;</td>
        </tr>
        <tr>
          <td id="L2609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2609"></td>
          <td id="LC2609" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), SD<span class="pl-k">*</span>kmPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), dum_mat_C2, dum_vec_D2, &amp;</td>
        </tr>
        <tr>
          <td id="L2610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2610"></td>
          <td id="LC2610" class="blob-code blob-code-inner js-file-line">        dum_ltype2, kmPO4, kmPO4<span class="pl-k">*</span>Minf, Dbio, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, e2_zinf_P, dedz2_zinf_P, f2_zinf_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2611"></td>
          <td id="LC2611" class="blob-code blob-code-inner js-file-line">        dfdz2_zinf_P, g2_zinf_P, dgdz2_zinf_P, p2_zinf_P, dpdz2_zinf_P, q2_zinf_P, dqdz2_zinf_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2612"></td>
          <td id="LC2612" class="blob-code blob-code-inner js-file-line">        e2_zinf_M, dedz2_zinf_M, f2_zinf_M, dfdz2_zinf_M, g2_zinf_M, dgdz2_zinf_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2613"></td>
          <td id="LC2613" class="blob-code blob-code-inner js-file-line">        p2_zinf_M, dpdz2_zinf_M, q2_zinf_M, dqdz2_zinf_M)</td>
        </tr>
        <tr>
          <td id="L2614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2614"></td>
          <td id="LC2614" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2615"></td>
          <td id="LC2615" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity and flux)</span></td>
        </tr>
        <tr>
          <td id="L2616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2616"></td>
          <td id="LC2616" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2617"></td>
          <td id="LC2617" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12_PO4_M(zox, reac1_po4_ox, reac2_po4_ox, ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), PO4s<span class="pl-k">*</span>ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), &amp;</td>
        </tr>
        <tr>
          <td id="L2618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2618"></td>
          <td id="LC2618" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), <span class="pl-c1">0.0</span>, dum_mat_C1, dum_vec_D1, &amp;</td>
        </tr>
        <tr>
          <td id="L2619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2619"></td>
          <td id="LC2619" class="blob-code blob-code-inner js-file-line">        dum_ltype1, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, Dbio, <span class="pl-c1">0.0</span>, (<span class="pl-c1">1</span><span class="pl-k">/</span>SD)<span class="pl-k">*</span>ksPO4, e1_zox_P, dedz1_zox_P, f1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2620"></td>
          <td id="LC2620" class="blob-code blob-code-inner js-file-line">        dfdz1_zox_P, g1_zox_P, dgdz1_zox_P, p1_zox_P, dpdz1_zox_P, q1_zox_P, dqdz1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2621"></td>
          <td id="LC2621" class="blob-code blob-code-inner js-file-line">        e1_zox_M, dedz1_zox_M, f1_zox_M, dfdz1_zox_M, g1_zox_M, dgdz1_zox_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2622"></td>
          <td id="LC2622" class="blob-code blob-code-inner js-file-line">        p1_zox_M, dpdz1_zox_M, q1_zox_M, dqdz1_zox_M)</td>
        </tr>
        <tr>
          <td id="L2623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2623"></td>
          <td id="LC2623" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2624"></td>
          <td id="LC2624" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  and top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2625"></td>
          <td id="LC2625" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12_PO4_M(zox, reac1_po4_anox, reac2_po4_anox, kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), PO4a<span class="pl-k">*</span>kaPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), &amp;</td>
        </tr>
        <tr>
          <td id="L2626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2626"></td>
          <td id="LC2626" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), SD<span class="pl-k">*</span>kmPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_anox), dum_mat_C2, dum_vec_D2, &amp;</td>
        </tr>
        <tr>
          <td id="L2627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2627"></td>
          <td id="LC2627" class="blob-code blob-code-inner js-file-line">        dum_ltype2, kmPO4, kmPO4<span class="pl-k">*</span>Minf, Dbio, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, e2_zox_P, dedz2_zox_P, f2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2628"></td>
          <td id="LC2628" class="blob-code blob-code-inner js-file-line">        dfdz2_zox_P, g2_zox_P, dgdz2_zox_P, p2_zox_P, dpdz2_zox_P, q2_zox_P, dqdz2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2629"></td>
          <td id="LC2629" class="blob-code blob-code-inner js-file-line">        e2_zox_M, dedz2_zox_M, f2_zox_M, dfdz2_zox_M, g2_zox_M, dgdz2_zox_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2630"></td>
          <td id="LC2630" class="blob-code blob-code-inner js-file-line">        p2_zox_M, dpdz2_zox_M, q2_zox_M, dqdz2_zox_M)</td>
        </tr>
        <tr>
          <td id="L2631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2631"></td>
          <td id="LC2631" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2632"></td>
          <td id="LC2632" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2633"></td>
          <td id="LC2633" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> organize the data in matrices and let the intrinsic fortran function do the calculation</span></td>
        </tr>
        <tr>
          <td id="L2634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2634"></td>
          <td id="LC2634" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: Maybe this could be done more efficiently !?</span></td>
        </tr>
        <tr>
          <td id="L2635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2635"></td>
          <td id="LC2635" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  |x1        |   | A_l |      | y1        | | A_r|    |z1|    always PO4 continuity</span></td>
        </tr>
        <tr>
          <td id="L2636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2636"></td>
          <td id="LC2636" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  |    .     |   | B_l |      |    .      | | B_r|    |z2|    always PO4 flux</span></td>
        </tr>
        <tr>
          <td id="L2637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2637"></td>
          <td id="LC2637" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  |      .   |   | C_l |   =  |      .    | | C_r|  + |z3|    always M continuity</span></td>
        </tr>
        <tr>
          <td id="L2638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2638"></td>
          <td id="LC2638" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  |       x16|   | D_l |      |        y16| | D_r|    |z4|    SD M flux only in bioturbated case, otherwise not an independent constraint</span></td>
        </tr>
        <tr>
          <td id="L2639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2639"></td>
          <td id="LC2639" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2640"></td>
          <td id="LC2640" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zox &lt; zbio)<span class="pl-k">then</span>  <span class="pl-c"><span class="pl-c">!</span> 1. CASE: 4 int const. in each layer</span></td>
        </tr>
        <tr>
          <td id="L2641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2641"></td>
          <td id="LC2641" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> weird FORTRAN matrices makes the transpose necessary</span></td>
        </tr>
        <tr>
          <td id="L2642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2642"></td>
          <td id="LC2642" class="blob-code blob-code-inner js-file-line">            loc_mat_X_4x4 <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e1_zox_P, f1_zox_P, p1_zox_P, q1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2643"></td>
          <td id="LC2643" class="blob-code blob-code-inner js-file-line">            dedz1_zox_P, dfdz1_zox_P, dpdz1_zox_P, dqdz1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2644"></td>
          <td id="LC2644" class="blob-code blob-code-inner js-file-line">            e1_zox_M, f1_zox_M, p1_zox_M, q1_zox_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2645"></td>
          <td id="LC2645" class="blob-code blob-code-inner js-file-line">            dedz1_zox_M, dfdz1_zox_M, dpdz1_zox_M, dqdz1_zox_M <span class="pl-k">/</span>), <span class="pl-k">shape</span>(loc_mat_X_4x4)))</td>
        </tr>
        <tr>
          <td id="L2646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2646"></td>
          <td id="LC2646" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2647"></td>
          <td id="LC2647" class="blob-code blob-code-inner js-file-line">            loc_mat_Y_4x4 <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e2_zox_P, f2_zox_P, p2_zox_P, q2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2648"></td>
          <td id="LC2648" class="blob-code blob-code-inner js-file-line">            dedz2_zox_P, dfdz2_zox_P, dpdz2_zox_P, dqdz2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2649"></td>
          <td id="LC2649" class="blob-code blob-code-inner js-file-line">            e2_zox_M, f2_zox_M, p2_zox_M, q2_zox_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2650"></td>
          <td id="LC2650" class="blob-code blob-code-inner js-file-line">            dedz2_zox_M, dfdz2_zox_M, dpdz2_zox_M, dqdz2_zox_M <span class="pl-k">/</span>), <span class="pl-k">shape</span>(loc_mat_Y_4x4)))</td>
        </tr>
        <tr>
          <td id="L2651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2651"></td>
          <td id="LC2651" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2652"></td>
          <td id="LC2652" class="blob-code blob-code-inner js-file-line">            loc_vec_Z_4 <span class="pl-k">=</span> (<span class="pl-k">/</span> g2_zox_P<span class="pl-k">-</span>g1_zox_P <span class="pl-k">+</span> loc_Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L2653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2653"></td>
          <td id="LC2653" class="blob-code blob-code-inner js-file-line">            dgdz2_zox_P <span class="pl-k">-</span> dgdz1_zox_P <span class="pl-k">+</span> loc_Fb <span class="pl-k">-</span> w<span class="pl-k">*</span>loc_Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L2654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2654"></td>
          <td id="LC2654" class="blob-code blob-code-inner js-file-line">            g2_zox_M<span class="pl-k">-</span>g1_zox_M <span class="pl-k">+</span> loc_Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L2655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2655"></td>
          <td id="LC2655" class="blob-code blob-code-inner js-file-line">            dgdz2_zox_M <span class="pl-k">-</span> dgdz1_zox_M <span class="pl-k">+</span> loc_Fb <span class="pl-k">-</span> w<span class="pl-k">*</span>loc_Vb <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2656"></td>
          <td id="LC2656" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2657"></td>
          <td id="LC2657" class="blob-code blob-code-inner js-file-line">            loc_dim <span class="pl-k">=</span> <span class="pl-c1">4</span></td>
        </tr>
        <tr>
          <td id="L2658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2658"></td>
          <td id="LC2658" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln_PO4_M(loc_mat_X_4x4, loc_mat_Y_4x4, loc_vec_Z_4, loc_dim, loc_mat_C_4x4, loc_vec_D_4)</td>
        </tr>
        <tr>
          <td id="L2659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2659"></td>
          <td id="LC2659" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2660"></td>
          <td id="LC2660" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2661"></td>
          <td id="LC2661" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> 2. CASE: 3 int const. in each layer</span></td>
        </tr>
        <tr>
          <td id="L2662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2662"></td>
          <td id="LC2662" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> DH: zox non-bioturbated</span></td>
        </tr>
        <tr>
          <td id="L2663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2663"></td>
          <td id="LC2663" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span> DH: this should generate 3x3 matrices as no M flux boundary condition (and then 4x4 C with zeros)</span></td>
        </tr>
        <tr>
          <td id="L2664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2664"></td>
          <td id="LC2664" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2665"></td>
          <td id="LC2665" class="blob-code blob-code-inner js-file-line">            loc_mat_X_3x3 <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e1_zox_P, f1_zox_P, p1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2666"></td>
          <td id="LC2666" class="blob-code blob-code-inner js-file-line">            dedz1_zox_P, dfdz1_zox_P, dpdz1_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2667"></td>
          <td id="LC2667" class="blob-code blob-code-inner js-file-line">            e1_zox_M, f1_zox_M, p1_zox_M <span class="pl-k">/</span>), <span class="pl-k">shape</span>(loc_mat_X_3x3)))</td>
        </tr>
        <tr>
          <td id="L2668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2668"></td>
          <td id="LC2668" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2669"></td>
          <td id="LC2669" class="blob-code blob-code-inner js-file-line">            loc_mat_Y_3x3 <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e2_zox_P, f2_zox_P, p2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2670"></td>
          <td id="LC2670" class="blob-code blob-code-inner js-file-line">            dedz2_zox_P, dfdz2_zox_P, dpdz2_zox_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2671"></td>
          <td id="LC2671" class="blob-code blob-code-inner js-file-line">            e2_zox_M, f2_zox_M, p2_zox_M <span class="pl-k">/</span>), <span class="pl-k">shape</span>(loc_mat_Y_3x3)))</td>
        </tr>
        <tr>
          <td id="L2672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2672"></td>
          <td id="LC2672" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2673"></td>
          <td id="LC2673" class="blob-code blob-code-inner js-file-line">            loc_vec_Z_3 <span class="pl-k">=</span> (<span class="pl-k">/</span> g2_zox_P<span class="pl-k">-</span>g1_zox_P <span class="pl-k">+</span> loc_Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L2674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2674"></td>
          <td id="LC2674" class="blob-code blob-code-inner js-file-line">            dgdz2_zox_P <span class="pl-k">-</span> dgdz1_zox_P <span class="pl-k">+</span> loc_Fb <span class="pl-k">-</span> w<span class="pl-k">*</span>loc_Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L2675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2675"></td>
          <td id="LC2675" class="blob-code blob-code-inner js-file-line">            g2_zox_M<span class="pl-k">-</span>g1_zox_M <span class="pl-k">+</span> loc_Vb <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2676"></td>
          <td id="LC2676" class="blob-code blob-code-inner js-file-line">            loc_dim <span class="pl-k">=</span> <span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L2677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2677"></td>
          <td id="LC2677" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2678"></td>
          <td id="LC2678" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln_PO4_M(loc_mat_X_3x3, loc_mat_Y_3x3, loc_vec_Z_3, loc_dim, loc_mat_C_3x3, loc_vec_D_3)</td>
        </tr>
        <tr>
          <td id="L2679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2679"></td>
          <td id="LC2679" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2680"></td>
          <td id="LC2680" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> integrate the 3x3 matrix in the 4x4 matrix</span></td>
        </tr>
        <tr>
          <td id="L2681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2681"></td>
          <td id="LC2681" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> loc_i <span class="pl-k">=</span> <span class="pl-c1">1</span>,<span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L2682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2682"></td>
          <td id="LC2682" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">do</span> loc_j <span class="pl-k">=</span> <span class="pl-c1">1</span>,<span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L2683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2683"></td>
          <td id="LC2683" class="blob-code blob-code-inner js-file-line">                    loc_mat_C_4x4(loc_i, loc_j) <span class="pl-k">=</span> loc_mat_C_3x3(loc_i, loc_j)</td>
        </tr>
        <tr>
          <td id="L2684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2684"></td>
          <td id="LC2684" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L2685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2685"></td>
          <td id="LC2685" class="blob-code blob-code-inner js-file-line">                loc_vec_D_4(loc_i)  <span class="pl-k">=</span> loc_vec_D_3(loc_i)</td>
        </tr>
        <tr>
          <td id="L2686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2686"></td>
          <td id="LC2686" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L2687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2687"></td>
          <td id="LC2687" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2688"></td>
          <td id="LC2688" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span> <span class="pl-c"><span class="pl-c">!</span>(zox &lt; zbio)</span></td>
        </tr>
        <tr>
          <td id="L2689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2689"></td>
          <td id="LC2689" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2690"></td>
          <td id="LC2690" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>201     format (6f12.6)</span></td>
        </tr>
        <tr>
          <td id="L2691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2691"></td>
          <td id="LC2691" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;final loc_mat_C_4x4 &#39;</span></td>
        </tr>
        <tr>
          <td id="L2692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2692"></td>
          <td id="LC2692" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        do loc_i=1,4</span></td>
        </tr>
        <tr>
          <td id="L2693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2693"></td>
          <td id="LC2693" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            write (*,201) (loc_mat_C_4x4(loc_i,loc_j),loc_j=1,4)</span></td>
        </tr>
        <tr>
          <td id="L2694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2694"></td>
          <td id="LC2694" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end do</span></td>
        </tr>
        <tr>
          <td id="L2695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2695"></td>
          <td id="LC2695" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_vec_D_4 &#39;, char(9), loc_vec_D_4</span></td>
        </tr>
        <tr>
          <td id="L2696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2696"></td>
          <td id="LC2696" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2697"></td>
          <td id="LC2697" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at SWI, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2698"></td>
          <td id="LC2698" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12_PO4_M(z0, reac1_po4_ox, reac2_po4_ox, ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), PO4s<span class="pl-k">*</span>ksPO4<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), &amp;</td>
        </tr>
        <tr>
          <td id="L2699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2699"></td>
          <td id="LC2699" class="blob-code blob-code-inner js-file-line">        DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), DPO42<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox), <span class="pl-c1">0.0</span>, dum_mat_C1, dum_vec_D1, &amp;</td>
        </tr>
        <tr>
          <td id="L2700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2700"></td>
          <td id="LC2700" class="blob-code blob-code-inner js-file-line">        dum_ltype1, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, Dbio, <span class="pl-c1">0.0</span>, (<span class="pl-c1">1</span><span class="pl-k">/</span>SD)<span class="pl-k">*</span>ksPO4, e1_z0_P, dedz1_z0_P, f1_z0_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2701"></td>
          <td id="LC2701" class="blob-code blob-code-inner js-file-line">        dfdz1_z0_P, g1_z0_P, dgdz1_z0_P, p1_z0_P, dpdz1_z0_P, q1_z0_P, dqdz1_z0_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2702"></td>
          <td id="LC2702" class="blob-code blob-code-inner js-file-line">        e1_z0_M, dedz1_z0_M, f1_z0_M, dfdz1_z0_M, g1_z0_M, dgdz1_z0_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2703"></td>
          <td id="LC2703" class="blob-code blob-code-inner js-file-line">        p1_z0_M, dpdz1_z0_M, q1_z0_M, dqdz1_z0_M)</td>
        </tr>
        <tr>
          <td id="L2704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2704"></td>
          <td id="LC2704" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2705"></td>
          <td id="LC2705" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l2</span></td>
        </tr>
        <tr>
          <td id="L2706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2706"></td>
          <td id="LC2706" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Now find &#39;transformed&#39; basis functions such that in layer 1 (here for O2, PO4 is a bit more complex)</span></td>
        </tr>
        <tr>
          <td id="L2707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2707"></td>
          <td id="LC2707" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> O2 = A_2*et + B_2*ft + gt  (ie layer 1 soln written in terms of layer 2 coeffs A_2, B_2)</span></td>
        </tr>
        <tr>
          <td id="L2708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2708"></td>
          <td id="LC2708" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_P <span class="pl-k">=</span> (<span class="pl-k">/</span> e1_z0_P, f1_z0_P, p1_z0_P, q1_z0_P <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2709"></td>
          <td id="LC2709" class="blob-code blob-code-inner js-file-line">        loc_dEFPQdz_P <span class="pl-k">=</span> (<span class="pl-k">/</span> dedz1_z0_P, dfdz1_z0_P, dpdz1_z0_P, dqdz1_z0_P <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2710"></td>
          <td id="LC2710" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_M <span class="pl-k">=</span> (<span class="pl-k">/</span> e1_z0_M, f1_z0_M, p1_z0_M, q1_z0_M <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2711"></td>
          <td id="LC2711" class="blob-code blob-code-inner js-file-line">        loc_dEFPQdz_M <span class="pl-k">=</span> (<span class="pl-k">/</span>dedz1_z0_M, dfdz1_z0_M, dpdz1_z0_M, dqdz1_z0_M <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2712"></td>
          <td id="LC2712" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2713"></td>
          <td id="LC2713" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln_PO4_M(loc_EFPQ_P, loc_EFPQ_M, loc_dEFPQdz_P, loc_dEFPQdz_M, &amp;</td>
        </tr>
        <tr>
          <td id="L2714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2714"></td>
          <td id="LC2714" class="blob-code blob-code-inner js-file-line">        g1_z0_P, g1_z0_M, dgdz1_z0_P, dgdz1_z0_M, loc_mat_C_4x4, loc_vec_D_4, &amp;</td>
        </tr>
        <tr>
          <td id="L2715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2715"></td>
          <td id="LC2715" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_P_t, g_P, loc_dEFPQdz_P_t, dgdz_P, loc_EFPQ_M_t, &amp;</td>
        </tr>
        <tr>
          <td id="L2716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2716"></td>
          <td id="LC2716" class="blob-code blob-code-inner js-file-line">        g_M, loc_dEFPQdz_M_t, dgdz_M)</td>
        </tr>
        <tr>
          <td id="L2717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2717"></td>
          <td id="LC2717" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2718"></td>
          <td id="LC2718" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> SD assume D2 == 0 (as q, dqdz2_zinf = 0 ) and solve for 3 unknowns</span></td>
        </tr>
        <tr>
          <td id="L2719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2719"></td>
          <td id="LC2719" class="blob-code blob-code-inner js-file-line">        loc_mat_X_3x3 <span class="pl-k">=</span>  <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> dedz2_zinf_P, dfdz2_zinf_P, dpdz2_zinf_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2720"></td>
          <td id="LC2720" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_P_t(<span class="pl-c1">1</span>), loc_EFPQ_P_t(<span class="pl-c1">2</span>), loc_EFPQ_P_t(<span class="pl-c1">3</span>), &amp;</td>
        </tr>
        <tr>
          <td id="L2721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2721"></td>
          <td id="LC2721" class="blob-code blob-code-inner js-file-line">        w<span class="pl-k">*</span>loc_EFPQ_M_t(<span class="pl-c1">1</span>), w<span class="pl-k">*</span>loc_EFPQ_M_t(<span class="pl-c1">2</span>), w<span class="pl-k">*</span>loc_EFPQ_M_t(<span class="pl-c1">3</span>) <span class="pl-k">/</span>), <span class="pl-k">shape</span>(loc_mat_X_3x3)))</td>
        </tr>
        <tr>
          <td id="L2722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2722"></td>
          <td id="LC2722" class="blob-code blob-code-inner js-file-line">        loc_vec_Z_3<span class="pl-k">=</span> (<span class="pl-k">/</span> <span class="pl-k">-</span>dgdz2_zinf_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2723"></td>
          <td id="LC2723" class="blob-code blob-code-inner js-file-line">        dum_swiconc_PO4 <span class="pl-k">-</span> g_P, &amp;</td>
        </tr>
        <tr>
          <td id="L2724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2724"></td>
          <td id="LC2724" class="blob-code blob-code-inner js-file-line">        dum_swiflux_M <span class="pl-k">-</span> w<span class="pl-k">*</span>g_M  <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2725"></td>
          <td id="LC2725" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2726"></td>
          <td id="LC2726" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate the integration conctants for Layer 2</span></td>
        </tr>
        <tr>
          <td id="L2727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2727"></td>
          <td id="LC2727" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> just need it once, so actually no need for subroutine, but maybe for later</span></td>
        </tr>
        <tr>
          <td id="L2728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2728"></td>
          <td id="LC2728" class="blob-code blob-code-inner js-file-line">        loc_dim <span class="pl-k">=</span> <span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L2729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2729"></td>
          <td id="LC2729" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn_PO4_M(loc_mat_X_3x3, loc_vec_Z_3, rPO4_M_A2, rPO4_M_B2, rPO4_M_C2, loc_dim)</td>
        </tr>
        <tr>
          <td id="L2730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2730"></td>
          <td id="LC2730" class="blob-code blob-code-inner js-file-line">        rPO4_M_D2 <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2731"></td>
          <td id="LC2731" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save IC in a vector for a later calculation</span></td>
        </tr>
        <tr>
          <td id="L2732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2732"></td>
          <td id="LC2732" class="blob-code blob-code-inner js-file-line">        loc_Layer2_IC <span class="pl-k">=</span> (<span class="pl-k">/</span> rPO4_M_A2, rPO4_M_B2, rPO4_M_C2, rPO4_M_D2 <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L2733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2733"></td>
          <td id="LC2733" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2734"></td>
          <td id="LC2734" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate concentration at zinf</span></td>
        </tr>
        <tr>
          <td id="L2735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2735"></td>
          <td id="LC2735" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> rPO4_M_A2<span class="pl-k">*</span>e2_zinf_P<span class="pl-k">+</span>rPO4_M_B2<span class="pl-k">*</span>f2_zinf_P <span class="pl-k">+</span> g2_zinf_P</td>
        </tr>
        <tr>
          <td id="L2736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2736"></td>
          <td id="LC2736" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2737"></td>
          <td id="LC2737" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> CALCULATE FINAL SWI fluxes and save the coefficients for</span></td>
        </tr>
        <tr>
          <td id="L2738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2738"></td>
          <td id="LC2738" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: use A2, B2, C2, D2 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L2739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2739"></td>
          <td id="LC2739" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_PO4 <span class="pl-k">=</span> por<span class="pl-k">*</span>(DPO41<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KPO4_ox)<span class="pl-k">*</span>(rPO4_M_A2<span class="pl-k">*</span>loc_dEFPQdz_P_t(<span class="pl-c1">1</span>)<span class="pl-k">+</span>rPO4_M_B2<span class="pl-k">*</span>loc_dEFPQdz_P_t(<span class="pl-c1">2</span>) &amp;</td>
        </tr>
        <tr>
          <td id="L2740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2740"></td>
          <td id="LC2740" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> rPO4_M_C2<span class="pl-k">*</span>loc_dEFPQdz_P_t(<span class="pl-c1">3</span>)<span class="pl-k">+</span>rPO4_M_D2<span class="pl-k">*</span>loc_dEFPQdz_P_t(<span class="pl-c1">4</span>) <span class="pl-k">+</span> dgdz_P) <span class="pl-k">-</span> w<span class="pl-k">*</span>(dum_swiconc_PO4 <span class="pl-k">-</span> loc_conczinf))</td>
        </tr>
        <tr>
          <td id="L2741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2741"></td>
          <td id="LC2741" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Does actually not exist, as it is a solid, just calculate for debugging</span></td>
        </tr>
        <tr>
          <td id="L2742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2742"></td>
          <td id="LC2742" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_M <span class="pl-k">=</span> por<span class="pl-k">*</span>Dbio<span class="pl-k">*</span>(rPO4_M_A2<span class="pl-k">*</span>loc_dEFPQdz_M_t(<span class="pl-c1">1</span>)<span class="pl-k">+</span>rPO4_M_B2<span class="pl-k">*</span>loc_dEFPQdz_M_t(<span class="pl-c1">2</span>) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L2743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2743"></td>
          <td id="LC2743" class="blob-code blob-code-inner js-file-line">        rPO4_M_C2<span class="pl-k">*</span>loc_dEFPQdz_M_t(<span class="pl-c1">3</span>) <span class="pl-k">+</span> rPO4_M_D2<span class="pl-k">*</span>loc_dEFPQdz_M_t(<span class="pl-c1">4</span>) <span class="pl-k">+</span> dgdz_M)</td>
        </tr>
        <tr>
          <td id="L2744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2744"></td>
          <td id="LC2744" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2745"></td>
          <td id="LC2745" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layer 1 - in case I want to calculate a profile later</span></td>
        </tr>
        <tr>
          <td id="L2746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2746"></td>
          <td id="LC2746" class="blob-code blob-code-inner js-file-line">        loc_Layer1_IC <span class="pl-k">=</span> <span class="pl-k">matmul</span>(loc_mat_C_4x4, loc_Layer2_IC) <span class="pl-k">+</span> loc_vec_D_4</td>
        </tr>
        <tr>
          <td id="L2747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2747"></td>
          <td id="LC2747" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2748"></td>
          <td id="LC2748" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2749"></td>
          <td id="LC2749" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_new_swiflux_PO4 &#39;, char(9), loc_new_swiflux_PO4</span></td>
        </tr>
        <tr>
          <td id="L2750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2750"></td>
          <td id="LC2750" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_new_swiflux_M &#39;, char(9), loc_new_swiflux_M</span></td>
        </tr>
        <tr>
          <td id="L2751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2751"></td>
          <td id="LC2751" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_Layer1_IC &#39;, char(9), loc_Layer1_IC</span></td>
        </tr>
        <tr>
          <td id="L2752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2752"></td>
          <td id="LC2752" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;loc_Layer2_IC &#39;, char(9), loc_Layer2_IC</span></td>
        </tr>
        <tr>
          <td id="L2753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2753"></td>
          <td id="LC2753" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2754"></td>
          <td id="LC2754" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zPO4_M</span></td>
        </tr>
        <tr>
          <td id="L2755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2755"></td>
          <td id="LC2755" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2756"></td>
          <td id="LC2756" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2757"></td>
          <td id="LC2757" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L2758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2758"></td>
          <td id="LC2758" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2759"></td>
          <td id="LC2759" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2760"></td>
          <td id="LC2760" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2761"></td>
          <td id="LC2761" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2762"></td>
          <td id="LC2762" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2763"></td>
          <td id="LC2763" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2764"></td>
          <td id="LC2764" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2765"></td>
          <td id="LC2765" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2766"></td>
          <td id="LC2766" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                   Dissolved Inorganic Carbon (DIC)</span></td>
        </tr>
        <tr>
          <td id="L2767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2767"></td>
          <td id="LC2767" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2768"></td>
          <td id="LC2768" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2769"></td>
          <td id="LC2769" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2770"></td>
          <td id="LC2770" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2771"></td>
          <td id="LC2771" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2772"></td>
          <td id="LC2772" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zDIC</span>(<span class="pl-v">dum_swiconc_DIC</span>, <span class="pl-v">loc_new_swiflux_DIC</span>)</td>
        </tr>
        <tr>
          <td id="L2773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2773"></td>
          <td id="LC2773" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2774"></td>
          <td id="LC2774" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2775"></td>
          <td id="LC2775" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L2776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2776"></td>
          <td id="LC2776" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_DIC                <span class="pl-c"><span class="pl-c">!</span> DIC concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2777"></td>
          <td id="LC2777" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_DIC         <span class="pl-c"><span class="pl-c">!</span> DIC flux</span></td>
        </tr>
        <tr>
          <td id="L2778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2778"></td>
          <td id="LC2778" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2779"></td>
          <td id="LC2779" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L2780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2780"></td>
          <td id="LC2780" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_conczinf</td>
        </tr>
        <tr>
          <td id="L2781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2781"></td>
          <td id="LC2781" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1_dic, reac2_dic                 <span class="pl-c"><span class="pl-c">!</span> reactive terms: OM degradation</span></td>
        </tr>
        <tr>
          <td id="L2782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2782"></td>
          <td id="LC2782" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype1 , ltype2</td>
        </tr>
        <tr>
          <td id="L2783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2783"></td>
          <td id="LC2783" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L2784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2784"></td>
          <td id="LC2784" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L2785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2785"></td>
          <td id="LC2785" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f</td>
        </tr>
        <tr>
          <td id="L2786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2786"></td>
          <td id="LC2786" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zinf, dedz2_zinf, f2_zinf, dfdz2_zinf, g2_zinf, dgdz2_zinf</td>
        </tr>
        <tr>
          <td id="L2787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2787"></td>
          <td id="LC2787" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zso4, dedz1_zso4, f1_zso4, dfdz1_zso4, g1_zso4, dgdz1_zso4</td>
        </tr>
        <tr>
          <td id="L2788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2788"></td>
          <td id="LC2788" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zso4, dedz2_zso4, f2_zso4, dfdz2_zso4, g2_zso4, dgdz2_zso4</td>
        </tr>
        <tr>
          <td id="L2789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2789"></td>
          <td id="LC2789" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L2790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2790"></td>
          <td id="LC2790" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L2791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2791"></td>
          <td id="LC2791" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L2792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2792"></td>
          <td id="LC2792" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rDIC_A2, rDIC_B2</td>
        </tr>
        <tr>
          <td id="L2793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2793"></td>
          <td id="LC2793" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rDIC_A1, rDIC_B1</td>
        </tr>
        <tr>
          <td id="L2794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2794"></td>
          <td id="LC2794" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2795"></td>
          <td id="LC2795" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4FDIC</td>
        </tr>
        <tr>
          <td id="L2796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2796"></td>
          <td id="LC2796" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2797"></td>
          <td id="LC2797" class="blob-code blob-code-inner js-file-line">        reac1_dic <span class="pl-k">=</span> DICC1                 <span class="pl-c"><span class="pl-c">!</span> DIC/C until zSO4 (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L2798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2798"></td>
          <td id="LC2798" class="blob-code blob-code-inner js-file-line">        reac2_dic <span class="pl-k">=</span> DICC2                 <span class="pl-c"><span class="pl-c">!</span>DIC/C below zSO4 (mol/mol)</span></td>
        </tr>
        <tr>
          <td id="L2799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2799"></td>
          <td id="LC2799" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2800"></td>
          <td id="LC2800" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2801"></td>
          <td id="LC2801" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L2802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2802"></td>
          <td id="LC2802" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zDIC ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2803"></td>
          <td id="LC2803" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2804"></td>
          <td id="LC2804" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2805"></td>
          <td id="LC2805" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate DIC</span></td>
        </tr>
        <tr>
          <td id="L2806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2806"></td>
          <td id="LC2806" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2807"></td>
          <td id="LC2807" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L2808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2808"></td>
          <td id="LC2808" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zso4, DIC produced my OM degradation</span></td>
        </tr>
        <tr>
          <td id="L2809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2809"></td>
          <td id="LC2809" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    prepfg_l12(    reac1,      reac2,   ktemp, zU,  zL,   D1,    D2, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, ltype)</span></td>
        </tr>
        <tr>
          <td id="L2810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2810"></td>
          <td id="LC2810" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac1_dic, reac1_dic, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zso4, DDIC1, DDIC2, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L2811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2811"></td>
          <td id="LC2811" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2812"></td>
          <td id="LC2812" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zso4 &lt; z &lt; zinf, DIC production by OM degradation (Methanogenesis) -&gt; different production rate</span></td>
        </tr>
        <tr>
          <td id="L2813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2813"></td>
          <td id="LC2813" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac2_dic, reac2_dic, <span class="pl-c1">0.0</span>, zso4, zinf, DDIC1, DDIC2, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L2814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2814"></td>
          <td id="LC2814" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2815"></td>
          <td id="LC2815" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2816"></td>
          <td id="LC2816" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L2817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2817"></td>
          <td id="LC2817" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 2 zinf</span></td>
        </tr>
        <tr>
          <td id="L2818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2818"></td>
          <td id="LC2818" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   calcfg_l12(  z,     reac1,      reac2, ktemp, ls_a, ls_b,  ls_c, ls_d,   ls_e, ls_f,  ls_D1, ls_D2, ltype, e, dedz, f, dfdz, g, dgdz)</span></td>
        </tr>
        <tr>
          <td id="L2819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2819"></td>
          <td id="LC2819" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zinf, reac2_dic, reac2_dic, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DDIC1, DDIC2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2820"></td>
          <td id="LC2820" class="blob-code blob-code-inner js-file-line">        e2_zinf, dedz2_zinf, f2_zinf, dfdz2_zinf, g2_zinf, dgdz2_zinf)</td>
        </tr>
        <tr>
          <td id="L2821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2821"></td>
          <td id="LC2821" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2822"></td>
          <td id="LC2822" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zso4, layer 1 - layer 2 (continuity and flux with AOM production)</span></td>
        </tr>
        <tr>
          <td id="L2823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2823"></td>
          <td id="LC2823" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2824"></td>
          <td id="LC2824" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac1_dic, reac1_dic, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DDIC1, DDIC2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2825"></td>
          <td id="LC2825" class="blob-code blob-code-inner js-file-line">        e1_zso4, dedz1_zso4, f1_zso4, dfdz1_zso4, g1_zso4, dgdz1_zso4)</td>
        </tr>
        <tr>
          <td id="L2826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2826"></td>
          <td id="LC2826" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2827"></td>
          <td id="LC2827" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L2828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2828"></td>
          <td id="LC2828" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac2_dic, reac2_dic, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DDIC1, DDIC2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L2829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2829"></td>
          <td id="LC2829" class="blob-code blob-code-inner js-file-line">        e2_zso4, dedz2_zso4, f2_zso4, dfdz2_zso4, g2_zso4, dgdz2_zso4)</td>
        </tr>
        <tr>
          <td id="L2830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2830"></td>
          <td id="LC2830" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2831"></td>
          <td id="LC2831" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of DIC produced by AOM interface (Source of DIC)</span></td>
        </tr>
        <tr>
          <td id="L2832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2832"></td>
          <td id="LC2832" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        zso4FDIC = FUN_calcReac(zso4, zinf, MC, MC) ! MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L2833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2833"></td>
          <td id="LC2833" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zso4 <span class="pl-k">.EQ.</span> zinf)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L2834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2834"></td>
          <td id="LC2834" class="blob-code blob-code-inner js-file-line">                    zso4FDIC <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2835"></td>
          <td id="LC2835" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2836"></td>
          <td id="LC2836" class="blob-code blob-code-inner js-file-line">                zso4FDIC <span class="pl-k">=</span> FUN_calcReac(zso4, zinf, MC, MC) <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????!             </span></td>
        </tr>
        <tr>
          <td id="L2837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2837"></td>
          <td id="LC2837" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L2838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2838"></td>
          <td id="LC2838" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zso4 = &#39;, zso4</span></td>
        </tr>
        <tr>
          <td id="L2839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2839"></td>
          <td id="LC2839" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flux of DIC produced by AOM interface zso4FDIC = &#39;, zso4FDIC</span></td>
        </tr>
        <tr>
          <td id="L2840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2840"></td>
          <td id="LC2840" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2841"></td>
          <td id="LC2841" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zso4 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2842"></td>
          <td id="LC2842" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e1_zso4, f1_zso4, g1_zso4, dedz1_zso4, dfdz1_zso4, dgdz1_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2843"></td>
          <td id="LC2843" class="blob-code blob-code-inner js-file-line">        e2_zso4, f2_zso4, g2_zso4, dedz2_zso4, dfdz2_zso4, dgdz2_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2844"></td>
          <td id="LC2844" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>gammaCH4<span class="pl-k">*</span>zso4FDIC<span class="pl-k">/</span>DDIC2, zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f)</td>
        </tr>
        <tr>
          <td id="L2845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2845"></td>
          <td id="LC2845" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2846"></td>
          <td id="LC2846" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L2847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2847"></td>
          <td id="LC2847" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, reac1_dic, reac1_dic, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DDIC1, DDIC2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L2848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2848"></td>
          <td id="LC2848" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L2849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2849"></td>
          <td id="LC2849" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2850"></td>
          <td id="LC2850" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l2</span></td>
        </tr>
        <tr>
          <td id="L2851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2851"></td>
          <td id="LC2851" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, &amp;</td>
        </tr>
        <tr>
          <td id="L2852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2852"></td>
          <td id="LC2852" class="blob-code blob-code-inner js-file-line">        zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f, &amp;</td>
        </tr>
        <tr>
          <td id="L2853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2853"></td>
          <td id="LC2853" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L2854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2854"></td>
          <td id="LC2854" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2855"></td>
          <td id="LC2855" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for ADIC, BDIC given boundary conditions (expressed in terms of transformed basis fns, layer 4 A, B)</span></td>
        </tr>
        <tr>
          <td id="L2856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2856"></td>
          <td id="LC2856" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  ADIC*dedz4_zinf   +  BDIC*dfz4_zinf  + dgz4_zinf = 0;          % zero flux at zinf</span></td>
        </tr>
        <tr>
          <td id="L2857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2857"></td>
          <td id="LC2857" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  ADIC*e1_0     +   BDIC*f1_0     + g1_0  = swi.DIC0;</span></td>
        </tr>
        <tr>
          <td id="L2858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2858"></td>
          <td id="LC2858" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2859"></td>
          <td id="LC2859" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | dedz4_zinf dfdz4_zinf |  |ADIC|   = | -dgz4_zinf       |</span></td>
        </tr>
        <tr>
          <td id="L2860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2860"></td>
          <td id="LC2860" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | e1_0     f1_0         |  |BDIC|     | swi.DIC0 - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L2861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2861"></td>
          <td id="LC2861" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2862"></td>
          <td id="LC2862" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz2_zinf, dfdz2_zinf, e1_0, f1_0, <span class="pl-k">-</span>dgdz2_zinf, dum_swiconc_DIC <span class="pl-k">-</span> g1_0, rDIC_A2, rDIC_B2)</td>
        </tr>
        <tr>
          <td id="L2863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2863"></td>
          <td id="LC2863" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2864"></td>
          <td id="LC2864" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate concentration at zinf</span></td>
        </tr>
        <tr>
          <td id="L2865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2865"></td>
          <td id="LC2865" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> rDIC_A2<span class="pl-k">*</span>e2_zinf<span class="pl-k">+</span>rDIC_B2<span class="pl-k">*</span>f2_zinf <span class="pl-k">+</span> g2_zinf</td>
        </tr>
        <tr>
          <td id="L2866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2866"></td>
          <td id="LC2866" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2867"></td>
          <td id="LC2867" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L2868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2868"></td>
          <td id="LC2868" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: added advective flux 28.05.2016</span></td>
        </tr>
        <tr>
          <td id="L2869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2869"></td>
          <td id="LC2869" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_DIC <span class="pl-k">=</span> por<span class="pl-k">*</span>(DDIC1<span class="pl-k">*</span>(rDIC_A2<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rDIC_B2<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0) <span class="pl-k">-</span> w<span class="pl-k">*</span>(dum_swiconc_DIC <span class="pl-k">-</span> loc_conczinf))   <span class="pl-c"><span class="pl-c">!</span> NB: use A2, B2 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L2870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2870"></td>
          <td id="LC2870" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2871"></td>
          <td id="LC2871" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layers 1</span></td>
        </tr>
        <tr>
          <td id="L2872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2872"></td>
          <td id="LC2872" class="blob-code blob-code-inner js-file-line">        rDIC_A1 <span class="pl-k">=</span> zso4_a<span class="pl-k">*</span>rDIC_A2 <span class="pl-k">+</span> zso4_b<span class="pl-k">*</span>rDIC_B2 <span class="pl-k">+</span> zso4_e</td>
        </tr>
        <tr>
          <td id="L2873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2873"></td>
          <td id="LC2873" class="blob-code blob-code-inner js-file-line">        rDIC_B1 <span class="pl-k">=</span> zso4_c<span class="pl-k">*</span>rDIC_A2 <span class="pl-k">+</span> zso4_d<span class="pl-k">*</span>rDIC_B2 <span class="pl-k">+</span> zso4_f</td>
        </tr>
        <tr>
          <td id="L2874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2874"></td>
          <td id="LC2874" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2875"></td>
          <td id="LC2875" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; ---------------- RESULTS: benthic_zDIC ---------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2876"></td>
          <td id="LC2876" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2877"></td>
          <td id="LC2877" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L2878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2878"></td>
          <td id="LC2878" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flxswiDIC &#39;, char(9), loc_new_swiflux_DIC</span></td>
        </tr>
        <tr>
          <td id="L2879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2879"></td>
          <td id="LC2879" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;adv z0 &#39;, char(9), w*dum_swiconc_DIC</span></td>
        </tr>
        <tr>
          <td id="L2880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2880"></td>
          <td id="LC2880" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;adv zinf &#39;, char(9), w*loc_conczinf</span></td>
        </tr>
        <tr>
          <td id="L2881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2881"></td>
          <td id="LC2881" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flxswiDIC - advzinf &#39;, char(9), loc_new_swiflux_DIC - w*loc_conczinf</span></td>
        </tr>
        <tr>
          <td id="L2882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2882"></td>
          <td id="LC2882" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rH2S_A4, rH2S_B4, rH2S_A3, rH2S_B3, rH2S_A2, rH2S_B2, rH2S_A1, rH2S_B1&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L2883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2883"></td>
          <td id="LC2883" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>          &amp;  rH2S_A4, rH2S_B4, rH2S_A3, rH2S_B3, rH2S_A2, rH2S_B2, rH2S_A1, rH2S_B1</span></td>
        </tr>
        <tr>
          <td id="L2884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2884"></td>
          <td id="LC2884" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2885"></td>
          <td id="LC2885" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2886"></td>
          <td id="LC2886" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zDIC</span></td>
        </tr>
        <tr>
          <td id="L2887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2887"></td>
          <td id="LC2887" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2888"></td>
          <td id="LC2888" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2889"></td>
          <td id="LC2889" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2890"></td>
          <td id="LC2890" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2891"></td>
          <td id="LC2891" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2892"></td>
          <td id="LC2892" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                           Alkalinity (ALK)</span></td>
        </tr>
        <tr>
          <td id="L2893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2893"></td>
          <td id="LC2893" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2894"></td>
          <td id="LC2894" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2895"></td>
          <td id="LC2895" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L2896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2896"></td>
          <td id="LC2896" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L2897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2897"></td>
          <td id="LC2897" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2898"></td>
          <td id="LC2898" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zALK</span>(<span class="pl-v">dum_swiconc_ALK</span>, <span class="pl-v">loc_new_swiflux_ALK</span>)</td>
        </tr>
        <tr>
          <td id="L2899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2899"></td>
          <td id="LC2899" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2900"></td>
          <td id="LC2900" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L2901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2901"></td>
          <td id="LC2901" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_swiconc_ALK                <span class="pl-c"><span class="pl-c">!</span> ALK concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L2902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2902"></td>
          <td id="LC2902" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>loc_new_swiflux_ALK         <span class="pl-c"><span class="pl-c">!</span> ALK flux</span></td>
        </tr>
        <tr>
          <td id="L2903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2903"></td>
          <td id="LC2903" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2904"></td>
          <td id="LC2904" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L2905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2905"></td>
          <td id="LC2905" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_conczinf</td>
        </tr>
        <tr>
          <td id="L2906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2906"></td>
          <td id="LC2906" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac11_alk, reac12_alk, reac21_alk, reac22_alk, reac3_alk, reac4_alk                 <span class="pl-c"><span class="pl-c">!</span> reactive terms: OM degradation</span></td>
        </tr>
        <tr>
          <td id="L2907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2907"></td>
          <td id="LC2907" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> ltype1, ltype2, ltype3, ltype4</td>
        </tr>
        <tr>
          <td id="L2908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2908"></td>
          <td id="LC2908" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1</td>
        </tr>
        <tr>
          <td id="L2909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2909"></td>
          <td id="LC2909" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2</td>
        </tr>
        <tr>
          <td id="L2910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2910"></td>
          <td id="LC2910" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3</td>
        </tr>
        <tr>
          <td id="L2911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2911"></td>
          <td id="LC2911" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4</td>
        </tr>
        <tr>
          <td id="L2912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2912"></td>
          <td id="LC2912" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e4_zinf, dedz4_zinf, f4_zinf, dfdz4_zinf, g4_zinf, dgdz4_zinf</td>
        </tr>
        <tr>
          <td id="L2913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2913"></td>
          <td id="LC2913" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4</td>
        </tr>
        <tr>
          <td id="L2914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2914"></td>
          <td id="LC2914" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4</td>
        </tr>
        <tr>
          <td id="L2915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2915"></td>
          <td id="LC2915" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f</td>
        </tr>
        <tr>
          <td id="L2916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2916"></td>
          <td id="LC2916" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3</td>
        </tr>
        <tr>
          <td id="L2917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2917"></td>
          <td id="LC2917" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30</td>
        </tr>
        <tr>
          <td id="L2918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2918"></td>
          <td id="LC2918" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e3_zno3, dedz3_zno3, f3_zno3, dfdz3_zno3, g3_zno3, dgdz3_zno3</td>
        </tr>
        <tr>
          <td id="L2919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2919"></td>
          <td id="LC2919" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f</td>
        </tr>
        <tr>
          <td id="L2920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2920"></td>
          <td id="LC2920" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox</td>
        </tr>
        <tr>
          <td id="L2921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2921"></td>
          <td id="LC2921" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0</td>
        </tr>
        <tr>
          <td id="L2922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2922"></td>
          <td id="LC2922" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e2_zox, dedz2_zox, f2_zox, dfdz2_zox, g2_zox, dgdz2_zox</td>
        </tr>
        <tr>
          <td id="L2923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2923"></td>
          <td id="LC2923" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zox_a, zox_b, zox_c, zox_d, zox_e, zox_f</td>
        </tr>
        <tr>
          <td id="L2924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2924"></td>
          <td id="LC2924" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00</td>
        </tr>
        <tr>
          <td id="L2925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2925"></td>
          <td id="LC2925" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e1_0, dedz1_0, f1_0, dfdz1_0, g1_0, dgdz1_0</td>
        </tr>
        <tr>
          <td id="L2926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2926"></td>
          <td id="LC2926" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2927"></td>
          <td id="LC2927" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rALK_A4, rALK_B4</td>
        </tr>
        <tr>
          <td id="L2928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2928"></td>
          <td id="LC2928" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rALK_A3, rALK_B3</td>
        </tr>
        <tr>
          <td id="L2929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2929"></td>
          <td id="LC2929" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rALK_A2, rALK_B2</td>
        </tr>
        <tr>
          <td id="L2930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2930"></td>
          <td id="LC2930" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> rALK_A1, rALK_B1</td>
        </tr>
        <tr>
          <td id="L2931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2931"></td>
          <td id="LC2931" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2932"></td>
          <td id="LC2932" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> zso4FALK, zoxFALK</td>
        </tr>
        <tr>
          <td id="L2933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2933"></td>
          <td id="LC2933" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2934"></td>
          <td id="LC2934" class="blob-code blob-code-inner js-file-line">        reac11_alk <span class="pl-k">=</span> gamma<span class="pl-k">*</span>NC1<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KNH4)<span class="pl-k">*</span>ALKRNIT<span class="pl-k">+</span>ALKROX           <span class="pl-c"><span class="pl-c">!</span> z &lt; zox:  Nitrification (-2) Aerobic degradation (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2935"></td>
          <td id="LC2935" class="blob-code blob-code-inner js-file-line">        reac12_alk <span class="pl-k">=</span> gamma<span class="pl-k">*</span>NC2<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KNH4)<span class="pl-k">*</span>ALKRNIT<span class="pl-k">+</span>ALKROX           <span class="pl-c"><span class="pl-c">!</span> z &lt; zox:  Nitrification (-2) Aerobic degradation (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2936"></td>
          <td id="LC2936" class="blob-code blob-code-inner js-file-line">        reac21_alk <span class="pl-k">=</span> ALKRDEN                                     <span class="pl-c"><span class="pl-c">!</span> zox &lt; z &lt; zno3: Denitrification (+93.4/106)</span></td>
        </tr>
        <tr>
          <td id="L2937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2937"></td>
          <td id="LC2937" class="blob-code blob-code-inner js-file-line">        reac22_alk <span class="pl-k">=</span> ALKRDEN                                     <span class="pl-c"><span class="pl-c">!</span> zox &lt; z &lt; zno3: Denitrification (+93.4/106)</span></td>
        </tr>
        <tr>
          <td id="L2938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2938"></td>
          <td id="LC2938" class="blob-code blob-code-inner js-file-line">        reac3_alk <span class="pl-k">=</span> ALKRSUL                                    <span class="pl-c"><span class="pl-c">!</span> zno3 &lt; z &lt; zso4: Sulfate reduction (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2939"></td>
          <td id="LC2939" class="blob-code blob-code-inner js-file-line">        reac4_alk <span class="pl-k">=</span> ALKRMET                                      <span class="pl-c"><span class="pl-c">!</span> zso4 &lt; z &lt; zinf: Methanogenesis (+14/106)</span></td>
        </tr>
        <tr>
          <td id="L2940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2940"></td>
          <td id="LC2940" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L2941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2941"></td>
          <td id="LC2941" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        reac11_alk = gamma*NC1/(1+KNH4)*ALKRNIT+ALKROX*SD           ! z &lt; zox:  Nitrification (-2) Aerobic degradation (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2942"></td>
          <td id="LC2942" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        reac12_alk = gamma*NC2/(1+KNH4)*ALKRNIT+ALKROX*SD           ! z &lt; zox:  Nitrification (-2) Aerobic degradation (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2943"></td>
          <td id="LC2943" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        reac2_alk = SD*ALKRDEN                                      ! zox &lt; z &lt; zno3: Denitrification (+93.4/106)</span></td>
        </tr>
        <tr>
          <td id="L2944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2944"></td>
          <td id="LC2944" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        reac3_alk = SD*ALKRSUL                                      ! zno3 &lt; z &lt; zso4: Sulfate reduction (+15/106)</span></td>
        </tr>
        <tr>
          <td id="L2945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2945"></td>
          <td id="LC2945" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        reac4_alk = SD*ALKRMET                                      ! zso4 &lt; z &lt; zinf: Methanogenesis (+14/106)</span></td>
        </tr>
        <tr>
          <td id="L2946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2946"></td>
          <td id="LC2946" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2947"></td>
          <td id="LC2947" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2948"></td>
          <td id="LC2948" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;------------------------------------------------------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L2949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2949"></td>
          <td id="LC2949" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;---------------------- START zALK ------------------------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L2950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2950"></td>
          <td id="LC2950" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;&#39;</span></td>
        </tr>
        <tr>
          <td id="L2951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2951"></td>
          <td id="LC2951" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2952"></td>
          <td id="LC2952" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Calculate ALK</span></td>
        </tr>
        <tr>
          <td id="L2953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2953"></td>
          <td id="LC2953" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2954"></td>
          <td id="LC2954" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Preparation: for each layer, sort out solution-matching across bioturbation boundary if necessary</span></td>
        </tr>
        <tr>
          <td id="L2955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2955"></td>
          <td id="LC2955" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 1: 0 &lt; z &lt; zox, Nitrification (-) Aerobic degradation (+)</span></td>
        </tr>
        <tr>
          <td id="L2956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2956"></td>
          <td id="LC2956" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    prepfg_l12(reac1,      reac2,    ktemp, zU,  zL,   D1,     D2, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, ltype)</span></td>
        </tr>
        <tr>
          <td id="L2957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2957"></td>
          <td id="LC2957" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac11_alk, reac12_alk, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zox, DALK1, DALK2, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, ltype1)</td>
        </tr>
        <tr>
          <td id="L2958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2958"></td>
          <td id="LC2958" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2959"></td>
          <td id="LC2959" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 2: zox &lt; z &lt; zno3, Denitrification (+)</span></td>
        </tr>
        <tr>
          <td id="L2960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2960"></td>
          <td id="LC2960" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac21_alk, reac22_alk, <span class="pl-c1">0.0</span>, zox, zno3, DALK1, DALK2, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, ltype2)</td>
        </tr>
        <tr>
          <td id="L2961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2961"></td>
          <td id="LC2961" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2962"></td>
          <td id="LC2962" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 3: zno3 &lt; z &lt; zso4, Sulfate reduction (+)</span></td>
        </tr>
        <tr>
          <td id="L2963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2963"></td>
          <td id="LC2963" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac3_alk, reac3_alk, <span class="pl-c1">0.0</span>, zno3, zso4, DALK1, DALK2, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, ltype3)</td>
        </tr>
        <tr>
          <td id="L2964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2964"></td>
          <td id="LC2964" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2965"></td>
          <td id="LC2965" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> layer 4: zso4 &lt; z &lt; zinf, Methanogenesis (+)</span></td>
        </tr>
        <tr>
          <td id="L2966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2966"></td>
          <td id="LC2966" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_prepfg_l12(reac4_alk, reac4_alk, <span class="pl-c1">0.0</span>, zso4, zinf, DALK1, DALK2, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, ltype4)</td>
        </tr>
        <tr>
          <td id="L2967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2967"></td>
          <td id="LC2967" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2968"></td>
          <td id="LC2968" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Work up from the bottom, matching solutions at boundaries</span></td>
        </tr>
        <tr>
          <td id="L2969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2969"></td>
          <td id="LC2969" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions at bottom of layer 4 zinf</span></td>
        </tr>
        <tr>
          <td id="L2970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2970"></td>
          <td id="LC2970" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   calcfg_l12(  z,     reac1,      reac2, ktemp, ls_a, ls_b,  ls_c, ls_d,   ls_e, ls_f,  ls_D1, ls_D2, ltype, e, dedz, f, dfdz, g, dgdz)</span></td>
        </tr>
        <tr>
          <td id="L2971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2971"></td>
          <td id="LC2971" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zinf, reac4_alk, reac4_alk, <span class="pl-c1">0.0</span>, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, DALK1, DALK2, ltype4, &amp;</td>
        </tr>
        <tr>
          <td id="L2972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2972"></td>
          <td id="LC2972" class="blob-code blob-code-inner js-file-line">        e4_zinf, dedz4_zinf, f4_zinf, dfdz4_zinf, g4_zinf, dgdz4_zinf)</td>
        </tr>
        <tr>
          <td id="L2973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2973"></td>
          <td id="LC2973" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2974"></td>
          <td id="LC2974" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zso4, layer 3 - layer 4 (continuity and flux with AOM production)</span></td>
        </tr>
        <tr>
          <td id="L2975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2975"></td>
          <td id="LC2975" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 3</span></td>
        </tr>
        <tr>
          <td id="L2976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2976"></td>
          <td id="LC2976" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac3_alk, reac3_alk, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DALK1, DALK2, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L2977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2977"></td>
          <td id="LC2977" class="blob-code blob-code-inner js-file-line">        e3_zso4, dedz3_zso4, f3_zso4, dfdz3_zso4, g3_zso4, dgdz3_zso4)</td>
        </tr>
        <tr>
          <td id="L2978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2978"></td>
          <td id="LC2978" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2979"></td>
          <td id="LC2979" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 4</span></td>
        </tr>
        <tr>
          <td id="L2980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2980"></td>
          <td id="LC2980" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zso4, reac4_alk, reac4_alk, <span class="pl-c1">0.0</span>, ls_a4, ls_b4, ls_c4, ls_d4, ls_e4, ls_f4, DALK1, DALK2, ltype4, &amp;</td>
        </tr>
        <tr>
          <td id="L2981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2981"></td>
          <td id="LC2981" class="blob-code blob-code-inner js-file-line">        e4_zso4, dedz4_zso4, f4_zso4, dfdz4_zso4, g4_zso4, dgdz4_zso4)</td>
        </tr>
        <tr>
          <td id="L2982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2982"></td>
          <td id="LC2982" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2983"></td>
          <td id="LC2983" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of ALK produced by AOM interface (Source of ALK)</span></td>
        </tr>
        <tr>
          <td id="L2984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2984"></td>
          <td id="LC2984" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>!!        zso4FALK = 0.0      !no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L2985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2985"></td>
          <td id="LC2985" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zso4 <span class="pl-k">.EQ.</span> zinf)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L2986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2986"></td>
          <td id="LC2986" class="blob-code blob-code-inner js-file-line">            zso4FALK <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L2987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2987"></td>
          <td id="LC2987" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2988"></td>
          <td id="LC2988" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>          zso4FALK = ALKRAOM*gammaCH4*FUN_calcReac(zso4, zinf, SD, SD) ! Dominik was before 12.03.2018</span></td>
        </tr>
        <tr>
          <td id="L2989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2989"></td>
          <td id="LC2989" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>             print*,&#39;zso4FALK SD&#39;, zso4FALK</span></td>
        </tr>
        <tr>
          <td id="L2990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2990"></td>
          <td id="LC2990" class="blob-code blob-code-inner js-file-line">            zso4FALK <span class="pl-k">=</span> ALKRAOM<span class="pl-k">*</span>gammaCH4<span class="pl-k">*</span>FUN_calcReac(zso4, zinf, MC, MC) <span class="pl-c"><span class="pl-c">!</span> MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L2991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2991"></td>
          <td id="LC2991" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>             print*,&#39;zso4FALK MC&#39;, zso4FALK</span></td>
        </tr>
        <tr>
          <td id="L2992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2992"></td>
          <td id="LC2992" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L2993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2993"></td>
          <td id="LC2993" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2994"></td>
          <td id="LC2994" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zso4 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L2995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2995"></td>
          <td id="LC2995" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e3_zso4, f3_zso4, g3_zso4, dedz3_zso4, dfdz3_zso4, dgdz3_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2996"></td>
          <td id="LC2996" class="blob-code blob-code-inner js-file-line">        e4_zso4, f4_zso4, g4_zso4, dedz4_zso4, dfdz4_zso4, dgdz4_zso4, &amp;</td>
        </tr>
        <tr>
          <td id="L2997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2997"></td>
          <td id="LC2997" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>zso4FALK<span class="pl-k">/</span>DALK2, zso4_a, zso4_b, zso4_c, zso4_d, zso4_e, zso4_f)</td>
        </tr>
        <tr>
          <td id="L2998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2998"></td>
          <td id="LC2998" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2999"></td>
          <td id="LC2999" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zno3, layer 2 - layer 3 (continuity and flux)</span></td>
        </tr>
        <tr>
          <td id="L3000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3000"></td>
          <td id="LC3000" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 2</span></td>
        </tr>
        <tr>
          <td id="L3001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3001"></td>
          <td id="LC3001" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, reac21_alk, reac22_alk, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DALK1, DALK2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L3002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3002"></td>
          <td id="LC3002" class="blob-code blob-code-inner js-file-line">        e2_zno3, dedz2_zno3, f2_zno3, dfdz2_zno3, g2_zno3, dgdz2_zno3)</td>
        </tr>
        <tr>
          <td id="L3003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3003"></td>
          <td id="LC3003" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3004"></td>
          <td id="LC3004" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... and top of layer 3</span></td>
        </tr>
        <tr>
          <td id="L3005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3005"></td>
          <td id="LC3005" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zno3, reac3_alk, reac3_alk, <span class="pl-c1">0.0</span>, ls_a3, ls_b3, ls_c3, ls_d3, ls_e3, ls_f3, DALK1, DALK2, ltype3, &amp;</td>
        </tr>
        <tr>
          <td id="L3006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3006"></td>
          <td id="LC3006" class="blob-code blob-code-inner js-file-line">        e3_zno30, dedz3_zno30, f3_zno30, dfdz3_zno30, g3_zno30, dgdz3_zno30)</td>
        </tr>
        <tr>
          <td id="L3007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3007"></td>
          <td id="LC3007" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3008"></td>
          <td id="LC3008" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ... transformed to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L3009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3009"></td>
          <td id="LC3009" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e3_zno30, f3_zno30, g3_zno30, dedz3_zno30, dfdz3_zno30, dgdz3_zno30, &amp;</td>
        </tr>
        <tr>
          <td id="L3010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3010"></td>
          <td id="LC3010" class="blob-code blob-code-inner js-file-line">        zso4_a , zso4_b , zso4_c , zso4_d , zso4_e ,zso4_f, &amp;</td>
        </tr>
        <tr>
          <td id="L3011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3011"></td>
          <td id="LC3011" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3)</td>
        </tr>
        <tr>
          <td id="L3012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3012"></td>
          <td id="LC3012" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zno3 - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L3013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3013"></td>
          <td id="LC3013" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_matchsoln(e2_zno3, f2_zno3, g2_zno3, dedz2_zno3, dfdz2_zno3, dgdz2_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L3014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3014"></td>
          <td id="LC3014" class="blob-code blob-code-inner js-file-line">        e3_zno3, f3_zno3, g3_zno3, dedz3_zno3, dfdz3_zno3, dgdz3_zno3, &amp;</td>
        </tr>
        <tr>
          <td id="L3015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3015"></td>
          <td id="LC3015" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, zno3_a, zno3_b, zno3_c, zno3_d, zno3_e, zno3_f)</td>
        </tr>
        <tr>
          <td id="L3016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3016"></td>
          <td id="LC3016" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3017"></td>
          <td id="LC3017" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match at zox, layer 1 - layer 2 (continuity, flux discontinuity from ALK source)</span></td>
        </tr>
        <tr>
          <td id="L3018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3018"></td>
          <td id="LC3018" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux of ALK to oxic interface (from all sources of ALK below) from NH4 and H2S</span></td>
        </tr>
        <tr>
          <td id="L3019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3019"></td>
          <td id="LC3019" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        zoxFALK = 0.0       !no secondary redox!</span></td>
        </tr>
        <tr>
          <td id="L3020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3020"></td>
          <td id="LC3020" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> with implicit N alkalinity</span></td>
        </tr>
        <tr>
          <td id="L3021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3021"></td>
          <td id="LC3021" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Dom 12.03.18 Don&#39;t need the -1.0 because all oxidised is accounted for in ALKSO4</span></td>
        </tr>
        <tr>
          <td id="L3022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3022"></td>
          <td id="LC3022" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        zoxFALK = -1.0*gamma*FUN_calcReac(zno3, zinf, (16.0/106.0)*SD*1/(1+KNH4),(16.0/106.0)*SD*1/(1+KNH4)) &amp;      ! was until 27.02. -1.0 before -2.0* gamma ... MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L3023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3023"></td>
          <td id="LC3023" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        + ALKRH2S*gammaH2S*FUN_calcReac(zno3, zso4, SO4C, SO4C)                 ! Dominik 25.02.2016</span></td>
        </tr>
        <tr>
          <td id="L3024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3024"></td>
          <td id="LC3024" class="blob-code blob-code-inner js-file-line">        zoxFALK <span class="pl-k">=</span> ALKRNIT<span class="pl-k">*</span>gamma<span class="pl-k">*</span>FUN_calcReac(zno3, zinf, NC1<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KNH4),NC2<span class="pl-k">/</span>(<span class="pl-c1">1</span><span class="pl-k">+</span>KNH4)) &amp;      <span class="pl-c"><span class="pl-c">!</span> was until 27.02. -1.0 before -2.0* gamma ... MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L3025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3025"></td>
          <td id="LC3025" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> ALKRH2S<span class="pl-k">*</span>gammaH2S<span class="pl-k">*</span>FUN_calcReac(zno3, zso4, SO4C, SO4C)                 <span class="pl-c"><span class="pl-c">!</span> Dominik 25.02.2016</span></td>
        </tr>
        <tr>
          <td id="L3026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3026"></td>
          <td id="LC3026" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        zoxFALK = ALKRH2S*gammaH2S*FUN_calcReac(zno3, zso4, SO4C, SO4C)                 ! Dominik 05.02.2018 try to fix ALK (here no NH4 contribution)</span></td>
        </tr>
        <tr>
          <td id="L3027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3027"></td>
          <td id="LC3027" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        zoxFALK = ALKRNIT*gamma*FUN_calcReac(zno3, zinf, NC1/(1+KNH4),NC2/(1+KNH4)) &amp;      ! MULTIPLY BY 1/POR ????</span></td>
        </tr>
        <tr>
          <td id="L3028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3028"></td>
          <td id="LC3028" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                  + ALKRH2S*gammaH2S*FUN_calcReac(zno3, zso4, SO4C, SO4C)                 ! Dominik 25.02.2016</span></td>
        </tr>
        <tr>
          <td id="L3029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3029"></td>
          <td id="LC3029" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH 24.02.2016: actually should be 2 integrals for ALK produced: ALK-reduction + AOM (see documentation, but has the same reac const = 0.5) :</span></td>
        </tr>
        <tr>
          <td id="L3030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3030"></td>
          <td id="LC3030" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        if(zso4 &lt; zinf)then</span></td>
        </tr>
        <tr>
          <td id="L3031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3031"></td>
          <td id="LC3031" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;zno3 = &#39;, zno3</span></td>
        </tr>
        <tr>
          <td id="L3032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3032"></td>
          <td id="LC3032" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        print*,&#39;zoxFALK = &#39;, zoxFALK</span></td>
        </tr>
        <tr>
          <td id="L3033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3033"></td>
          <td id="LC3033" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;impl flux of ALK to oxic interface zoxFALK = &#39;, -1.0*gamma*FUN_calcReac(zno3, zinf, (16.0/106.0)*SD*1/(1+KNH4),(16.0/106.0)*SD*1/(1+KNH4)) + ALKRH2S*gammaH2S*FUN_calcReac(zno3, zso4, SO4C, SO4C) </span></td>
        </tr>
        <tr>
          <td id="L3034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3034"></td>
          <td id="LC3034" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flux of ALK to oxic interface zoxFALK = &#39;, zoxFALK</span></td>
        </tr>
        <tr>
          <td id="L3035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3035"></td>
          <td id="LC3035" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flux N   = &#39;, -1.0*gamma*FUN_calcReac(zno3, zinf, (16.0/106.0)*SD*1/(1+KNH4),(16.0/106.0)*SD*1/(1+KNH4))</span></td>
        </tr>
        <tr>
          <td id="L3036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3036"></td>
          <td id="LC3036" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flux N = &#39;, ALKRNIT*gamma*FUN_calcReac(zno3, zinf, NC1/(1+KNH4),NC2/(1+KNH4))        </span></td>
        </tr>
        <tr>
          <td id="L3037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3037"></td>
          <td id="LC3037" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39;flux H2S = &#39;, ALKRH2S*gammaH2S*FUN_calcReac(zno3, zso4, SO4C, SO4C)</span></td>
        </tr>
        <tr>
          <td id="L3038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3038"></td>
          <td id="LC3038" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L3039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3039"></td>
          <td id="LC3039" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L3040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3040"></td>
          <td id="LC3040" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at bottom of layer 1</span></td>
        </tr>
        <tr>
          <td id="L3041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3041"></td>
          <td id="LC3041" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, reac11_alk, reac12_alk, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DALK1, DALK2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L3042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3042"></td>
          <td id="LC3042" class="blob-code blob-code-inner js-file-line">        e1_zox, dedz1_zox, f1_zox, dfdz1_zox, g1_zox, dgdz1_zox)</td>
        </tr>
        <tr>
          <td id="L3043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3043"></td>
          <td id="LC3043" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3044"></td>
          <td id="LC3044" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> basis functions at top of layer 2</span></td>
        </tr>
        <tr>
          <td id="L3045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3045"></td>
          <td id="LC3045" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(zox, reac21_alk, reac22_alk, <span class="pl-c1">0.0</span>, ls_a2, ls_b2, ls_c2, ls_d2, ls_e2, ls_f2, DALK1, DALK2, ltype2, &amp;</td>
        </tr>
        <tr>
          <td id="L3046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3046"></td>
          <td id="LC3046" class="blob-code blob-code-inner js-file-line">        e2_zox0, dedz2_zox0, f2_zox0, dfdz2_zox0, g2_zox0, dgdz2_zox0)</td>
        </tr>
        <tr>
          <td id="L3047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3047"></td>
          <td id="LC3047" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3048"></td>
          <td id="LC3048" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   transform to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L3049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3049"></td>
          <td id="LC3049" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e2_zox0, f2_zox0, g2_zox0, dedz2_zox0, dfdz2_zox0, dgdz2_zox0, &amp;</td>
        </tr>
        <tr>
          <td id="L3050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3050"></td>
          <td id="LC3050" class="blob-code blob-code-inner js-file-line">        zno3_a , zno3_b , zno3_c , zno3_d , zno3_e ,zno3_f, &amp;</td>
        </tr>
        <tr>
          <td id="L3051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3051"></td>
          <td id="LC3051" class="blob-code blob-code-inner js-file-line">        e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox)</td>
        </tr>
        <tr>
          <td id="L3052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3052"></td>
          <td id="LC3052" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3053"></td>
          <td id="LC3053" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> match solutions at zox - continuous concentration, flux discontinuity from ALK ox</span></td>
        </tr>
        <tr>
          <td id="L3054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3054"></td>
          <td id="LC3054" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3055"></td>
          <td id="LC3055" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>(zox <span class="pl-k">.le.</span> zbio) <span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L3056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3056"></td>
          <td id="LC3056" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L3057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3057"></td>
          <td id="LC3057" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L3058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3058"></td>
          <td id="LC3058" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>zoxFALK<span class="pl-k">/</span>DALK1, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L3059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3059"></td>
          <td id="LC3059" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Dominik 07.02.2018 change sign to + r_zxf*zoxFALK/DALK1</span></td>
        </tr>
        <tr>
          <td id="L3060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3060"></td>
          <td id="LC3060" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            call sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3061"></td>
          <td id="LC3061" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3062"></td>
          <td id="LC3062" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            0.0, +r_zxf*zoxFALK/DALK1, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</span></td>
        </tr>
        <tr>
          <td id="L3063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3063"></td>
          <td id="LC3063" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L3064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3064"></td>
          <td id="LC3064" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L3065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3065"></td>
          <td id="LC3065" class="blob-code blob-code-inner js-file-line">            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</td>
        </tr>
        <tr>
          <td id="L3066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3066"></td>
          <td id="LC3066" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-k">-</span>r_zxf<span class="pl-k">*</span>zoxFALK<span class="pl-k">/</span>DALK2, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</td>
        </tr>
        <tr>
          <td id="L3067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3067"></td>
          <td id="LC3067" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Dominik 07.02.2018 change sign to + r_zxf*zoxFALK/DALK1</span></td>
        </tr>
        <tr>
          <td id="L3068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3068"></td>
          <td id="LC3068" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            call sub_matchsoln(e1_zox, f1_zox, g1_zox, dedz1_zox, dfdz1_zox, dgdz1_zox, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3069"></td>
          <td id="LC3069" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            e2_zox, f2_zox, g2_zox, dedz2_zox, dfdz2_zox, dgdz2_zox, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3070"></td>
          <td id="LC3070" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">!</span>            0.0, +r_zxf*zoxFALK/DALK2, zox_a, zox_b, zox_c, zox_d, zox_e, zox_f)</span></td>
        </tr>
        <tr>
          <td id="L3071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3071"></td>
          <td id="LC3071" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L3072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3072"></td>
          <td id="LC3072" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3073"></td>
          <td id="LC3073" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solution at swi, top of layer 1</span></td>
        </tr>
        <tr>
          <td id="L3074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3074"></td>
          <td id="LC3074" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_calcfg_l12(<span class="pl-c1">0.0</span>, reac11_alk, reac12_alk, <span class="pl-c1">0.0</span>, ls_a1, ls_b1, ls_c1, ls_d1, ls_e1, ls_f1, DALK1, DALK2, ltype1, &amp;</td>
        </tr>
        <tr>
          <td id="L3075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3075"></td>
          <td id="LC3075" class="blob-code blob-code-inner js-file-line">        e1_00, dedz1_00, f1_00, dfdz1_00, g1_00, dgdz1_00)</td>
        </tr>
        <tr>
          <td id="L3076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3076"></td>
          <td id="LC3076" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3077"></td>
          <td id="LC3077" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> transform to use coeffs from l4</span></td>
        </tr>
        <tr>
          <td id="L3078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3078"></td>
          <td id="LC3078" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_xformsoln(e1_00, f1_00, g1_00, dedz1_00, dfdz1_00, dgdz1_00, &amp;</td>
        </tr>
        <tr>
          <td id="L3079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3079"></td>
          <td id="LC3079" class="blob-code blob-code-inner js-file-line">        zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f, &amp;</td>
        </tr>
        <tr>
          <td id="L3080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3080"></td>
          <td id="LC3080" class="blob-code blob-code-inner js-file-line">        e1_0, f1_0, g1_0, dedz1_0,  dfdz1_0, dgdz1_0)</td>
        </tr>
        <tr>
          <td id="L3081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3081"></td>
          <td id="LC3081" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3082"></td>
          <td id="LC3082" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Solve for AALK, BALK given boundary conditions (expressed in terms of transformed basis fns, layer 4 A, B)</span></td>
        </tr>
        <tr>
          <td id="L3083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3083"></td>
          <td id="LC3083" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  AALK*dedz4_zinf   +  BALK*dfz4_zinf  + dgz4_zinf = 0;          % zero flux at zinf</span></td>
        </tr>
        <tr>
          <td id="L3084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3084"></td>
          <td id="LC3084" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  AALK*e1_0     +   BALK*f1_0     + g1_0  = swi.ALK0;</span></td>
        </tr>
        <tr>
          <td id="L3085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3085"></td>
          <td id="LC3085" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3086"></td>
          <td id="LC3086" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | dedz4_zinf dfdz4_zinf |  |AALK|   = | -dgz4_zinf       |</span></td>
        </tr>
        <tr>
          <td id="L3087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3087"></td>
          <td id="LC3087" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  | e1_0     f1_0         |  |BALK|     | swi.ALK0 - g1_0 |</span></td>
        </tr>
        <tr>
          <td id="L3088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3088"></td>
          <td id="LC3088" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3089"></td>
          <td id="LC3089" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_solve2eqn(dedz4_zinf, dfdz4_zinf, e1_0, f1_0, <span class="pl-k">-</span>dgdz4_zinf, dum_swiconc_ALK <span class="pl-k">-</span> g1_0, rALK_A4, rALK_B4)</td>
        </tr>
        <tr>
          <td id="L3090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3090"></td>
          <td id="LC3090" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3091"></td>
          <td id="LC3091" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate concentration at zinf</span></td>
        </tr>
        <tr>
          <td id="L3092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3092"></td>
          <td id="LC3092" class="blob-code blob-code-inner js-file-line">        loc_conczinf <span class="pl-k">=</span> rALK_A4<span class="pl-k">*</span>e4_zinf<span class="pl-k">+</span>rALK_B4<span class="pl-k">*</span>f4_zinf <span class="pl-k">+</span> g4_zinf</td>
        </tr>
        <tr>
          <td id="L3093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3093"></td>
          <td id="LC3093" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3094"></td>
          <td id="LC3094" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> flux at swi - DO include por so this is per cm^2 water column area</span></td>
        </tr>
        <tr>
          <td id="L3095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3095"></td>
          <td id="LC3095" class="blob-code blob-code-inner js-file-line">        loc_new_swiflux_ALK <span class="pl-k">=</span> por<span class="pl-k">*</span>(DALK1<span class="pl-k">*</span>(rALK_A4<span class="pl-k">*</span>dedz1_0<span class="pl-k">+</span>rALK_B4<span class="pl-k">*</span>dfdz1_0 <span class="pl-k">+</span> dgdz1_0) <span class="pl-k">-</span> w<span class="pl-k">*</span>(dum_swiconc_ALK <span class="pl-k">-</span> loc_conczinf))   <span class="pl-c"><span class="pl-c">!</span> NB: use A4, B4 as these are _xformed_ layer 1 basis functions</span></td>
        </tr>
        <tr>
          <td id="L3096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3096"></td>
          <td id="LC3096" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3097"></td>
          <td id="LC3097" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save coeffs for layers 3, 2 and 1</span></td>
        </tr>
        <tr>
          <td id="L3098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3098"></td>
          <td id="LC3098" class="blob-code blob-code-inner js-file-line">        rALK_A3 <span class="pl-k">=</span> zso4_a<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zso4_b<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zso4_e</td>
        </tr>
        <tr>
          <td id="L3099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3099"></td>
          <td id="LC3099" class="blob-code blob-code-inner js-file-line">        rALK_B3 <span class="pl-k">=</span> zso4_c<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zso4_d<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zso4_f</td>
        </tr>
        <tr>
          <td id="L3100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3100"></td>
          <td id="LC3100" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3101"></td>
          <td id="LC3101" class="blob-code blob-code-inner js-file-line">        rALK_A2 <span class="pl-k">=</span> zno3_a<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zno3_b<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zno3_e</td>
        </tr>
        <tr>
          <td id="L3102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3102"></td>
          <td id="LC3102" class="blob-code blob-code-inner js-file-line">        rALK_B2 <span class="pl-k">=</span> zno3_c<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zno3_d<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zno3_f</td>
        </tr>
        <tr>
          <td id="L3103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3103"></td>
          <td id="LC3103" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3104"></td>
          <td id="LC3104" class="blob-code blob-code-inner js-file-line">        rALK_A1 <span class="pl-k">=</span> zox_a<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zox_b<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zox_e</td>
        </tr>
        <tr>
          <td id="L3105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3105"></td>
          <td id="LC3105" class="blob-code blob-code-inner js-file-line">        rALK_B1 <span class="pl-k">=</span> zox_c<span class="pl-k">*</span>rALK_A4 <span class="pl-k">+</span> zox_d<span class="pl-k">*</span>rALK_B4 <span class="pl-k">+</span> zox_f</td>
        </tr>
        <tr>
          <td id="L3106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3106"></td>
          <td id="LC3106" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3107"></td>
          <td id="LC3107" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; ---------------- RESULTS: benthic_zALK ---------------- &#39;</span></td>
        </tr>
        <tr>
          <td id="L3108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3108"></td>
          <td id="LC3108" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;flxswiALK &#39;, char(9), flxswiALK</span></td>
        </tr>
        <tr>
          <td id="L3109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3109"></td>
          <td id="LC3109" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;rALK_A4, rALK_B4, rALK_A3, rALK_B3, rALK_A2, rALK_B2, rALK_A1, rALK_B1&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3110"></td>
          <td id="LC3110" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>          &amp;  rALK_A4, rALK_B4, rALK_A3, rALK_B3, rALK_A2, rALK_B2, rALK_A1, rALK_B1</span></td>
        </tr>
        <tr>
          <td id="L3111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3111"></td>
          <td id="LC3111" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3112"></td>
          <td id="LC3112" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3113"></td>
          <td id="LC3113" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   print*,&#39;INPUT1: dedz4_zinf, dfdz4_zinf, e1_0, f1_0, -dgdz4_zinf, ALK0 - g1_0&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3114"></td>
          <td id="LC3114" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>           &amp; dedz4_zinf, dfdz4_zinf, e1_0, f1_0, -dgdz4_zinf, ALK0 - g1_0</span></td>
        </tr>
        <tr>
          <td id="L3115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3115"></td>
          <td id="LC3115" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;INPUT2: zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3116"></td>
          <td id="LC3116" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; zox_a , zox_b , zox_c , zox_d , zox_e ,zox_f</span></td>
        </tr>
        <tr>
          <td id="L3117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3117"></td>
          <td id="LC3117" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;RESULTS:  rALK_A4, rALK_B4&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L3118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3118"></td>
          <td id="LC3118" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            &amp; rALK_A4, rALK_B4</span></td>
        </tr>
        <tr>
          <td id="L3119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3119"></td>
          <td id="LC3119" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3120"></td>
          <td id="LC3120" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zALK</span></td>
        </tr>
        <tr>
          <td id="L3121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3121"></td>
          <td id="LC3121" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3122"></td>
          <td id="LC3122" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3123"></td>
          <td id="LC3123" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3124"></td>
          <td id="LC3124" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3125"></td>
          <td id="LC3125" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3126"></td>
          <td id="LC3126" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcReac</td>
        </tr>
        <tr>
          <td id="L3127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3127"></td>
          <td id="LC3127" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3128"></td>
          <td id="LC3128" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Integral of reacted organic matter from zU to zL,</span></td>
        </tr>
        <tr>
          <td id="L3129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3129"></td>
          <td id="LC3129" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> multiplied by stoichiometric factors reac1, reac2 (for the two OC phases)</span></td>
        </tr>
        <tr>
          <td id="L3130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3130"></td>
          <td id="LC3130" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3131"></td>
          <td id="LC3131" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Vector-friendly way of handling 3 cases:</span></td>
        </tr>
        <tr>
          <td id="L3132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3132"></td>
          <td id="LC3132" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 1) wholly within bioturbated layer:    FUN_calcReac_l1(zU,zL)     + (0 =) FUN_calcReac_l2(zbio, zbio)</span></td>
        </tr>
        <tr>
          <td id="L3133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3133"></td>
          <td id="LC3133" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 2) wholly within non-bio     layer:  (0=) FUN_calcReac_l1(zbio, zbio) +   FUN_calcReac_l2(zU, zL)</span></td>
        </tr>
        <tr>
          <td id="L3134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3134"></td>
          <td id="LC3134" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 3) crossing zbio                       calcRead_l1(zU,zbio)   +       FUN_calcReac_l2(zbio, zL)</span></td>
        </tr>
        <tr>
          <td id="L3135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3135"></td>
          <td id="LC3135" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3136"></td>
          <td id="LC3136" class="blob-code blob-code-inner js-file-line">        FUN_calcReac <span class="pl-k">=</span> FUN_calcReac_l1(<span class="pl-k">min</span>(zU,zbio), <span class="pl-k">min</span>(zL,zbio), reac1, reac2) &amp;</td>
        </tr>
        <tr>
          <td id="L3137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3137"></td>
          <td id="LC3137" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> FUN_calcReac_l2(<span class="pl-k">max</span>(zU,zbio), <span class="pl-k">max</span>(zL, zbio), reac1, reac2)</td>
        </tr>
        <tr>
          <td id="L3138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3138"></td>
          <td id="LC3138" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3139"></td>
          <td id="LC3139" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> TODO confirm (1-por)*  has been added (to k1 &amp; k2 ?)</span></td>
        </tr>
        <tr>
          <td id="L3140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3140"></td>
          <td id="LC3140" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3141"></td>
          <td id="LC3141" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac</span></td>
        </tr>
        <tr>
          <td id="L3142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3142"></td>
          <td id="LC3142" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3143"></td>
          <td id="LC3143" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3144"></td>
          <td id="LC3144" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3145"></td>
          <td id="LC3145" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3146"></td>
          <td id="LC3146" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3147"></td>
          <td id="LC3147" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3148"></td>
          <td id="LC3148" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac_l1</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3149"></td>
          <td id="LC3149" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3150"></td>
          <td id="LC3150" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3151"></td>
          <td id="LC3151" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcReac_l1, reacf1, reacf2</td>
        </tr>
        <tr>
          <td id="L3152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3152"></td>
          <td id="LC3152" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3153"></td>
          <td id="LC3153" class="blob-code blob-code-inner js-file-line">        reacf1 <span class="pl-k">=</span> k1<span class="pl-k">*</span>reac1</td>
        </tr>
        <tr>
          <td id="L3154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3154"></td>
          <td id="LC3154" class="blob-code blob-code-inner js-file-line">        reacf2 <span class="pl-k">=</span> k2<span class="pl-k">*</span>reac2</td>
        </tr>
        <tr>
          <td id="L3155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3155"></td>
          <td id="LC3155" class="blob-code blob-code-inner js-file-line">        FUN_calcReac_l1 <span class="pl-k">=</span> <span class="pl-k">-</span>reacf1<span class="pl-k">*</span>(A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>bb11 <span class="pl-k">-</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa11 <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa11) &amp;</td>
        </tr>
        <tr>
          <td id="L3156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3156"></td>
          <td id="LC3156" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa11 <span class="pl-k">-</span> dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa11)<span class="pl-k">/</span>(aa11<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> const_real_nullsmall) &amp;</td>
        </tr>
        <tr>
          <td id="L3157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3157"></td>
          <td id="LC3157" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">-</span>reacf2<span class="pl-k">*</span>(A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>bb12 <span class="pl-k">-</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa12 <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>bb12 <span class="pl-k">+</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa12) &amp;</td>
        </tr>
        <tr>
          <td id="L3158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3158"></td>
          <td id="LC3158" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa12 <span class="pl-k">-</span> dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa12)<span class="pl-k">/</span>(aa12<span class="pl-k">*</span>bb12 <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3159"></td>
          <td id="LC3159" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;in FUN_calcReac_l1 dum_POC1_conc_swi = &#39;, dum_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L3160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3160"></td>
          <td id="LC3160" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;in FUN_calcReac_l1 dum_POC2_conc_swi = &#39;, dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L3161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3161"></td>
          <td id="LC3161" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3162"></td>
          <td id="LC3162" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3163"></td>
          <td id="LC3163" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac_l1</span></td>
        </tr>
        <tr>
          <td id="L3164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3164"></td>
          <td id="LC3164" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3165"></td>
          <td id="LC3165" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3166"></td>
          <td id="LC3166" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3167"></td>
          <td id="LC3167" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3168"></td>
          <td id="LC3168" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3169"></td>
          <td id="LC3169" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3170"></td>
          <td id="LC3170" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac_l2</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3171"></td>
          <td id="LC3171" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3172"></td>
          <td id="LC3172" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3173"></td>
          <td id="LC3173" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcReac_l2, reacf1, reacf2</td>
        </tr>
        <tr>
          <td id="L3174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3174"></td>
          <td id="LC3174" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3175"></td>
          <td id="LC3175" class="blob-code blob-code-inner js-file-line">        reacf1 <span class="pl-k">=</span> k1<span class="pl-k">*</span>reac1</td>
        </tr>
        <tr>
          <td id="L3176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3176"></td>
          <td id="LC3176" class="blob-code blob-code-inner js-file-line">        reacf2 <span class="pl-k">=</span> k2<span class="pl-k">*</span>reac2</td>
        </tr>
        <tr>
          <td id="L3177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3177"></td>
          <td id="LC3177" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3178"></td>
          <td id="LC3178" class="blob-code blob-code-inner js-file-line">        FUN_calcReac_l2 <span class="pl-k">=</span> <span class="pl-k">-</span>reacf1<span class="pl-k">*</span>A21<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zU) <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zL))<span class="pl-k">/</span>(aa21 <span class="pl-k">+</span> const_real_nullsmall) &amp;</td>
        </tr>
        <tr>
          <td id="L3179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3179"></td>
          <td id="LC3179" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">-</span>reacf2<span class="pl-k">*</span>A22<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zU) <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zL))<span class="pl-k">/</span>(aa22 <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3180"></td>
          <td id="LC3180" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3181"></td>
          <td id="LC3181" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FUN_calcReac_l2&#39;, FUN_calcReac_l2</span></td>
        </tr>
        <tr>
          <td id="L3182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3182"></td>
          <td id="LC3182" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3183"></td>
          <td id="LC3183" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcReac_l2</span></td>
        </tr>
        <tr>
          <td id="L3184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3184"></td>
          <td id="LC3184" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3185"></td>
          <td id="LC3185" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3186"></td>
          <td id="LC3186" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3187"></td>
          <td id="LC3187" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3188"></td>
          <td id="LC3188" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3189"></td>
          <td id="LC3189" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3190"></td>
          <td id="LC3190" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3191"></td>
          <td id="LC3191" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3192"></td>
          <td id="LC3192" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3193"></td>
          <td id="LC3193" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3194"></td>
          <td id="LC3194" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcOM</td>
        </tr>
        <tr>
          <td id="L3195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3195"></td>
          <td id="LC3195" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3196"></td>
          <td id="LC3196" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3197"></td>
          <td id="LC3197" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_FUN_calcOM_l1, loc_FUN_calcOM_l2</td>
        </tr>
        <tr>
          <td id="L3198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3198"></td>
          <td id="LC3198" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3199"></td>
          <td id="LC3199" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3200"></td>
          <td id="LC3200" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Integral of organic matter from zU to zL,</span></td>
        </tr>
        <tr>
          <td id="L3201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3201"></td>
          <td id="LC3201" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> multiplied by stoichiometric factors reac1, reac2 (for the two OC phases)</span></td>
        </tr>
        <tr>
          <td id="L3202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3202"></td>
          <td id="LC3202" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3203"></td>
          <td id="LC3203" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Vector-friendly way of handling 3 cases:</span></td>
        </tr>
        <tr>
          <td id="L3204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3204"></td>
          <td id="LC3204" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 1) wholly within bioturbated layer:    FUN_calcReac_l1(zU,zL)     + (0 =) FUN_calcReac_l2(zbio, zbio)</span></td>
        </tr>
        <tr>
          <td id="L3205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3205"></td>
          <td id="LC3205" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 2) wholly within non-bio     layer:  (0=) FUN_calcReac_l1(zbio, zbio) +   FUN_calcReac_l2(zU, zL)</span></td>
        </tr>
        <tr>
          <td id="L3206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3206"></td>
          <td id="LC3206" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> 3) crossing zbio                       calcRead_l1(zU,zbio)   +       FUN_calcReac_l2(zbio, zL)</span></td>
        </tr>
        <tr>
          <td id="L3207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3207"></td>
          <td id="LC3207" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3208"></td>
          <td id="LC3208" class="blob-code blob-code-inner js-file-line">        loc_FUN_calcOM_l1 <span class="pl-k">=</span> FUN_calcOM_l1(<span class="pl-k">min</span>(zU,zbio), <span class="pl-k">min</span>(zL,zbio), reac1, reac2)</td>
        </tr>
        <tr>
          <td id="L3209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3209"></td>
          <td id="LC3209" class="blob-code blob-code-inner js-file-line">        loc_FUN_calcOM_l2 <span class="pl-k">=</span> FUN_calcOM_l2(<span class="pl-k">max</span>(zU,zbio), <span class="pl-k">max</span>(zL, zbio), reac1, reac2)</td>
        </tr>
        <tr>
          <td id="L3210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3210"></td>
          <td id="LC3210" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3211"></td>
          <td id="LC3211" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(isnan(loc_FUN_calcOM_l1) <span class="pl-k">.AND.</span> isnan(loc_FUN_calcOM_l2))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L3212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3212"></td>
          <td id="LC3212" class="blob-code blob-code-inner js-file-line">            FUN_calcOM <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L3213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3213"></td>
          <td id="LC3213" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">elseif</span>(isnan(loc_FUN_calcOM_l2)) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L3214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3214"></td>
          <td id="LC3214" class="blob-code blob-code-inner js-file-line">            FUN_calcOM <span class="pl-k">=</span> loc_FUN_calcOM_l1</td>
        </tr>
        <tr>
          <td id="L3215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3215"></td>
          <td id="LC3215" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L3216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3216"></td>
          <td id="LC3216" class="blob-code blob-code-inner js-file-line">            FUN_calcOM <span class="pl-k">=</span> loc_FUN_calcOM_l1 <span class="pl-k">+</span> loc_FUN_calcOM_l2</td>
        </tr>
        <tr>
          <td id="L3217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3217"></td>
          <td id="LC3217" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3218"></td>
          <td id="LC3218" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3219"></td>
          <td id="LC3219" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L3220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3220"></td>
          <td id="LC3220" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;FUN_calcOM_l1 &#39;, loc_FUN_calcOM_l1</span></td>
        </tr>
        <tr>
          <td id="L3221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3221"></td>
          <td id="LC3221" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;FUN_calcOM_l2 &#39;, loc_FUN_calcOM_l2</span></td>
        </tr>
        <tr>
          <td id="L3222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3222"></td>
          <td id="LC3222" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;FUN_calcOM &#39;, FUN_calcOM</span></td>
        </tr>
        <tr>
          <td id="L3223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3223"></td>
          <td id="LC3223" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3224"></td>
          <td id="LC3224" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3225"></td>
          <td id="LC3225" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3226"></td>
          <td id="LC3226" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> TODO confirm (1-por)*  has been added (to k1 &amp; k2 ?)</span></td>
        </tr>
        <tr>
          <td id="L3227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3227"></td>
          <td id="LC3227" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3228"></td>
          <td id="LC3228" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM</span></td>
        </tr>
        <tr>
          <td id="L3229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3229"></td>
          <td id="LC3229" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3230"></td>
          <td id="LC3230" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3231"></td>
          <td id="LC3231" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3232"></td>
          <td id="LC3232" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3233"></td>
          <td id="LC3233" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3234"></td>
          <td id="LC3234" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3235"></td>
          <td id="LC3235" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM_l1</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3236"></td>
          <td id="LC3236" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3237"></td>
          <td id="LC3237" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3238"></td>
          <td id="LC3238" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcOM_l1, reacf1, reacf2</td>
        </tr>
        <tr>
          <td id="L3239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3239"></td>
          <td id="LC3239" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3240"></td>
          <td id="LC3240" class="blob-code blob-code-inner js-file-line">        reacf1 <span class="pl-k">=</span> reac1</td>
        </tr>
        <tr>
          <td id="L3241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3241"></td>
          <td id="LC3241" class="blob-code blob-code-inner js-file-line">        reacf2 <span class="pl-k">=</span> reac2</td>
        </tr>
        <tr>
          <td id="L3242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3242"></td>
          <td id="LC3242" class="blob-code blob-code-inner js-file-line">        FUN_calcOM_l1 <span class="pl-k">=</span> <span class="pl-k">-</span>reacf1<span class="pl-k">*</span>(A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>bb11 <span class="pl-k">-</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa11 <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa11) &amp;</td>
        </tr>
        <tr>
          <td id="L3243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3243"></td>
          <td id="LC3243" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa11 <span class="pl-k">-</span> dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa11)<span class="pl-k">/</span>(aa11<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> const_real_nullsmall) &amp;</td>
        </tr>
        <tr>
          <td id="L3244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3244"></td>
          <td id="LC3244" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">-</span>reacf2<span class="pl-k">*</span>(A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>bb12 <span class="pl-k">-</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa12 <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>bb12 <span class="pl-k">+</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa12) &amp;</td>
        </tr>
        <tr>
          <td id="L3245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3245"></td>
          <td id="LC3245" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">+</span> dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zU)<span class="pl-k">*</span>aa12 <span class="pl-k">-</span> dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zL)<span class="pl-k">*</span>aa12)<span class="pl-k">/</span>(aa12<span class="pl-k">*</span>bb12 <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3246"></td>
          <td id="LC3246" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3247"></td>
          <td id="LC3247" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;in FUN_calcReac_l1 dum_POC2_conc_swi = &#39;, dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L3248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3248"></td>
          <td id="LC3248" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3249"></td>
          <td id="LC3249" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3250"></td>
          <td id="LC3250" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM_l1</span></td>
        </tr>
        <tr>
          <td id="L3251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3251"></td>
          <td id="LC3251" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3252"></td>
          <td id="LC3252" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3253"></td>
          <td id="LC3253" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3254"></td>
          <td id="LC3254" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3255"></td>
          <td id="LC3255" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3256"></td>
          <td id="LC3256" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3257"></td>
          <td id="LC3257" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM_l2</span>(<span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>)</td>
        </tr>
        <tr>
          <td id="L3258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3258"></td>
          <td id="LC3258" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3259"></td>
          <td id="LC3259" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> zU, zL, reac1, reac2</td>
        </tr>
        <tr>
          <td id="L3260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3260"></td>
          <td id="LC3260" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_calcOM_l2, reacf1, reacf2</td>
        </tr>
        <tr>
          <td id="L3261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3261"></td>
          <td id="LC3261" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3262"></td>
          <td id="LC3262" class="blob-code blob-code-inner js-file-line">        reacf1 <span class="pl-k">=</span> reac1</td>
        </tr>
        <tr>
          <td id="L3263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3263"></td>
          <td id="LC3263" class="blob-code blob-code-inner js-file-line">        reacf2 <span class="pl-k">=</span> reac2</td>
        </tr>
        <tr>
          <td id="L3264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3264"></td>
          <td id="LC3264" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3265"></td>
          <td id="LC3265" class="blob-code blob-code-inner js-file-line">        FUN_calcOM_l2 <span class="pl-k">=</span> <span class="pl-k">-</span>reacf1<span class="pl-k">*</span>A21<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zU) <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zL))<span class="pl-k">/</span>(aa21 <span class="pl-k">+</span> const_real_nullsmall) &amp;</td>
        </tr>
        <tr>
          <td id="L3266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3266"></td>
          <td id="LC3266" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">-</span>reacf2<span class="pl-k">*</span>A22<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zU) <span class="pl-k">-</span> <span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zL))<span class="pl-k">/</span>(aa22 <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3267"></td>
          <td id="LC3267" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3268"></td>
          <td id="LC3268" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3269"></td>
          <td id="LC3269" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;FUN_calcReac_l2&#39;, FUN_calcReac_l2</span></td>
        </tr>
        <tr>
          <td id="L3270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3270"></td>
          <td id="LC3270" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3271"></td>
          <td id="LC3271" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_calcOM_l2</span></td>
        </tr>
        <tr>
          <td id="L3272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3272"></td>
          <td id="LC3272" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3273"></td>
          <td id="LC3273" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3274"></td>
          <td id="LC3274" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3275"></td>
          <td id="LC3275" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3276"></td>
          <td id="LC3276" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3277"></td>
          <td id="LC3277" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3278"></td>
          <td id="LC3278" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3279"></td>
          <td id="LC3279" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3280"></td>
          <td id="LC3280" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3281"></td>
          <td id="LC3281" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l12</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">ls_a</span>, <span class="pl-v">ls_b</span>, <span class="pl-v">ls_c</span>, <span class="pl-v">ls_d</span>, <span class="pl-v">ls_e</span>, <span class="pl-v">ls_f</span>, <span class="pl-v">ls_D1</span>, <span class="pl-v">ls_D2</span>,<span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3282"></td>
          <td id="LC3282" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">ltype</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>)</td>
        </tr>
        <tr>
          <td id="L3283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3283"></td>
          <td id="LC3283" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> calculate solution basis functions, for layer which may cross bioturbation boundary</span></td>
        </tr>
        <tr>
          <td id="L3284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3284"></td>
          <td id="LC3284" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3285"></td>
          <td id="LC3285" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol/mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3286"></td>
          <td id="LC3286" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3287"></td>
          <td id="LC3287" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3288"></td>
          <td id="LC3288" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3289"></td>
          <td id="LC3289" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3290"></td>
          <td id="LC3290" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Where e,f,g are generated by matching solutions across bioturbation boundary (if necessary)</span></td>
        </tr>
        <tr>
          <td id="L3291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3291"></td>
          <td id="LC3291" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Solution properties (matching etc) are input in ls</span></td>
        </tr>
        <tr>
          <td id="L3292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3292"></td>
          <td id="LC3292" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> On input, ls should contain fields generated by sub_prepfg_l12</span></td>
        </tr>
        <tr>
          <td id="L3293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3293"></td>
          <td id="LC3293" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3294"></td>
          <td id="LC3294" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>       z, reac1, reac2, ktemp</td>
        </tr>
        <tr>
          <td id="L3295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3295"></td>
          <td id="LC3295" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>   ltype</td>
        </tr>
        <tr>
          <td id="L3296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3296"></td>
          <td id="LC3296" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>    e, dedz, f, dfdz, g, dgdz</td>
        </tr>
        <tr>
          <td id="L3297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3297"></td>
          <td id="LC3297" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>                    ls_a, ls_b, ls_c, ls_d, ls_e, ls_f, ls_D1, ls_D2</td>
        </tr>
        <tr>
          <td id="L3298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3298"></td>
          <td id="LC3298" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3299"></td>
          <td id="LC3299" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3300"></td>
          <td id="LC3300" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_1, f_1, g_1, dedz_1, dfdz_1, dgdz_1</td>
        </tr>
        <tr>
          <td id="L3301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3301"></td>
          <td id="LC3301" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>real ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</span></td>
        </tr>
        <tr>
          <td id="L3302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3302"></td>
          <td id="LC3302" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3303"></td>
          <td id="LC3303" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3304"></td>
          <td id="LC3304" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">select case</span> (ltype)</td>
        </tr>
        <tr>
          <td id="L3305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3305"></td>
          <td id="LC3305" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">1</span>)    <span class="pl-c"><span class="pl-c">!</span> bioturbated</span></td>
        </tr>
        <tr>
          <td id="L3306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3306"></td>
          <td id="LC3306" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                print*, &#39;sub_calcfg_l12 CASE 1 bioturbated&#39;</span></td>
        </tr>
        <tr>
          <td id="L3307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3307"></td>
          <td id="LC3307" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l1(z, reac1, reac2, ls_D1, ktemp, e, dedz, f, dfdz, g, dgdz)</td>
        </tr>
        <tr>
          <td id="L3308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3308"></td>
          <td id="LC3308" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">2</span>)    <span class="pl-c"><span class="pl-c">!</span> not bioturbated</span></td>
        </tr>
        <tr>
          <td id="L3309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3309"></td>
          <td id="LC3309" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l2(z, reac1, reac2, ls_D2, ktemp, e, dedz, f, dfdz, g, dgdz)</td>
        </tr>
        <tr>
          <td id="L3310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3310"></td>
          <td id="LC3310" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">3</span>)    <span class="pl-c"><span class="pl-c">!</span> crossing boundary</span></td>
        </tr>
        <tr>
          <td id="L3311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3311"></td>
          <td id="LC3311" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">!</span>                   print*, &#39;sub_calcfg_l12 CASE 3 crossing boundary&#39;</span></td>
        </tr>
        <tr>
          <td id="L3312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3312"></td>
          <td id="LC3312" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">IF</span>(z &gt;<span class="pl-k">=</span> zbio) <span class="pl-k">THEN</span>      <span class="pl-c"><span class="pl-c">!</span> below bioturbated region</span></td>
        </tr>
        <tr>
          <td id="L3313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3313"></td>
          <td id="LC3313" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l2(z, reac1, reac2, ls_D2, ktemp, e, dedz, f, dfdz, g, dgdz)</td>
        </tr>
        <tr>
          <td id="L3314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3314"></td>
          <td id="LC3314" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> above bioturbated region</span></td>
        </tr>
        <tr>
          <td id="L3315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3315"></td>
          <td id="LC3315" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                    print*, &#39;CASE 3 crossing boundary ELSEEEEE&#39;</span></td>
        </tr>
        <tr>
          <td id="L3316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3316"></td>
          <td id="LC3316" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l1(z, reac1, reac2, ls_D1, ktemp, e_1, dedz_1, f_1, dfdz_1, g_1, dgdz_1)</td>
        </tr>
        <tr>
          <td id="L3317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3317"></td>
          <td id="LC3317" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                    print*, &#39;sub_calcfg_l1111111111111: z, reac1, reac2, DO21, ktemp, e_1, dedz_1, f_1, dfdz_1,&amp;</span></td>
        </tr>
        <tr>
          <td id="L3318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3318"></td>
          <td id="LC3318" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span>                            &amp; g_1, dgdz_1&#39;, z, reac1, reac2, DO21, ktemp, e_1, dedz_1, f_1, dfdz_1, g_1, dgdz_1</span></td>
        </tr>
        <tr>
          <td id="L3319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3319"></td>
          <td id="LC3319" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> Now find &#39;transformed&#39; basis functions such that in layer 1, O2 = A_2*et + B_2*ft + gt</span></td>
        </tr>
        <tr>
          <td id="L3320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3320"></td>
          <td id="LC3320" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> (ie layer 1 soln written in terms of layer 2 coeffs A_2, B_2)</span></td>
        </tr>
        <tr>
          <td id="L3321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3321"></td>
          <td id="LC3321" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_xformsoln(e_1, f_1, g_1, dedz_1, dfdz_1, dgdz_1, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f,&amp;</td>
        </tr>
        <tr>
          <td id="L3322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3322"></td>
          <td id="LC3322" class="blob-code blob-code-inner js-file-line">                    e, f, g, dedz, dfdz, dgdz)</td>
        </tr>
        <tr>
          <td id="L3323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3323"></td>
          <td id="LC3323" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3324"></td>
          <td id="LC3324" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case default</span></td>
        </tr>
        <tr>
          <td id="L3325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3325"></td>
          <td id="LC3325" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">STOP</span></td>
        </tr>
        <tr>
          <td id="L3326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3326"></td>
          <td id="LC3326" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end select</span></td>
        </tr>
        <tr>
          <td id="L3327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3327"></td>
          <td id="LC3327" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3328"></td>
          <td id="LC3328" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l12</span></td>
        </tr>
        <tr>
          <td id="L3329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3329"></td>
          <td id="LC3329" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3330"></td>
          <td id="LC3330" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3331"></td>
          <td id="LC3331" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3332"></td>
          <td id="LC3332" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3333"></td>
          <td id="LC3333" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3334"></td>
          <td id="LC3334" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3335"></td>
          <td id="LC3335" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3336"></td>
          <td id="LC3336" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l1</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">Dtemp</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>)</td>
        </tr>
        <tr>
          <td id="L3337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3337"></td>
          <td id="LC3337" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &lt;= zbio</span></td>
        </tr>
        <tr>
          <td id="L3338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3338"></td>
          <td id="LC3338" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3339"></td>
          <td id="LC3339" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol./mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3340"></td>
          <td id="LC3340" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3341"></td>
          <td id="LC3341" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3342"></td>
          <td id="LC3342" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3343"></td>
          <td id="LC3343" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3344"></td>
          <td id="LC3344" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, reac1, reac2, Dtemp, ktemp                                                          <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3345"></td>
          <td id="LC3345" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz             <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3346"></td>
          <td id="LC3346" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3347"></td>
          <td id="LC3347" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3348"></td>
          <td id="LC3348" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> b1, pfac, PhiI1, PhiII1, PhiIII1, PhiI2, PhiII2, PhiIII2</td>
        </tr>
        <tr>
          <td id="L3349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3349"></td>
          <td id="LC3349" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ea11z, eb11z, ea12z, eb12z</td>
        </tr>
        <tr>
          <td id="L3350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3350"></td>
          <td id="LC3350" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3351"></td>
          <td id="LC3351" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3352"></td>
          <td id="LC3352" class="blob-code blob-code-inner js-file-line">        e <span class="pl-k">=</span> <span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L3353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3353"></td>
          <td id="LC3353" class="blob-code blob-code-inner js-file-line">        dedz <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L3354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3354"></td>
          <td id="LC3354" class="blob-code blob-code-inner js-file-line">        b1<span class="pl-k">=</span>w<span class="pl-k">/</span>(Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3355"></td>
          <td id="LC3355" class="blob-code blob-code-inner js-file-line">        f<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1)</td>
        </tr>
        <tr>
          <td id="L3356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3356"></td>
          <td id="LC3356" class="blob-code blob-code-inner js-file-line">        dfdz <span class="pl-k">=</span> b1<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1)</td>
        </tr>
        <tr>
          <td id="L3357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3357"></td>
          <td id="LC3357" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3358"></td>
          <td id="LC3358" class="blob-code blob-code-inner js-file-line">        pfac <span class="pl-k">=</span> <span class="pl-c1">1</span>                    <span class="pl-c"><span class="pl-c">!</span> in fact, already has (1-por)/por</span></td>
        </tr>
        <tr>
          <td id="L3359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3359"></td>
          <td id="LC3359" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3360"></td>
          <td id="LC3360" class="blob-code blob-code-inner js-file-line">        PhiI1 <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A11<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3361"></td>
          <td id="LC3361" class="blob-code blob-code-inner js-file-line">        PhiII1  <span class="pl-k">=</span> pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A11<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3362"></td>
          <td id="LC3362" class="blob-code blob-code-inner js-file-line">        PhiIII1 <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>dum_POC1_conc_swi<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3363"></td>
          <td id="LC3363" class="blob-code blob-code-inner js-file-line">        PhiI2   <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A12<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3364"></td>
          <td id="LC3364" class="blob-code blob-code-inner js-file-line">        PhiII2  <span class="pl-k">=</span> pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A12<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3365"></td>
          <td id="LC3365" class="blob-code blob-code-inner js-file-line">        PhiIII2 <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>dum_POC2_conc_swi<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3366"></td>
          <td id="LC3366" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3367"></td>
          <td id="LC3367" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3368"></td>
          <td id="LC3368" class="blob-code blob-code-inner js-file-line">        ea11z <span class="pl-k">=</span> <span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3369"></td>
          <td id="LC3369" class="blob-code blob-code-inner js-file-line">        eb11z <span class="pl-k">=</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3370"></td>
          <td id="LC3370" class="blob-code blob-code-inner js-file-line">        ea12z <span class="pl-k">=</span> <span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3371"></td>
          <td id="LC3371" class="blob-code blob-code-inner js-file-line">        eb12z <span class="pl-k">=</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3372"></td>
          <td id="LC3372" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3373"></td>
          <td id="LC3373" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;PhiI1, PhiII1, PhiIII1&#39;, PhiI1, PhiII1, PhiIII1</span></td>
        </tr>
        <tr>
          <td id="L3374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3374"></td>
          <td id="LC3374" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;PhiI2, PhiII2, PhiIII2&#39;, PhiI2, PhiII2, PhiIII2</span></td>
        </tr>
        <tr>
          <td id="L3375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3375"></td>
          <td id="LC3375" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;ea11z, eb11z, ea12z, eb12z&#39;, ea11z, eb11z, ea12z, eb12z</span></td>
        </tr>
        <tr>
          <td id="L3376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3376"></td>
          <td id="LC3376" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3377"></td>
          <td id="LC3377" class="blob-code blob-code-inner js-file-line">        g <span class="pl-k">=</span>  PhiI1<span class="pl-k">*</span>ea11z <span class="pl-k">+</span> PhiII1<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> PhiIII1<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3378"></td>
          <td id="LC3378" class="blob-code blob-code-inner js-file-line">        PhiI2<span class="pl-k">*</span>ea12z <span class="pl-k">+</span> PhiII2<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> PhiIII2<span class="pl-k">*</span>eb12z</td>
        </tr>
        <tr>
          <td id="L3379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3379"></td>
          <td id="LC3379" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3380"></td>
          <td id="LC3380" class="blob-code blob-code-inner js-file-line">        dgdz <span class="pl-k">=</span> PhiI1<span class="pl-k">*</span>aa11<span class="pl-k">*</span>ea11z <span class="pl-k">+</span> PhiII1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> PhiIII1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3381"></td>
          <td id="LC3381" class="blob-code blob-code-inner js-file-line">        PhiI2<span class="pl-k">*</span>aa12<span class="pl-k">*</span>ea12z <span class="pl-k">+</span> PhiII2<span class="pl-k">*</span>bb12<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> PhiIII2<span class="pl-k">*</span>bb12<span class="pl-k">*</span>eb12z</td>
        </tr>
        <tr>
          <td id="L3382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3382"></td>
          <td id="LC3382" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3383"></td>
          <td id="LC3383" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;INPUT sub_calcfg_l1&#39;, z, reac1, reac2, Dtemp, ktemp</span></td>
        </tr>
        <tr>
          <td id="L3384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3384"></td>
          <td id="LC3384" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                print*, &#39;IN  sub_calcfg_l1 g&#39;, g</span></td>
        </tr>
        <tr>
          <td id="L3385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3385"></td>
          <td id="LC3385" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                print*, &#39;IN  sub_calcfg_l1 dgdz&#39;, dgdz</span></td>
        </tr>
        <tr>
          <td id="L3386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3386"></td>
          <td id="LC3386" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3387"></td>
          <td id="LC3387" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l1</span></td>
        </tr>
        <tr>
          <td id="L3388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3388"></td>
          <td id="LC3388" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3389"></td>
          <td id="LC3389" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3390"></td>
          <td id="LC3390" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3391"></td>
          <td id="LC3391" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3392"></td>
          <td id="LC3392" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3393"></td>
          <td id="LC3393" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3394"></td>
          <td id="LC3394" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l2</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">Dtemp</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>)</td>
        </tr>
        <tr>
          <td id="L3395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3395"></td>
          <td id="LC3395" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &gt; zbio</span></td>
        </tr>
        <tr>
          <td id="L3396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3396"></td>
          <td id="LC3396" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol/mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3397"></td>
          <td id="LC3397" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3398"></td>
          <td id="LC3398" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3399"></td>
          <td id="LC3399" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3400"></td>
          <td id="LC3400" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3401"></td>
          <td id="LC3401" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, reac1, reac2, Dtemp, ktemp                                                          <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3402"></td>
          <td id="LC3402" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz             <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3403"></td>
          <td id="LC3403" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3404"></td>
          <td id="LC3404" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3405"></td>
          <td id="LC3405" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> b2, pfac, PhiI1, PhiI2</td>
        </tr>
        <tr>
          <td id="L3406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3406"></td>
          <td id="LC3406" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3407"></td>
          <td id="LC3407" class="blob-code blob-code-inner js-file-line">        e <span class="pl-k">=</span> <span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L3408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3408"></td>
          <td id="LC3408" class="blob-code blob-code-inner js-file-line">        dedz <span class="pl-k">=</span> <span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L3409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3409"></td>
          <td id="LC3409" class="blob-code blob-code-inner js-file-line">        b2 <span class="pl-k">=</span> w<span class="pl-k">/</span>(Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3410"></td>
          <td id="LC3410" class="blob-code blob-code-inner js-file-line">        f<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b2)</td>
        </tr>
        <tr>
          <td id="L3411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3411"></td>
          <td id="LC3411" class="blob-code blob-code-inner js-file-line">        dfdz <span class="pl-k">=</span> b2<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b2)</td>
        </tr>
        <tr>
          <td id="L3412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3412"></td>
          <td id="LC3412" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3413"></td>
          <td id="LC3413" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>pfac=1./por;   ! assume org matter already *(1-por)</span></td>
        </tr>
        <tr>
          <td id="L3414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3414"></td>
          <td id="LC3414" class="blob-code blob-code-inner js-file-line">        pfac <span class="pl-k">=</span> <span class="pl-c1">1</span>            <span class="pl-c"><span class="pl-c">!</span>in fact, already has (1-por)/por</span></td>
        </tr>
        <tr>
          <td id="L3415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3415"></td>
          <td id="LC3415" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3416"></td>
          <td id="LC3416" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3417"></td>
          <td id="LC3417" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3418"></td>
          <td id="LC3418" class="blob-code blob-code-inner js-file-line">        PhiI1 <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A21<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa21<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa21<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3419"></td>
          <td id="LC3419" class="blob-code blob-code-inner js-file-line">        PhiI2 <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A22<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa22<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa22<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3420"></td>
          <td id="LC3420" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3421"></td>
          <td id="LC3421" class="blob-code blob-code-inner js-file-line">        g <span class="pl-k">=</span> PhiI1<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> PhiI2<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3422"></td>
          <td id="LC3422" class="blob-code blob-code-inner js-file-line">        dgdz <span class="pl-k">=</span> PhiI1<span class="pl-k">*</span>aa21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> PhiI2<span class="pl-k">*</span>aa22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3423"></td>
          <td id="LC3423" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3424"></td>
          <td id="LC3424" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  sub_calcfg_l2 g&#39;, g</span></td>
        </tr>
        <tr>
          <td id="L3425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3425"></td>
          <td id="LC3425" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  sub_calcfg_l1 dgdz&#39;, dgdz</span></td>
        </tr>
        <tr>
          <td id="L3426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3426"></td>
          <td id="LC3426" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3427"></td>
          <td id="LC3427" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l2</span></td>
        </tr>
        <tr>
          <td id="L3428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3428"></td>
          <td id="LC3428" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3429"></td>
          <td id="LC3429" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3430"></td>
          <td id="LC3430" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3431"></td>
          <td id="LC3431" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3432"></td>
          <td id="LC3432" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3433"></td>
          <td id="LC3433" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3434"></td>
          <td id="LC3434" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3435"></td>
          <td id="LC3435" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_prepfg_l12</span>(<span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">D1</span>, <span class="pl-v">D2</span>, <span class="pl-v">ls_a</span>, <span class="pl-v">ls_b</span>, <span class="pl-v">ls_c</span>, <span class="pl-v">ls_d</span>, <span class="pl-v">ls_e</span>, <span class="pl-v">ls_f</span>, <span class="pl-v">ltype</span>)</td>
        </tr>
        <tr>
          <td id="L3436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3436"></td>
          <td id="LC3436" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1, reac2, ktemp, zU, zL, D1, D2</td>
        </tr>
        <tr>
          <td id="L3437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3437"></td>
          <td id="LC3437" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l1, dedz_zbio_l1, f_zbio_l1, dfdz_zbio_l1, g_zbio_l1, dgdz_zbio_l1</td>
        </tr>
        <tr>
          <td id="L3438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3438"></td>
          <td id="LC3438" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l2, dedz_zbio_l2, f_zbio_l2, dfdz_zbio_l2, g_zbio_l2, dgdz_zbio_l2</td>
        </tr>
        <tr>
          <td id="L3439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3439"></td>
          <td id="LC3439" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</td>
        </tr>
        <tr>
          <td id="L3440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3440"></td>
          <td id="LC3440" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3441"></td>
          <td id="LC3441" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> ltype</td>
        </tr>
        <tr>
          <td id="L3442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3442"></td>
          <td id="LC3442" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3443"></td>
          <td id="LC3443" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zL &lt;<span class="pl-k">=</span> zbio)<span class="pl-k">then</span>  <span class="pl-c"><span class="pl-c">!</span> wholly within bioturbated layer</span></td>
        </tr>
        <tr>
          <td id="L3444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3444"></td>
          <td id="LC3444" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L3445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3445"></td>
          <td id="LC3445" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">elseif</span>(zU &gt;<span class="pl-k">=</span> zbio) <span class="pl-k">then</span> <span class="pl-c"><span class="pl-c">!</span> wholly within non-bioturbated layer</span></td>
        </tr>
        <tr>
          <td id="L3446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3446"></td>
          <td id="LC3446" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L3447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3447"></td>
          <td id="LC3447" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>             <span class="pl-c"><span class="pl-c">!</span> crossing boundary - sort out solution matching at zbio</span></td>
        </tr>
        <tr>
          <td id="L3448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3448"></td>
          <td id="LC3448" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  CROSS BOUNDARY CASE &#39;</span></td>
        </tr>
        <tr>
          <td id="L3449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3449"></td>
          <td id="LC3449" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L3450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3450"></td>
          <td id="LC3450" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_calcfg_l1(zbio, reac1, reac2, D1, ktemp, e_zbio_l1, dedz_zbio_l1, f_zbio_l1, dfdz_zbio_l1, g_zbio_l1, dgdz_zbio_l1)</td>
        </tr>
        <tr>
          <td id="L3451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3451"></td>
          <td id="LC3451" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_calcfg_l2(zbio, reac1, reac2, D2, ktemp, e_zbio_l2, dedz_zbio_l2, f_zbio_l2, dfdz_zbio_l2, g_zbio_l2, dgdz_zbio_l2)</td>
        </tr>
        <tr>
          <td id="L3452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3452"></td>
          <td id="LC3452" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3453"></td>
          <td id="LC3453" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> match solutions at zbio - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L3454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3454"></td>
          <td id="LC3454" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;in prepfg: &#39;</span></td>
        </tr>
        <tr>
          <td id="L3455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3455"></td>
          <td id="LC3455" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;e_zbio_l1, dedz_zbio_l1&#39;, e_zbio_l1, dedz_zbio_l1</span></td>
        </tr>
        <tr>
          <td id="L3456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3456"></td>
          <td id="LC3456" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;f_zbio_l1, dfdz_zbio_l1&#39;, f_zbio_l1, dfdz_zbio_l1</span></td>
        </tr>
        <tr>
          <td id="L3457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3457"></td>
          <td id="LC3457" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;g_zbio_l1, dgdz_zbio_l1&#39;, g_zbio_l1, dgdz_zbio_l1</span></td>
        </tr>
        <tr>
          <td id="L3458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3458"></td>
          <td id="LC3458" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;e_zbio_l2, dedz_zbio_l2&#39;, e_zbio_l2, dedz_zbio_l2</span></td>
        </tr>
        <tr>
          <td id="L3459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3459"></td>
          <td id="LC3459" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;f_zbio_l2, dfdz_zbio_l2&#39;, f_zbio_l2, dfdz_zbio_l2</span></td>
        </tr>
        <tr>
          <td id="L3460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3460"></td>
          <td id="LC3460" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;g_zbio_l2, dgdz_zbio_l2&#39;, g_zbio_l2, dgdz_zbio_l2</span></td>
        </tr>
        <tr>
          <td id="L3461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3461"></td>
          <td id="LC3461" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3462"></td>
          <td id="LC3462" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln(e_zbio_l1, f_zbio_l1, g_zbio_l1, D1<span class="pl-k">*</span>dedz_zbio_l1, D1<span class="pl-k">*</span>dfdz_zbio_l1, D1<span class="pl-k">*</span>dgdz_zbio_l1, &amp;</td>
        </tr>
        <tr>
          <td id="L3463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3463"></td>
          <td id="LC3463" class="blob-code blob-code-inner js-file-line">            e_zbio_l2, f_zbio_l2, g_zbio_l2, D2<span class="pl-k">*</span>dedz_zbio_l2, D2<span class="pl-k">*</span>dfdz_zbio_l2, D2<span class="pl-k">*</span>dgdz_zbio_l2, &amp;</td>
        </tr>
        <tr>
          <td id="L3464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3464"></td>
          <td id="LC3464" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f)</td>
        </tr>
        <tr>
          <td id="L3465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3465"></td>
          <td id="LC3465" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>           print*, &#39;in sub_prepfg_l12 AFTER sub_matchsoln:  ls_a, ls_b, ls_c, ls_d, ls_e, ls_f&#39;, ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</span></td>
        </tr>
        <tr>
          <td id="L3466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3466"></td>
          <td id="LC3466" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3467"></td>
          <td id="LC3467" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3468"></td>
          <td id="LC3468" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_prepfg_l12</span></td>
        </tr>
        <tr>
          <td id="L3469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3469"></td>
          <td id="LC3469" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3470"></td>
          <td id="LC3470" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3471"></td>
          <td id="LC3471" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3472"></td>
          <td id="LC3472" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3473"></td>
          <td id="LC3473" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3474"></td>
          <td id="LC3474" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3475"></td>
          <td id="LC3475" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                               Utility subroutines for PO4/Fe-bound P</span></td>
        </tr>
        <tr>
          <td id="L3476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3476"></td>
          <td id="LC3476" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3477"></td>
          <td id="LC3477" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3478"></td>
          <td id="LC3478" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3479"></td>
          <td id="LC3479" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3480"></td>
          <td id="LC3480" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3481"></td>
          <td id="LC3481" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l12_PO4_M</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1P</span>, <span class="pl-v">reac2P</span>, <span class="pl-v">dum_ktempP</span>, <span class="pl-v">dum_QtempP</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3482"></td>
          <td id="LC3482" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">dum_D1P</span>, <span class="pl-v">dum_D2P</span>, <span class="pl-v">dum_alphaP</span>, <span class="pl-v">dum_mat_C</span>, <span class="pl-v">dum_vec_D</span>, <span class="pl-v">dum_ltype</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3483"></td>
          <td id="LC3483" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">dum_ktempM</span>, <span class="pl-v">dum_QtempM</span>, <span class="pl-v">dum_D1M</span>, <span class="pl-v">dum_D2M</span>, <span class="pl-v">dum_alphaM</span>, <span class="pl-v">e_P</span>, <span class="pl-v">dedz_P</span>, <span class="pl-v">f_P</span>, <span class="pl-v">dfdz_P</span>, <span class="pl-v">g_P</span>, <span class="pl-v">dgdz_P</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3484"></td>
          <td id="LC3484" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">p_P</span>, <span class="pl-v">dpdz_P</span>, <span class="pl-v">q_P</span>, <span class="pl-v">dqdz_P</span>, <span class="pl-v">e_M</span>, <span class="pl-v">dedz_M</span>, <span class="pl-v">f_M</span>, <span class="pl-v">dfdz_M</span>, <span class="pl-v">g_M</span>, <span class="pl-v">dgdz_M</span>, <span class="pl-v">p_M</span>, <span class="pl-v">dpdz_M</span>, <span class="pl-v">q_M</span>, <span class="pl-v">dqdz_M</span>)</td>
        </tr>
        <tr>
          <td id="L3485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3485"></td>
          <td id="LC3485" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> calculate solution basis functions, for layer which may cross bioturbation boundary</span></td>
        </tr>
        <tr>
          <td id="L3486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3486"></td>
          <td id="LC3486" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3487"></td>
          <td id="LC3487" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol/mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3488"></td>
          <td id="LC3488" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3489"></td>
          <td id="LC3489" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3490"></td>
          <td id="LC3490" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3491"></td>
          <td id="LC3491" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3492"></td>
          <td id="LC3492" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Where e,f,g are generated by matching solutions across bioturbation boundary (if necessary)</span></td>
        </tr>
        <tr>
          <td id="L3493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3493"></td>
          <td id="LC3493" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Solution properties (matching etc) are input in ls</span></td>
        </tr>
        <tr>
          <td id="L3494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3494"></td>
          <td id="LC3494" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> On input, ls should contain fields generated by prepfg_l12</span></td>
        </tr>
        <tr>
          <td id="L3495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3495"></td>
          <td id="LC3495" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3496"></td>
          <td id="LC3496" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> z, reac1P, reac2P, dum_ktempP, dum_QtempP, dum_alphaP, dum_D1P, dum_D2P</td>
        </tr>
        <tr>
          <td id="L3497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3497"></td>
          <td id="LC3497" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> dum_ktempM, dum_QtempM, dum_alphaM, dum_D1M, dum_D2M</td>
        </tr>
        <tr>
          <td id="L3498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3498"></td>
          <td id="LC3498" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> dum_ltype</td>
        </tr>
        <tr>
          <td id="L3499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3499"></td>
          <td id="LC3499" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">4</span>, <span class="pl-c1">4</span>), <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_mat_C</td>
        </tr>
        <tr>
          <td id="L3500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3500"></td>
          <td id="LC3500" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>), <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span>  dum_vec_D</td>
        </tr>
        <tr>
          <td id="L3501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3501"></td>
          <td id="LC3501" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3502"></td>
          <td id="LC3502" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> ODE solutions (E, F, P, Q) and the particulat integral (G) and their derivatives</span></td>
        </tr>
        <tr>
          <td id="L3503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3503"></td>
          <td id="LC3503" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P</td>
        </tr>
        <tr>
          <td id="L3504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3504"></td>
          <td id="LC3504" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M</td>
        </tr>
        <tr>
          <td id="L3505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3505"></td>
          <td id="LC3505" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3506"></td>
          <td id="LC3506" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3507"></td>
          <td id="LC3507" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_a1_P, loc_b1_P, loc_a1_M, loc_b1_M, loc_a2_M, loc_a2_P, loc_b2_P</td>
        </tr>
        <tr>
          <td id="L3508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3508"></td>
          <td id="LC3508" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">6</span>) <span class="pl-k">::</span> loc_Phi1_P, loc_Phi2_P</td>
        </tr>
        <tr>
          <td id="L3509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3509"></td>
          <td id="LC3509" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_e_P_1, loc_dedz_P_1, loc_f_P_1, loc_dfdz_P_1, loc_g_P_1, loc_dgdz_P_1</td>
        </tr>
        <tr>
          <td id="L3510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3510"></td>
          <td id="LC3510" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_p_P_1, loc_dpdz_P_1, loc_q_P_1, loc_dqdz_P_1</td>
        </tr>
        <tr>
          <td id="L3511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3511"></td>
          <td id="LC3511" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_e_M_1, loc_dedz_M_1, loc_f_M_1, loc_dfdz_M_1, loc_g_M_1, loc_dgdz_M_1</td>
        </tr>
        <tr>
          <td id="L3512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3512"></td>
          <td id="LC3512" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_p_M_1, loc_dpdz_M_1, loc_q_M_1, loc_dqdz_M_1</td>
        </tr>
        <tr>
          <td id="L3513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3513"></td>
          <td id="LC3513" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save the ODE solutions in vectors to make calculation easier (DH?: however, is this faster?)</span></td>
        </tr>
        <tr>
          <td id="L3514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3514"></td>
          <td id="LC3514" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_EFPQ_P, loc_dEFPQdz_P, loc_EFPQ_M, loc_dEFPQdz_M</td>
        </tr>
        <tr>
          <td id="L3515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3515"></td>
          <td id="LC3515" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the transformed ODE solutions coming from sub_xformsoln_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L3516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3516"></td>
          <td id="LC3516" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> loc_EFPQ_P_t, loc_dEFPQdz_P_t, loc_EFPQ_M_t, loc_dEFPQdz_M_t</td>
        </tr>
        <tr>
          <td id="L3517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3517"></td>
          <td id="LC3517" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3518"></td>
          <td id="LC3518" class="blob-code blob-code-inner js-file-line">        loc_Phi1_P <span class="pl-k">=</span> (<span class="pl-k">/</span> <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span> <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3519"></td>
          <td id="LC3519" class="blob-code blob-code-inner js-file-line">        loc_Phi2_P <span class="pl-k">=</span> (<span class="pl-k">/</span> <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span> <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3520"></td>
          <td id="LC3520" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3521"></td>
          <td id="LC3521" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">select case</span> (dum_ltype)</td>
        </tr>
        <tr>
          <td id="L3522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3522"></td>
          <td id="LC3522" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">1</span>)    <span class="pl-c"><span class="pl-c">!</span> bioturbated</span></td>
        </tr>
        <tr>
          <td id="L3523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3523"></td>
          <td id="LC3523" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(dum_alphaP<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> oxic layer -&gt; call PO4 first</span></td>
        </tr>
        <tr>
          <td id="L3524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3524"></td>
          <td id="LC3524" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l1_PO4(z, reac1P, reac2P, dum_D1P, dum_ktempP, dum_QtempP, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3525"></td>
          <td id="LC3525" class="blob-code blob-code-inner js-file-line">                    e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a1_P, loc_b1_P, loc_Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3526"></td>
          <td id="LC3526" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l1_M(z, dum_D1M, dum_ktempM, dum_QtempM, loc_a1_P, loc_b1_P, loc_Phi1_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3527"></td>
          <td id="LC3527" class="blob-code blob-code-inner js-file-line">                    e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a1_M, loc_b1_M)</td>
        </tr>
        <tr>
          <td id="L3528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3528"></td>
          <td id="LC3528" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span>        <span class="pl-c"><span class="pl-c">!</span> anoxic layer -&gt; call M first</span></td>
        </tr>
        <tr>
          <td id="L3529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3529"></td>
          <td id="LC3529" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l1_M(z, dum_D1M, dum_ktempM, dum_QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, loc_Phi1_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3530"></td>
          <td id="LC3530" class="blob-code blob-code-inner js-file-line">                    e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a1_M, loc_b1_M)</td>
        </tr>
        <tr>
          <td id="L3531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3531"></td>
          <td id="LC3531" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l1_PO4(z, reac1P, reac2P, dum_D1P, dum_ktempP, dum_QtempP, loc_a1_M, loc_b1_M, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3532"></td>
          <td id="LC3532" class="blob-code blob-code-inner js-file-line">                    e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a1_P, loc_b1_P, loc_Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3533"></td>
          <td id="LC3533" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3534"></td>
          <td id="LC3534" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3535"></td>
          <td id="LC3535" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">2</span>)    <span class="pl-c"><span class="pl-c">!</span> not bioturbated</span></td>
        </tr>
        <tr>
          <td id="L3536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3536"></td>
          <td id="LC3536" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(dum_alphaP<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> oxic layer -&gt; call PO4 first</span></td>
        </tr>
        <tr>
          <td id="L3537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3537"></td>
          <td id="LC3537" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l2_PO4(z, reac1P, reac2P, dum_D2P, dum_ktempP, dum_QtempP, <span class="pl-c1">0.0</span>, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3538"></td>
          <td id="LC3538" class="blob-code blob-code-inner js-file-line">                    e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a2_P, loc_b2_P, loc_Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3539"></td>
          <td id="LC3539" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l2_M(z, dum_ktempM, dum_QtempM, loc_a2_P, loc_b2_P, loc_Phi2_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3540"></td>
          <td id="LC3540" class="blob-code blob-code-inner js-file-line">                    e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a2_M)</td>
        </tr>
        <tr>
          <td id="L3541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3541"></td>
          <td id="LC3541" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> anoxic layer -&gt; call M first</span></td>
        </tr>
        <tr>
          <td id="L3542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3542"></td>
          <td id="LC3542" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l2_M(z, dum_ktempM, dum_QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, loc_Phi2_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3543"></td>
          <td id="LC3543" class="blob-code blob-code-inner js-file-line">                    e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a2_M)</td>
        </tr>
        <tr>
          <td id="L3544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3544"></td>
          <td id="LC3544" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_calcfg_l2_PO4(z, reac1P, reac2P, dum_D2P, dum_ktempP, dum_QtempP, loc_a2_M, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3545"></td>
          <td id="LC3545" class="blob-code blob-code-inner js-file-line">                    e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a2_P, loc_b2_P, loc_Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3546"></td>
          <td id="LC3546" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3547"></td>
          <td id="LC3547" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3548"></td>
          <td id="LC3548" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case</span> (<span class="pl-c1">3</span>)    <span class="pl-c"><span class="pl-c">!</span> crossing boundary</span></td>
        </tr>
        <tr>
          <td id="L3549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3549"></td>
          <td id="LC3549" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">IF</span>(z &gt; zbio) <span class="pl-k">THEN</span>      <span class="pl-c"><span class="pl-c">!</span> not bioturbated region</span></td>
        </tr>
        <tr>
          <td id="L3550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3550"></td>
          <td id="LC3550" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(dum_alphaP<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> oxic layer -&gt; call PO4 first NOTE: BUT DECIDE VIA ALPHA_M NOT WITH &lt;= ZOX!!! DOESN&#39;t WORK FOR BOUNDARY ZOX</span></td>
        </tr>
        <tr>
          <td id="L3551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3551"></td>
          <td id="LC3551" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l2_PO4(z, reac1P, reac2P, dum_D2P, dum_ktempP, dum_QtempP, <span class="pl-c1">0.0</span>, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3552"></td>
          <td id="LC3552" class="blob-code blob-code-inner js-file-line">                        e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a2_P, loc_b2_P, loc_Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3553"></td>
          <td id="LC3553" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l2_M(z, dum_ktempM, dum_QtempM, loc_a2_P, loc_b2_P, loc_Phi2_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3554"></td>
          <td id="LC3554" class="blob-code blob-code-inner js-file-line">                        e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a2_M)</td>
        </tr>
        <tr>
          <td id="L3555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3555"></td>
          <td id="LC3555" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span> <span class="pl-c"><span class="pl-c">!</span> anoxic layer -&gt; call M first</span></td>
        </tr>
        <tr>
          <td id="L3556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3556"></td>
          <td id="LC3556" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l2_M(z, dum_ktempM, dum_QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, loc_Phi2_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3557"></td>
          <td id="LC3557" class="blob-code blob-code-inner js-file-line">                        e_M, dedz_M, f_M, dfdz_M, g_M, dgdz_M, p_M, dpdz_M, q_M, dqdz_M, loc_a2_M)</td>
        </tr>
        <tr>
          <td id="L3558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3558"></td>
          <td id="LC3558" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l2_PO4(z, reac1P, reac2P, dum_D2P, dum_ktempP, dum_QtempP, loc_a2_M, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3559"></td>
          <td id="LC3559" class="blob-code blob-code-inner js-file-line">                        e_P, dedz_P, f_P, dfdz_P, g_P, dgdz_P, p_P, dpdz_P, q_P, dqdz_P, loc_a2_P, loc_b2_P, loc_Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3560"></td>
          <td id="LC3560" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span> <span class="pl-c"><span class="pl-c">!</span> (dum_alphaP==0)</span></td>
        </tr>
        <tr>
          <td id="L3561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3561"></td>
          <td id="LC3561" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">ELSE</span>    <span class="pl-c"><span class="pl-c">!</span> bioturbated region z &lt;= zbio</span></td>
        </tr>
        <tr>
          <td id="L3562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3562"></td>
          <td id="LC3562" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(dum_alphaP<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> oxic layer -&gt; call PO4 first</span></td>
        </tr>
        <tr>
          <td id="L3563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3563"></td>
          <td id="LC3563" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> CASE 1 &amp; 2: LAYER 1: have 4 int. const.</span></td>
        </tr>
        <tr>
          <td id="L3564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3564"></td>
          <td id="LC3564" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l1_PO4(z, reac1P, reac2P, dum_D1P, dum_ktempP, dum_QtempP, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3565"></td>
          <td id="LC3565" class="blob-code blob-code-inner js-file-line">                        loc_e_P_1, loc_dedz_P_1, loc_f_P_1, loc_dfdz_P_1, loc_g_P_1, loc_dgdz_P_1, loc_p_P_1, loc_dpdz_P_1, &amp;</td>
        </tr>
        <tr>
          <td id="L3566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3566"></td>
          <td id="LC3566" class="blob-code blob-code-inner js-file-line">                        loc_q_P_1, loc_dqdz_P_1, loc_a1_P, loc_b1_P, loc_Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3567"></td>
          <td id="LC3567" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l1_M(z, dum_D1M, dum_ktempM, dum_QtempM, loc_a1_P, loc_b1_P, loc_Phi1_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3568"></td>
          <td id="LC3568" class="blob-code blob-code-inner js-file-line">                        loc_e_M_1, loc_dedz_M_1, loc_f_M_1, loc_dfdz_M_1, loc_g_M_1, loc_dgdz_M_1, loc_p_M_1, loc_dpdz_M_1, &amp;</td>
        </tr>
        <tr>
          <td id="L3569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3569"></td>
          <td id="LC3569" class="blob-code blob-code-inner js-file-line">                        loc_q_M_1, loc_dqdz_M_1, loc_a1_M, loc_b1_M)</td>
        </tr>
        <tr>
          <td id="L3570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3570"></td>
          <td id="LC3570" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> DH: FOR CASE 2: DON&#39;T HAVE D FROM LAYER 2</span></td>
        </tr>
        <tr>
          <td id="L3571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3571"></td>
          <td id="LC3571" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span>    <span class="pl-c"><span class="pl-c">!</span> anoxic layer -&gt; call M first</span></td>
        </tr>
        <tr>
          <td id="L3572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3572"></td>
          <td id="LC3572" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">!</span> DH: CASE 1: LAYER 2: have 4 int. const.</span></td>
        </tr>
        <tr>
          <td id="L3573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3573"></td>
          <td id="LC3573" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l1_M(z, dum_D1M, dum_ktempM, dum_QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, loc_Phi1_P, dum_alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3574"></td>
          <td id="LC3574" class="blob-code blob-code-inner js-file-line">                        loc_e_M_1, loc_dedz_M_1, loc_f_M_1, loc_dfdz_M_1, loc_g_M_1, loc_dgdz_M_1, loc_p_M_1, loc_dpdz_M_1, &amp;</td>
        </tr>
        <tr>
          <td id="L3575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3575"></td>
          <td id="LC3575" class="blob-code blob-code-inner js-file-line">                        loc_q_M_1, loc_dqdz_M_1, loc_a1_M, loc_b1_M)</td>
        </tr>
        <tr>
          <td id="L3576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3576"></td>
          <td id="LC3576" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">call</span> sub_calcfg_l1_PO4(z, reac1P, reac2P, dum_D1P, dum_ktempP, dum_QtempP, loc_a1_M, loc_b1_M, dum_alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3577"></td>
          <td id="LC3577" class="blob-code blob-code-inner js-file-line">                        loc_e_P_1, loc_dedz_P_1, loc_f_P_1, loc_dfdz_P_1, loc_g_P_1, loc_dgdz_P_1, loc_p_P_1, loc_dpdz_P_1, &amp;</td>
        </tr>
        <tr>
          <td id="L3578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3578"></td>
          <td id="LC3578" class="blob-code blob-code-inner js-file-line">                        loc_q_P_1, loc_dqdz_P_1, loc_a1_P, loc_b1_P, loc_Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3579"></td>
          <td id="LC3579" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span>  <span class="pl-c"><span class="pl-c">!</span> (dum_alphaP==0)</span></td>
        </tr>
        <tr>
          <td id="L3580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3580"></td>
          <td id="LC3580" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3581"></td>
          <td id="LC3581" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> Now find &#39;transformed&#39; basis functions such that in layer 1,</span></td>
        </tr>
        <tr>
          <td id="L3582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3582"></td>
          <td id="LC3582" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> O2 = A_2*et + B_2*ft + gt  (ie layer 1 solution written in terms of layer 2 coeffs A_2, B_2)</span></td>
        </tr>
        <tr>
          <td id="L3583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3583"></td>
          <td id="LC3583" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3584"></td>
          <td id="LC3584" class="blob-code blob-code-inner js-file-line">                    loc_EFPQ_P <span class="pl-k">=</span> (<span class="pl-k">/</span> loc_e_P_1, loc_f_P_1, loc_p_P_1, loc_q_P_1 <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3585"></td>
          <td id="LC3585" class="blob-code blob-code-inner js-file-line">                    loc_dEFPQdz_P <span class="pl-k">=</span> (<span class="pl-k">/</span> loc_dedz_P_1, loc_dfdz_P_1, loc_dpdz_P_1, loc_dqdz_P_1 <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3586"></td>
          <td id="LC3586" class="blob-code blob-code-inner js-file-line">                    loc_EFPQ_M <span class="pl-k">=</span> (<span class="pl-k">/</span> loc_e_M_1, loc_f_M_1, loc_p_M_1, loc_q_M_1 <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3587"></td>
          <td id="LC3587" class="blob-code blob-code-inner js-file-line">                    loc_dEFPQdz_M <span class="pl-k">=</span> (<span class="pl-k">/</span>loc_dedz_M_1, loc_dfdz_M_1, loc_dpdz_M_1, loc_dqdz_M_1<span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3588"></td>
          <td id="LC3588" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3589"></td>
          <td id="LC3589" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">call</span> sub_xformsoln_PO4_M(loc_EFPQ_P, loc_EFPQ_M, loc_dEFPQdz_P, loc_dEFPQdz_M, &amp;</td>
        </tr>
        <tr>
          <td id="L3590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3590"></td>
          <td id="LC3590" class="blob-code blob-code-inner js-file-line">                    loc_g_P_1, loc_g_M_1,loc_dgdz_P_1, loc_dgdz_M_1, dum_mat_C, dum_vec_D, &amp;</td>
        </tr>
        <tr>
          <td id="L3591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3591"></td>
          <td id="LC3591" class="blob-code blob-code-inner js-file-line">                    loc_EFPQ_P_t, g_P, loc_dEFPQdz_P_t, dgdz_P, loc_EFPQ_M_t, &amp;</td>
        </tr>
        <tr>
          <td id="L3592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3592"></td>
          <td id="LC3592" class="blob-code blob-code-inner js-file-line">                    g_M, loc_dEFPQdz_M_t, dgdz_M)</td>
        </tr>
        <tr>
          <td id="L3593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3593"></td>
          <td id="LC3593" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3594"></td>
          <td id="LC3594" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> WHEN lTYPE=3 - DEAL WITH ONE VARIABLE SHORT FROM LAYER BELOW</span></td>
        </tr>
        <tr>
          <td id="L3595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3595"></td>
          <td id="LC3595" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">!</span> FOR CASE 1 &amp; 2: deal with missing values from layer below</span></td>
        </tr>
        <tr>
          <td id="L3596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3596"></td>
          <td id="LC3596" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(zox <span class="pl-k">.LE.</span> zbio)<span class="pl-k">then</span>   <span class="pl-c"><span class="pl-c">!</span> CASE 1: no F from layer below - DH: no e_M &amp; f_M as well !? but 0 anyway at the moment</span></td>
        </tr>
        <tr>
          <td id="L3597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3597"></td>
          <td id="LC3597" class="blob-code blob-code-inner js-file-line">                        e_P <span class="pl-k">=</span> loc_EFPQ_P_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3598"></td>
          <td id="LC3598" class="blob-code blob-code-inner js-file-line">                        f_P <span class="pl-k">=</span> loc_EFPQ_P_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3599"></td>
          <td id="LC3599" class="blob-code blob-code-inner js-file-line">                        p_P <span class="pl-k">=</span> loc_EFPQ_P_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3600"></td>
          <td id="LC3600" class="blob-code blob-code-inner js-file-line">                        q_P <span class="pl-k">=</span> loc_q_P_1</td>
        </tr>
        <tr>
          <td id="L3601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3601"></td>
          <td id="LC3601" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3602"></td>
          <td id="LC3602" class="blob-code blob-code-inner js-file-line">                        dedz_P <span class="pl-k">=</span> loc_dEFPQdz_P_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3603"></td>
          <td id="LC3603" class="blob-code blob-code-inner js-file-line">                        dfdz_P <span class="pl-k">=</span> loc_dEFPQdz_P_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3604"></td>
          <td id="LC3604" class="blob-code blob-code-inner js-file-line">                        dpdz_P <span class="pl-k">=</span> loc_dEFPQdz_P_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3605"></td>
          <td id="LC3605" class="blob-code blob-code-inner js-file-line">                        dqdz_P <span class="pl-k">=</span> loc_dqdz_P_1</td>
        </tr>
        <tr>
          <td id="L3606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3606"></td>
          <td id="LC3606" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3607"></td>
          <td id="LC3607" class="blob-code blob-code-inner js-file-line">                        e_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3608"></td>
          <td id="LC3608" class="blob-code blob-code-inner js-file-line">                        f_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3609"></td>
          <td id="LC3609" class="blob-code blob-code-inner js-file-line">                        p_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3610"></td>
          <td id="LC3610" class="blob-code blob-code-inner js-file-line">                        q_M <span class="pl-k">=</span> loc_q_M_1</td>
        </tr>
        <tr>
          <td id="L3611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3611"></td>
          <td id="LC3611" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3612"></td>
          <td id="LC3612" class="blob-code blob-code-inner js-file-line">                        dedz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3613"></td>
          <td id="LC3613" class="blob-code blob-code-inner js-file-line">                        dfdz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3614"></td>
          <td id="LC3614" class="blob-code blob-code-inner js-file-line">                        dpdz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3615"></td>
          <td id="LC3615" class="blob-code blob-code-inner js-file-line">                        dqdz_M <span class="pl-k">=</span> loc_dqdz_M_1</td>
        </tr>
        <tr>
          <td id="L3616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3616"></td>
          <td id="LC3616" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3617"></td>
          <td id="LC3617" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span>            <span class="pl-c"><span class="pl-c">!</span> CASE 2: no Q from layer below - DH: no p_P as well !?</span></td>
        </tr>
        <tr>
          <td id="L3618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3618"></td>
          <td id="LC3618" class="blob-code blob-code-inner js-file-line">                        e_P <span class="pl-k">=</span> loc_EFPQ_P_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3619"></td>
          <td id="LC3619" class="blob-code blob-code-inner js-file-line">                        f_P <span class="pl-k">=</span> loc_EFPQ_P_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3620"></td>
          <td id="LC3620" class="blob-code blob-code-inner js-file-line">                        p_P <span class="pl-k">=</span> loc_p_P_1             <span class="pl-c"><span class="pl-c">!</span> DH:  was = EFPQ_P_t(3);</span></td>
        </tr>
        <tr>
          <td id="L3621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3621"></td>
          <td id="LC3621" class="blob-code blob-code-inner js-file-line">                        q_P <span class="pl-k">=</span> loc_q_P_1</td>
        </tr>
        <tr>
          <td id="L3622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3622"></td>
          <td id="LC3622" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3623"></td>
          <td id="LC3623" class="blob-code blob-code-inner js-file-line">                        dedz_P <span class="pl-k">=</span> loc_dEFPQdz_P_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3624"></td>
          <td id="LC3624" class="blob-code blob-code-inner js-file-line">                        dfdz_P <span class="pl-k">=</span> loc_dEFPQdz_P_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3625"></td>
          <td id="LC3625" class="blob-code blob-code-inner js-file-line">                        dpdz_P <span class="pl-k">=</span> loc_dpdz_P_1       <span class="pl-c"><span class="pl-c">!</span>DH: was = dEFPQ_P_t(3);</span></td>
        </tr>
        <tr>
          <td id="L3626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3626"></td>
          <td id="LC3626" class="blob-code blob-code-inner js-file-line">                        dqdz_P <span class="pl-k">=</span> loc_dqdz_P_1</td>
        </tr>
        <tr>
          <td id="L3627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3627"></td>
          <td id="LC3627" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3628"></td>
          <td id="LC3628" class="blob-code blob-code-inner js-file-line">                        e_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3629"></td>
          <td id="LC3629" class="blob-code blob-code-inner js-file-line">                        f_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3630"></td>
          <td id="LC3630" class="blob-code blob-code-inner js-file-line">                        p_M <span class="pl-k">=</span> loc_EFPQ_M_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3631"></td>
          <td id="LC3631" class="blob-code blob-code-inner js-file-line">                        q_M <span class="pl-k">=</span> loc_q_M_1</td>
        </tr>
        <tr>
          <td id="L3632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3632"></td>
          <td id="LC3632" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3633"></td>
          <td id="LC3633" class="blob-code blob-code-inner js-file-line">                        dedz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L3634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3634"></td>
          <td id="LC3634" class="blob-code blob-code-inner js-file-line">                        dfdz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L3635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3635"></td>
          <td id="LC3635" class="blob-code blob-code-inner js-file-line">                        dpdz_M <span class="pl-k">=</span> loc_dEFPQdz_M_t(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L3636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3636"></td>
          <td id="LC3636" class="blob-code blob-code-inner js-file-line">                        dqdz_M <span class="pl-k">=</span> loc_dqdz_M_1</td>
        </tr>
        <tr>
          <td id="L3637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3637"></td>
          <td id="LC3637" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3638"></td>
          <td id="LC3638" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">end if</span> <span class="pl-c"><span class="pl-c">!</span> (zox .LE. zbio)</span></td>
        </tr>
        <tr>
          <td id="L3639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3639"></td>
          <td id="LC3639" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3640"></td>
          <td id="LC3640" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">END IF</span>  <span class="pl-c"><span class="pl-c">!</span> (z &gt; zbio)</span></td>
        </tr>
        <tr>
          <td id="L3641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3641"></td>
          <td id="LC3641" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">case default</span></td>
        </tr>
        <tr>
          <td id="L3642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3642"></td>
          <td id="LC3642" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">print</span><span class="pl-k">*</span>, <span class="pl-s"><span class="pl-pds">&#39;</span> unrecognized ltype in  sub_calcfg_l2_PO4 <span class="pl-pds">&#39;</span></span>, dum_ltype</td>
        </tr>
        <tr>
          <td id="L3643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3643"></td>
          <td id="LC3643" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">STOP</span></td>
        </tr>
        <tr>
          <td id="L3644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3644"></td>
          <td id="LC3644" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end select</span></td>
        </tr>
        <tr>
          <td id="L3645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3645"></td>
          <td id="LC3645" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3646"></td>
          <td id="LC3646" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L3647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3647"></td>
          <td id="LC3647" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;IN  calcfg_l12_PO4 --------&#39;</span></td>
        </tr>
        <tr>
          <td id="L3648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3648"></td>
          <td id="LC3648" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; z = &#39;, z</span></td>
        </tr>
        <tr>
          <td id="L3649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3649"></td>
          <td id="LC3649" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;e_P, dedz_P &#39;, char(9), e_P, dedz_P</span></td>
        </tr>
        <tr>
          <td id="L3650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3650"></td>
          <td id="LC3650" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;f_P, dfdz_P&#39;, char(9), f_P, dfdz_P</span></td>
        </tr>
        <tr>
          <td id="L3651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3651"></td>
          <td id="LC3651" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;g_P, dgdz_P&#39;, char(9), g_P, dgdz_P</span></td>
        </tr>
        <tr>
          <td id="L3652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3652"></td>
          <td id="LC3652" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;p_P, dpdz_P&#39;, char(9), p_P, dpdz_P</span></td>
        </tr>
        <tr>
          <td id="L3653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3653"></td>
          <td id="LC3653" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; q_P, dqdz_P &#39;, char(9), q_P, dqdz_P</span></td>
        </tr>
        <tr>
          <td id="L3654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3654"></td>
          <td id="LC3654" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L3655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3655"></td>
          <td id="LC3655" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;e_M, dedz_M &#39;, char(9), e_M, dedz_M</span></td>
        </tr>
        <tr>
          <td id="L3656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3656"></td>
          <td id="LC3656" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;f_M, dfdz_M&#39;, char(9), f_M, dfdz_M</span></td>
        </tr>
        <tr>
          <td id="L3657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3657"></td>
          <td id="LC3657" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;g_M, dgdz_M&#39;, char(9), g_M, dgdz_M</span></td>
        </tr>
        <tr>
          <td id="L3658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3658"></td>
          <td id="LC3658" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;p_M, dpdz_M&#39;, char(9), p_M, dpdz_M</span></td>
        </tr>
        <tr>
          <td id="L3659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3659"></td>
          <td id="LC3659" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; q_M, dqdz_M &#39;, char(9), q_M, dqdz_M</span></td>
        </tr>
        <tr>
          <td id="L3660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3660"></td>
          <td id="LC3660" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3661"></td>
          <td id="LC3661" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3662"></td>
          <td id="LC3662" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l12_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L3663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3663"></td>
          <td id="LC3663" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3664"></td>
          <td id="LC3664" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3665"></td>
          <td id="LC3665" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L3666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3666"></td>
          <td id="LC3666" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3667"></td>
          <td id="LC3667" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3668"></td>
          <td id="LC3668" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3669"></td>
          <td id="LC3669" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3670"></td>
          <td id="LC3670" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3671"></td>
          <td id="LC3671" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3672"></td>
          <td id="LC3672" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l1_PO4</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">Dtemp</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">Qtemp</span>, <span class="pl-v">a1_M</span>, <span class="pl-v">b1_M</span>, <span class="pl-v">alpha</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3673"></td>
          <td id="LC3673" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">p</span>, <span class="pl-v">dpdz</span>, <span class="pl-v">q</span>, <span class="pl-v">dqdz</span>, <span class="pl-v">a1</span>, <span class="pl-v">b1</span>, <span class="pl-v">Phi1</span>)</td>
        </tr>
        <tr>
          <td id="L3674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3674"></td>
          <td id="LC3674" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &lt;= zbio</span></td>
        </tr>
        <tr>
          <td id="L3675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3675"></td>
          <td id="LC3675" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3676"></td>
          <td id="LC3676" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol./mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3677"></td>
          <td id="LC3677" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> depend1,   depend2 coming from other species</span></td>
        </tr>
        <tr>
          <td id="L3678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3678"></td>
          <td id="LC3678" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3679"></td>
          <td id="LC3679" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3680"></td>
          <td id="LC3680" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3681"></td>
          <td id="LC3681" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> and for dependent species</span></td>
        </tr>
        <tr>
          <td id="L3682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3682"></td>
          <td id="LC3682" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>       S(z) = A .* e(z) + B .* f(z) + C .* p(z) +  D.* q(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3683"></td>
          <td id="LC3683" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3684"></td>
          <td id="LC3684" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, reac1, reac2, Dtemp, ktemp, Qtemp, a1_M, b1_M, alpha              <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3685"></td>
          <td id="LC3685" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz, p, dpdz, q, dqdz, a1, b1 <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3686"></td>
          <td id="LC3686" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">6</span>), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span> Phi1                               <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3687"></td>
          <td id="LC3687" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3688"></td>
          <td id="LC3688" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3689"></td>
          <td id="LC3689" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> pfac</td>
        </tr>
        <tr>
          <td id="L3690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3690"></td>
          <td id="LC3690" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> ea11z, eb11z, ea12z, eb12z</td>
        </tr>
        <tr>
          <td id="L3691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3691"></td>
          <td id="LC3691" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3692"></td>
          <td id="LC3692" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3693"></td>
          <td id="LC3693" class="blob-code blob-code-inner js-file-line">        a1<span class="pl-k">=</span>(w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3694"></td>
          <td id="LC3694" class="blob-code blob-code-inner js-file-line">        e<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a1)</td>
        </tr>
        <tr>
          <td id="L3695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3695"></td>
          <td id="LC3695" class="blob-code blob-code-inner js-file-line">        dedz <span class="pl-k">=</span> a1<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a1)</td>
        </tr>
        <tr>
          <td id="L3696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3696"></td>
          <td id="LC3696" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3697"></td>
          <td id="LC3697" class="blob-code blob-code-inner js-file-line">        b1<span class="pl-k">=</span>(w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3698"></td>
          <td id="LC3698" class="blob-code blob-code-inner js-file-line">        f<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1)</td>
        </tr>
        <tr>
          <td id="L3699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3699"></td>
          <td id="LC3699" class="blob-code blob-code-inner js-file-line">        dfdz <span class="pl-k">=</span> b1<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1);</td>
        </tr>
        <tr>
          <td id="L3700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3700"></td>
          <td id="LC3700" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3701"></td>
          <td id="LC3701" class="blob-code blob-code-inner js-file-line">        pfac <span class="pl-k">=</span> <span class="pl-c1">1</span>                    <span class="pl-c"><span class="pl-c">!</span> in fact, already has (1-por)/por</span></td>
        </tr>
        <tr>
          <td id="L3702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3702"></td>
          <td id="LC3702" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3703"></td>
          <td id="LC3703" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NOW to OM reaction terms!</span></td>
        </tr>
        <tr>
          <td id="L3704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3704"></td>
          <td id="LC3704" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save all Phis in one variable to pass back</span></td>
        </tr>
        <tr>
          <td id="L3705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3705"></td>
          <td id="LC3705" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">1</span>) <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A11<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3706"></td>
          <td id="LC3706" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">2</span>)  <span class="pl-k">=</span> pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A11<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3707"></td>
          <td id="LC3707" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">3</span>) <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>dum_POC1_conc_swi<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3708"></td>
          <td id="LC3708" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">4</span>)   <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A12<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3709"></td>
          <td id="LC3709" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">5</span>)  <span class="pl-k">=</span> pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A12<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3710"></td>
          <td id="LC3710" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">6</span>) <span class="pl-k">=-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>dum_POC2_conc_swi<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3711"></td>
          <td id="LC3711" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3712"></td>
          <td id="LC3712" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3713"></td>
          <td id="LC3713" class="blob-code blob-code-inner js-file-line">        ea11z <span class="pl-k">=</span> <span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>z);</td>
        </tr>
        <tr>
          <td id="L3714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3714"></td>
          <td id="LC3714" class="blob-code blob-code-inner js-file-line">        eb11z <span class="pl-k">=</span> <span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z);</td>
        </tr>
        <tr>
          <td id="L3715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3715"></td>
          <td id="LC3715" class="blob-code blob-code-inner js-file-line">        ea12z <span class="pl-k">=</span> <span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>z);</td>
        </tr>
        <tr>
          <td id="L3716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3716"></td>
          <td id="LC3716" class="blob-code blob-code-inner js-file-line">        eb12z <span class="pl-k">=</span> <span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z);</td>
        </tr>
        <tr>
          <td id="L3717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3717"></td>
          <td id="LC3717" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3718"></td>
          <td id="LC3718" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ktemp<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>        <span class="pl-c"><span class="pl-c">!</span>CHECK: actually no need as ktemp always &lt;&gt; 0</span></td>
        </tr>
        <tr>
          <td id="L3719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3719"></td>
          <td id="LC3719" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span>  Phi1(<span class="pl-c1">1</span>)<span class="pl-k">*</span>ea11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">2</span>)<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">3</span>)<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3720"></td>
          <td id="LC3720" class="blob-code blob-code-inner js-file-line">            Phi1(<span class="pl-c1">4</span>)<span class="pl-k">*</span>ea12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">5</span>)<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">6</span>)<span class="pl-k">*</span>eb12z</td>
        </tr>
        <tr>
          <td id="L3721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3721"></td>
          <td id="LC3721" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L3722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3722"></td>
          <td id="LC3722" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span>  Phi1(<span class="pl-c1">1</span>)<span class="pl-k">*</span>ea11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">2</span>)<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">3</span>)<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3723"></td>
          <td id="LC3723" class="blob-code blob-code-inner js-file-line">            Phi1(<span class="pl-c1">4</span>)<span class="pl-k">*</span>ea12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">5</span>)<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">6</span>)<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> Qtemp<span class="pl-k">/</span>(ktemp <span class="pl-k">+</span> const_real_nullsmall)   <span class="pl-c"><span class="pl-c">!</span> here problem if ktemp=0</span></td>
        </tr>
        <tr>
          <td id="L3724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3724"></td>
          <td id="LC3724" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3725"></td>
          <td id="LC3725" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3726"></td>
          <td id="LC3726" class="blob-code blob-code-inner js-file-line">        dgdz <span class="pl-k">=</span> Phi1(<span class="pl-c1">1</span>)<span class="pl-k">*</span>aa11<span class="pl-k">*</span>ea11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">2</span>)<span class="pl-k">*</span>bb11<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> Phi1(<span class="pl-c1">3</span>)<span class="pl-k">*</span>bb11<span class="pl-k">*</span>eb11z <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3727"></td>
          <td id="LC3727" class="blob-code blob-code-inner js-file-line">        Phi1(<span class="pl-c1">4</span>)<span class="pl-k">*</span>aa12<span class="pl-k">*</span>ea12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">5</span>)<span class="pl-k">*</span>bb12<span class="pl-k">*</span>eb12z <span class="pl-k">+</span> Phi1(<span class="pl-c1">6</span>)<span class="pl-k">*</span>bb12<span class="pl-k">*</span>eb12z</td>
        </tr>
        <tr>
          <td id="L3728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3728"></td>
          <td id="LC3728" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3729"></td>
          <td id="LC3729" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(alpha == <span class="pl-c1">0</span>)<span class="pl-k">then</span>      <span class="pl-c"><span class="pl-c">!</span> was z&lt;=res.zox PO4 is independent of M (no info in alpha)</span></td>
        </tr>
        <tr>
          <td id="L3730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3730"></td>
          <td id="LC3730" class="blob-code blob-code-inner js-file-line">            p <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3731"></td>
          <td id="LC3731" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3732"></td>
          <td id="LC3732" class="blob-code blob-code-inner js-file-line">            q <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3733"></td>
          <td id="LC3733" class="blob-code blob-code-inner js-file-line">            dqdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3734"></td>
          <td id="LC3734" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>                    <span class="pl-c"><span class="pl-c">!</span> PO4 is dependent on M</span></td>
        </tr>
        <tr>
          <td id="L3735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3735"></td>
          <td id="LC3735" class="blob-code blob-code-inner js-file-line">            p <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>a1_M<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>a1_M<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a1_M)</td>
        </tr>
        <tr>
          <td id="L3736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3736"></td>
          <td id="LC3736" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> a1_M<span class="pl-k">*</span>p</td>
        </tr>
        <tr>
          <td id="L3737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3737"></td>
          <td id="LC3737" class="blob-code blob-code-inner js-file-line">            q <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>b1_M<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>b1_M<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1_M)</td>
        </tr>
        <tr>
          <td id="L3738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3738"></td>
          <td id="LC3738" class="blob-code blob-code-inner js-file-line">            dqdz <span class="pl-k">=</span> b1_M<span class="pl-k">*</span>q</td>
        </tr>
        <tr>
          <td id="L3739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3739"></td>
          <td id="LC3739" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3740"></td>
          <td id="LC3740" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3741"></td>
          <td id="LC3741" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;INPUT calcfg_l1&#39;, z, reac1, reac2, Dtemp, ktemp</span></td>
        </tr>
        <tr>
          <td id="L3742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3742"></td>
          <td id="LC3742" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l1 g&#39;, g</span></td>
        </tr>
        <tr>
          <td id="L3743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3743"></td>
          <td id="LC3743" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l1 dgdz&#39;, dgdz</span></td>
        </tr>
        <tr>
          <td id="L3744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3744"></td>
          <td id="LC3744" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3745"></td>
          <td id="LC3745" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l1_PO4</span></td>
        </tr>
        <tr>
          <td id="L3746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3746"></td>
          <td id="LC3746" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3747"></td>
          <td id="LC3747" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3748"></td>
          <td id="LC3748" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3749"></td>
          <td id="LC3749" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3750"></td>
          <td id="LC3750" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3751"></td>
          <td id="LC3751" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3752"></td>
          <td id="LC3752" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l2_PO4</span>(<span class="pl-v">z</span>, <span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">Dtemp</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">Qtemp</span>, <span class="pl-v">a2_M</span>, <span class="pl-v">alpha</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3753"></td>
          <td id="LC3753" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>, <span class="pl-v">p</span>, <span class="pl-v">dpdz</span>, <span class="pl-v">q</span>, <span class="pl-v">dqdz</span>, <span class="pl-v">a2</span>, <span class="pl-v">b2</span>, <span class="pl-v">Phi2</span>)</td>
        </tr>
        <tr>
          <td id="L3754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3754"></td>
          <td id="LC3754" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &gt; zbio</span></td>
        </tr>
        <tr>
          <td id="L3755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3755"></td>
          <td id="LC3755" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol/mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3756"></td>
          <td id="LC3756" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3757"></td>
          <td id="LC3757" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3758"></td>
          <td id="LC3758" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3759"></td>
          <td id="LC3759" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3760"></td>
          <td id="LC3760" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3761"></td>
          <td id="LC3761" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, reac1, reac2, Dtemp, ktemp, Qtemp , a2_M, alpha</td>
        </tr>
        <tr>
          <td id="L3762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3762"></td>
          <td id="LC3762" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3763"></td>
          <td id="LC3763" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz, p, dpdz, q, dqdz, a2, b2</td>
        </tr>
        <tr>
          <td id="L3764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3764"></td>
          <td id="LC3764" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">2</span>), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span> Phi2</td>
        </tr>
        <tr>
          <td id="L3765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3765"></td>
          <td id="LC3765" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3766"></td>
          <td id="LC3766" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3767"></td>
          <td id="LC3767" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> pfac</td>
        </tr>
        <tr>
          <td id="L3768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3768"></td>
          <td id="LC3768" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3769"></td>
          <td id="LC3769" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3770"></td>
          <td id="LC3770" class="blob-code blob-code-inner js-file-line">        a2<span class="pl-k">=</span>(w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3771"></td>
          <td id="LC3771" class="blob-code blob-code-inner js-file-line">        e<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a2)</td>
        </tr>
        <tr>
          <td id="L3772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3772"></td>
          <td id="LC3772" class="blob-code blob-code-inner js-file-line">        dedz <span class="pl-k">=</span> a2<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a2)</td>
        </tr>
        <tr>
          <td id="L3773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3773"></td>
          <td id="LC3773" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3774"></td>
          <td id="LC3774" class="blob-code blob-code-inner js-file-line">        b2<span class="pl-k">=</span>(w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3775"></td>
          <td id="LC3775" class="blob-code blob-code-inner js-file-line">        f<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b2)</td>
        </tr>
        <tr>
          <td id="L3776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3776"></td>
          <td id="LC3776" class="blob-code blob-code-inner js-file-line">        dfdz <span class="pl-k">=</span> b2<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b2)</td>
        </tr>
        <tr>
          <td id="L3777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3777"></td>
          <td id="LC3777" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3778"></td>
          <td id="LC3778" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>pfac=1./por;   ! assume org matter already *(1-por)</span></td>
        </tr>
        <tr>
          <td id="L3779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3779"></td>
          <td id="LC3779" class="blob-code blob-code-inner js-file-line">        pfac <span class="pl-k">=</span> <span class="pl-c1">1</span>            <span class="pl-c"><span class="pl-c">!</span>in fact, already has (1-por)/por</span></td>
        </tr>
        <tr>
          <td id="L3780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3780"></td>
          <td id="LC3780" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3781"></td>
          <td id="LC3781" class="blob-code blob-code-inner js-file-line">        Phi2(<span class="pl-c1">1</span>) <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k1<span class="pl-k">*</span>(reac1)<span class="pl-k">*</span>A21<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa21<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa21<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3782"></td>
          <td id="LC3782" class="blob-code blob-code-inner js-file-line">        Phi2(<span class="pl-c1">2</span>) <span class="pl-k">=</span> <span class="pl-k">-</span>pfac<span class="pl-k">*</span>k2<span class="pl-k">*</span>(reac2)<span class="pl-k">*</span>A22<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa22<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa22<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3783"></td>
          <td id="LC3783" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3784"></td>
          <td id="LC3784" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3785"></td>
          <td id="LC3785" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(ktemp<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>            <span class="pl-c"><span class="pl-c">!</span> CHECK: think no need for this as always ktemp &lt;&gt; 0</span></td>
        </tr>
        <tr>
          <td id="L3786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3786"></td>
          <td id="LC3786" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> Phi2(<span class="pl-c1">1</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> Phi2(<span class="pl-c1">2</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3787"></td>
          <td id="LC3787" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L3788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3788"></td>
          <td id="LC3788" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> Phi2(<span class="pl-c1">1</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> Phi2(<span class="pl-c1">2</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z) <span class="pl-k">+</span> Qtemp<span class="pl-k">/</span>(ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3789"></td>
          <td id="LC3789" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3790"></td>
          <td id="LC3790" class="blob-code blob-code-inner js-file-line">        dgdz <span class="pl-k">=</span> Phi2(<span class="pl-c1">1</span>)<span class="pl-k">*</span>aa21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> Phi2(<span class="pl-c1">2</span>)<span class="pl-k">*</span>aa22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3791"></td>
          <td id="LC3791" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3792"></td>
          <td id="LC3792" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(alpha<span class="pl-k">==</span><span class="pl-c1">0</span>)<span class="pl-k">then</span>            <span class="pl-c"><span class="pl-c">!</span> was z&lt;=res.zox PO4 is independent of M (no info in alpha)</span></td>
        </tr>
        <tr>
          <td id="L3793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3793"></td>
          <td id="LC3793" class="blob-code blob-code-inner js-file-line">            p <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3794"></td>
          <td id="LC3794" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3795"></td>
          <td id="LC3795" class="blob-code blob-code-inner js-file-line">            q <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3796"></td>
          <td id="LC3796" class="blob-code blob-code-inner js-file-line">            dqdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3797"></td>
          <td id="LC3797" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>                        <span class="pl-c"><span class="pl-c">!</span> PO4 is dependent on M</span></td>
        </tr>
        <tr>
          <td id="L3798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3798"></td>
          <td id="LC3798" class="blob-code blob-code-inner js-file-line">            p <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>a2_M<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>a2_M<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(a2_M<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3799"></td>
          <td id="LC3799" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> a2_M<span class="pl-k">*</span>p</td>
        </tr>
        <tr>
          <td id="L3800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3800"></td>
          <td id="LC3800" class="blob-code blob-code-inner js-file-line">            q<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3801"></td>
          <td id="LC3801" class="blob-code blob-code-inner js-file-line">            dqdz<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3802"></td>
          <td id="LC3802" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3803"></td>
          <td id="LC3803" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3804"></td>
          <td id="LC3804" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l2 g&#39;, g</span></td>
        </tr>
        <tr>
          <td id="L3805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3805"></td>
          <td id="LC3805" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l1 dgdz&#39;, dgdz</span></td>
        </tr>
        <tr>
          <td id="L3806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3806"></td>
          <td id="LC3806" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3807"></td>
          <td id="LC3807" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l2_PO4</span></td>
        </tr>
        <tr>
          <td id="L3808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3808"></td>
          <td id="LC3808" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3809"></td>
          <td id="LC3809" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3810"></td>
          <td id="LC3810" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3811"></td>
          <td id="LC3811" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3812"></td>
          <td id="LC3812" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3813"></td>
          <td id="LC3813" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3814"></td>
          <td id="LC3814" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3815"></td>
          <td id="LC3815" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l1_M</span>(<span class="pl-v">z</span>, <span class="pl-v">Dtemp</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">Qtemp</span>, <span class="pl-v">a1_P</span>, <span class="pl-v">b1_P</span>, <span class="pl-v">Phi1_P</span>, <span class="pl-v">alpha</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>, <span class="pl-v">p</span>, <span class="pl-v">dpdz</span>, <span class="pl-v">q</span>, <span class="pl-v">dqdz</span>, <span class="pl-v">c1</span>, <span class="pl-v">d1</span>)</td>
        </tr>
        <tr>
          <td id="L3816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3816"></td>
          <td id="LC3816" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &lt;= zbio</span></td>
        </tr>
        <tr>
          <td id="L3817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3817"></td>
          <td id="LC3817" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3818"></td>
          <td id="LC3818" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol./mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3819"></td>
          <td id="LC3819" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> depend1,   depend2 coming from other species</span></td>
        </tr>
        <tr>
          <td id="L3820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3820"></td>
          <td id="LC3820" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3821"></td>
          <td id="LC3821" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3822"></td>
          <td id="LC3822" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3823"></td>
          <td id="LC3823" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> and for dependent species</span></td>
        </tr>
        <tr>
          <td id="L3824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3824"></td>
          <td id="LC3824" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>       S(z) = A .* e(z) + B .* f(z) + C .* p(z) +  D.* q(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3825"></td>
          <td id="LC3825" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3826"></td>
          <td id="LC3826" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, Dtemp, ktemp, Qtemp, a1_P, b1_P, alpha                                <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3827"></td>
          <td id="LC3827" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">6</span>), <span class="pl-k">intent</span> (<span class="pl-k">in</span>) <span class="pl-k">::</span> Phi1_P                                            <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3828"></td>
          <td id="LC3828" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz, p, dpdz, q, dqdz, c1, d1             <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3829"></td>
          <td id="LC3829" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3830"></td>
          <td id="LC3830" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3831"></td>
          <td id="LC3831" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3832"></td>
          <td id="LC3832" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3833"></td>
          <td id="LC3833" class="blob-code blob-code-inner js-file-line">        c1<span class="pl-k">=</span>(w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3834"></td>
          <td id="LC3834" class="blob-code blob-code-inner js-file-line">        p<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>c1)</td>
        </tr>
        <tr>
          <td id="L3835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3835"></td>
          <td id="LC3835" class="blob-code blob-code-inner js-file-line">        dpdz <span class="pl-k">=</span> c1<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>c1)</td>
        </tr>
        <tr>
          <td id="L3836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3836"></td>
          <td id="LC3836" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3837"></td>
          <td id="LC3837" class="blob-code blob-code-inner js-file-line">        d1<span class="pl-k">=</span>(w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4.0</span><span class="pl-k">*</span>Dtemp<span class="pl-k">*</span>ktemp))<span class="pl-k">/</span>(<span class="pl-c1">2.0</span><span class="pl-k">*</span>Dtemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3838"></td>
          <td id="LC3838" class="blob-code blob-code-inner js-file-line">        q<span class="pl-k">=</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>d1)</td>
        </tr>
        <tr>
          <td id="L3839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3839"></td>
          <td id="LC3839" class="blob-code blob-code-inner js-file-line">        dqdz <span class="pl-k">=</span> d1<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>d1);</td>
        </tr>
        <tr>
          <td id="L3840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3840"></td>
          <td id="LC3840" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3841"></td>
          <td id="LC3841" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(alpha <span class="pl-k">.NE.</span> <span class="pl-c1">0</span>)<span class="pl-k">then</span>      <span class="pl-c"><span class="pl-c">!</span> oxic layer: was z&lt;=res.zox BUT problems at boundary. M is dependent on PO4</span></td>
        </tr>
        <tr>
          <td id="L3842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3842"></td>
          <td id="LC3842" class="blob-code blob-code-inner js-file-line">            c1<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3843"></td>
          <td id="LC3843" class="blob-code blob-code-inner js-file-line">            d1<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3844"></td>
          <td id="LC3844" class="blob-code blob-code-inner js-file-line">            e <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>a1_P<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>a1_P<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a1_P)</td>
        </tr>
        <tr>
          <td id="L3845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3845"></td>
          <td id="LC3845" class="blob-code blob-code-inner js-file-line">            dedz <span class="pl-k">=</span> a1_P<span class="pl-k">*</span>e</td>
        </tr>
        <tr>
          <td id="L3846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3846"></td>
          <td id="LC3846" class="blob-code blob-code-inner js-file-line">            f <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>b1_P<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>b1_P<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b1_P)</td>
        </tr>
        <tr>
          <td id="L3847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3847"></td>
          <td id="LC3847" class="blob-code blob-code-inner js-file-line">            dfdz <span class="pl-k">=</span> b1_P<span class="pl-k">*</span>f</td>
        </tr>
        <tr>
          <td id="L3848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3848"></td>
          <td id="LC3848" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">*</span>(Phi1_P(<span class="pl-c1">1</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>aa11) <span class="pl-k">+</span> Phi1_P(<span class="pl-c1">2</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb11) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3849"></td>
          <td id="LC3849" class="blob-code blob-code-inner js-file-line">            Phi1_P(<span class="pl-c1">3</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb11) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3850"></td>
          <td id="LC3850" class="blob-code blob-code-inner js-file-line">            Phi1_P(<span class="pl-c1">4</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>aa12) <span class="pl-k">+</span> Phi1_P(<span class="pl-c1">5</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb12) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3851"></td>
          <td id="LC3851" class="blob-code blob-code-inner js-file-line">            Phi1_P(<span class="pl-c1">6</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb12))</td>
        </tr>
        <tr>
          <td id="L3852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3852"></td>
          <td id="LC3852" class="blob-code blob-code-inner js-file-line">            dgdz <span class="pl-k">=</span> <span class="pl-k">-</span>alpha<span class="pl-k">*</span>(Phi1_P(<span class="pl-c1">1</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>aa11)<span class="pl-k">*</span>aa11 <span class="pl-k">+</span> Phi1_P(<span class="pl-c1">2</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall) &amp;</td>
        </tr>
        <tr>
          <td id="L3853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3853"></td>
          <td id="LC3853" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb11)<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> Phi1_P(<span class="pl-c1">3</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb11<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb11<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb11)<span class="pl-k">*</span>bb11 <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3854"></td>
          <td id="LC3854" class="blob-code blob-code-inner js-file-line">            Phi1_P(<span class="pl-c1">4</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>aa12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>aa12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>aa12)<span class="pl-k">*</span>aa12 <span class="pl-k">+</span> Phi1_P(<span class="pl-c1">5</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb12)<span class="pl-k">*</span>bb12 <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3855"></td>
          <td id="LC3855" class="blob-code blob-code-inner js-file-line">            Phi1_P(<span class="pl-c1">6</span>)<span class="pl-k">/</span>(Dtemp<span class="pl-k">*</span>bb12<span class="pl-k">**</span><span class="pl-c1">2</span><span class="pl-k">-</span>w<span class="pl-k">*</span>bb12<span class="pl-k">-</span>ktemp <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>bb12)<span class="pl-k">*</span>bb12)</td>
        </tr>
        <tr>
          <td id="L3856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3856"></td>
          <td id="LC3856" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3857"></td>
          <td id="LC3857" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>                    <span class="pl-c"><span class="pl-c">!</span> anoxic layer: M is independent of PO4 (no value in alpha!)</span></td>
        </tr>
        <tr>
          <td id="L3858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3858"></td>
          <td id="LC3858" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> Qtemp<span class="pl-k">/</span>(ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3859"></td>
          <td id="LC3859" class="blob-code blob-code-inner js-file-line">            dgdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3860"></td>
          <td id="LC3860" class="blob-code blob-code-inner js-file-line">            e <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3861"></td>
          <td id="LC3861" class="blob-code blob-code-inner js-file-line">            dedz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3862"></td>
          <td id="LC3862" class="blob-code blob-code-inner js-file-line">            f <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3863"></td>
          <td id="LC3863" class="blob-code blob-code-inner js-file-line">            dfdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3864"></td>
          <td id="LC3864" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3865"></td>
          <td id="LC3865" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3866"></td>
          <td id="LC3866" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;INPUT sub_calcfg_l1_M&#39;, z, reac1, reac2, Dtemp, ktemp</span></td>
        </tr>
        <tr>
          <td id="L3867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3867"></td>
          <td id="LC3867" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l1 g&#39;, g</span></td>
        </tr>
        <tr>
          <td id="L3868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3868"></td>
          <td id="LC3868" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  calcfg_l1 dgdz&#39;, dgdz</span></td>
        </tr>
        <tr>
          <td id="L3869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3869"></td>
          <td id="LC3869" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3870"></td>
          <td id="LC3870" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l1_M</span></td>
        </tr>
        <tr>
          <td id="L3871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3871"></td>
          <td id="LC3871" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3872"></td>
          <td id="LC3872" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3873"></td>
          <td id="LC3873" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3874"></td>
          <td id="LC3874" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3875"></td>
          <td id="LC3875" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3876"></td>
          <td id="LC3876" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3877"></td>
          <td id="LC3877" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3878"></td>
          <td id="LC3878" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_calcfg_l2_M</span>(<span class="pl-v">z</span>, <span class="pl-v">ktemp</span>, <span class="pl-v">Qtemp</span>, <span class="pl-v">a2_P</span>, <span class="pl-v">b2_P</span>, <span class="pl-v">Phi2_P</span>, <span class="pl-v">alpha</span>, <span class="pl-v">e</span>, <span class="pl-v">dedz</span>, <span class="pl-v">f</span>, <span class="pl-v">dfdz</span>, <span class="pl-v">g</span>, <span class="pl-v">dgdz</span>, <span class="pl-v">p</span>, <span class="pl-v">dpdz</span>, <span class="pl-v">q</span>, <span class="pl-v">dqdz</span>, <span class="pl-v">c2</span>)</td>
        </tr>
        <tr>
          <td id="L3879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3879"></td>
          <td id="LC3879" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Basis functions for solutes, case z &gt; zbio</span></td>
        </tr>
        <tr>
          <td id="L3880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3880"></td>
          <td id="LC3880" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> reac1, reac2        - mol/mol S released per organic carbon C</span></td>
        </tr>
        <tr>
          <td id="L3881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3881"></td>
          <td id="LC3881" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L3882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3882"></td>
          <td id="LC3882" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> General solution for solute S is given by</span></td>
        </tr>
        <tr>
          <td id="L3883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3883"></td>
          <td id="LC3883" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  S(z) = A * e(z) + B * f(z) + g(z)</span></td>
        </tr>
        <tr>
          <td id="L3884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3884"></td>
          <td id="LC3884" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3885"></td>
          <td id="LC3885" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> z, ktemp, Qtemp, a2_P, b2_P, alpha                                           <span class="pl-c"><span class="pl-c">!</span> in from SUBROUTINE before</span></td>
        </tr>
        <tr>
          <td id="L3886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3886"></td>
          <td id="LC3886" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>  e, dedz, f, dfdz, g, dgdz, p, dpdz, q, dqdz, c2             <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3887"></td>
          <td id="LC3887" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">2</span>), <span class="pl-k">intent</span> (<span class="pl-k">in</span>) <span class="pl-k">::</span> Phi2_P                                        <span class="pl-c"><span class="pl-c">!</span> out</span></td>
        </tr>
        <tr>
          <td id="L3888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3888"></td>
          <td id="LC3888" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3889"></td>
          <td id="LC3889" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3890"></td>
          <td id="LC3890" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3891"></td>
          <td id="LC3891" class="blob-code blob-code-inner js-file-line">        c2<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3892"></td>
          <td id="LC3892" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3893"></td>
          <td id="LC3893" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(alpha <span class="pl-k">.NE.</span> <span class="pl-c1">0</span>)<span class="pl-k">then</span>            <span class="pl-c"><span class="pl-c">!</span> M is dependent of PO4, was z&lt;=res.zox</span></td>
        </tr>
        <tr>
          <td id="L3894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3894"></td>
          <td id="LC3894" class="blob-code blob-code-inner js-file-line">            e<span class="pl-k">=</span>alpha<span class="pl-k">/</span>(w<span class="pl-k">*</span>a2_P <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>a2_P)</td>
        </tr>
        <tr>
          <td id="L3895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3895"></td>
          <td id="LC3895" class="blob-code blob-code-inner js-file-line">            dedz <span class="pl-k">=</span> a2_P<span class="pl-k">*</span>e</td>
        </tr>
        <tr>
          <td id="L3896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3896"></td>
          <td id="LC3896" class="blob-code blob-code-inner js-file-line">            f<span class="pl-k">=</span>alpha<span class="pl-k">/</span>(w<span class="pl-k">*</span>b2_P <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(z<span class="pl-k">*</span>b2_P)</td>
        </tr>
        <tr>
          <td id="L3897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3897"></td>
          <td id="LC3897" class="blob-code blob-code-inner js-file-line">            dfdz <span class="pl-k">=</span> b2_P<span class="pl-k">*</span>f</td>
        </tr>
        <tr>
          <td id="L3898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3898"></td>
          <td id="LC3898" class="blob-code blob-code-inner js-file-line">            p <span class="pl-k">=</span> <span class="pl-c1">1</span>                       <span class="pl-c"><span class="pl-c">!</span> DH CHECK/TODO: integration constant just C</span></td>
        </tr>
        <tr>
          <td id="L3899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3899"></td>
          <td id="LC3899" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3900"></td>
          <td id="LC3900" class="blob-code blob-code-inner js-file-line">            q<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3901"></td>
          <td id="LC3901" class="blob-code blob-code-inner js-file-line">            dqdz<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3902"></td>
          <td id="LC3902" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> alpha<span class="pl-k">/</span>(w <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span>(Phi2_P(<span class="pl-c1">1</span>)<span class="pl-k">/</span>(aa21 <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3903"></td>
          <td id="LC3903" class="blob-code blob-code-inner js-file-line">            Phi2_P(<span class="pl-c1">2</span>)<span class="pl-k">/</span>(aa22 <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z))</td>
        </tr>
        <tr>
          <td id="L3904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3904"></td>
          <td id="LC3904" class="blob-code blob-code-inner js-file-line">            dgdz <span class="pl-k">=</span> alpha<span class="pl-k">/</span>(w <span class="pl-k">+</span> const_real_nullsmall)<span class="pl-k">*</span>(Phi2_P(<span class="pl-c1">1</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>z) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L3905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3905"></td>
          <td id="LC3905" class="blob-code blob-code-inner js-file-line">            Phi2_P(<span class="pl-c1">2</span>)<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>z))</td>
        </tr>
        <tr>
          <td id="L3906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3906"></td>
          <td id="LC3906" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>                        <span class="pl-c"><span class="pl-c">!</span> M is independent of PO4 - z &gt; res.zox</span></td>
        </tr>
        <tr>
          <td id="L3907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3907"></td>
          <td id="LC3907" class="blob-code blob-code-inner js-file-line">            c2<span class="pl-k">=-</span>ktemp<span class="pl-k">/</span>(w <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3908"></td>
          <td id="LC3908" class="blob-code blob-code-inner js-file-line">            p<span class="pl-k">=</span><span class="pl-k">exp</span>(c2<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3909"></td>
          <td id="LC3909" class="blob-code blob-code-inner js-file-line">            dpdz <span class="pl-k">=</span> c2<span class="pl-k">*</span><span class="pl-k">exp</span>(c2<span class="pl-k">*</span>z)</td>
        </tr>
        <tr>
          <td id="L3910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3910"></td>
          <td id="LC3910" class="blob-code blob-code-inner js-file-line">            q<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3911"></td>
          <td id="LC3911" class="blob-code blob-code-inner js-file-line">            dqdz<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3912"></td>
          <td id="LC3912" class="blob-code blob-code-inner js-file-line">            g <span class="pl-k">=</span> Qtemp<span class="pl-k">/</span>(ktemp <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L3913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3913"></td>
          <td id="LC3913" class="blob-code blob-code-inner js-file-line">            dgdz <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3914"></td>
          <td id="LC3914" class="blob-code blob-code-inner js-file-line">            e<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3915"></td>
          <td id="LC3915" class="blob-code blob-code-inner js-file-line">            dedz<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3916"></td>
          <td id="LC3916" class="blob-code blob-code-inner js-file-line">            f<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3917"></td>
          <td id="LC3917" class="blob-code blob-code-inner js-file-line">            dfdz<span class="pl-k">=</span><span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L3918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3918"></td>
          <td id="LC3918" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3919"></td>
          <td id="LC3919" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3920"></td>
          <td id="LC3920" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3921"></td>
          <td id="LC3921" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_calcfg_l2_M</span></td>
        </tr>
        <tr>
          <td id="L3922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3922"></td>
          <td id="LC3922" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3923"></td>
          <td id="LC3923" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3924"></td>
          <td id="LC3924" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3925"></td>
          <td id="LC3925" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L3926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3926"></td>
          <td id="LC3926" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L3927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3927"></td>
          <td id="LC3927" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3928"></td>
          <td id="LC3928" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_prepfg_l12_PO4_M</span>(<span class="pl-v">reac1</span>, <span class="pl-v">reac2</span>, <span class="pl-v">ktempP</span>, <span class="pl-v">QtempP</span>, <span class="pl-v">zU</span>, <span class="pl-v">zL</span>, <span class="pl-v">D1P</span>, <span class="pl-v">D2P</span>, <span class="pl-v">alphaP</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L3929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3929"></td>
          <td id="LC3929" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">ktempM</span>, <span class="pl-v">QtempM</span>, <span class="pl-v">D1M</span>, <span class="pl-v">D2M</span>, <span class="pl-v">alphaM</span>, <span class="pl-v">loc_mat_C</span>, <span class="pl-v">loc_vec_D</span>, <span class="pl-v">ltype</span>)</td>
        </tr>
        <tr>
          <td id="L3930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3930"></td>
          <td id="LC3930" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> reac1, reac2, ktempP, QtempP, zU, zL, D1P, D2P, alphaP, ktempM, QtempM, D1M, D2M, alphaM</td>
        </tr>
        <tr>
          <td id="L3931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3931"></td>
          <td id="LC3931" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">4</span>, <span class="pl-c1">4</span>), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span> loc_mat_C</td>
        </tr>
        <tr>
          <td id="L3932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3932"></td>
          <td id="LC3932" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span>  loc_vec_D</td>
        </tr>
        <tr>
          <td id="L3933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3933"></td>
          <td id="LC3933" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> ltype</td>
        </tr>
        <tr>
          <td id="L3934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3934"></td>
          <td id="LC3934" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3935"></td>
          <td id="LC3935" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L3936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3936"></td>
          <td id="LC3936" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l1_P, dedz_zbio_l1_P, f_zbio_l1_P, dfdz_zbio_l1_P, g_zbio_l1_P, dgdz_zbio_l1_P</td>
        </tr>
        <tr>
          <td id="L3937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3937"></td>
          <td id="LC3937" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p_zbio_l1_P, dpdz_zbio_l1_P, q_zbio_l1_P, dqdz_zbio_l1_P, a1_P, b1_P</td>
        </tr>
        <tr>
          <td id="L3938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3938"></td>
          <td id="LC3938" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l2_P, dedz_zbio_l2_P, f_zbio_l2_P, dfdz_zbio_l2_P, g_zbio_l2_P, dgdz_zbio_l2_P</td>
        </tr>
        <tr>
          <td id="L3939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3939"></td>
          <td id="LC3939" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p_zbio_l2_P, dpdz_zbio_l2_P, q_zbio_l2_P, dqdz_zbio_l2_P, a2_P, b2_P</td>
        </tr>
        <tr>
          <td id="L3940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3940"></td>
          <td id="LC3940" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l1_M, dedz_zbio_l1_M, f_zbio_l1_M, dfdz_zbio_l1_M, g_zbio_l1_M, dgdz_zbio_l1_M</td>
        </tr>
        <tr>
          <td id="L3941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3941"></td>
          <td id="LC3941" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p_zbio_l1_M, dpdz_zbio_l1_M, q_zbio_l1_M, dqdz_zbio_l1_M, a1_M, b1_M</td>
        </tr>
        <tr>
          <td id="L3942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3942"></td>
          <td id="LC3942" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> e_zbio_l2_M, dedz_zbio_l2_M, f_zbio_l2_M, dfdz_zbio_l2_M, g_zbio_l2_M, dgdz_zbio_l2_M</td>
        </tr>
        <tr>
          <td id="L3943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3943"></td>
          <td id="LC3943" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> p_zbio_l2_M, dpdz_zbio_l2_M, q_zbio_l2_M, dqdz_zbio_l2_M, a2_M</td>
        </tr>
        <tr>
          <td id="L3944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3944"></td>
          <td id="LC3944" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> Vb, Fb</td>
        </tr>
        <tr>
          <td id="L3945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3945"></td>
          <td id="LC3945" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">6</span>) <span class="pl-k">::</span> Phi1_P, Phi2_P</td>
        </tr>
        <tr>
          <td id="L3946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3946"></td>
          <td id="LC3946" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>,<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span> mat_X, mat_Y</td>
        </tr>
        <tr>
          <td id="L3947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3947"></td>
          <td id="LC3947" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>) <span class="pl-k">::</span>  vec_Z</td>
        </tr>
        <tr>
          <td id="L3948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3948"></td>
          <td id="LC3948" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> <span class="pl-k">::</span> loc_dim</td>
        </tr>
        <tr>
          <td id="L3949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3949"></td>
          <td id="LC3949" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3950"></td>
          <td id="LC3950" class="blob-code blob-code-inner js-file-line">        Phi1_P <span class="pl-k">=</span> (<span class="pl-k">/</span> <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span> <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3951"></td>
          <td id="LC3951" class="blob-code blob-code-inner js-file-line">        Phi2_P <span class="pl-k">=</span> (<span class="pl-k">/</span> <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span> <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L3952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3952"></td>
          <td id="LC3952" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3953"></td>
          <td id="LC3953" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zL &lt;<span class="pl-k">=</span> zbio)<span class="pl-k">then</span>  <span class="pl-c"><span class="pl-c">!</span> wholly within bioturbated layer</span></td>
        </tr>
        <tr>
          <td id="L3954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3954"></td>
          <td id="LC3954" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L3955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3955"></td>
          <td id="LC3955" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">elseif</span>(zU &gt;<span class="pl-k">=</span> zbio) <span class="pl-k">then</span> <span class="pl-c"><span class="pl-c">!</span> wholly within non-bioturbated layer</span></td>
        </tr>
        <tr>
          <td id="L3956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3956"></td>
          <td id="LC3956" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L3957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3957"></td>
          <td id="LC3957" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span>             <span class="pl-c"><span class="pl-c">!</span> crossing boundary - sort out solution matching at zbio</span></td>
        </tr>
        <tr>
          <td id="L3958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3958"></td>
          <td id="LC3958" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN  CROSS BOUNDARY CASE &#39;</span></td>
        </tr>
        <tr>
          <td id="L3959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3959"></td>
          <td id="LC3959" class="blob-code blob-code-inner js-file-line">            ltype <span class="pl-k">=</span> <span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L3960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3960"></td>
          <td id="LC3960" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3961"></td>
          <td id="LC3961" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span>(zL &lt;<span class="pl-k">=</span> zox)<span class="pl-k">then</span>       <span class="pl-c"><span class="pl-c">!</span> oxic layer -&gt; call PO4 first</span></td>
        </tr>
        <tr>
          <td id="L3962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3962"></td>
          <td id="LC3962" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l1_PO4(zbio, reac1, reac2, D1P, ktempP, QtempP, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3963"></td>
          <td id="LC3963" class="blob-code blob-code-inner js-file-line">                e_zbio_l1_P, dedz_zbio_l1_P, f_zbio_l1_P, dfdz_zbio_l1_P, g_zbio_l1_P, &amp;</td>
        </tr>
        <tr>
          <td id="L3964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3964"></td>
          <td id="LC3964" class="blob-code blob-code-inner js-file-line">                dgdz_zbio_l1_P, p_zbio_l1_P, dpdz_zbio_l1_P, q_zbio_l1_P, dqdz_zbio_l1_P, a1_P, b1_P, Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3965"></td>
          <td id="LC3965" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l2_PO4(zbio, reac1, reac2, D2P, ktempP, QtempP, <span class="pl-c1">0.0</span>, alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3966"></td>
          <td id="LC3966" class="blob-code blob-code-inner js-file-line">                e_zbio_l2_P, dedz_zbio_l2_P, f_zbio_l2_P, dfdz_zbio_l2_P, g_zbio_l2_P, &amp;</td>
        </tr>
        <tr>
          <td id="L3967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3967"></td>
          <td id="LC3967" class="blob-code blob-code-inner js-file-line">                dgdz_zbio_l2_P, p_zbio_l2_P, dpdz_zbio_l2_P, q_zbio_l2_P, dqdz_zbio_l2_P, a2_P, b2_P, Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3968"></td>
          <td id="LC3968" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l1_M(zbio, D1M, ktempM, QtempM, a1_P, b1_P, Phi1_P, alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3969"></td>
          <td id="LC3969" class="blob-code blob-code-inner js-file-line">                e_zbio_l1_M, dedz_zbio_l1_M, f_zbio_l1_M, dfdz_zbio_l1_M, g_zbio_l1_M, dgdz_zbio_l1_M, &amp;</td>
        </tr>
        <tr>
          <td id="L3970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3970"></td>
          <td id="LC3970" class="blob-code blob-code-inner js-file-line">                p_zbio_l1_M, dpdz_zbio_l1_M, q_zbio_l1_M, dqdz_zbio_l1_M, a1_M, b1_M)</td>
        </tr>
        <tr>
          <td id="L3971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3971"></td>
          <td id="LC3971" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l2_M(zbio, ktempM, QtempM, a2_P, b2_P, Phi2_P, alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3972"></td>
          <td id="LC3972" class="blob-code blob-code-inner js-file-line">                e_zbio_l2_M, dedz_zbio_l2_M, f_zbio_l2_M, dfdz_zbio_l2_M, g_zbio_l2_M, dgdz_zbio_l2_M, &amp;</td>
        </tr>
        <tr>
          <td id="L3973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3973"></td>
          <td id="LC3973" class="blob-code blob-code-inner js-file-line">                p_zbio_l2_M, dpdz_zbio_l2_M, q_zbio_l2_M, dqdz_zbio_l2_M, a2_M)</td>
        </tr>
        <tr>
          <td id="L3974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3974"></td>
          <td id="LC3974" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3975"></td>
          <td id="LC3975" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">else</span>                <span class="pl-c"><span class="pl-c">!</span> anoxic layer -&gt; call M first</span></td>
        </tr>
        <tr>
          <td id="L3976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3976"></td>
          <td id="LC3976" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l1_M(zbio, D1M, ktempM, QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, Phi1_P, alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3977"></td>
          <td id="LC3977" class="blob-code blob-code-inner js-file-line">                e_zbio_l1_M, dedz_zbio_l1_M, f_zbio_l1_M, dfdz_zbio_l1_M, g_zbio_l1_M, dgdz_zbio_l1_M, &amp;</td>
        </tr>
        <tr>
          <td id="L3978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3978"></td>
          <td id="LC3978" class="blob-code blob-code-inner js-file-line">                p_zbio_l1_M, dpdz_zbio_l1_M, q_zbio_l1_M, dqdz_zbio_l1_M, a1_M, b1_M)</td>
        </tr>
        <tr>
          <td id="L3979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3979"></td>
          <td id="LC3979" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l2_M(zbio, ktempM, QtempM, <span class="pl-c1">0.0</span>, <span class="pl-c1">0.0</span>, Phi2_P, alphaM, &amp;</td>
        </tr>
        <tr>
          <td id="L3980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3980"></td>
          <td id="LC3980" class="blob-code blob-code-inner js-file-line">                e_zbio_l2_M, dedz_zbio_l2_M, f_zbio_l2_M, dfdz_zbio_l2_M, g_zbio_l2_M, dgdz_zbio_l2_M, &amp;</td>
        </tr>
        <tr>
          <td id="L3981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3981"></td>
          <td id="LC3981" class="blob-code blob-code-inner js-file-line">                p_zbio_l2_M, dpdz_zbio_l2_M, q_zbio_l2_M, dqdz_zbio_l2_M, a2_M)</td>
        </tr>
        <tr>
          <td id="L3982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3982"></td>
          <td id="LC3982" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l1_PO4(zbio, reac1, reac2, D1P, ktempP, QtempP, a1_M, b1_M, alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3983"></td>
          <td id="LC3983" class="blob-code blob-code-inner js-file-line">                e_zbio_l1_P, dedz_zbio_l1_P, f_zbio_l1_P, dfdz_zbio_l1_P, g_zbio_l1_P, dgdz_zbio_l1_P, &amp;</td>
        </tr>
        <tr>
          <td id="L3984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3984"></td>
          <td id="LC3984" class="blob-code blob-code-inner js-file-line">                p_zbio_l1_P, dpdz_zbio_l1_P, q_zbio_l1_P, dqdz_zbio_l1_P, a1_P, b1_P, Phi1_P)</td>
        </tr>
        <tr>
          <td id="L3985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3985"></td>
          <td id="LC3985" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">call</span> sub_calcfg_l2_PO4(zbio, reac1, reac2, D2P, ktempP, QtempP, a2_M, alphaP, &amp;</td>
        </tr>
        <tr>
          <td id="L3986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3986"></td>
          <td id="LC3986" class="blob-code blob-code-inner js-file-line">                e_zbio_l2_P, dedz_zbio_l2_P, f_zbio_l2_P, dfdz_zbio_l2_P, g_zbio_l2_P, dgdz_zbio_l2_P, &amp;</td>
        </tr>
        <tr>
          <td id="L3987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3987"></td>
          <td id="LC3987" class="blob-code blob-code-inner js-file-line">                p_zbio_l2_P, dpdz_zbio_l2_P, q_zbio_l2_P, dqdz_zbio_l2_P, a2_P, b2_P, Phi2_P)</td>
        </tr>
        <tr>
          <td id="L3988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3988"></td>
          <td id="LC3988" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L3989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3989"></td>
          <td id="LC3989" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3990"></td>
          <td id="LC3990" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> match solutions at zbio - continuous concentration and flux</span></td>
        </tr>
        <tr>
          <td id="L3991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3991"></td>
          <td id="LC3991" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> organize the data in matrices, and use the intrinsic fortran fct.</span></td>
        </tr>
        <tr>
          <td id="L3992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3992"></td>
          <td id="LC3992" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> DH: Maybe more efficient when written out !?</span></td>
        </tr>
        <tr>
          <td id="L3993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3993"></td>
          <td id="LC3993" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3994"></td>
          <td id="LC3994" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  |x1        |   | A_l |      | y1        | | A_r|    |z1|    always PO4 continuity</span></td>
        </tr>
        <tr>
          <td id="L3995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3995"></td>
          <td id="LC3995" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  |    .     |   | B_l |      |    .      | | B_r|    |z2|    always PO4 flux</span></td>
        </tr>
        <tr>
          <td id="L3996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3996"></td>
          <td id="LC3996" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  |      .   |   | C_l |   =  |      .    | | C_r|  + |z3|    always M continuity</span></td>
        </tr>
        <tr>
          <td id="L3997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3997"></td>
          <td id="LC3997" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>  |       x16|   | D_l |      |        y16| | D_r|    |z4|    SD always M _diffusive_ flux  = 0 (cf org C)</span></td>
        </tr>
        <tr>
          <td id="L3998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3998"></td>
          <td id="LC3998" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L3999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3999"></td>
          <td id="LC3999" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> discontinuity constants</span></td>
        </tr>
        <tr>
          <td id="L4000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4000"></td>
          <td id="LC4000" class="blob-code blob-code-inner js-file-line">            Vb <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L4001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4001"></td>
          <td id="LC4001" class="blob-code blob-code-inner js-file-line">            Fb <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L4002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4002"></td>
          <td id="LC4002" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4003"></td>
          <td id="LC4003" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> weird FORTRAN matrices makes the transpose necessary</span></td>
        </tr>
        <tr>
          <td id="L4004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4004"></td>
          <td id="LC4004" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> matrix mat_X</span></td>
        </tr>
        <tr>
          <td id="L4005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4005"></td>
          <td id="LC4005" class="blob-code blob-code-inner js-file-line">            mat_X <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e_zbio_l1_P, f_zbio_l1_P, p_zbio_l1_P, q_zbio_l1_P, &amp;</td>
        </tr>
        <tr>
          <td id="L4006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4006"></td>
          <td id="LC4006" class="blob-code blob-code-inner js-file-line">            D1P<span class="pl-k">*</span>dedz_zbio_l1_P, D1P<span class="pl-k">*</span>dfdz_zbio_l1_P, D1P<span class="pl-k">*</span>dpdz_zbio_l1_P, D1P<span class="pl-k">*</span>dqdz_zbio_l1_P, &amp;</td>
        </tr>
        <tr>
          <td id="L4007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4007"></td>
          <td id="LC4007" class="blob-code blob-code-inner js-file-line">            e_zbio_l1_M, f_zbio_l1_M, p_zbio_l1_M, q_zbio_l1_M, &amp;</td>
        </tr>
        <tr>
          <td id="L4008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4008"></td>
          <td id="LC4008" class="blob-code blob-code-inner js-file-line">            D1M<span class="pl-k">*</span>dedz_zbio_l1_M, D1M<span class="pl-k">*</span>dfdz_zbio_l1_M, D1M<span class="pl-k">*</span>dpdz_zbio_l1_M, D1M<span class="pl-k">*</span>dqdz_zbio_l1_M<span class="pl-k">/</span>), <span class="pl-k">shape</span>(mat_X)))</td>
        </tr>
        <tr>
          <td id="L4009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4009"></td>
          <td id="LC4009" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_X(1,loc_i), loc_i=1,4) /  e_zbio_l1_P, f_zbio_l1_P, p_zbio_l1_P, q_zbio_l1_P /</span></td>
        </tr>
        <tr>
          <td id="L4010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4010"></td>
          <td id="LC4010" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_X(2,loc_i), loc_i=1,4) /  D1P*dedz_zbio_l1_P, D1P*dfdz_zbio_l1_P, D1P*dpdz_zbio_l1_P, D1P*dqdz_zbio_l1_P /</span></td>
        </tr>
        <tr>
          <td id="L4011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4011"></td>
          <td id="LC4011" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_X(3,loc_i), loc_i=1,4) /  e_zbio_l1_M, f_zbio_l1_M, p_zbio_l1_M, q_zbio_l1_M /</span></td>
        </tr>
        <tr>
          <td id="L4012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4012"></td>
          <td id="LC4012" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_X(4,loc_i), loc_i=1,4) /  D1M*dedz_zbio_l1_M, D1M*dfdz_zbio_l1_M, D1M*dpdz_zbio_l1_M, D1M*dqdz_zbio_l1_M /</span></td>
        </tr>
        <tr>
          <td id="L4013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4013"></td>
          <td id="LC4013" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4014"></td>
          <td id="LC4014" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> matrix mat_Y</span></td>
        </tr>
        <tr>
          <td id="L4015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4015"></td>
          <td id="LC4015" class="blob-code blob-code-inner js-file-line">            mat_Y <span class="pl-k">=</span> <span class="pl-k">transpose</span>(<span class="pl-k">reshape</span>((<span class="pl-k">/</span> e_zbio_l2_P, f_zbio_l2_P, p_zbio_l2_P, q_zbio_l2_P, &amp;</td>
        </tr>
        <tr>
          <td id="L4016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4016"></td>
          <td id="LC4016" class="blob-code blob-code-inner js-file-line">            D2P<span class="pl-k">*</span>dedz_zbio_l2_P, D2P<span class="pl-k">*</span>dfdz_zbio_l2_P, D2P<span class="pl-k">*</span>dpdz_zbio_l2_P, D2P<span class="pl-k">*</span>dqdz_zbio_l2_P, &amp;</td>
        </tr>
        <tr>
          <td id="L4017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4017"></td>
          <td id="LC4017" class="blob-code blob-code-inner js-file-line">            e_zbio_l2_M, f_zbio_l2_M, p_zbio_l2_M, q_zbio_l2_M, &amp;</td>
        </tr>
        <tr>
          <td id="L4018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4018"></td>
          <td id="LC4018" class="blob-code blob-code-inner js-file-line">            D2M<span class="pl-k">*</span>dedz_zbio_l2_M, D2M<span class="pl-k">*</span>dfdz_zbio_l2_M, D2M<span class="pl-k">*</span>dpdz_zbio_l2_M, D2M<span class="pl-k">*</span>dqdz_zbio_l2_M<span class="pl-k">/</span>), <span class="pl-k">shape</span>(mat_Y)))</td>
        </tr>
        <tr>
          <td id="L4019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4019"></td>
          <td id="LC4019" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_Y(1,loc_i), loc_i=1,4) /  e_zbio_l2_P, f_zbio_l2_P, p_zbio_l2_P, q_zbio_l2_P /</span></td>
        </tr>
        <tr>
          <td id="L4020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4020"></td>
          <td id="LC4020" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_Y(2,loc_i), loc_i=1,4) /  D2P*dedz_zbio_l2_P, D2P*dfdz_zbio_l2_P, D2P*dpdz_zbio_l2_P, D2P*dqdz_zbio_l2_P /</span></td>
        </tr>
        <tr>
          <td id="L4021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4021"></td>
          <td id="LC4021" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_Y(3,loc_i), loc_i=1,4) /  e_zbio_l2_M, f_zbio_l2_M, p_zbio_l2_M, q_zbio_l2_M /</span></td>
        </tr>
        <tr>
          <td id="L4022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4022"></td>
          <td id="LC4022" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            data (mat_Y(4,loc_i), loc_i=1,4) /  D2M*dedz_zbio_l2_M, D2M*dfdz_zbio_l2_M, D2M*dpdz_zbio_l2_M, D2M*dqdz_zbio_l2_M /</span></td>
        </tr>
        <tr>
          <td id="L4023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4023"></td>
          <td id="LC4023" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4024"></td>
          <td id="LC4024" class="blob-code blob-code-inner js-file-line">            vec_Z <span class="pl-k">=</span> (<span class="pl-k">/</span> g_zbio_l2_P<span class="pl-k">-</span>g_zbio_l1_P <span class="pl-k">+</span> Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L4025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4025"></td>
          <td id="LC4025" class="blob-code blob-code-inner js-file-line">            D2P<span class="pl-k">*</span>dgdz_zbio_l2_P <span class="pl-k">-</span> D1P<span class="pl-k">*</span>dgdz_zbio_l1_P <span class="pl-k">+</span> Fb <span class="pl-k">-</span> w<span class="pl-k">*</span>Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L4026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4026"></td>
          <td id="LC4026" class="blob-code blob-code-inner js-file-line">            g_zbio_l2_M<span class="pl-k">-</span>g_zbio_l1_M <span class="pl-k">+</span> Vb, &amp;</td>
        </tr>
        <tr>
          <td id="L4027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4027"></td>
          <td id="LC4027" class="blob-code blob-code-inner js-file-line">            D2M<span class="pl-k">*</span>dgdz_zbio_l2_M <span class="pl-k">-</span> D1M<span class="pl-k">*</span>dgdz_zbio_l1_M <span class="pl-k">+</span> Fb <span class="pl-k">-</span> w<span class="pl-k">*</span>Vb <span class="pl-k">/</span>)</td>
        </tr>
        <tr>
          <td id="L4028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4028"></td>
          <td id="LC4028" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4029"></td>
          <td id="LC4029" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4030"></td>
          <td id="LC4030" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            201         format (6f12.6)</span></td>
        </tr>
        <tr>
          <td id="L4031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4031"></td>
          <td id="LC4031" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;mat_X &#39;</span></td>
        </tr>
        <tr>
          <td id="L4032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4032"></td>
          <td id="LC4032" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        do loc_i=1,4</span></td>
        </tr>
        <tr>
          <td id="L4033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4033"></td>
          <td id="LC4033" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                            write (*,201) (mat_X(loc_i,loc_j),loc_j=1,4)</span></td>
        </tr>
        <tr>
          <td id="L4034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4034"></td>
          <td id="LC4034" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        end do</span></td>
        </tr>
        <tr>
          <td id="L4035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4035"></td>
          <td id="LC4035" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;mat_Y &#39;</span></td>
        </tr>
        <tr>
          <td id="L4036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4036"></td>
          <td id="LC4036" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        do loc_i=1,4</span></td>
        </tr>
        <tr>
          <td id="L4037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4037"></td>
          <td id="LC4037" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                            write (*,201) (mat_Y(loc_i,loc_j),loc_j=1,4)</span></td>
        </tr>
        <tr>
          <td id="L4038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4038"></td>
          <td id="LC4038" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        end do</span></td>
        </tr>
        <tr>
          <td id="L4039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4039"></td>
          <td id="LC4039" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        print*,&#39;vec_Z &#39;, char(9), vec_Z</span></td>
        </tr>
        <tr>
          <td id="L4040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4040"></td>
          <td id="LC4040" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4041"></td>
          <td id="LC4041" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4042"></td>
          <td id="LC4042" class="blob-code blob-code-inner js-file-line">            loc_dim <span class="pl-k">=</span> <span class="pl-c1">4</span></td>
        </tr>
        <tr>
          <td id="L4043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4043"></td>
          <td id="LC4043" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">call</span> sub_matchsoln_PO4_M(mat_X, mat_Y, vec_Z, loc_dim, loc_mat_C, loc_vec_D)</td>
        </tr>
        <tr>
          <td id="L4044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4044"></td>
          <td id="LC4044" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4045"></td>
          <td id="LC4045" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4046"></td>
          <td id="LC4046" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_prepfg_l12_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L4047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4047"></td>
          <td id="LC4047" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4048"></td>
          <td id="LC4048" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4049"></td>
          <td id="LC4049" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_matchsoln</span>(<span class="pl-v">E_l</span>, <span class="pl-v">F_l</span>, <span class="pl-v">G_l</span>, <span class="pl-v">dEdx_l</span>, <span class="pl-v">dFdx_l</span>, <span class="pl-v">dGdx_l</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L4050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4050"></td>
          <td id="LC4050" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">E_r</span>, <span class="pl-v">F_r</span>, <span class="pl-v">G_r</span>, <span class="pl-v">dEdx_r</span>, <span class="pl-v">dFdx_r</span>, <span class="pl-v">dGdx_r</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L4051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4051"></td>
          <td id="LC4051" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">Vb</span>, <span class="pl-v">Db</span>, <span class="pl-v">ls_a</span>, <span class="pl-v">ls_b</span>, <span class="pl-v">ls_c</span>, <span class="pl-v">ls_d</span>, <span class="pl-v">ls_e</span>, <span class="pl-v">ls_f</span>)</td>
        </tr>
        <tr>
          <td id="L4052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4052"></td>
          <td id="LC4052" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4053"></td>
          <td id="LC4053" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> E_l, F_l, G_l, dEdx_l, dFdx_l, dGdx_l</td>
        </tr>
        <tr>
          <td id="L4054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4054"></td>
          <td id="LC4054" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> E_r, F_r, G_r, dEdx_r, dFdx_r, dGdx_r, Vb, Db</td>
        </tr>
        <tr>
          <td id="L4055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4055"></td>
          <td id="LC4055" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> ls_a, ls_b, ls_c, ls_d, ls_e, ls_f</td>
        </tr>
        <tr>
          <td id="L4056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4056"></td>
          <td id="LC4056" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span> alden, blden</td>
        </tr>
        <tr>
          <td id="L4057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4057"></td>
          <td id="LC4057" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4058"></td>
          <td id="LC4058" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match two solutions at a boundary:</span></td>
        </tr>
        <tr>
          <td id="L4059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4059"></td>
          <td id="LC4059" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> &#39;left&#39; solution   y_l(x) = A_l*E_l(x) + B_l*F_l(x) + G_l(x)</span></td>
        </tr>
        <tr>
          <td id="L4060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4060"></td>
          <td id="LC4060" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> &#39;right&#39; solution  y_r(x) = A_r*E_r(x) + B_r*F_l(x) + G_r(x)</span></td>
        </tr>
        <tr>
          <td id="L4061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4061"></td>
          <td id="LC4061" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4062"></td>
          <td id="LC4062" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> (Dis)continuity conditions at boundary:</span></td>
        </tr>
        <tr>
          <td id="L4063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4063"></td>
          <td id="LC4063" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                   y_r(xb)    = y_l(xb)     + Vb</span></td>
        </tr>
        <tr>
          <td id="L4064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4064"></td>
          <td id="LC4064" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                   dydx_r(xb) = dydx_l(xb)  + Db</span></td>
        </tr>
        <tr>
          <td id="L4065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4065"></td>
          <td id="LC4065" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4066"></td>
          <td id="LC4066" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find a,b,c,d,e,f such that:</span></td>
        </tr>
        <tr>
          <td id="L4067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4067"></td>
          <td id="LC4067" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | A_l |   =  | a  b | | A_r|  + |e|</span></td>
        </tr>
        <tr>
          <td id="L4068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4068"></td>
          <td id="LC4068" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | B_l |      | c  d | | B_r|    |f|</span></td>
        </tr>
        <tr>
          <td id="L4069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4069"></td>
          <td id="LC4069" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4070"></td>
          <td id="LC4070" class="blob-code blob-code-inner js-file-line">        alden <span class="pl-k">=</span> dFdx_l<span class="pl-k">*</span>E_l <span class="pl-k">-</span> F_l<span class="pl-k">*</span>dEdx_l <span class="pl-k">+</span> const_real_nullsmall</td>
        </tr>
        <tr>
          <td id="L4071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4071"></td>
          <td id="LC4071" class="blob-code blob-code-inner js-file-line">        ls_a     <span class="pl-k">=</span> (dFdx_l<span class="pl-k">*</span>E_r <span class="pl-k">-</span> F_l<span class="pl-k">*</span>dEdx_r)<span class="pl-k">/</span>alden</td>
        </tr>
        <tr>
          <td id="L4072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4072"></td>
          <td id="LC4072" class="blob-code blob-code-inner js-file-line">        ls_b     <span class="pl-k">=</span> (dFdx_l<span class="pl-k">*</span>F_r <span class="pl-k">-</span> F_l<span class="pl-k">*</span>dFdx_r)<span class="pl-k">/</span>alden</td>
        </tr>
        <tr>
          <td id="L4073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4073"></td>
          <td id="LC4073" class="blob-code blob-code-inner js-file-line">        ls_e     <span class="pl-k">=</span> (F_l<span class="pl-k">*</span>(dGdx_l <span class="pl-k">-</span> dGdx_r <span class="pl-k">+</span> Db) <span class="pl-k">+</span> dFdx_l<span class="pl-k">*</span>(<span class="pl-k">-</span>G_l <span class="pl-k">+</span> G_r <span class="pl-k">-</span> Vb))<span class="pl-k">/</span>alden</td>
        </tr>
        <tr>
          <td id="L4074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4074"></td>
          <td id="LC4074" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4075"></td>
          <td id="LC4075" class="blob-code blob-code-inner js-file-line">        blden <span class="pl-k">=</span> dEdx_l<span class="pl-k">*</span>F_l <span class="pl-k">-</span> E_l<span class="pl-k">*</span>dFdx_l <span class="pl-k">+</span> const_real_nullsmall</td>
        </tr>
        <tr>
          <td id="L4076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4076"></td>
          <td id="LC4076" class="blob-code blob-code-inner js-file-line">        ls_c     <span class="pl-k">=</span> (dEdx_l<span class="pl-k">*</span>E_r <span class="pl-k">-</span> E_l<span class="pl-k">*</span>dEdx_r)<span class="pl-k">/</span>blden</td>
        </tr>
        <tr>
          <td id="L4077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4077"></td>
          <td id="LC4077" class="blob-code blob-code-inner js-file-line">        ls_d     <span class="pl-k">=</span> (dEdx_l<span class="pl-k">*</span>F_r <span class="pl-k">-</span> E_l<span class="pl-k">*</span>dFdx_r)<span class="pl-k">/</span>blden;</td>
        </tr>
        <tr>
          <td id="L4078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4078"></td>
          <td id="LC4078" class="blob-code blob-code-inner js-file-line">        ls_f     <span class="pl-k">=</span> (E_l<span class="pl-k">*</span>(dGdx_l <span class="pl-k">-</span> dGdx_r <span class="pl-k">+</span> Db) <span class="pl-k">+</span> dEdx_l<span class="pl-k">*</span>(<span class="pl-k">-</span>G_l<span class="pl-k">+</span>G_r <span class="pl-k">-</span> Vb))<span class="pl-k">/</span>blden</td>
        </tr>
        <tr>
          <td id="L4079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4079"></td>
          <td id="LC4079" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4080"></td>
          <td id="LC4080" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_matchsoln</span></td>
        </tr>
        <tr>
          <td id="L4081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4081"></td>
          <td id="LC4081" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4082"></td>
          <td id="LC4082" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4083"></td>
          <td id="LC4083" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4084"></td>
          <td id="LC4084" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4085"></td>
          <td id="LC4085" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4086"></td>
          <td id="LC4086" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4087"></td>
          <td id="LC4087" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4088"></td>
          <td id="LC4088" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4089"></td>
          <td id="LC4089" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_xformsoln</span>(<span class="pl-v">E</span>, <span class="pl-v">F</span>, <span class="pl-v">G</span>, <span class="pl-v">dEdx</span>, <span class="pl-v">dFdx</span>, <span class="pl-v">dGdx</span>, <span class="pl-v">ls_a</span> , <span class="pl-v">ls_b</span> , <span class="pl-v">ls_c</span> , <span class="pl-v">ls_d</span> , <span class="pl-v">ls_e</span> ,<span class="pl-v">ls_f</span>, <span class="pl-v">Etr</span>, <span class="pl-v">Ftr</span>, <span class="pl-v">Gtr</span>, <span class="pl-v">dEtdx</span>, <span class="pl-v">dFtdx</span>, <span class="pl-v">dGtdx</span>)</td>
        </tr>
        <tr>
          <td id="L4090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4090"></td>
          <td id="LC4090" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4091"></td>
          <td id="LC4091" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span> E, F, G, dEdx, dFdx, dGdx, ls_a , ls_b , ls_c , ls_d , ls_e ,ls_f</td>
        </tr>
        <tr>
          <td id="L4092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4092"></td>
          <td id="LC4092" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> Etr, Ftr, Gtr, dEtdx, dFtdx, dGtdx</td>
        </tr>
        <tr>
          <td id="L4093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4093"></td>
          <td id="LC4093" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4094"></td>
          <td id="LC4094" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find &#39;transformed&#39; soln such that in layer l,</span></td>
        </tr>
        <tr>
          <td id="L4095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4095"></td>
          <td id="LC4095" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    y_l = A_r*et + B_r*ft + gt</span></td>
        </tr>
        <tr>
          <td id="L4096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4096"></td>
          <td id="LC4096" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> (ie l soln written in terms of r solution coefficents A_r, B_r)</span></td>
        </tr>
        <tr>
          <td id="L4097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4097"></td>
          <td id="LC4097" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4098"></td>
          <td id="LC4098" class="blob-code blob-code-inner js-file-line">        Etr      <span class="pl-k">=</span> ls_a<span class="pl-k">*</span>E    <span class="pl-k">+</span> ls_c<span class="pl-k">*</span>F</td>
        </tr>
        <tr>
          <td id="L4099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4099"></td>
          <td id="LC4099" class="blob-code blob-code-inner js-file-line">        dEtdx   <span class="pl-k">=</span> ls_a<span class="pl-k">*</span>dEdx <span class="pl-k">+</span> ls_c<span class="pl-k">*</span>dFdx</td>
        </tr>
        <tr>
          <td id="L4100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4100"></td>
          <td id="LC4100" class="blob-code blob-code-inner js-file-line">        Ftr      <span class="pl-k">=</span> ls_b<span class="pl-k">*</span>E    <span class="pl-k">+</span> ls_d<span class="pl-k">*</span>F</td>
        </tr>
        <tr>
          <td id="L4101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4101"></td>
          <td id="LC4101" class="blob-code blob-code-inner js-file-line">        dFtdx   <span class="pl-k">=</span> ls_b<span class="pl-k">*</span>dEdx <span class="pl-k">+</span> ls_d<span class="pl-k">*</span>dFdx</td>
        </tr>
        <tr>
          <td id="L4102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4102"></td>
          <td id="LC4102" class="blob-code blob-code-inner js-file-line">        Gtr      <span class="pl-k">=</span> G       <span class="pl-k">+</span> ls_e<span class="pl-k">*</span>E      <span class="pl-k">+</span> ls_f<span class="pl-k">*</span>F</td>
        </tr>
        <tr>
          <td id="L4103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4103"></td>
          <td id="LC4103" class="blob-code blob-code-inner js-file-line">        dGtdx   <span class="pl-k">=</span> dGdx    <span class="pl-k">+</span> ls_e<span class="pl-k">*</span>dEdx   <span class="pl-k">+</span> ls_f<span class="pl-k">*</span>dFdx</td>
        </tr>
        <tr>
          <td id="L4104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4104"></td>
          <td id="LC4104" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4105"></td>
          <td id="LC4105" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;IN sub_xformsoln E, F, G, dEdx, dFdx, dGdx, ls_a , ls_b , ls_c , ls_d , ls_e ,ls_f&#39;, &amp;</span></td>
        </tr>
        <tr>
          <td id="L4106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4106"></td>
          <td id="LC4106" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>                    &amp; E, F, G, dEdx, dFdx, dGdx, ls_a , ls_b , ls_c , ls_d , ls_e ,ls_f</span></td>
        </tr>
        <tr>
          <td id="L4107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4107"></td>
          <td id="LC4107" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>            print*, &#39;OUT sub_xformsoln Etr, Ftr, Gtr, dEtdx, dFtdx, dGtdx&#39;, Etr, Ft, Gt, dEtdx, dFtdx, dGtdx</span></td>
        </tr>
        <tr>
          <td id="L4108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4108"></td>
          <td id="LC4108" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4109"></td>
          <td id="LC4109" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_xformsoln</span></td>
        </tr>
        <tr>
          <td id="L4110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4110"></td>
          <td id="LC4110" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4111"></td>
          <td id="LC4111" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4112"></td>
          <td id="LC4112" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4113"></td>
          <td id="LC4113" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4114"></td>
          <td id="LC4114" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4115"></td>
          <td id="LC4115" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4116"></td>
          <td id="LC4116" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_solve2eqn</span>(<span class="pl-v">a</span>, <span class="pl-v">b</span>, <span class="pl-v">c</span>, <span class="pl-v">d</span>, <span class="pl-v">e</span>, <span class="pl-v">f</span>, <span class="pl-v">x</span>, <span class="pl-v">y</span>)</td>
        </tr>
        <tr>
          <td id="L4117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4117"></td>
          <td id="LC4117" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4118"></td>
          <td id="LC4118" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find soln of</span></td>
        </tr>
        <tr>
          <td id="L4119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4119"></td>
          <td id="LC4119" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | a    b |  |x|   = | e |</span></td>
        </tr>
        <tr>
          <td id="L4120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4120"></td>
          <td id="LC4120" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | c    d |  |y|     | f |</span></td>
        </tr>
        <tr>
          <td id="L4121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4121"></td>
          <td id="LC4121" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4122"></td>
          <td id="LC4122" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">IN</span>)<span class="pl-k">::</span>a, b, c, d, e, f</td>
        </tr>
        <tr>
          <td id="L4123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4123"></td>
          <td id="LC4123" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">OUT</span>)<span class="pl-k">::</span>x, y</td>
        </tr>
        <tr>
          <td id="L4124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4124"></td>
          <td id="LC4124" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4125"></td>
          <td id="LC4125" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variable</span></td>
        </tr>
        <tr>
          <td id="L4126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4126"></td>
          <td id="LC4126" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span><span class="pl-k">::</span>det</td>
        </tr>
        <tr>
          <td id="L4127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4127"></td>
          <td id="LC4127" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4128"></td>
          <td id="LC4128" class="blob-code blob-code-inner js-file-line">        det <span class="pl-k">=</span> a<span class="pl-k">*</span>d<span class="pl-k">-</span>b<span class="pl-k">*</span>c<span class="pl-k">+</span>const_real_nullsmall</td>
        </tr>
        <tr>
          <td id="L4129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4129"></td>
          <td id="LC4129" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(det == <span class="pl-c1">0.0</span>) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4130"></td>
          <td id="LC4130" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>det too small <span class="pl-pds">&#39;</span></span>, det</td>
        </tr>
        <tr>
          <td id="L4131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4131"></td>
          <td id="LC4131" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4132"></td>
          <td id="LC4132" class="blob-code blob-code-inner js-file-line">        x    <span class="pl-k">=</span>  (e<span class="pl-k">*</span>d<span class="pl-k">-</span>b<span class="pl-k">*</span>f)<span class="pl-k">/</span>det</td>
        </tr>
        <tr>
          <td id="L4133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4133"></td>
          <td id="LC4133" class="blob-code blob-code-inner js-file-line">        y    <span class="pl-k">=</span>  (a<span class="pl-k">*</span>f<span class="pl-k">-</span>e<span class="pl-k">*</span>c)<span class="pl-k">/</span>det</td>
        </tr>
        <tr>
          <td id="L4134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4134"></td>
          <td id="LC4134" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4135"></td>
          <td id="LC4135" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;a, b, c, d, e, f&#39;, a, b, c, d, e, f</span></td>
        </tr>
        <tr>
          <td id="L4136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4136"></td>
          <td id="LC4136" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;det&#39;, det</span></td>
        </tr>
        <tr>
          <td id="L4137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4137"></td>
          <td id="LC4137" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;x&#39;, x</span></td>
        </tr>
        <tr>
          <td id="L4138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4138"></td>
          <td id="LC4138" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;y&#39;, y</span></td>
        </tr>
        <tr>
          <td id="L4139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4139"></td>
          <td id="LC4139" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4140"></td>
          <td id="LC4140" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_solve2eqn</span></td>
        </tr>
        <tr>
          <td id="L4141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4141"></td>
          <td id="LC4141" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4142"></td>
          <td id="LC4142" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4143"></td>
          <td id="LC4143" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4144"></td>
          <td id="LC4144" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4145"></td>
          <td id="LC4145" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4146"></td>
          <td id="LC4146" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4147"></td>
          <td id="LC4147" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_matchsoln_PO4_M</span>(<span class="pl-v">dum_mat_X</span>, <span class="pl-v">dum_mat_Y</span>, <span class="pl-v">dum_vec_Z</span>, <span class="pl-v">dum_dim</span>, <span class="pl-v">loc_mat_C</span>, <span class="pl-v">loc_vec_D</span>)</td>
        </tr>
        <tr>
          <td id="L4148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4148"></td>
          <td id="LC4148" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4149"></td>
          <td id="LC4149" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> dum_dim                      <span class="pl-c"><span class="pl-c">!</span> dimension of the matrices</span></td>
        </tr>
        <tr>
          <td id="L4150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4150"></td>
          <td id="LC4150" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim,<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span> (<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_mat_X, dum_mat_Y</td>
        </tr>
        <tr>
          <td id="L4151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4151"></td>
          <td id="LC4151" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span> (<span class="pl-k">in</span>) <span class="pl-k">::</span>  dum_vec_Z</td>
        </tr>
        <tr>
          <td id="L4152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4152"></td>
          <td id="LC4152" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim,<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span> loc_mat_C</td>
        </tr>
        <tr>
          <td id="L4153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4153"></td>
          <td id="LC4153" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span> (<span class="pl-k">inout</span>) <span class="pl-k">::</span>  loc_vec_D</td>
        </tr>
        <tr>
          <td id="L4154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4154"></td>
          <td id="LC4154" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4155"></td>
          <td id="LC4155" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L4156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4156"></td>
          <td id="LC4156" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim,<span class="pl-c1">1</span>:dum_dim) <span class="pl-k">::</span> loc_mat_X, loc_inv_mat_X</td>
        </tr>
        <tr>
          <td id="L4157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4157"></td>
          <td id="LC4157" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        integer :: loc_i, loc_j</span></td>
        </tr>
        <tr>
          <td id="L4158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4158"></td>
          <td id="LC4158" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4159"></td>
          <td id="LC4159" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Match four solutions at a boundary:</span></td>
        </tr>
        <tr>
          <td id="L4160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4160"></td>
          <td id="LC4160" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  for PO4</span></td>
        </tr>
        <tr>
          <td id="L4161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4161"></td>
          <td id="LC4161" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> &#39;left&#39; solution   y_l(z) = A_l*E_l(z) + B_l*F_l(z) + C_l*P_l(z) + D_l*Q_l(z) + G_l(z)</span></td>
        </tr>
        <tr>
          <td id="L4162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4162"></td>
          <td id="LC4162" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> &#39;right&#39; solution  y_r(z) = A_r*E_r(z) + B_r*F_r(z) + C_r*P_r(z) + D_r*Q_r(z) + G_r(z)</span></td>
        </tr>
        <tr>
          <td id="L4163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4163"></td>
          <td id="LC4163" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4164"></td>
          <td id="LC4164" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>  and the same for M</span></td>
        </tr>
        <tr>
          <td id="L4165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4165"></td>
          <td id="LC4165" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4166"></td>
          <td id="LC4166" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> (Dis)continuity conditions at boundary:</span></td>
        </tr>
        <tr>
          <td id="L4167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4167"></td>
          <td id="LC4167" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                   y_r(xb)    = y_l(xb)     + Vb</span></td>
        </tr>
        <tr>
          <td id="L4168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4168"></td>
          <td id="LC4168" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                   dydx_r(xb) = dydx_l(xb)  + Db</span></td>
        </tr>
        <tr>
          <td id="L4169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4169"></td>
          <td id="LC4169" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4170"></td>
          <td id="LC4170" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | A_l |         | A_r|</span></td>
        </tr>
        <tr>
          <td id="L4171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4171"></td>
          <td id="LC4171" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | B_l |         | B_r|</span></td>
        </tr>
        <tr>
          <td id="L4172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4172"></td>
          <td id="LC4172" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>     X   | C_l |   =  Y  | C_r|  + Z</span></td>
        </tr>
        <tr>
          <td id="L4173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4173"></td>
          <td id="LC4173" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | D_l |         | D_r|</span></td>
        </tr>
        <tr>
          <td id="L4174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4174"></td>
          <td id="LC4174" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4175"></td>
          <td id="LC4175" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4176"></td>
          <td id="LC4176" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find C and D such that:</span></td>
        </tr>
        <tr>
          <td id="L4177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4177"></td>
          <td id="LC4177" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | A_l |         | A_r|</span></td>
        </tr>
        <tr>
          <td id="L4178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4178"></td>
          <td id="LC4178" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | B_l |         | B_r|</span></td>
        </tr>
        <tr>
          <td id="L4179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4179"></td>
          <td id="LC4179" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | C_l |   =  C  | C_r|  +  D</span></td>
        </tr>
        <tr>
          <td id="L4180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4180"></td>
          <td id="LC4180" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>         | D_l |         | D_r|</span></td>
        </tr>
        <tr>
          <td id="L4181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4181"></td>
          <td id="LC4181" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4182"></td>
          <td id="LC4182" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save matrix locally, as the original matrix loc_mat_X(4,4) will be destroyed during the calculation</span></td>
        </tr>
        <tr>
          <td id="L4183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4183"></td>
          <td id="LC4183" class="blob-code blob-code-inner js-file-line">        loc_mat_X <span class="pl-k">=</span> dum_mat_X</td>
        </tr>
        <tr>
          <td id="L4184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4184"></td>
          <td id="LC4184" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate loc_mat_X^{-1}</span></td>
        </tr>
        <tr>
          <td id="L4185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4185"></td>
          <td id="LC4185" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_inverse(loc_mat_X,loc_inv_mat_X,dum_dim)</td>
        </tr>
        <tr>
          <td id="L4186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4186"></td>
          <td id="LC4186" class="blob-code blob-code-inner js-file-line">        loc_mat_C <span class="pl-k">=</span> <span class="pl-k">matmul</span>(loc_inv_mat_X, dum_mat_Y)</td>
        </tr>
        <tr>
          <td id="L4187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4187"></td>
          <td id="LC4187" class="blob-code blob-code-inner js-file-line">        loc_vec_D <span class="pl-k">=</span> <span class="pl-k">matmul</span>(loc_inv_mat_X, dum_vec_Z)</td>
        </tr>
        <tr>
          <td id="L4188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4188"></td>
          <td id="LC4188" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4189"></td>
          <td id="LC4189" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4190"></td>
          <td id="LC4190" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_matchsoln_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L4191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4191"></td>
          <td id="LC4191" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4192"></td>
          <td id="LC4192" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4193"></td>
          <td id="LC4193" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4194"></td>
          <td id="LC4194" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4195"></td>
          <td id="LC4195" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4196"></td>
          <td id="LC4196" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4197"></td>
          <td id="LC4197" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_xformsoln_PO4_M</span>(<span class="pl-v">dum_EFPQ_P</span>, <span class="pl-v">dum_EFPQ_M</span>, <span class="pl-v">dum_dEFPQdz_P</span>, <span class="pl-v">dum_dEFPQdz_M</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L4198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4198"></td>
          <td id="LC4198" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">dum_g_P</span>, <span class="pl-v">dum_g_M</span>, <span class="pl-v">dum_dgdz_P</span>, <span class="pl-v">dum_dgdz_M</span>, <span class="pl-v">dum_mat_C</span>, <span class="pl-v">dum_vec_D</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L4199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4199"></td>
          <td id="LC4199" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">loc_EFPQ_P_t</span>, <span class="pl-v">loc_G_P_t</span>, <span class="pl-v">loc_dEFPQ_P_t</span>, <span class="pl-v">loc_dG_P_t</span>, <span class="pl-v">loc_EFPQ_M_t</span>, <span class="pl-v">loc_G_M_t</span>, <span class="pl-v">&amp;</span></td>
        </tr>
        <tr>
          <td id="L4200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4200"></td>
          <td id="LC4200" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">loc_dEFPQ_M_t</span>, <span class="pl-v">loc_dG_M_t</span>)</td>
        </tr>
        <tr>
          <td id="L4201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4201"></td>
          <td id="LC4201" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4202"></td>
          <td id="LC4202" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>), <span class="pl-k">intent</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_EFPQ_P, dum_dEFPQdz_P, dum_EFPQ_M, dum_dEFPQdz_M</td>
        </tr>
        <tr>
          <td id="L4203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4203"></td>
          <td id="LC4203" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">IN</span>)<span class="pl-k">::</span> dum_g_P, dum_g_M, dum_dgdz_P, dum_dgdz_M</td>
        </tr>
        <tr>
          <td id="L4204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4204"></td>
          <td id="LC4204" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">4</span>, <span class="pl-c1">4</span>), <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_mat_C</td>
        </tr>
        <tr>
          <td id="L4205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4205"></td>
          <td id="LC4205" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>), <span class="pl-k">INTENT</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span>  dum_vec_D</td>
        </tr>
        <tr>
          <td id="L4206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4206"></td>
          <td id="LC4206" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4207"></td>
          <td id="LC4207" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> output variables</span></td>
        </tr>
        <tr>
          <td id="L4208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4208"></td>
          <td id="LC4208" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:<span class="pl-c1">4</span>), <span class="pl-k">intent</span>(<span class="pl-k">inout</span>) <span class="pl-k">::</span> loc_EFPQ_P_t, loc_dEFPQ_P_t, loc_EFPQ_M_t, loc_dEFPQ_M_t</td>
        </tr>
        <tr>
          <td id="L4209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4209"></td>
          <td id="LC4209" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">intent</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span> loc_G_P_t, loc_dG_P_t, loc_G_M_t, loc_dG_M_t</td>
        </tr>
        <tr>
          <td id="L4210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4210"></td>
          <td id="LC4210" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4211"></td>
          <td id="LC4211" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find &#39;transformed&#39; soln such that in layer l,</span></td>
        </tr>
        <tr>
          <td id="L4212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4212"></td>
          <td id="LC4212" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    y_l = A_r*et + B_r*ft + gt</span></td>
        </tr>
        <tr>
          <td id="L4213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4213"></td>
          <td id="LC4213" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> (ie l soln written in terms of r solution coefficents A_r, B_r)</span></td>
        </tr>
        <tr>
          <td id="L4214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4214"></td>
          <td id="LC4214" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4215"></td>
          <td id="LC4215" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> here save values in matrices - as this saves a lot of code</span></td>
        </tr>
        <tr>
          <td id="L4216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4216"></td>
          <td id="LC4216" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4217"></td>
          <td id="LC4217" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_P_t <span class="pl-k">=</span> <span class="pl-k">matmul</span>(<span class="pl-k">transpose</span>(dum_mat_C), dum_EFPQ_P)     <span class="pl-c"><span class="pl-c">!</span> DH TODO: check multiplication with transpose, especially if vector*vector</span></td>
        </tr>
        <tr>
          <td id="L4218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4218"></td>
          <td id="LC4218" class="blob-code blob-code-inner js-file-line">        loc_dEFPQ_P_t <span class="pl-k">=</span> <span class="pl-k">matmul</span>(<span class="pl-k">transpose</span>(dum_mat_C), dum_dEFPQdz_P)</td>
        </tr>
        <tr>
          <td id="L4219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4219"></td>
          <td id="LC4219" class="blob-code blob-code-inner js-file-line">        loc_G_P_t <span class="pl-k">=</span> <span class="pl-k">dot_product</span>(dum_vec_D, dum_EFPQ_P)<span class="pl-k">+</span>dum_g_P</td>
        </tr>
        <tr>
          <td id="L4220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4220"></td>
          <td id="LC4220" class="blob-code blob-code-inner js-file-line">        loc_dG_P_t <span class="pl-k">=</span> <span class="pl-k">dot_product</span>(dum_vec_D,dum_dEFPQdz_P)<span class="pl-k">+</span>dum_dgdz_P</td>
        </tr>
        <tr>
          <td id="L4221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4221"></td>
          <td id="LC4221" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4222"></td>
          <td id="LC4222" class="blob-code blob-code-inner js-file-line">        loc_EFPQ_M_t <span class="pl-k">=</span> <span class="pl-k">matmul</span>(<span class="pl-k">transpose</span>(dum_mat_C), dum_EFPQ_M)</td>
        </tr>
        <tr>
          <td id="L4223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4223"></td>
          <td id="LC4223" class="blob-code blob-code-inner js-file-line">        loc_dEFPQ_M_t <span class="pl-k">=</span> <span class="pl-k">matmul</span>(<span class="pl-k">transpose</span>(dum_mat_C), dum_dEFPQdz_M)</td>
        </tr>
        <tr>
          <td id="L4224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4224"></td>
          <td id="LC4224" class="blob-code blob-code-inner js-file-line">        loc_G_M_t <span class="pl-k">=</span> <span class="pl-k">dot_product</span>(dum_vec_D, dum_EFPQ_M) <span class="pl-k">+</span> dum_g_M</td>
        </tr>
        <tr>
          <td id="L4225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4225"></td>
          <td id="LC4225" class="blob-code blob-code-inner js-file-line">        loc_dG_M_t <span class="pl-k">=</span> <span class="pl-k">dot_product</span>(dum_vec_D,dum_dEFPQdz_M) <span class="pl-k">+</span> dum_dgdz_M</td>
        </tr>
        <tr>
          <td id="L4226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4226"></td>
          <td id="LC4226" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4227"></td>
          <td id="LC4227" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4228"></td>
          <td id="LC4228" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;IN sub_xformsoln_PO4_M &#39;</span></td>
        </tr>
        <tr>
          <td id="L4229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4229"></td>
          <td id="LC4229" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_EFPQ_P_t&#39;, loc_EFPQ_P_t</span></td>
        </tr>
        <tr>
          <td id="L4230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4230"></td>
          <td id="LC4230" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_dEFPQ_P_t&#39;, loc_dEFPQ_P_t</span></td>
        </tr>
        <tr>
          <td id="L4231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4231"></td>
          <td id="LC4231" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_G_P_t&#39;, loc_G_P_t</span></td>
        </tr>
        <tr>
          <td id="L4232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4232"></td>
          <td id="LC4232" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_dG_P_t&#39;, loc_dG_P_t</span></td>
        </tr>
        <tr>
          <td id="L4233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4233"></td>
          <td id="LC4233" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4234"></td>
          <td id="LC4234" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_EFPQ_M_t&#39;, loc_EFPQ_M_t</span></td>
        </tr>
        <tr>
          <td id="L4235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4235"></td>
          <td id="LC4235" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_dEFPQ_M_t&#39;, loc_dEFPQ_M_t</span></td>
        </tr>
        <tr>
          <td id="L4236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4236"></td>
          <td id="LC4236" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_G_M_t&#39;, loc_G_M_t</span></td>
        </tr>
        <tr>
          <td id="L4237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4237"></td>
          <td id="LC4237" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_dG_M_t&#39;, loc_dG_M_t</span></td>
        </tr>
        <tr>
          <td id="L4238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4238"></td>
          <td id="LC4238" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4239"></td>
          <td id="LC4239" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_xformsoln_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L4240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4240"></td>
          <td id="LC4240" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4241"></td>
          <td id="LC4241" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4242"></td>
          <td id="LC4242" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4243"></td>
          <td id="LC4243" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4244"></td>
          <td id="LC4244" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4245"></td>
          <td id="LC4245" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4246"></td>
          <td id="LC4246" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4247"></td>
          <td id="LC4247" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_solve2eqn_PO4_M</span>(<span class="pl-v">dum_mat_X</span>, <span class="pl-v">dum_vec_Y</span>, <span class="pl-v">dum_A</span>, <span class="pl-v">dum_B</span>, <span class="pl-v">dum_C</span>, <span class="pl-v">dum_dim</span>)</td>
        </tr>
        <tr>
          <td id="L4248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4248"></td>
          <td id="LC4248" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4249"></td>
          <td id="LC4249" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Find solution of</span></td>
        </tr>
        <tr>
          <td id="L4250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4250"></td>
          <td id="LC4250" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | x1  .  . x4|  |A|     | y1 |</span></td>
        </tr>
        <tr>
          <td id="L4251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4251"></td>
          <td id="LC4251" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> |     .      |  |B|     | y2 |</span></td>
        </tr>
        <tr>
          <td id="L4252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4252"></td>
          <td id="LC4252" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> |       .    |  |C|   = | y3 |</span></td>
        </tr>
        <tr>
          <td id="L4253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4253"></td>
          <td id="LC4253" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> | .       x16|  |D|     | y4 |</span></td>
        </tr>
        <tr>
          <td id="L4254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4254"></td>
          <td id="LC4254" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span>, <span class="pl-k">intent</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_dim                             <span class="pl-c"><span class="pl-c">!</span> dim of input matrix to inverse</span></td>
        </tr>
        <tr>
          <td id="L4255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4255"></td>
          <td id="LC4255" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim,<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span> dum_mat_X</td>
        </tr>
        <tr>
          <td id="L4256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4256"></td>
          <td id="LC4256" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim), <span class="pl-k">intent</span>(<span class="pl-k">in</span>) <span class="pl-k">::</span>  dum_vec_Y</td>
        </tr>
        <tr>
          <td id="L4257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4257"></td>
          <td id="LC4257" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">INOUT</span>) <span class="pl-k">::</span> dum_A, dum_B, dum_C</td>
        </tr>
        <tr>
          <td id="L4258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4258"></td>
          <td id="LC4258" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4259"></td>
          <td id="LC4259" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variable</span></td>
        </tr>
        <tr>
          <td id="L4260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4260"></td>
          <td id="LC4260" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim,<span class="pl-c1">1</span>:dum_dim) <span class="pl-k">::</span> loc_mat_X, loc_inv_mat_X</td>
        </tr>
        <tr>
          <td id="L4261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4261"></td>
          <td id="LC4261" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:dum_dim) <span class="pl-k">::</span> loc_vec_Z</td>
        </tr>
        <tr>
          <td id="L4262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4262"></td>
          <td id="LC4262" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> save matrix locally, as the original matrix dum_mat_X(4,4) will be destroyed during the calculation</span></td>
        </tr>
        <tr>
          <td id="L4263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4263"></td>
          <td id="LC4263" class="blob-code blob-code-inner js-file-line">        loc_mat_X <span class="pl-k">=</span> dum_mat_X</td>
        </tr>
        <tr>
          <td id="L4264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4264"></td>
          <td id="LC4264" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate loc_mat_X^{-1}</span></td>
        </tr>
        <tr>
          <td id="L4265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4265"></td>
          <td id="LC4265" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">call</span> sub_inverse(loc_mat_X,loc_inv_mat_X,dum_dim)</td>
        </tr>
        <tr>
          <td id="L4266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4266"></td>
          <td id="LC4266" class="blob-code blob-code-inner js-file-line">        loc_vec_Z <span class="pl-k">=</span> <span class="pl-k">matmul</span>(loc_inv_mat_X, dum_vec_Y)</td>
        </tr>
        <tr>
          <td id="L4267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4267"></td>
          <td id="LC4267" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4268"></td>
          <td id="LC4268" class="blob-code blob-code-inner js-file-line">        dum_A <span class="pl-k">=</span> loc_vec_Z(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L4269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4269"></td>
          <td id="LC4269" class="blob-code blob-code-inner js-file-line">        dum_B <span class="pl-k">=</span> loc_vec_Z(<span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L4270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4270"></td>
          <td id="LC4270" class="blob-code blob-code-inner js-file-line">        dum_C <span class="pl-k">=</span> loc_vec_Z(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L4271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4271"></td>
          <td id="LC4271" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4272"></td>
          <td id="LC4272" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; IN SOLVE2EQN_PO4_M &#39;</span></td>
        </tr>
        <tr>
          <td id="L4273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4273"></td>
          <td id="LC4273" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_A &#39;, dum_A</span></td>
        </tr>
        <tr>
          <td id="L4274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4274"></td>
          <td id="LC4274" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_B&#39;, dum_B</span></td>
        </tr>
        <tr>
          <td id="L4275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4275"></td>
          <td id="LC4275" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_C&#39;, dum_C</span></td>
        </tr>
        <tr>
          <td id="L4276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4276"></td>
          <td id="LC4276" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4277"></td>
          <td id="LC4277" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_solve2eqn_PO4_M</span></td>
        </tr>
        <tr>
          <td id="L4278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4278"></td>
          <td id="LC4278" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4279"></td>
          <td id="LC4279" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4280"></td>
          <td id="LC4280" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4281"></td>
          <td id="LC4281" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4282"></td>
          <td id="LC4282" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4283"></td>
          <td id="LC4283" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4284"></td>
          <td id="LC4284" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4285"></td>
          <td id="LC4285" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">subroutine</span> <span class="pl-en">sub_inverse</span>(<span class="pl-v">a</span>, <span class="pl-v">c</span>,<span class="pl-v">n</span>)</td>
        </tr>
        <tr>
          <td id="L4286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4286"></td>
          <td id="LC4286" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>============================================================</span></td>
        </tr>
        <tr>
          <td id="L4287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4287"></td>
          <td id="LC4287" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Inverse matrix</span></td>
        </tr>
        <tr>
          <td id="L4288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4288"></td>
          <td id="LC4288" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Method: Based on Doolittle LU factorization for Ax=b</span></td>
        </tr>
        <tr>
          <td id="L4289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4289"></td>
          <td id="LC4289" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Alex G. December 2009</span></td>
        </tr>
        <tr>
          <td id="L4290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4290"></td>
          <td id="LC4290" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!-</span>----------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4291"></td>
          <td id="LC4291" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> input ...</span></td>
        </tr>
        <tr>
          <td id="L4292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4292"></td>
          <td id="LC4292" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> a(n,n) - array of coefficients for matrix A</span></td>
        </tr>
        <tr>
          <td id="L4293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4293"></td>
          <td id="LC4293" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> n      - dimension</span></td>
        </tr>
        <tr>
          <td id="L4294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4294"></td>
          <td id="LC4294" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> output ...</span></td>
        </tr>
        <tr>
          <td id="L4295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4295"></td>
          <td id="LC4295" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> c(n,n) - inverse matrix of A</span></td>
        </tr>
        <tr>
          <td id="L4296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4296"></td>
          <td id="LC4296" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> comments ...</span></td>
        </tr>
        <tr>
          <td id="L4297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4297"></td>
          <td id="LC4297" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> the original matrix a(n,n) will be destroyed</span></td>
        </tr>
        <tr>
          <td id="L4298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4298"></td>
          <td id="LC4298" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> during the calculation</span></td>
        </tr>
        <tr>
          <td id="L4299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4299"></td>
          <td id="LC4299" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>===========================================================</span></td>
        </tr>
        <tr>
          <td id="L4300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4300"></td>
          <td id="LC4300" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">implicit none</span></td>
        </tr>
        <tr>
          <td id="L4301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4301"></td>
          <td id="LC4301" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> n</td>
        </tr>
        <tr>
          <td id="L4302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4302"></td>
          <td id="LC4302" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:n,<span class="pl-c1">1</span>:n) <span class="pl-k">::</span> a, c</td>
        </tr>
        <tr>
          <td id="L4303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4303"></td>
          <td id="LC4303" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4304"></td>
          <td id="LC4304" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        ! local variables</span></td>
        </tr>
        <tr>
          <td id="L4305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4305"></td>
          <td id="LC4305" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        double precision a(n,n), c(n,n)</span></td>
        </tr>
        <tr>
          <td id="L4306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4306"></td>
          <td id="LC4306" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:n,<span class="pl-c1">1</span>:n) <span class="pl-k">::</span> L, U</td>
        </tr>
        <tr>
          <td id="L4307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4307"></td>
          <td id="LC4307" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>, <span class="pl-k">dimension</span> (<span class="pl-c1">1</span>:n) <span class="pl-k">::</span> b, d, x</td>
        </tr>
        <tr>
          <td id="L4308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4308"></td>
          <td id="LC4308" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> coeff</td>
        </tr>
        <tr>
          <td id="L4309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4309"></td>
          <td id="LC4309" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        double precision a(n,n), c(n,n)</span></td>
        </tr>
        <tr>
          <td id="L4310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4310"></td>
          <td id="LC4310" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        double precision L(n,n), U(n,n), b(n), d(n), x(n)</span></td>
        </tr>
        <tr>
          <td id="L4311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4311"></td>
          <td id="LC4311" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        double precision coeff</span></td>
        </tr>
        <tr>
          <td id="L4312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4312"></td>
          <td id="LC4312" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">integer</span> i, j, k</td>
        </tr>
        <tr>
          <td id="L4313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4313"></td>
          <td id="LC4313" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4314"></td>
          <td id="LC4314" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        ! DH: Cast input real to double precision</span></td>
        </tr>
        <tr>
          <td id="L4315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4315"></td>
          <td id="LC4315" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        a = dble(dum_a)</span></td>
        </tr>
        <tr>
          <td id="L4316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4316"></td>
          <td id="LC4316" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        c = dble(dum_c)</span></td>
        </tr>
        <tr>
          <td id="L4317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4317"></td>
          <td id="LC4317" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4318"></td>
          <td id="LC4318" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> step 0: initialization for matrices L and U and b</span></td>
        </tr>
        <tr>
          <td id="L4319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4319"></td>
          <td id="LC4319" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Fortran 90/95 aloows such operations on matrices</span></td>
        </tr>
        <tr>
          <td id="L4320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4320"></td>
          <td id="LC4320" class="blob-code blob-code-inner js-file-line">        L<span class="pl-k">=</span><span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L4321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4321"></td>
          <td id="LC4321" class="blob-code blob-code-inner js-file-line">        U<span class="pl-k">=</span><span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L4322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4322"></td>
          <td id="LC4322" class="blob-code blob-code-inner js-file-line">        b<span class="pl-k">=</span><span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L4323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4323"></td>
          <td id="LC4323" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4324"></td>
          <td id="LC4324" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> step 1: forward elimination</span></td>
        </tr>
        <tr>
          <td id="L4325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4325"></td>
          <td id="LC4325" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">do</span> k<span class="pl-k">=</span><span class="pl-c1">1</span>, n<span class="pl-c1">-1</span></td>
        </tr>
        <tr>
          <td id="L4326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4326"></td>
          <td id="LC4326" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> i<span class="pl-k">=</span>k<span class="pl-c1">+1</span>,n</td>
        </tr>
        <tr>
          <td id="L4327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4327"></td>
          <td id="LC4327" class="blob-code blob-code-inner js-file-line">                coeff<span class="pl-k">=</span>a(i,k)<span class="pl-k">/</span>(a(k,k) <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4328"></td>
          <td id="LC4328" class="blob-code blob-code-inner js-file-line">                L(i,k) <span class="pl-k">=</span> coeff</td>
        </tr>
        <tr>
          <td id="L4329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4329"></td>
          <td id="LC4329" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">do</span> j<span class="pl-k">=</span>k<span class="pl-c1">+1</span>,n</td>
        </tr>
        <tr>
          <td id="L4330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4330"></td>
          <td id="LC4330" class="blob-code blob-code-inner js-file-line">                    a(i,j) <span class="pl-k">=</span> a(i,j)<span class="pl-k">-</span>coeff<span class="pl-k">*</span>a(k,j)</td>
        </tr>
        <tr>
          <td id="L4331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4331"></td>
          <td id="LC4331" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4332"></td>
          <td id="LC4332" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4333"></td>
          <td id="LC4333" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4334"></td>
          <td id="LC4334" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4335"></td>
          <td id="LC4335" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Step 2: prepare L and U matrices</span></td>
        </tr>
        <tr>
          <td id="L4336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4336"></td>
          <td id="LC4336" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> L matrix is a matrix of the elimination coefficient</span></td>
        </tr>
        <tr>
          <td id="L4337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4337"></td>
          <td id="LC4337" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> + the diagonal elements are 1.0</span></td>
        </tr>
        <tr>
          <td id="L4338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4338"></td>
          <td id="LC4338" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">do</span> i<span class="pl-k">=</span><span class="pl-c1">1</span>,n</td>
        </tr>
        <tr>
          <td id="L4339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4339"></td>
          <td id="LC4339" class="blob-code blob-code-inner js-file-line">            L(i,i) <span class="pl-k">=</span> <span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L4340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4340"></td>
          <td id="LC4340" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4341"></td>
          <td id="LC4341" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> U matrix is the upper triangular part of A</span></td>
        </tr>
        <tr>
          <td id="L4342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4342"></td>
          <td id="LC4342" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">do</span> j<span class="pl-k">=</span><span class="pl-c1">1</span>,n</td>
        </tr>
        <tr>
          <td id="L4343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4343"></td>
          <td id="LC4343" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> i<span class="pl-k">=</span><span class="pl-c1">1</span>,j</td>
        </tr>
        <tr>
          <td id="L4344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4344"></td>
          <td id="LC4344" class="blob-code blob-code-inner js-file-line">                U(i,j) <span class="pl-k">=</span> a(i,j)</td>
        </tr>
        <tr>
          <td id="L4345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4345"></td>
          <td id="LC4345" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4346"></td>
          <td id="LC4346" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4347"></td>
          <td id="LC4347" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4348"></td>
          <td id="LC4348" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Step 3: compute columns of the inverse matrix C</span></td>
        </tr>
        <tr>
          <td id="L4349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4349"></td>
          <td id="LC4349" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">do</span> k<span class="pl-k">=</span><span class="pl-c1">1</span>,n</td>
        </tr>
        <tr>
          <td id="L4350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4350"></td>
          <td id="LC4350" class="blob-code blob-code-inner js-file-line">            b(k)<span class="pl-k">=</span><span class="pl-c1">1.0</span></td>
        </tr>
        <tr>
          <td id="L4351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4351"></td>
          <td id="LC4351" class="blob-code blob-code-inner js-file-line">            d(<span class="pl-c1">1</span>) <span class="pl-k">=</span> b(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L4352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4352"></td>
          <td id="LC4352" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Step 3a: Solve Ld=b using the forward substitution</span></td>
        </tr>
        <tr>
          <td id="L4353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4353"></td>
          <td id="LC4353" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> i<span class="pl-k">=</span><span class="pl-c1">2</span>,n</td>
        </tr>
        <tr>
          <td id="L4354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4354"></td>
          <td id="LC4354" class="blob-code blob-code-inner js-file-line">                d(i)<span class="pl-k">=</span>b(i)</td>
        </tr>
        <tr>
          <td id="L4355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4355"></td>
          <td id="LC4355" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">do</span> j<span class="pl-k">=</span><span class="pl-c1">1</span>,i<span class="pl-c1">-1</span></td>
        </tr>
        <tr>
          <td id="L4356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4356"></td>
          <td id="LC4356" class="blob-code blob-code-inner js-file-line">                    d(i) <span class="pl-k">=</span> d(i) <span class="pl-k">-</span> L(i,j)<span class="pl-k">*</span>d(j)</td>
        </tr>
        <tr>
          <td id="L4357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4357"></td>
          <td id="LC4357" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4358"></td>
          <td id="LC4358" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4359"></td>
          <td id="LC4359" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Step 3b: Solve Ux=d using the back substitution</span></td>
        </tr>
        <tr>
          <td id="L4360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4360"></td>
          <td id="LC4360" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> DH: check for division by zero</span></td>
        </tr>
        <tr>
          <td id="L4361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4361"></td>
          <td id="LC4361" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            if(U(n,n) &gt; const_real_nullsmall) then</span></td>
        </tr>
        <tr>
          <td id="L4362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4362"></td>
          <td id="LC4362" class="blob-code blob-code-inner js-file-line">            x(n)<span class="pl-k">=</span>d(n)<span class="pl-k">/</span>(U(n,n)<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4363"></td>
          <td id="LC4363" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            else</span></td>
        </tr>
        <tr>
          <td id="L4364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4364"></td>
          <td id="LC4364" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                print*,&#39;U(n,n) small &#39;, U(n,n)</span></td>
        </tr>
        <tr>
          <td id="L4365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4365"></td>
          <td id="LC4365" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>                x(n)=d(n)/const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L4366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4366"></td>
          <td id="LC4366" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span>            end if</span></td>
        </tr>
        <tr>
          <td id="L4367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4367"></td>
          <td id="LC4367" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> i <span class="pl-k">=</span> n<span class="pl-c1">-1</span>,<span class="pl-c1">1</span>,<span class="pl-k">-</span><span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L4368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4368"></td>
          <td id="LC4368" class="blob-code blob-code-inner js-file-line">                x(i) <span class="pl-k">=</span> d(i)</td>
        </tr>
        <tr>
          <td id="L4369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4369"></td>
          <td id="LC4369" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">do</span> j<span class="pl-k">=</span>n,i<span class="pl-c1">+1</span>,<span class="pl-k">-</span><span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L4370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4370"></td>
          <td id="LC4370" class="blob-code blob-code-inner js-file-line">                    x(i)<span class="pl-k">=</span>x(i)<span class="pl-k">-</span>U(i,j)<span class="pl-k">*</span>x(j)</td>
        </tr>
        <tr>
          <td id="L4371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4371"></td>
          <td id="LC4371" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4372"></td>
          <td id="LC4372" class="blob-code blob-code-inner js-file-line">                x(i) <span class="pl-k">=</span> x(i)<span class="pl-k">/</span>(u(i,i) <span class="pl-k">+</span> const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4373"></td>
          <td id="LC4373" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4374"></td>
          <td id="LC4374" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">!</span> Step 3c: fill the solutions x(n) into column k of C</span></td>
        </tr>
        <tr>
          <td id="L4375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4375"></td>
          <td id="LC4375" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> i<span class="pl-k">=</span><span class="pl-c1">1</span>,n</td>
        </tr>
        <tr>
          <td id="L4376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4376"></td>
          <td id="LC4376" class="blob-code blob-code-inner js-file-line">                c(i,k) <span class="pl-k">=</span> x(i)</td>
        </tr>
        <tr>
          <td id="L4377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4377"></td>
          <td id="LC4377" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4378"></td>
          <td id="LC4378" class="blob-code blob-code-inner js-file-line">            b(k)<span class="pl-k">=</span><span class="pl-c1">0.0</span></td>
        </tr>
        <tr>
          <td id="L4379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4379"></td>
          <td id="LC4379" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end do</span></td>
        </tr>
        <tr>
          <td id="L4380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4380"></td>
          <td id="LC4380" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4381"></td>
          <td id="LC4381" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        ! DH cast back to real</span></td>
        </tr>
        <tr>
          <td id="L4382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4382"></td>
          <td id="LC4382" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>        dum_c = real(c)</span></td>
        </tr>
        <tr>
          <td id="L4383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4383"></td>
          <td id="LC4383" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">subroutine</span><span class="pl-en"> sub_inverse</span></td>
        </tr>
        <tr>
          <td id="L4384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4384"></td>
          <td id="LC4384" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4385"></td>
          <td id="LC4385" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4386"></td>
          <td id="LC4386" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span> ****************************************************************************************************************************** !</span></td>
        </tr>
        <tr>
          <td id="L4387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4387"></td>
          <td id="LC4387" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4388"></td>
          <td id="LC4388" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>   *****************************************************************</span></td>
        </tr>
        <tr>
          <td id="L4389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4389"></td>
          <td id="LC4389" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!-</span>-----------------------------------------------------------------------------------</span></td>
        </tr>
        <tr>
          <td id="L4390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4390"></td>
          <td id="LC4390" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4391"></td>
          <td id="LC4391" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>!!! TODO: better put outside module, in kind of collection of auxiliary functions</span></td>
        </tr>
        <tr>
          <td id="L4392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4392"></td>
          <td id="LC4392" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4393"></td>
          <td id="LC4393" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zbrent</span>(<span class="pl-v">func</span>,<span class="pl-v">x1</span>,<span class="pl-v">x2</span>,<span class="pl-v">tol</span>)</td>
        </tr>
        <tr>
          <td id="L4394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4394"></td>
          <td id="LC4394" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4395"></td>
          <td id="LC4395" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate root of func in the interval [x1,x2]</span></td>
        </tr>
        <tr>
          <td id="L4396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4396"></td>
          <td id="LC4396" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4397"></td>
          <td id="LC4397" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span> ITMAX</td>
        </tr>
        <tr>
          <td id="L4398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4398"></td>
          <td id="LC4398" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> FUN_zbrent,tol,x1,x2,func,EPS</td>
        </tr>
        <tr>
          <td id="L4399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4399"></td>
          <td id="LC4399" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">EXTERNAL</span> func</td>
        </tr>
        <tr>
          <td id="L4400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4400"></td>
          <td id="LC4400" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">PARAMETER</span> (ITMAX<span class="pl-k">=</span><span class="pl-c1">100</span>,EPS<span class="pl-k">=</span><span class="pl-c1">3.e-8</span>)</td>
        </tr>
        <tr>
          <td id="L4401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4401"></td>
          <td id="LC4401" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">INTEGER</span> iter</td>
        </tr>
        <tr>
          <td id="L4402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4402"></td>
          <td id="LC4402" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> a,b,c,d,e,fa,fb,fc,p,q,r,s,tol1,xm</td>
        </tr>
        <tr>
          <td id="L4403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4403"></td>
          <td id="LC4403" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4404"></td>
          <td id="LC4404" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4405"></td>
          <td id="LC4405" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    print*,&#39;++++++++++++ START FUN_zbrent ++++++++++++++++ &#39;</span></td>
        </tr>
        <tr>
          <td id="L4406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4406"></td>
          <td id="LC4406" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4407"></td>
          <td id="LC4407" class="blob-code blob-code-inner js-file-line">        a<span class="pl-k">=</span>x1</td>
        </tr>
        <tr>
          <td id="L4408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4408"></td>
          <td id="LC4408" class="blob-code blob-code-inner js-file-line">        b<span class="pl-k">=</span>x2</td>
        </tr>
        <tr>
          <td id="L4409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4409"></td>
          <td id="LC4409" class="blob-code blob-code-inner js-file-line">        fa<span class="pl-k">=</span>func(a)</td>
        </tr>
        <tr>
          <td id="L4410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4410"></td>
          <td id="LC4410" class="blob-code blob-code-inner js-file-line">        fb<span class="pl-k">=</span>func(b)</td>
        </tr>
        <tr>
          <td id="L4411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4411"></td>
          <td id="LC4411" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>was      if((fa.gt.0..and.fb.gt.0.).or.(fa.lt.0..and.fb.lt.0.))pause</span></td>
        </tr>
        <tr>
          <td id="L4412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4412"></td>
          <td id="LC4412" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>was     *&#39;root must be bracketed for FUN_zbrent&#39;</span></td>
        </tr>
        <tr>
          <td id="L4413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4413"></td>
          <td id="LC4413" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">IF</span>((fa<span class="pl-k">.gt.</span><span class="pl-c1">0</span>.<span class="pl-k">.and.</span>fb<span class="pl-k">.gt.</span><span class="pl-c1">0</span>.)<span class="pl-k">.or.</span>(fa<span class="pl-k">.lt.</span><span class="pl-c1">0</span>.<span class="pl-k">.and.</span>fb<span class="pl-k">.lt.</span><span class="pl-c1">0</span>.))<span class="pl-k">THEN</span></td>
        </tr>
        <tr>
          <td id="L4414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4414"></td>
          <td id="LC4414" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>root must be bracketed for FUN_zbrent<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L4415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4415"></td>
          <td id="LC4415" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">STOP</span></td>
        </tr>
        <tr>
          <td id="L4416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4416"></td>
          <td id="LC4416" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">ELSE</span></td>
        </tr>
        <tr>
          <td id="L4417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4417"></td>
          <td id="LC4417" class="blob-code blob-code-inner js-file-line">            c<span class="pl-k">=</span>b</td>
        </tr>
        <tr>
          <td id="L4418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4418"></td>
          <td id="LC4418" class="blob-code blob-code-inner js-file-line">            fc<span class="pl-k">=</span>fb</td>
        </tr>
        <tr>
          <td id="L4419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4419"></td>
          <td id="LC4419" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">do</span> <span class="pl-c1">11</span> iter<span class="pl-k">=</span><span class="pl-c1">1</span>,ITMAX</td>
        </tr>
        <tr>
          <td id="L4420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4420"></td>
          <td id="LC4420" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>((fb<span class="pl-k">.gt.</span><span class="pl-c1">0</span>.<span class="pl-k">.and.</span>fc<span class="pl-k">.gt.</span><span class="pl-c1">0</span>.)<span class="pl-k">.or.</span>(fb<span class="pl-k">.lt.</span><span class="pl-c1">0</span>.<span class="pl-k">.and.</span>fc<span class="pl-k">.lt.</span><span class="pl-c1">0</span>.))<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4421"></td>
          <td id="LC4421" class="blob-code blob-code-inner js-file-line">                    c<span class="pl-k">=</span>a</td>
        </tr>
        <tr>
          <td id="L4422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4422"></td>
          <td id="LC4422" class="blob-code blob-code-inner js-file-line">                    fc<span class="pl-k">=</span>fa</td>
        </tr>
        <tr>
          <td id="L4423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4423"></td>
          <td id="LC4423" class="blob-code blob-code-inner js-file-line">                    d<span class="pl-k">=</span>b<span class="pl-k">-</span>a</td>
        </tr>
        <tr>
          <td id="L4424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4424"></td>
          <td id="LC4424" class="blob-code blob-code-inner js-file-line">                    e<span class="pl-k">=</span>d</td>
        </tr>
        <tr>
          <td id="L4425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4425"></td>
          <td id="LC4425" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4426"></td>
          <td id="LC4426" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(<span class="pl-k">abs</span>(fc)<span class="pl-k">.lt.</span><span class="pl-k">abs</span>(fb)) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4427"></td>
          <td id="LC4427" class="blob-code blob-code-inner js-file-line">                    a<span class="pl-k">=</span>b</td>
        </tr>
        <tr>
          <td id="L4428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4428"></td>
          <td id="LC4428" class="blob-code blob-code-inner js-file-line">                    b<span class="pl-k">=</span>c</td>
        </tr>
        <tr>
          <td id="L4429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4429"></td>
          <td id="LC4429" class="blob-code blob-code-inner js-file-line">                    c<span class="pl-k">=</span>a</td>
        </tr>
        <tr>
          <td id="L4430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4430"></td>
          <td id="LC4430" class="blob-code blob-code-inner js-file-line">                    fa<span class="pl-k">=</span>fb</td>
        </tr>
        <tr>
          <td id="L4431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4431"></td>
          <td id="LC4431" class="blob-code blob-code-inner js-file-line">                    fb<span class="pl-k">=</span>fc</td>
        </tr>
        <tr>
          <td id="L4432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4432"></td>
          <td id="LC4432" class="blob-code blob-code-inner js-file-line">                    fc<span class="pl-k">=</span>fa</td>
        </tr>
        <tr>
          <td id="L4433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4433"></td>
          <td id="LC4433" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4434"></td>
          <td id="LC4434" class="blob-code blob-code-inner js-file-line">                tol1<span class="pl-k">=</span><span class="pl-c1">2</span>.<span class="pl-k">*</span>EPS<span class="pl-k">*</span><span class="pl-k">abs</span>(b)<span class="pl-k">+</span><span class="pl-c1">0.5</span><span class="pl-k">*</span>tol</td>
        </tr>
        <tr>
          <td id="L4435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4435"></td>
          <td id="LC4435" class="blob-code blob-code-inner js-file-line">                xm<span class="pl-k">=</span>.<span class="pl-c1">5</span><span class="pl-k">*</span>(c<span class="pl-k">-</span>b)</td>
        </tr>
        <tr>
          <td id="L4436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4436"></td>
          <td id="LC4436" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(<span class="pl-k">abs</span>(xm)<span class="pl-k">.le.</span>tol1 <span class="pl-k">.or.</span> fb<span class="pl-k">.eq.</span><span class="pl-c1">0</span>.)<span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4437"></td>
          <td id="LC4437" class="blob-code blob-code-inner js-file-line">                    FUN_zbrent<span class="pl-k">=</span>b</td>
        </tr>
        <tr>
          <td id="L4438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4438"></td>
          <td id="LC4438" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">return</span></td>
        </tr>
        <tr>
          <td id="L4439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4439"></td>
          <td id="LC4439" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4440"></td>
          <td id="LC4440" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(<span class="pl-k">abs</span>(e)<span class="pl-k">.ge.</span>tol1 <span class="pl-k">.and.</span> <span class="pl-k">abs</span>(fa)<span class="pl-k">.gt.</span><span class="pl-k">abs</span>(fb)) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4441"></td>
          <td id="LC4441" class="blob-code blob-code-inner js-file-line">                    s<span class="pl-k">=</span>fb<span class="pl-k">/</span>fa</td>
        </tr>
        <tr>
          <td id="L4442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4442"></td>
          <td id="LC4442" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(a<span class="pl-k">.eq.</span>c) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4443"></td>
          <td id="LC4443" class="blob-code blob-code-inner js-file-line">                        p<span class="pl-k">=</span><span class="pl-c1">2</span>.<span class="pl-k">*</span>xm<span class="pl-k">*</span>s</td>
        </tr>
        <tr>
          <td id="L4444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4444"></td>
          <td id="LC4444" class="blob-code blob-code-inner js-file-line">                        q<span class="pl-k">=</span><span class="pl-c1">1</span>.<span class="pl-k">-</span>s</td>
        </tr>
        <tr>
          <td id="L4445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4445"></td>
          <td id="LC4445" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4446"></td>
          <td id="LC4446" class="blob-code blob-code-inner js-file-line">                        q<span class="pl-k">=</span>fa<span class="pl-k">/</span>fc</td>
        </tr>
        <tr>
          <td id="L4447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4447"></td>
          <td id="LC4447" class="blob-code blob-code-inner js-file-line">                        r<span class="pl-k">=</span>fb<span class="pl-k">/</span>fc</td>
        </tr>
        <tr>
          <td id="L4448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4448"></td>
          <td id="LC4448" class="blob-code blob-code-inner js-file-line">                        p<span class="pl-k">=</span>s<span class="pl-k">*</span>(<span class="pl-c1">2</span>.<span class="pl-k">*</span>xm<span class="pl-k">*</span>q<span class="pl-k">*</span>(q<span class="pl-k">-</span>r)<span class="pl-k">-</span>(b<span class="pl-k">-</span>a)<span class="pl-k">*</span>(r<span class="pl-c1">-1</span>.))</td>
        </tr>
        <tr>
          <td id="L4449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4449"></td>
          <td id="LC4449" class="blob-code blob-code-inner js-file-line">                        q<span class="pl-k">=</span>(q<span class="pl-c1">-1</span>.)<span class="pl-k">*</span>(r<span class="pl-c1">-1</span>.)<span class="pl-k">*</span>(s<span class="pl-c1">-1</span>.)</td>
        </tr>
        <tr>
          <td id="L4450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4450"></td>
          <td id="LC4450" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4451"></td>
          <td id="LC4451" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(p<span class="pl-k">.gt.</span><span class="pl-c1">0</span>.) q<span class="pl-k">=-</span>q</td>
        </tr>
        <tr>
          <td id="L4452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4452"></td>
          <td id="LC4452" class="blob-code blob-code-inner js-file-line">                    p<span class="pl-k">=</span><span class="pl-k">abs</span>(p)</td>
        </tr>
        <tr>
          <td id="L4453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4453"></td>
          <td id="LC4453" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span>(<span class="pl-c1">2</span>.<span class="pl-k">*</span>p <span class="pl-k">.lt.</span> <span class="pl-k">min</span>(<span class="pl-c1">3</span>.<span class="pl-k">*</span>xm<span class="pl-k">*</span>q<span class="pl-k">-</span><span class="pl-k">abs</span>(tol1<span class="pl-k">*</span>q),<span class="pl-k">abs</span>(e<span class="pl-k">*</span>q))) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4454"></td>
          <td id="LC4454" class="blob-code blob-code-inner js-file-line">                        e<span class="pl-k">=</span>d</td>
        </tr>
        <tr>
          <td id="L4455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4455"></td>
          <td id="LC4455" class="blob-code blob-code-inner js-file-line">                        d<span class="pl-k">=</span>p<span class="pl-k">/</span>q</td>
        </tr>
        <tr>
          <td id="L4456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4456"></td>
          <td id="LC4456" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4457"></td>
          <td id="LC4457" class="blob-code blob-code-inner js-file-line">                        d<span class="pl-k">=</span>xm</td>
        </tr>
        <tr>
          <td id="L4458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4458"></td>
          <td id="LC4458" class="blob-code blob-code-inner js-file-line">                        e<span class="pl-k">=</span>d</td>
        </tr>
        <tr>
          <td id="L4459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4459"></td>
          <td id="LC4459" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4460"></td>
          <td id="LC4460" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4461"></td>
          <td id="LC4461" class="blob-code blob-code-inner js-file-line">                    d<span class="pl-k">=</span>xm</td>
        </tr>
        <tr>
          <td id="L4462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4462"></td>
          <td id="LC4462" class="blob-code blob-code-inner js-file-line">                    e<span class="pl-k">=</span>d</td>
        </tr>
        <tr>
          <td id="L4463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4463"></td>
          <td id="LC4463" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4464"></td>
          <td id="LC4464" class="blob-code blob-code-inner js-file-line">                a<span class="pl-k">=</span>b</td>
        </tr>
        <tr>
          <td id="L4465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4465"></td>
          <td id="LC4465" class="blob-code blob-code-inner js-file-line">                fa<span class="pl-k">=</span>fb</td>
        </tr>
        <tr>
          <td id="L4466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4466"></td>
          <td id="LC4466" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(<span class="pl-k">abs</span>(d) <span class="pl-k">.gt.</span> tol1) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4467"></td>
          <td id="LC4467" class="blob-code blob-code-inner js-file-line">                    b<span class="pl-k">=</span>b<span class="pl-k">+</span>d</td>
        </tr>
        <tr>
          <td id="L4468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4468"></td>
          <td id="LC4468" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4469"></td>
          <td id="LC4469" class="blob-code blob-code-inner js-file-line">                    b<span class="pl-k">=</span>b<span class="pl-k">+</span><span class="pl-k">sign</span>(tol1,xm)</td>
        </tr>
        <tr>
          <td id="L4470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4470"></td>
          <td id="LC4470" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">endif</span></td>
        </tr>
        <tr>
          <td id="L4471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4471"></td>
          <td id="LC4471" class="blob-code blob-code-inner js-file-line">                fb<span class="pl-k">=</span>func(b)</td>
        </tr>
        <tr>
          <td id="L4472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4472"></td>
          <td id="LC4472" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">11</span>          <span class="pl-k">continue</span></td>
        </tr>
        <tr>
          <td id="L4473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4473"></td>
          <td id="LC4473" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">END IF</span></td>
        </tr>
        <tr>
          <td id="L4474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4474"></td>
          <td id="LC4474" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> was      pause &#39;FUN_zbrent exceeding maximum iterations&#39;</span></td>
        </tr>
        <tr>
          <td id="L4475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4475"></td>
          <td id="LC4475" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">print</span><span class="pl-k">*</span>,<span class="pl-s"><span class="pl-pds">&#39;</span>FUN_zbrent exceeding maximum iterations<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L4476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4476"></td>
          <td id="LC4476" class="blob-code blob-code-inner js-file-line">        FUN_zbrent<span class="pl-k">=</span>b</td>
        </tr>
        <tr>
          <td id="L4477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4477"></td>
          <td id="LC4477" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">STOP</span></td>
        </tr>
        <tr>
          <td id="L4478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4478"></td>
          <td id="LC4478" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4479"></td>
          <td id="LC4479" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">return</span></td>
        </tr>
        <tr>
          <td id="L4480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4480"></td>
          <td id="LC4480" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4481"></td>
          <td id="LC4481" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">END</span> <span class="pl-k">FUNCTION</span> <span class="pl-en">FUN_zbrent</span></td>
        </tr>
        <tr>
          <td id="L4482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4482"></td>
          <td id="LC4482" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4483"></td>
          <td id="LC4483" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4484"></td>
          <td id="LC4484" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zTOC_2Diffcoeff</span>(<span class="pl-v">dum_POC1_flux_swi</span>, <span class="pl-v">dum_POC2_flux_swi</span>, <span class="pl-v">dum_sed_pres_fracC</span>)</td>
        </tr>
        <tr>
          <td id="L4485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4485"></td>
          <td id="LC4485" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> NOT USED IN CURRENT VERSION</span></td>
        </tr>
        <tr>
          <td id="L4486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4486"></td>
          <td id="LC4486" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> THIS ROUTINE USES A SMALL DIFFUSION COEFFICIENT FOR THE UNBIOTURBATED LAYER TO DEAL WITH NUMERICAL INACCURACIES!</span></td>
        </tr>
        <tr>
          <td id="L4487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4487"></td>
          <td id="LC4487" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L4488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4488"></td>
          <td id="LC4488" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4489"></td>
          <td id="LC4489" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   calculate benthic burial/recycling fluxes (see documentation for details!)</span></td>
        </tr>
        <tr>
          <td id="L4490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4490"></td>
          <td id="LC4490" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L4491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4491"></td>
          <td id="LC4491" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4492"></td>
          <td id="LC4492" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   organic matter burial 2 fractions</span></td>
        </tr>
        <tr>
          <td id="L4493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4493"></td>
          <td id="LC4493" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4494"></td>
          <td id="LC4494" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L4495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4495"></td>
          <td id="LC4495" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_POC1_flux_swi, dum_POC2_flux_swi               <span class="pl-c"><span class="pl-c">!</span> POC flux at SWI   [mol/(cm2 yr)]</span></td>
        </tr>
        <tr>
          <td id="L4496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4496"></td>
          <td id="LC4496" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_pres_fracC                              <span class="pl-c"><span class="pl-c">!</span> POC concentrations at zinf</span></td>
        </tr>
        <tr>
          <td id="L4497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4497"></td>
          <td id="LC4497" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4498"></td>
          <td id="LC4498" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L4499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4499"></td>
          <td id="LC4499" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        real loc_POC1_conc_swi, dum_POC2_conc_swi                           ! POC concentration at SWI   [mol/cm3]</span></td>
        </tr>
        <tr>
          <td id="L4500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4500"></td>
          <td id="LC4500" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_POC1_conc_zinf, loc_POC2_conc_zinf</td>
        </tr>
        <tr>
          <td id="L4501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4501"></td>
          <td id="LC4501" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real aa11, bb11, aa21, A11, A21, aa12, bb12, aa22, A12, A22</span></td>
        </tr>
        <tr>
          <td id="L4502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4502"></td>
          <td id="LC4502" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> dC1dz, C1flx, dC2dz, C2flx, Cflx                             <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L4503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4503"></td>
          <td id="LC4503" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> F_TOC1, F_TOC2, F_TOC                                        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column</span></td>
        </tr>
        <tr>
          <td id="L4504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4504"></td>
          <td id="LC4504" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4505"></td>
          <td id="LC4505" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4506"></td>
          <td id="LC4506" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                print*,&#39; ------------------ START zTOC 2 diff coeffs---------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L4507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4507"></td>
          <td id="LC4507" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>                print*,&#39; DC2 &#39;, DC2</span></td>
        </tr>
        <tr>
          <td id="L4508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4508"></td>
          <td id="LC4508" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; sedimentation rate/burial velocity w = &#39;, w</span></td>
        </tr>
        <tr>
          <td id="L4509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4509"></td>
          <td id="LC4509" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4510"></td>
          <td id="LC4510" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Dom: Use this when comparing with MATLAB, here we use wt% of g -&gt; *1/12</span></td>
        </tr>
        <tr>
          <td id="L4511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4511"></td>
          <td id="LC4511" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        loc_POC1_conc_swi=0.01*dum_POC1_wtpct_swi/12.0*rho_sed              ! %TOC concentration frac1 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4512"></td>
          <td id="LC4512" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_POC2_conc_swi=0.01*dum_POC2_wtpct_swi/12.0*rho_sed              ! %TOC concentration frac2 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4513"></td>
          <td id="LC4513" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC1_conc_swi&#39;, char(9), loc_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4514"></td>
          <td id="LC4514" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;dum_POC2_conc_swi&#39;, char(9), dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4515"></td>
          <td id="LC4515" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4516"></td>
          <td id="LC4516" class="blob-code blob-code-inner js-file-line">        aa11 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4517"></td>
          <td id="LC4517" class="blob-code blob-code-inner js-file-line">        bb11 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4518"></td>
          <td id="LC4518" class="blob-code blob-code-inner js-file-line">        aa21 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC2<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC2)</td>
        </tr>
        <tr>
          <td id="L4519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4519"></td>
          <td id="LC4519" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4520"></td>
          <td id="LC4520" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;DC1, aa11, bb11, aa21 = &#39;, DC1, aa11, bb11, aa21</span></td>
        </tr>
        <tr>
          <td id="L4521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4521"></td>
          <td id="LC4521" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4522"></td>
          <td id="LC4522" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4523"></td>
          <td id="LC4523" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate TOC SWI concentration from flux</span></td>
        </tr>
        <tr>
          <td id="L4524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4524"></td>
          <td id="LC4524" class="blob-code blob-code-inner js-file-line">        dum_POC1_conc_swi <span class="pl-k">=</span> (dum_POC1_flux_swi<span class="pl-k">*</span>(<span class="pl-k">-</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L4525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4525"></td>
          <td id="LC4525" class="blob-code blob-code-inner js-file-line">        DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> DC1<span class="pl-k">*</span>bb11<span class="pl-k">*</span>aa11<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> w<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L4526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4526"></td>
          <td id="LC4526" class="blob-code blob-code-inner js-file-line">        w<span class="pl-k">*</span>por<span class="pl-k">*</span>aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>por<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))</td>
        </tr>
        <tr>
          <td id="L4527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4527"></td>
          <td id="LC4527" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_POC1_conc_swi = &#39;, dum_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4528"></td>
          <td id="LC4528" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4529"></td>
          <td id="LC4529" class="blob-code blob-code-inner js-file-line">        A11<span class="pl-k">=</span>((DC2<span class="pl-k">*</span>aa21<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb11)<span class="pl-k">*</span>(dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(DC1<span class="pl-k">*</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">-</span>DC2<span class="pl-k">*</span>aa21<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)))</td>
        </tr>
        <tr>
          <td id="L4530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4530"></td>
          <td id="LC4530" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(exp(aa21*zbio) &gt; const_real_nullsmall) then</span></td>
        </tr>
        <tr>
          <td id="L4531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4531"></td>
          <td id="LC4531" class="blob-code blob-code-inner js-file-line">        A21<span class="pl-k">=</span>(A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall/100000000)</span></td>
        </tr>
        <tr>
          <td id="L4532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4532"></td>
          <td id="LC4532" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        else</span></td>
        </tr>
        <tr>
          <td id="L4533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4533"></td>
          <td id="LC4533" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            A21=(A11*(exp(aa11*zbio)-exp(bb11*zbio))+dum_POC1_conc_swi*exp(bb11*zbio))/const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L4534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4534"></td>
          <td id="LC4534" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;in small exp(aa21*zbio)&#39;, +exp(aa21*zbio)</span></td>
        </tr>
        <tr>
          <td id="L4535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4535"></td>
          <td id="LC4535" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L4536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4536"></td>
          <td id="LC4536" class="blob-code blob-code-inner js-file-line">        aa12 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4537"></td>
          <td id="LC4537" class="blob-code blob-code-inner js-file-line">        bb12 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4538"></td>
          <td id="LC4538" class="blob-code blob-code-inner js-file-line">        aa22 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC2<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC2)</td>
        </tr>
        <tr>
          <td id="L4539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4539"></td>
          <td id="LC4539" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4540"></td>
          <td id="LC4540" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> calculate TOC SWI concentration from flux</span></td>
        </tr>
        <tr>
          <td id="L4541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4541"></td>
          <td id="LC4541" class="blob-code blob-code-inner js-file-line">        dum_POC2_conc_swi <span class="pl-k">=</span> (dum_POC2_flux_swi<span class="pl-k">*</span>(<span class="pl-k">-</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L4542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4542"></td>
          <td id="LC4542" class="blob-code blob-code-inner js-file-line">        DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> DC1<span class="pl-k">*</span>bb12<span class="pl-k">*</span>aa12<span class="pl-k">*</span>por<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> w<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio) <span class="pl-k">+</span> &amp;</td>
        </tr>
        <tr>
          <td id="L4543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4543"></td>
          <td id="LC4543" class="blob-code blob-code-inner js-file-line">        w<span class="pl-k">*</span>por<span class="pl-k">*</span>aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio) <span class="pl-k">-</span> w<span class="pl-k">*</span>por<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))</td>
        </tr>
        <tr>
          <td id="L4544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4544"></td>
          <td id="LC4544" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39;dum_POC2_conc_swi = &#39;, dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4545"></td>
          <td id="LC4545" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4546"></td>
          <td id="LC4546" class="blob-code blob-code-inner js-file-line">        A12<span class="pl-k">=</span>((DC2<span class="pl-k">*</span>aa22<span class="pl-k">-</span>DC1<span class="pl-k">*</span>bb12)<span class="pl-k">*</span>(dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)))<span class="pl-k">/</span>(DC1<span class="pl-k">*</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">-</span>DC2<span class="pl-k">*</span>aa22<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)))</td>
        </tr>
        <tr>
          <td id="L4547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4547"></td>
          <td id="LC4547" class="blob-code blob-code-inner js-file-line">        A22<span class="pl-k">=</span>(A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zbio)) <span class="pl-c"><span class="pl-c">!</span>+const_real_nullsmall/100000000)</span></td>
        </tr>
        <tr>
          <td id="L4548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4548"></td>
          <td id="LC4548" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4549"></td>
          <td id="LC4549" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!! no need for this as this is SWI concentration for z0 = 0!</span></td>
        </tr>
        <tr>
          <td id="L4550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4550"></td>
          <td id="LC4550" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    ! % Calculate concentration at z0</span></td>
        </tr>
        <tr>
          <td id="L4551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4551"></td>
          <td id="LC4551" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    if(z0&lt;=zbio) then</span></td>
        </tr>
        <tr>
          <td id="L4552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4552"></td>
          <td id="LC4552" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A11*(exp(aa11*z0)-exp(bb11*z0))+dum_POC1_conc_swi*exp(bb11*z0)</span></td>
        </tr>
        <tr>
          <td id="L4553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4553"></td>
          <td id="LC4553" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A12*(exp(aa12*z0)-exp(bb12*z0))+dum_POC2_conc_swi*exp(bb12*z0)</span></td>
        </tr>
        <tr>
          <td id="L4554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4554"></td>
          <td id="LC4554" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    else</span></td>
        </tr>
        <tr>
          <td id="L4555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4555"></td>
          <td id="LC4555" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A21*exp(aa21*z0)</span></td>
        </tr>
        <tr>
          <td id="L4556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4556"></td>
          <td id="LC4556" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A22*exp(aa22*z0)</span></td>
        </tr>
        <tr>
          <td id="L4557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4557"></td>
          <td id="LC4557" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    end if</span></td>
        </tr>
        <tr>
          <td id="L4558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4558"></td>
          <td id="LC4558" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    C = C1 + C2</span></td>
        </tr>
        <tr>
          <td id="L4559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4559"></td>
          <td id="LC4559" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!</span></td>
        </tr>
        <tr>
          <td id="L4560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4560"></td>
          <td id="LC4560" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39;C = C1 + C2 &#39;, C</span></td>
        </tr>
        <tr>
          <td id="L4561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4561"></td>
          <td id="LC4561" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4562"></td>
          <td id="LC4562" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4563"></td>
          <td id="LC4563" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L4564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4564"></td>
          <td id="LC4564" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(z0 &lt; zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4565"></td>
          <td id="LC4565" class="blob-code blob-code-inner js-file-line">            dC1dz <span class="pl-k">=</span>  A11<span class="pl-k">*</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L4566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4566"></td>
          <td id="LC4566" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC1dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC1_conc_swi)</td>
        </tr>
        <tr>
          <td id="L4567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4567"></td>
          <td id="LC4567" class="blob-code blob-code-inner js-file-line">            dC2dz <span class="pl-k">=</span>  A12<span class="pl-k">*</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L4568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4568"></td>
          <td id="LC4568" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC2dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC2_conc_swi)</td>
        </tr>
        <tr>
          <td id="L4569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4569"></td>
          <td id="LC4569" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4570"></td>
          <td id="LC4570" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC1_conc_swi</td>
        </tr>
        <tr>
          <td id="L4571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4571"></td>
          <td id="LC4571" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC2_conc_swi</td>
        </tr>
        <tr>
          <td id="L4572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4572"></td>
          <td id="LC4572" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4573"></td>
          <td id="LC4573" class="blob-code blob-code-inner js-file-line">        Cflx <span class="pl-k">=</span> C1flx <span class="pl-k">+</span> C2flx</td>
        </tr>
        <tr>
          <td id="L4574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4574"></td>
          <td id="LC4574" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4575"></td>
          <td id="LC4575" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;Cflx swi&#39;, char(9), Cflx</span></td>
        </tr>
        <tr>
          <td id="L4576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4576"></td>
          <td id="LC4576" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C1flx swi&#39;, char(9), C1flx</span></td>
        </tr>
        <tr>
          <td id="L4577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4577"></td>
          <td id="LC4577" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C2flx swi&#39;, char(9), C2flx</span></td>
        </tr>
        <tr>
          <td id="L4578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4578"></td>
          <td id="LC4578" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4579"></td>
          <td id="LC4579" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4580"></td>
          <td id="LC4580" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column (Dom 08.02.2018 was -(1-por)*w*A21*exp(aa21*zinf))</span></td>
        </tr>
        <tr>
          <td id="L4581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4581"></td>
          <td id="LC4581" class="blob-code blob-code-inner js-file-line">        F_TOC1 <span class="pl-k">=</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4582"></td>
          <td id="LC4582" class="blob-code blob-code-inner js-file-line">        F_TOC2 <span class="pl-k">=</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4583"></td>
          <td id="LC4583" class="blob-code blob-code-inner js-file-line">        F_TOC <span class="pl-k">=</span> F_TOC1 <span class="pl-k">+</span> F_TOC2</td>
        </tr>
        <tr>
          <td id="L4584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4584"></td>
          <td id="LC4584" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC1 zinf&#39;, char(9), F_TOC1</span></td>
        </tr>
        <tr>
          <td id="L4585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4585"></td>
          <td id="LC4585" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC2 zinf&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L4586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4586"></td>
          <td id="LC4586" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC zinf&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L4587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4587"></td>
          <td id="LC4587" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4588"></td>
          <td id="LC4588" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Concentration at lower boundary zinf</span></td>
        </tr>
        <tr>
          <td id="L4589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4589"></td>
          <td id="LC4589" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zinf<span class="pl-k">&lt;</span>zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4590"></td>
          <td id="LC4590" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4591"></td>
          <td id="LC4591" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4592"></td>
          <td id="LC4592" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4593"></td>
          <td id="LC4593" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4594"></td>
          <td id="LC4594" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4595"></td>
          <td id="LC4595" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4596"></td>
          <td id="LC4596" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4597"></td>
          <td id="LC4597" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: need to give back fraction buried of initially deposited (so fraction of the input values to this subroutine)</span></td>
        </tr>
        <tr>
          <td id="L4598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4598"></td>
          <td id="LC4598" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC1_conc_zinf &#39;, char(9), loc_POC1_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L4599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4599"></td>
          <td id="LC4599" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC2_conc_zinf &#39;, char(9), loc_POC2_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L4600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4600"></td>
          <td id="LC4600" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4601"></td>
          <td id="LC4601" class="blob-code blob-code-inner js-file-line">        dum_sed_pres_fracC <span class="pl-k">=</span> (loc_POC1_conc_zinf<span class="pl-k">+</span>loc_POC2_conc_zinf)<span class="pl-k">/</span>(dum_POC1_conc_swi<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4602"></td>
          <td id="LC4602" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4603"></td>
          <td id="LC4603" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4604"></td>
          <td id="LC4604" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC1&#39;, char(9), F_TOC1</span></td>
        </tr>
        <tr>
          <td id="L4605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4605"></td>
          <td id="LC4605" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC2&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L4606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4606"></td>
          <td id="LC4606" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L4607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4607"></td>
          <td id="LC4607" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4608"></td>
          <td id="LC4608" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4609"></td>
          <td id="LC4609" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_zTOC_2Diffcoeff</span></td>
        </tr>
        <tr>
          <td id="L4610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4610"></td>
          <td id="LC4610" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4611"></td>
          <td id="LC4611" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4612"></td>
          <td id="LC4612" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4613"></td>
          <td id="LC4613" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">SUBROUTINE</span> <span class="pl-en">sub_huelseetal2016_zTOC_CONCENTRATION</span>(<span class="pl-v">dum_POC1_wtpct_swi</span>, <span class="pl-v">dum_POC2_wtpct_swi</span>, <span class="pl-v">dum_sed_pres_fracC</span>)</td>
        </tr>
        <tr>
          <td id="L4614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4614"></td>
          <td id="LC4614" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!!!!!!!!!!!!!!!!!!!!!!!</span></td>
        </tr>
        <tr>
          <td id="L4615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4615"></td>
          <td id="LC4615" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4616"></td>
          <td id="LC4616" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>       OLD APPROACH, USING TOC CONCENTRATION AT SWI</span></td>
        </tr>
        <tr>
          <td id="L4617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4617"></td>
          <td id="LC4617" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4618"></td>
          <td id="LC4618" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!!!!!!!!!!!!!!!!!!!!!!!</span></td>
        </tr>
        <tr>
          <td id="L4619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4619"></td>
          <td id="LC4619" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L4620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4620"></td>
          <td id="LC4620" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span></span></td>
        </tr>
        <tr>
          <td id="L4621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4621"></td>
          <td id="LC4621" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   calculate benthic burial/recycling fluxes (see documentation for details!)</span></td>
        </tr>
        <tr>
          <td id="L4622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4622"></td>
          <td id="LC4622" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   __________________________________________________________</span></td>
        </tr>
        <tr>
          <td id="L4623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4623"></td>
          <td id="LC4623" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4624"></td>
          <td id="LC4624" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>   organic matter burial 2 fractions</span></td>
        </tr>
        <tr>
          <td id="L4625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4625"></td>
          <td id="LC4625" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4626"></td>
          <td id="LC4626" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> dummy arguments</span></td>
        </tr>
        <tr>
          <td id="L4627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4627"></td>
          <td id="LC4627" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">in</span>)<span class="pl-k">::</span>dum_POC1_wtpct_swi, dum_POC2_wtpct_swi             <span class="pl-c"><span class="pl-c">!</span> POC concentrations at SWI</span></td>
        </tr>
        <tr>
          <td id="L4628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4628"></td>
          <td id="LC4628" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span>,<span class="pl-k">INTENT</span>(<span class="pl-k">inout</span>)<span class="pl-k">::</span>dum_sed_pres_fracC                              <span class="pl-c"><span class="pl-c">!</span> POC concentrations at zinf</span></td>
        </tr>
        <tr>
          <td id="L4629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4629"></td>
          <td id="LC4629" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4630"></td>
          <td id="LC4630" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> local variables</span></td>
        </tr>
        <tr>
          <td id="L4631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4631"></td>
          <td id="LC4631" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> loc_POC1_conc_zinf, loc_POC2_conc_zinf</td>
        </tr>
        <tr>
          <td id="L4632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4632"></td>
          <td id="LC4632" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>    real aa11, bb11, aa21, A11, A21, aa12, bb12, aa22, A12, A22</span></td>
        </tr>
        <tr>
          <td id="L4633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4633"></td>
          <td id="LC4633" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> dC1dz, C1flx, dC2dz, C2flx, Cflx                             <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L4634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4634"></td>
          <td id="LC4634" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">real</span> F_TOC1, F_TOC2, F_TOC                                        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column</span></td>
        </tr>
        <tr>
          <td id="L4635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4635"></td>
          <td id="LC4635" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4636"></td>
          <td id="LC4636" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4637"></td>
          <td id="LC4637" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; ------------------ START zTOC ---------------------&#39;</span></td>
        </tr>
        <tr>
          <td id="L4638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4638"></td>
          <td id="LC4638" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*,&#39; sedimentation rate/burial velocity w = &#39;, w</span></td>
        </tr>
        <tr>
          <td id="L4639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4639"></td>
          <td id="LC4639" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4640"></td>
          <td id="LC4640" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> initialize BW conentration POC1,2 in mol/cm3   DH WHY here not divided by 12?????</span></td>
        </tr>
        <tr>
          <td id="L4641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4641"></td>
          <td id="LC4641" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_POC1_conc_swi=0.01*dum_POC1_wtpct_swi*rho_sed              ! %TOC concentration frac1 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4642"></td>
          <td id="LC4642" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        dum_POC2_conc_swi=0.01*dum_POC2_wtpct_swi*rho_sed              ! %TOC concentration frac2 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4643"></td>
          <td id="LC4643" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Dom: Use this when comparing with MATLAB, here we use wt% of g -&gt; *1/12</span></td>
        </tr>
        <tr>
          <td id="L4644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4644"></td>
          <td id="LC4644" class="blob-code blob-code-inner js-file-line">        dum_POC1_conc_swi<span class="pl-k">=</span><span class="pl-c1">0.01</span><span class="pl-k">*</span>dum_POC1_wtpct_swi<span class="pl-k">/</span><span class="pl-c1">12.0</span><span class="pl-k">*</span>rho_sed              <span class="pl-c"><span class="pl-c">!</span> %TOC concentration frac1 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4645"></td>
          <td id="LC4645" class="blob-code blob-code-inner js-file-line">        dum_POC2_conc_swi<span class="pl-k">=</span><span class="pl-c1">0.01</span><span class="pl-k">*</span>dum_POC2_wtpct_swi<span class="pl-k">/</span><span class="pl-c1">12.0</span><span class="pl-k">*</span>rho_sed              <span class="pl-c"><span class="pl-c">!</span> %TOC concentration frac2 at SWI (wt%) -&gt; (mol/cm3 bulk phase)</span></td>
        </tr>
        <tr>
          <td id="L4646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4646"></td>
          <td id="LC4646" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;dum_POC1_conc_swi&#39;, char(9), dum_POC1_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4647"></td>
          <td id="LC4647" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;dum_POC2_conc_swi&#39;, char(9), dum_POC2_conc_swi</span></td>
        </tr>
        <tr>
          <td id="L4648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4648"></td>
          <td id="LC4648" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4649"></td>
          <td id="LC4649" class="blob-code blob-code-inner js-file-line">        aa11 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4650"></td>
          <td id="LC4650" class="blob-code blob-code-inner js-file-line">        bb11 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k1))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4651"></td>
          <td id="LC4651" class="blob-code blob-code-inner js-file-line">        aa21 <span class="pl-k">=</span> (<span class="pl-k">-</span>k1<span class="pl-k">/</span>w)</td>
        </tr>
        <tr>
          <td id="L4652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4652"></td>
          <td id="LC4652" class="blob-code blob-code-inner js-file-line">        A11 <span class="pl-k">=</span> <span class="pl-k">-</span>(dum_POC1_conc_swi<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4653"></td>
          <td id="LC4653" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        if(exp(aa21*zbio) &gt; const_real_nullsmall) then</span></td>
        </tr>
        <tr>
          <td id="L4654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4654"></td>
          <td id="LC4654" class="blob-code blob-code-inner js-file-line">        A21<span class="pl-k">=</span>(A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4655"></td>
          <td id="LC4655" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        else</span></td>
        </tr>
        <tr>
          <td id="L4656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4656"></td>
          <td id="LC4656" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            A21=(A11*(exp(aa11*zbio)-exp(bb11*zbio))+dum_POC1_conc_swi*exp(bb11*zbio))/const_real_nullsmall</span></td>
        </tr>
        <tr>
          <td id="L4657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4657"></td>
          <td id="LC4657" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>            print*,&#39;in small exp(aa21*zbio)&#39;, +exp(aa21*zbio)</span></td>
        </tr>
        <tr>
          <td id="L4658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4658"></td>
          <td id="LC4658" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        end if</span></td>
        </tr>
        <tr>
          <td id="L4659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4659"></td>
          <td id="LC4659" class="blob-code blob-code-inner js-file-line">        aa12 <span class="pl-k">=</span> (w<span class="pl-k">-</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4660"></td>
          <td id="LC4660" class="blob-code blob-code-inner js-file-line">        bb12 <span class="pl-k">=</span> (w<span class="pl-k">+</span><span class="pl-k">sqrt</span>(w<span class="pl-k">**</span><span class="pl-c1">2+4</span><span class="pl-k">*</span>DC1<span class="pl-k">*</span>k2))<span class="pl-k">/</span>(<span class="pl-c1">2</span><span class="pl-k">*</span>DC1)</td>
        </tr>
        <tr>
          <td id="L4661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4661"></td>
          <td id="LC4661" class="blob-code blob-code-inner js-file-line">        aa22 <span class="pl-k">=</span> (<span class="pl-k">-</span>k2<span class="pl-k">/</span>w)</td>
        </tr>
        <tr>
          <td id="L4662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4662"></td>
          <td id="LC4662" class="blob-code blob-code-inner js-file-line">        A12<span class="pl-k">=-</span>(dum_POC2_conc_swi<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4663"></td>
          <td id="LC4663" class="blob-code blob-code-inner js-file-line">        A22<span class="pl-k">=</span>(A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zbio)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zbio))<span class="pl-k">/</span>(<span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zbio)<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4664"></td>
          <td id="LC4664" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4665"></td>
          <td id="LC4665" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!! no need for this as this is SWI concentration for z0 = 0!</span></td>
        </tr>
        <tr>
          <td id="L4666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4666"></td>
          <td id="LC4666" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    ! % Calculate concentration at z0</span></td>
        </tr>
        <tr>
          <td id="L4667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4667"></td>
          <td id="LC4667" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    if(z0&lt;=zbio) then</span></td>
        </tr>
        <tr>
          <td id="L4668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4668"></td>
          <td id="LC4668" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A11*(exp(aa11*z0)-exp(bb11*z0))+dum_POC1_conc_swi*exp(bb11*z0)</span></td>
        </tr>
        <tr>
          <td id="L4669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4669"></td>
          <td id="LC4669" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A12*(exp(aa12*z0)-exp(bb12*z0))+dum_POC2_conc_swi*exp(bb12*z0)</span></td>
        </tr>
        <tr>
          <td id="L4670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4670"></td>
          <td id="LC4670" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    else</span></td>
        </tr>
        <tr>
          <td id="L4671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4671"></td>
          <td id="LC4671" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C1=A21*exp(aa21*z0)</span></td>
        </tr>
        <tr>
          <td id="L4672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4672"></td>
          <td id="LC4672" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!        C2=A22*exp(aa22*z0)</span></td>
        </tr>
        <tr>
          <td id="L4673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4673"></td>
          <td id="LC4673" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    end if</span></td>
        </tr>
        <tr>
          <td id="L4674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4674"></td>
          <td id="LC4674" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    C = C1 + C2</span></td>
        </tr>
        <tr>
          <td id="L4675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4675"></td>
          <td id="LC4675" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!</span></td>
        </tr>
        <tr>
          <td id="L4676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4676"></td>
          <td id="LC4676" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39;C = C1 + C2 &#39;, C</span></td>
        </tr>
        <tr>
          <td id="L4677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4677"></td>
          <td id="LC4677" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>!!    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4678"></td>
          <td id="LC4678" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4679"></td>
          <td id="LC4679" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Cflx: Sed input flux to upper boundary, per cm^2 water column</span></td>
        </tr>
        <tr>
          <td id="L4680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4680"></td>
          <td id="LC4680" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(z0 &lt; zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4681"></td>
          <td id="LC4681" class="blob-code blob-code-inner js-file-line">            dC1dz <span class="pl-k">=</span>  A11<span class="pl-k">*</span>(aa11<span class="pl-k">*</span><span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span>bb11<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L4682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4682"></td>
          <td id="LC4682" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC1dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC1_conc_swi)</td>
        </tr>
        <tr>
          <td id="L4683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4683"></td>
          <td id="LC4683" class="blob-code blob-code-inner js-file-line">            dC2dz <span class="pl-k">=</span>  A12<span class="pl-k">*</span>(aa12<span class="pl-k">*</span><span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>z0)<span class="pl-k">-</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span>bb12<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>z0)</td>
        </tr>
        <tr>
          <td id="L4684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4684"></td>
          <td id="LC4684" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>(<span class="pl-k">-</span>DC1<span class="pl-k">*</span>dC2dz <span class="pl-k">+</span> w<span class="pl-k">*</span>dum_POC2_conc_swi)</td>
        </tr>
        <tr>
          <td id="L4685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4685"></td>
          <td id="LC4685" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4686"></td>
          <td id="LC4686" class="blob-code blob-code-inner js-file-line">            C1flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC1_conc_swi</td>
        </tr>
        <tr>
          <td id="L4687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4687"></td>
          <td id="LC4687" class="blob-code blob-code-inner js-file-line">            C2flx <span class="pl-k">=</span> <span class="pl-k">-</span> (<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>dum_POC2_conc_swi</td>
        </tr>
        <tr>
          <td id="L4688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4688"></td>
          <td id="LC4688" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4689"></td>
          <td id="LC4689" class="blob-code blob-code-inner js-file-line">        Cflx <span class="pl-k">=</span> C1flx <span class="pl-k">+</span> C2flx</td>
        </tr>
        <tr>
          <td id="L4690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4690"></td>
          <td id="LC4690" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4691"></td>
          <td id="LC4691" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;Cflx swi&#39;, char(9), Cflx</span></td>
        </tr>
        <tr>
          <td id="L4692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4692"></td>
          <td id="LC4692" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C1flx swi&#39;, char(9), C1flx</span></td>
        </tr>
        <tr>
          <td id="L4693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4693"></td>
          <td id="LC4693" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;C2flx swi&#39;, char(9), C2flx</span></td>
        </tr>
        <tr>
          <td id="L4694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4694"></td>
          <td id="LC4694" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4695"></td>
          <td id="LC4695" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4696"></td>
          <td id="LC4696" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Flux through lower boundary zinf, per cm^2 water-column</span></td>
        </tr>
        <tr>
          <td id="L4697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4697"></td>
          <td id="LC4697" class="blob-code blob-code-inner js-file-line">        F_TOC1 <span class="pl-k">=</span> <span class="pl-k">-</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4698"></td>
          <td id="LC4698" class="blob-code blob-code-inner js-file-line">        F_TOC2 <span class="pl-k">=</span> <span class="pl-k">-</span>(<span class="pl-c1">1</span><span class="pl-k">-</span>por)<span class="pl-k">*</span>w<span class="pl-k">*</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4699"></td>
          <td id="LC4699" class="blob-code blob-code-inner js-file-line">        F_TOC <span class="pl-k">=</span> F_TOC1 <span class="pl-k">+</span> F_TOC2</td>
        </tr>
        <tr>
          <td id="L4700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4700"></td>
          <td id="LC4700" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC1 zinf&#39;, char(9), F_TOC1</span></td>
        </tr>
        <tr>
          <td id="L4701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4701"></td>
          <td id="LC4701" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC2 zinf&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L4702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4702"></td>
          <td id="LC4702" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;F_TOC zinf&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L4703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4703"></td>
          <td id="LC4703" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4704"></td>
          <td id="LC4704" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> Concentration at lower boundary zinf</span></td>
        </tr>
        <tr>
          <td id="L4705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4705"></td>
          <td id="LC4705" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(zinf<span class="pl-k">&lt;</span>zbio) <span class="pl-k">then</span></td>
        </tr>
        <tr>
          <td id="L4706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4706"></td>
          <td id="LC4706" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A11<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa11<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC1_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb11<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4707"></td>
          <td id="LC4707" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A12<span class="pl-k">*</span>(<span class="pl-k">exp</span>(aa12<span class="pl-k">*</span>zinf)<span class="pl-k">-</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf))<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">*</span><span class="pl-k">exp</span>(bb12<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4708"></td>
          <td id="LC4708" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L4709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4709"></td>
          <td id="LC4709" class="blob-code blob-code-inner js-file-line">            loc_POC1_conc_zinf<span class="pl-k">=</span>A21<span class="pl-k">*</span><span class="pl-k">exp</span>(aa21<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4710"></td>
          <td id="LC4710" class="blob-code blob-code-inner js-file-line">            loc_POC2_conc_zinf<span class="pl-k">=</span>A22<span class="pl-k">*</span><span class="pl-k">exp</span>(aa22<span class="pl-k">*</span>zinf)</td>
        </tr>
        <tr>
          <td id="L4711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4711"></td>
          <td id="LC4711" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">end if</span></td>
        </tr>
        <tr>
          <td id="L4712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4712"></td>
          <td id="LC4712" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4713"></td>
          <td id="LC4713" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span> DH: need to give back fraction buried of initially deposited (so fraction of the input values to this subroutine)</span></td>
        </tr>
        <tr>
          <td id="L4714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4714"></td>
          <td id="LC4714" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC1_conc_zinf &#39;, char(9), loc_POC1_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L4715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4715"></td>
          <td id="LC4715" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">!</span>        print*, &#39;loc_POC2_conc_zinf &#39;, char(9), loc_POC2_conc_zinf</span></td>
        </tr>
        <tr>
          <td id="L4716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4716"></td>
          <td id="LC4716" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4717"></td>
          <td id="LC4717" class="blob-code blob-code-inner js-file-line">        dum_sed_pres_fracC <span class="pl-k">=</span> (loc_POC1_conc_zinf<span class="pl-k">+</span>loc_POC2_conc_zinf)<span class="pl-k">/</span>(dum_POC1_conc_swi<span class="pl-k">+</span>dum_POC2_conc_swi<span class="pl-k">+</span>const_real_nullsmall)</td>
        </tr>
        <tr>
          <td id="L4718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4718"></td>
          <td id="LC4718" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4719"></td>
          <td id="LC4719" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39; &#39;</span></td>
        </tr>
        <tr>
          <td id="L4720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4720"></td>
          <td id="LC4720" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC1&#39;, char(9), F_TOC1</span></td>
        </tr>
        <tr>
          <td id="L4721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4721"></td>
          <td id="LC4721" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC2&#39;, char(9), F_TOC2</span></td>
        </tr>
        <tr>
          <td id="L4722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4722"></td>
          <td id="LC4722" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">!</span>    print*, &#39;F_TOC&#39;, char(9), F_TOC</span></td>
        </tr>
        <tr>
          <td id="L4723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4723"></td>
          <td id="LC4723" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4724"></td>
          <td id="LC4724" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4725"></td>
          <td id="LC4725" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">end</span> <span class="pl-k">SUBROUTINE</span><span class="pl-en"> sub_huelseetal2016_zTOC_CONCENTRATION</span></td>
        </tr>
        <tr>
          <td id="L4726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4726"></td>
          <td id="LC4726" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L4727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4727"></td>
          <td id="LC4727" class="blob-code blob-code-inner js-file-line"><span class="pl-k">END MODULE</span> sedgem_box_benthic</td>
        </tr>
        <tr>
          <td id="L4728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4728"></td>
          <td id="LC4728" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
  </table>
</div>

  <details class="details-reset details-overlay BlobToolbar position-absolute js-file-line-actions dropdown d-none" aria-hidden="true">
    <summary class="btn-octicon ml-0 px-2 p-0 color-bg-default border color-border-default rounded-2" aria-label="Inline file action toolbar">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
    </summary>
    <details-menu>

      <ul class="BlobToolbar-dropdown dropdown-menu dropdown-menu-se ml-2 mt-2"
      style="width:185px"
      >
        <li>
          <clipboard-copy role="menuitem" class="dropdown-item" id="js-copy-lines" style="cursor:pointer;" aria-label="Copy lines">
            Copy lines
          </clipboard-copy>
        </li>
        <li>
          <clipboard-copy role="menuitem" class="dropdown-item" id="js-copy-permalink" style="cursor:pointer;" aria-label="Copy permalink">
            Copy permalink
          </clipboard-copy>
        </li>
        <li><a class="dropdown-item js-update-url-with-hash" id="js-view-git-blame" role="menuitem" href="/derpycode/cgenie.muffin/blame/b47047942d1431bc136db842ad9a68027c3a1949/genie-sedgem/src/fortran/sedgem_box_benthic.f90">View git blame</a></li>
          <li><a class="dropdown-item" id="js-new-issue" role="menuitem" href="/derpycode/cgenie.muffin/issues/new">Reference in new issue</a></li>
      </ul>
    </details-menu>
  </details>

    </div>

    </div>


  

  <details class="details-reset details-overlay details-overlay-dark" id="jumpto-line-details-dialog">
    <summary data-hotkey="l" aria-label="Jump to line"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump overflow-hidden" aria-label="Jump to line">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form Box-body d-flex" data-turbo="false" action="" accept-charset="UTF-8" method="get">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
          <button data-close-dialog="" type="submit" data-view-component="true" class="btn">    Go
</button>
</form>    </details-dialog>
  </details>



    <div class="pt-3" >
      <details class="details-reset details-overlay details-overlay-dark " >
                <summary data-view-component="true" class="btn-link">    Give feedback
</summary>

  <details-dialog
    class="Box d-flex flex-column anim-fade-in fast Box--overlay overflow-visible"
      aria-label="Provide feedback"
      src="/derpycode/cgenie.muffin/repos/code_nav_survey"
      
    >
    <div class="Box-header">
      <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
        <h1 class="Box-title" >Provide feedback</h1>
    </div>
      <div class="Box-body overflow-auto">
                  <include-fragment>
            <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="my-3 mx-auto d-block anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
          </include-fragment>

      </div>
  </details-dialog>
</details>
    </div>
</div>

  </div>


  </div>

</turbo-frame>


    </main>
  </div>

  </div>

          <footer class="footer width-full container-xl p-responsive" role="contentinfo">
  <h2 class='sr-only'>Footer</h2>

  <div class="position-relative d-flex flex-items-center pb-2 f6 color-fg-muted border-top color-border-muted flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap mt-6 pt-6">
    <div class="list-style-none d-flex flex-wrap col-0 col-lg-2 flex-justify-start flex-lg-justify-between mb-2 mb-lg-0">
      <div class="mt-2 mt-lg-0 d-flex flex-items-center">
        <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-2" href="https://github.com">
          <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
</svg>
</a>        <span>
        &copy; 2023 GitHub, Inc.
        </span>
      </div>
    </div>

    <nav aria-label='footer' class="col-12 col-lg-8">
      <h3 class='sr-only' id='sr-footer-heading'>Footer navigation</h3>
      <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0" aria-labelledby='sr-footer-heading'>
          <li class="mr-3 mr-lg-0"><a href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}">Terms</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}">Privacy</a></li>
          <li class="mr-3 mr-lg-0"><a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security">Security</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://www.githubstatus.com/" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}">Status</a></li>
          <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to help, text:Docs" href="https://docs.github.com">Docs</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://support.github.com?tags=dotcom-footer" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}">Contact GitHub</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Pricing&quot;,&quot;label&quot;:&quot;text:Pricing&quot;}">Pricing</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://docs.github.com" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to api&quot;,&quot;label&quot;:&quot;text:api&quot;}">API</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://services.github.com" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to training&quot;,&quot;label&quot;:&quot;text:training&quot;}">Training</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://github.blog" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to blog&quot;,&quot;label&quot;:&quot;text:blog&quot;}">Blog</a></li>
          <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>
      </ul>
    </nav>
  </div>

  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 color-fg-muted"></span>
  </div>
</footer>




  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You can’t perform that action at this time.
  </div>

  <div class="js-stale-session-flash flash flash-warn flash-banner" hidden
    >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0 tooltipped-no-delay" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>


    <style>
      .user-mention[href$="/derpycode"] {
        color: var(--color-user-mention-fg);
        background-color: var(--color-user-mention-bg);
        border-radius: 2px;
        margin-left: -2px;
        margin-right: -2px;
        padding: 0 2px;
      }
    </style>


    </div>

    <div id="js-global-screen-reader-notice" class="sr-only" aria-live="polite" ></div>
  </body>
</html>

